#include "header.h"

/*****************************************************/
//Функція меню з якої здійснюються всі інші операції
/*****************************************************/
void main_manu_function(void)
{
  static __CURRENT_EKRAN current_ekran_reserv_off_on;
  static unsigned char working_ekran_reserv_off_on[MAX_ROW_LCD][MAX_COL_LCD];

  static __CURRENT_EKRAN current_ekran_reserv_repr;
  static unsigned char working_ekran_reserv_repr[MAX_ROW_LCD][MAX_COL_LCD];
  //Перевіряємо чи не треба відобразити інформацію про режим перпрограмування або спрацювання захистів
  if (
      (
       (_GET_STATE(reprogram_device, UNSUPPORT_REPROGRAM)) ||
       (_CHECK_SET_BIT(diagnostyka, WARNING_REPROGRAM) != 0)
      )
      &&
      (current_ekran.current_level != EKRAN_UNSUPPORT_REPROGRAM) 
      &&
      (current_ekran.current_level != EKRAN_REPROGRAM_ACTIVE   )
      &&
      (new_state_keyboard == 0)
     ) 
  {
    //Запам'ятовуємо поперердній стан меню
    current_ekran_reserv_repr = current_ekran;
    //Запам'ятовуємо попередній екран (бо діалогові вікна не обновлюються при виконанні команди REWRITE)
    for (size_t i = 0; i < MAX_ROW_LCD; ++i)
    {
      for (size_t j = 0; j < MAX_COL_LCD; ++j) working_ekran_reserv_repr[i][j] = working_ekran[i][j];
    }

    //Переходимо на меню відображення повідомлення, що ми у режимі репрограмування
    current_ekran.current_level = (_CHECK_SET_BIT(diagnostyka, WARNING_REPROGRAM) != 0) ? EKRAN_REPROGRAM_ACTIVE : EKRAN_UNSUPPORT_REPROGRAM;
    current_ekran.index_position = -1/*position_in_current_level_menu[current_ekran.current_level]*/;
    current_ekran.edition = 0;
    current_ekran.cursor_on = 0;
    current_ekran.cursor_blinking_on = 0;

    //Виставляємо команду на обновлекння нового екрану, а всі попередні натискування відміняємо
    new_state_keyboard = (1<<BIT_REWRITE);
  }
  else if (
           (
            ((current_ekran.current_level == EKRAN_REPROGRAM_ACTIVE   ) && (_CHECK_SET_BIT(diagnostyka, WARNING_REPROGRAM) == 0)) ||
            ((current_ekran.current_level == EKRAN_UNSUPPORT_REPROGRAM) && (!_GET_STATE(reprogram_device, UNSUPPORT_REPROGRAM)))
           )   
           &&
           (new_state_keyboard == 0)
          )
  {
    //Переходимо у попереднє меню
    current_ekran = current_ekran_reserv_repr;

    //Відображаємо попередній екран (бо діалогові вікна не обновлюються при виконанні команди REWRITE)
    for (size_t i = 0; i < MAX_ROW_LCD; ++i)
    {
      for (size_t j = 0; j < MAX_COL_LCD; ++j) working_ekran[i][j] = working_ekran_reserv_repr[i][j];
    }
    //Обновити повністю весь екран
    current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;
    time_rewrite = MAX_TIME_REWRITE_EKRAN;

    new_state_keyboard = (1<<BIT_REWRITE); //Ця команда буде виконана після поперднього відновлення стану екрану, який був до переходу у вікно відображення інформації про програмування або вікно, яке говорить, що цей режим не підтримується
    return; //цим виходом я перериваю зараз виконання цієї функції, щоб спочатку булоа виведена попередня інформація, к потім вже відпрацюав біт BIT_REWRITE
  }
//!  if ((current_settings.control_extra_settings_1 & MASKA_FOR_BIT(INDEX_ML_CTREXTRA_SETTINGS_1_CTRL_WINDOW_OFF_CB)) != 0)
//!  {
//!    if (
//!        (
//!         (info_vidkluchennja_vymykacha[0] != 0) ||
//!         (info_vidkluchennja_vymykacha[1] != 0)
//!        ) &&   
//!        (current_ekran.current_level != EKRAN_VIDKLUCHENNJA) &&
//!        ((new_state_keyboard & (1<<BIT_REWRITE)) == 0)
//!       )   
//!    {
//!
//!      time_rewrite = 0;
//!      //Запам'ятовуємо поперердній стан меню
//!      current_ekran_reserv_off_on = current_ekran;
//!      //Запам'ятовуємо попередній екран (бо діалогові вікна не обновлюються при виконанні команди REWRITE)
//!      for (unsigned int i = 0; i < MAX_ROW_LCD; i++)
//!      {
//!        for (unsigned int j = 0; j < MAX_COL_LCD; j++) working_ekran_reserv_off_on[i][j] = working_ekran[i][j];
//!      }
//!
//!      //Переходимо на меню відображення спрацювання захистів
//!      current_ekran.current_level = EKRAN_VIDKLUCHENNJA;
//!      current_ekran.index_position = -1/*position_in_current_level_menu[current_ekran.current_level]*/;
//!      current_ekran.edition = 0;
//!      current_ekran.cursor_on = 0;
//!      current_ekran.cursor_blinking_on = 0;
//!
//!      //Виставляємо команду на обновлекння нового екрану, а всі попередні натискування відміняємо
//!      new_state_keyboard = (1<<BIT_REWRITE);
//!    }
//!  }
//!  else if ((current_settings.control_extra_settings_1 & MASKA_FOR_BIT(INDEX_ML_CTREXTRA_SETTINGS_1_CTRL_WINDOW_OFF_CB)) == 0)
//!  {
//!    //Очищаємо інформацію про спрацювання захистів
//!    info_vidkluchennja_vymykacha[0] = 0;
//!    info_vidkluchennja_vymykacha[1] = 0;
//!  }
  
  //Перевіряємо чи якась кнопка натиснута
  if (new_state_keyboard !=0)
  {
    static unsigned int pervynna_vtorynna; //Зміна для відображенні або значень із первинної обмоки, або із вторинної обмотки
    
    //Аналізуємо в якому ми зараз робочому екрані і виконуємо відповідні дії
    switch (current_ekran.current_level)
    {
/******************************************************************************************************************************************/ 
    case EKRAN_LEVEL_PASSWORD:
    case EKRAN_LEVEL_PASSWORD_HARD:
    case EKRAN_LEVEL_PASSWORD_REPROGRAM:
      {
        //Зміння для фіксації стану курсору з попреднього рівня меню
        static __PREVIOUS_STATE_CURSOR previous_state_cursor;
        //Змінні для фіксації введеного паролю
        static unsigned int new_password;
        static unsigned int number_symbols;
        
        //Очищаємо всі біти краім упралінських
        new_state_keyboard &= (1<<BIT_KEY_ENTER)|(1<<BIT_KEY_ESC)|(1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN)|(1<<BIT_KEY_RIGHT)|(1<<BIT_KEY_LEFT)|(1<<BIT_REWRITE);

        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            previous_state_cursor.position_cursor_x = current_ekran.position_cursor_x;              
            previous_state_cursor.cursor_on = current_ekran.cursor_on;
            previous_state_cursor.cursor_blinking_on = current_ekran.cursor_blinking_on;
            current_ekran.cursor_on = 1;
            current_ekran.cursor_blinking_on = 1;
            current_ekran.position_cursor_x = COL_NEW_PASSWORD_BEGIN;
            position_in_current_level_menu[current_ekran.current_level] = 1;
            //Скидаємо новий пароль у нуль і скидаємо кількість введених символів
            new_password = 0;
            number_symbols = 0;
            
            //Формуємо екран рівня password
            make_ekran_level_password(new_password, 0);
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              unsigned int password = 0;
              if (current_ekran.current_level == EKRAN_LEVEL_PASSWORD)
                password = current_settings.password1;
              else if (current_ekran.current_level == EKRAN_LEVEL_PASSWORD_HARD)
                password = current_settings.password2;
              else if (current_ekran.current_level == EKRAN_LEVEL_PASSWORD_REPROGRAM)
                password = current_settings.password3;
              else
              {
                //Теоретично цього ніколи не мало б бути
                total_error_sw_fixed();
              }

              if (new_password == password)
              {
                //Пароль зійшовся
                //Переходимо у попереднє меню у режимі редагування
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 1;
                current_ekran.position_cursor_x = previous_state_cursor.position_cursor_x;
                current_ekran.cursor_on = previous_state_cursor.cursor_on;
                current_ekran.cursor_blinking_on = previous_state_cursor.cursor_blinking_on;
              }
              else
              {
                //Пароль не зійшовся
                //Переходимо у попереднє меню і анульовуємо процес редагування
                unsigned int repeat = false;
                do
                {
                  current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                  current_ekran.edition = 0;
                  if (repeat == false)
                  {
                    current_ekran.position_cursor_x = previous_state_cursor.position_cursor_x;
                    current_ekran.cursor_on = previous_state_cursor.cursor_on;
                    current_ekran.cursor_blinking_on = previous_state_cursor.cursor_blinking_on;
                  }
                  else break;
                  
                  if (current_ekran.current_level == EKRAN_REPROGRAM) repeat = true;
                }
                while (repeat);
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
              //Виставляємо біт обновлення екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              //Натиснута кнопка ESC

              //Переходимо у попереднє меню і анульовуємо процес редагування
              unsigned int repeat = false;
              do
              {
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                if (repeat == false)
                {
                  current_ekran.position_cursor_x = previous_state_cursor.position_cursor_x;
                  current_ekran.cursor_on = previous_state_cursor.cursor_on;
                  current_ekran.cursor_blinking_on = previous_state_cursor.cursor_blinking_on;
                }
                else break;
                  
                if (current_ekran.current_level == EKRAN_REPROGRAM) repeat = true;
              }
              while (repeat);
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
              //Виставляємо біт обновлення екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              new_password = new_password*10 + 1;
              number_symbols++;
              current_ekran.position_cursor_x++;
              
              //Формуємо екран рівня password
              make_ekran_level_password(new_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
              //Перевіряємо чи не натиснуто максимальну кількість символів для паролю (4) і якщо це так, то автоматично приймаємо його
              if (number_symbols >= 4) new_state_keyboard |= (1<<BIT_KEY_ENTER);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              new_password = new_password*10 + 3;
              number_symbols++;
              current_ekran.position_cursor_x++;

              //Формуємо екран рівня password
              make_ekran_level_password(new_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
              //Перевіряємо чи не натиснуто максимальну кількість символів для паролю (4) і якщо це так, то автоматично приймаємо його
              if (number_symbols >= 4) new_state_keyboard |= (1<<BIT_KEY_ENTER);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_RIGHT))
            {
              //Натиснута кнопка RIGHT
              new_password = new_password*10 + 2;
              number_symbols++;
              current_ekran.position_cursor_x++;

              //Формуємо екран рівня password
              make_ekran_level_password(new_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
              //Перевіряємо чи не натиснуто максимальну кількість символів для паролю (4) і якщо це так, то автоматично приймаємо його
              if (number_symbols >= 4) new_state_keyboard |= (1<<BIT_KEY_ENTER);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_LEFT))
            {
              //Натиснута кнопка LEFT
              new_password = new_password*10 + 4;
              number_symbols++;
              current_ekran.position_cursor_x++;

              //Формуємо екран рівня password
              make_ekran_level_password(new_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
              //Перевіряємо чи не натиснуто максимальну кількість символів для паролю (4) і якщо це так, то автоматично приймаємо його
              if (number_symbols >= 4) new_state_keyboard |= (1<<BIT_KEY_ENTER);
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
          
        }
        break;
      }
/******************************************************************************************************************************************/ 

/******************************************************************************************************************************************/ 
    case EKRAN_LEVEL_SET_NEW_PASSWORD1:
    case EKRAN_LEVEL_SET_NEW_PASSWORD2:
    case EKRAN_LEVEL_SET_NEW_PASSWORD3:
      {
        //Змінні для фіксації введеного паролю
        static unsigned int new_setting_password;
        static int number_symbols_new_setting_password;
        
        //Очищаємо всі біти краім упралінських
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        
        if (current_ekran.edition == 1)
          maska_keyboard_bits |= (1<<BIT_KEY_RIGHT) | (1<<BIT_KEY_LEFT) | (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        
        new_state_keyboard &= maska_keyboard_bits;

        if (new_state_keyboard !=0)
        {
          unsigned int *p_password = NULL;
          if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD1)
            p_password = &current_settings.password1;
          else if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD2)
            p_password = &current_settings.password2;
          else if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD3)
            p_password = &current_settings.password3;
          else
          {
            //Теоретично цього ніколи не мало б бути
            total_error_sw_fixed();
          }
            
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if (current_ekran.edition == 1)
            {
              current_ekran.cursor_on = 1;
              current_ekran.cursor_blinking_on = 1;
              current_ekran.position_cursor_x = COL_NEW_PASSWORD_BEGIN;
              position_in_current_level_menu[current_ekran.current_level] = 1;
              //Встановлюємо початкове значення нового паролю і скидаємо кількість введених символів
              new_setting_password = *p_password;
              number_symbols_new_setting_password = 0;
              
              unsigned int temp_value = new_setting_password;
              while (temp_value != 0)
              {
                number_symbols_new_setting_password++;
                temp_value /= 10;
              }
              if (number_symbols_new_setting_password == 0) number_symbols_new_setting_password = 1; //Це випадок коли current_settings.password1 = 0, тоді кількість символів рівна 0, бо число є "0"
            
              //Формуємо екран рівня password
              make_ekran_level_password(new_setting_password, 1);
              //Очищаємо біт обновлення екрану
              new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
            }
            else
            {
              //Переходимо у попереднє меню і анульовуємо процес редагування
              current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
              current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              current_ekran.edition = 0;
              
              //Біт, який сигналізує про обновлекння екрану не скидаємто, бо його ще раз треба перерисувати
            }
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              if (current_ekran.edition == 1)
              {
                //Виходимо з режиму редагування
                if (current_settings.password1 == new_setting_password)
                {
                  //Переходимо на попередній рівень
                  current_ekran.edition = 0;
                  current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
                else current_ekran.edition = 2;

                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 2)
              {
                //Помічаємо, що поле структури зараз буде змінене
                changed_settings = CHANGED_ETAP_EXECUTION;
                        
                //Вводимо нове значення у дію
                *p_password = new_setting_password;

                //Не формуємо запис у таблиці настройок про зміну конфігурації, бо її як такої не було. Просто змінився пароль доступу з меню
                //але ініціюємо запис у EEPROM настройок
                //Запускаємо запис у EEPROM
                if (_CHECK_SET_BIT(active_functions, RNG_BIG_SETTINGS_CHANGED) == 0) current_settings_interfaces = current_settings;
                _SET_BIT(control_spi1_taskes, TASK_START_WRITE_SETTINGS_EEPROM_BIT);
                
                //Помічаємо, що таблиця змінилася і її треба буде з системи захистів зкопіювати у таблицю з якою працює система захистів (хоч ця операція і є зайвою, бо не було змін тих полів, які використовуються системою захистів, але це я зробив для універсальності, щоб завжди дві таблиці були ідентичні)
                changed_settings = CHANGED_ETAP_ENDED;
                
                //Вихід у режимі редагування
                current_ekran.edition = 0;
                //Переходимо на попередній рівень
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 3)
              {
                //Вихід у режимі редагування
                current_ekran.edition = 0;
                //Переходимо на попередній рівень
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else
              {
                //По ідеї сюди програма ніколи б не мала дійти і виставляється повідомлення про помилку
                current_ekran.edition = 3;
              }
                
              if(current_ekran.edition == 2) make_ekran_ask_rewrite();
              else if (current_ekran.edition == 0)
              {
                //Виставляємо біт обновлення екрану
                new_state_keyboard |= (1<<BIT_REWRITE);
              }
              else if (current_ekran.edition == 3)
              {
                static const unsigned char information_about_error[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  " Неопред.ошибка ",
                  " Невизн.помилка ",
                  " Undefined error",
                  " Неопред.ошибка "
                };
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
                make_ekran_about_error(information_about_error);
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              //Натиснута кнопка ESC

              //Переходимо у попереднє меню і анульовуємо процес редагування
              current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
              current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              current_ekran.edition = 0;
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
              //Виставляємо біт обновлення екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              unsigned int vaga = 1, temp_value, ostacha, vyshchi_rozrjady;
              int edit_rozrjad;
              
              for (int i=(current_ekran.position_cursor_x - 5 + 1); i<number_symbols_new_setting_password; i++) vaga *= 10;
              ostacha = new_setting_password % vaga;
              temp_value = (new_setting_password / vaga);
              edit_rozrjad = temp_value % 10;
              vyshchi_rozrjady = temp_value / 10;
              if (++edit_rozrjad > 4) 
              {
                if (ostacha == 0)
                {
                  edit_rozrjad = 0;
                  if (number_symbols_new_setting_password > 1)
                  {
                    number_symbols_new_setting_password--;
                    current_ekran.position_cursor_x--;
                    new_setting_password = vyshchi_rozrjady*vaga;
                  }
                  else
                  {
                    if (current_ekran.current_level != EKRAN_LEVEL_SET_NEW_PASSWORD1) edit_rozrjad = 1;
                    new_setting_password = vyshchi_rozrjady*vaga*10 + edit_rozrjad*vaga; 
                  }
                }
                else
                {
                  edit_rozrjad = 1;
                  new_setting_password = (vyshchi_rozrjady*vaga*10) + edit_rozrjad*vaga + ostacha;
                }
              }
              else
                new_setting_password = (vyshchi_rozrjady*vaga*10) + edit_rozrjad*vaga + ostacha;
              //Формуємо екран рівня password
              make_ekran_level_password(new_setting_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              unsigned int vaga = 1, temp_value, ostacha, vyshchi_rozrjady;
              int edit_rozrjad;
              for (int i=(current_ekran.position_cursor_x - 5 + 1); i<number_symbols_new_setting_password; i++) vaga *= 10;
              ostacha = new_setting_password % vaga;
              temp_value = (new_setting_password / vaga);
              edit_rozrjad = temp_value % 10;
              vyshchi_rozrjady = temp_value / 10;
              edit_rozrjad--;
              if (edit_rozrjad < 0)
              {
                edit_rozrjad = 4;
                new_setting_password = (vyshchi_rozrjady*vaga*10) + edit_rozrjad*vaga + ostacha;
              }
              else if (edit_rozrjad == 0)
              {
                if ((vyshchi_rozrjady !=0) || (ostacha != 0))
                {
                  if (ostacha == 0)
                  {
                    edit_rozrjad = 0;
                    if (number_symbols_new_setting_password > 1)
                    {
                      number_symbols_new_setting_password--;
                      current_ekran.position_cursor_x--;
                      new_setting_password = vyshchi_rozrjady*vaga;
                    }
                    else
                    {
                      if (current_ekran.current_level != EKRAN_LEVEL_SET_NEW_PASSWORD1) edit_rozrjad = 4;
                      new_setting_password = vyshchi_rozrjady*vaga*10 + edit_rozrjad*vaga;
                    }
                  }
                  else
                  {
                    edit_rozrjad = 4;
                    new_setting_password = (vyshchi_rozrjady*vaga*10) + edit_rozrjad*vaga + ostacha;
                  }
                }
                else
                {
                  if (current_ekran.current_level != EKRAN_LEVEL_SET_NEW_PASSWORD1) new_setting_password = 4;
                  else new_setting_password = 0;
                }
                  
              }
              else
                new_setting_password = (vyshchi_rozrjady*vaga*10) + edit_rozrjad*vaga + ostacha;

              //Формуємо екран рівня password
              make_ekran_level_password(new_setting_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_RIGHT))
            {
              //Натиснута кнопка RIGHT
              if (new_setting_password !=0)
              {
                if (++current_ekran.position_cursor_x > COL_NEW_PASSWORD_END) current_ekran.position_cursor_x = COL_NEW_PASSWORD_BEGIN;
                if (number_symbols_new_setting_password < (current_ekran.position_cursor_x - COL_NEW_PASSWORD_BEGIN + 1))
                {
                  new_setting_password = new_setting_password*10 + 1;
                  number_symbols_new_setting_password++;
                }
              }

              //Формуємо екран рівня password
              make_ekran_level_password(new_setting_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_LEFT))
            {
              //Натиснута кнопка LEFT
              if (new_setting_password !=0)
              {
                if (--current_ekran.position_cursor_x < COL_NEW_PASSWORD_BEGIN) current_ekran.position_cursor_x = COL_NEW_PASSWORD_BEGIN + number_symbols_new_setting_password - 1;
              }

              //Формуємо екран рівня password
              make_ekran_level_password(new_setting_password, 1);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
          
        }
        break;
      }
/******************************************************************************************************************************************/ 
      
/******************************************************************************************************************************************/      
    case EKRAN_MAIN:
      {
        //Очищаємо всі біти краім упралінських
        new_state_keyboard &= (1<<BIT_KEY_ENTER)|(1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN)|(1<<BIT_REWRITE);
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            do
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_MAIN) current_ekran.index_position = 0;
                
              if ((current_ekran.index_position == INDEX_ML1_DZ) && ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_MTZ) && ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_ZDZ) && ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_NZZ) && ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_TZNP) && ((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_APV) && ((current_settings.configuration & (1<<APV_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_ACHR_CHAPV) && ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_UROV) && ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_ZOP) && ((current_settings.configuration & (1<<ZOP_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_UMIN) && ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_UMAX) && ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_UP) && ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
              if ((current_ekran.index_position == INDEX_ML1_VMP) && ((current_settings.configuration & (1<<VMP_BIT_CONFIGURATION)) == 0))
                current_ekran.index_position++;
            }
            while (current_ekran.index_position >= MAX_ROW_FOR_EKRAN_MAIN);
            position_in_current_level_menu[EKRAN_MAIN] = current_ekran.index_position;
            
            //Формуємо екран рівня головного меню
            make_ekran_main();
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              int temp_current_level = current_ekran.current_level;
              
              //Натиснута кнопка ENTER
              if(current_ekran.index_position == INDEX_ML1_TIME)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню часу-калібровки
                time_rewrite = 0;
                current_ekran.current_level = EKRAN_TIME;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
                
                /**************************************************/
                //Курсор має бути на першому символі рядка з даними
                /**************************************************/
                if(current_ekran.index_position == ROW_Y_)
                {
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_T_)
                {
                  current_ekran.index_position = ROW_Y_;
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_N_)
                {
                  current_ekran.index_position = ROW_K_;
                  current_ekran.position_cursor_x = COL_SK1;
                }
                else if(current_ekran.index_position == ROW_K_)
                {
                  current_ekran.position_cursor_x = COL_SK1;
                }
                /**************************************************/
              }
              else if(current_ekran.index_position == INDEX_ML1_MEASURMENTS)
              {
                //Переходимо на меню вибору відображення асписку типів налогових вимірювань
                current_ekran.current_level = EKRAN_MEASURMENT;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if(current_ekran.index_position == INDEX_ML1_ENERGY)
              {
                //Переходимо на меню відображення технічного обліку електроенергії
                current_ekran.current_level = EKRAN_ENERGY;

                //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення, які поступають на аналогові входи приладу
                pervynna_vtorynna = 0;
                
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if(current_ekran.index_position == INDEX_ML1_INPUTS_OUTPUTS)
              {
                //Переходимо на меню вибору відображення списку вибору входів-виходів для відображення їх миттєвого стану
                current_ekran.current_level = EKRAN_LIST_INPUTS_OUTPUTS;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if(current_ekran.index_position == INDEX_ML1_RESURS)
              {
                //Переходимо на меню відображення ресурсу вимикача
                current_ekran.current_level = EKRAN_RESURS;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if(current_ekran.index_position == INDEX_ML1_REGISTRATORS)
              {
                //Переходимо на меню вибору відображення списку реєстраторів
                current_ekran.current_level = EKRAN_LIST_REGISTRATORS;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if(current_ekran.index_position == INDEX_ML1_LANGUAGE)
              {
                //Переходимо на меню вибору мови відображення меню
                current_ekran.current_level = EKRAN_VIEW_SETTING_LANGUAGE;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if(current_ekran.index_position == INDEX_ML1_SETTINGS)
              {
                //Переходимо на меню настройок
                current_ekran.current_level = EKRAN_CHOSE_SETTINGS;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if(current_ekran.index_position == INDEX_ML1_DIAGNOSTYKA)
              {
                //Переходимо на меню настройок
                current_ekran.current_level = EKRAN_DIAGNOSTYKA;
                //Для того, щоб при першому входженні завжди список починався із першої помилки обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if(current_ekran.index_position == INDEX_ML1_KONF)
              {
                //Переходимо на меню конфігурації
                current_ekran.current_level = EKRAN_COFIGURATION;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if(
                      (current_ekran.index_position == INDEX_ML1_DZ     ) || 
                      (current_ekran.index_position == INDEX_ML1_MTZ       ) || 
                      (current_ekran.index_position == INDEX_ML1_ZDZ       ) || 
                      (current_ekran.index_position == INDEX_ML1_NZZ       ) || 
                      (current_ekran.index_position == INDEX_ML1_TZNP      ) || 
                      (current_ekran.index_position == INDEX_ML1_APV       ) ||
                      (current_ekran.index_position == INDEX_ML1_ACHR_CHAPV) ||
                      (current_ekran.index_position == INDEX_ML1_UROV      ) || 
                      (current_ekran.index_position == INDEX_ML1_ZOP       ) ||
                      (current_ekran.index_position == INDEX_ML1_UMIN      ) ||
                      (current_ekran.index_position == INDEX_ML1_UMAX      ) || 
                      (current_ekran.index_position == INDEX_ML1_UP        ) || 
                      (current_ekran.index_position == INDEX_ML1_VMP       ) 
                     )
              {
                //Переходимо на меню МТЗ
                if(current_ekran.index_position == INDEX_ML1_DZ) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_DZ;
                //Переходимо на меню МТЗ
                else if(current_ekran.index_position == INDEX_ML1_MTZ) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_MTZ;
                //Переходимо на меню ЗДЗ
                else if(current_ekran.index_position == INDEX_ML1_ZDZ) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_ZDZ;
                //Переходимо на меню ЗЗ
                else if(current_ekran.index_position == INDEX_ML1_NZZ) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_ZZ;
                //Переходимо на меню ТЗНП
                else if(current_ekran.index_position == INDEX_ML1_TZNP) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_TZNP;
                //Переходимо на меню АПВ
                else if(current_ekran.index_position == INDEX_ML1_APV) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_APV;
                //Переходимо на меню АЧР с ЧАПВ
                else if(current_ekran.index_position == INDEX_ML1_ACHR_CHAPV) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV;
                //Переходимо на меню УРОВ
                else if(current_ekran.index_position == INDEX_ML1_UROV) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_UROV;
                //Переходимо на меню ЗОП(КОФ)
                else if(current_ekran.index_position == INDEX_ML1_ZOP) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_ZOP;
                //Переходимо на меню Umin
                else if(current_ekran.index_position == INDEX_ML1_UMIN) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_UMIN;
                //Переходимо на меню Umax
                else if(current_ekran.index_position == INDEX_ML1_UMAX) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_UMAX;
                //Переходимо на меню Umax
                else if(current_ekran.index_position == INDEX_ML1_UP) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_UP;
                //Переходимо на меню "Визначення місця пошкодження"
                else if(current_ekran.index_position == INDEX_ML1_VMP) current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_VMP;
                
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              //У разі, якщо текучий екран змінився, то запам'ятовуємо екран в який требе буде повернутися
              if (temp_current_level != current_ekran.current_level) 
                previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              current_ekran.index_position--;
              do
              {
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EKRAN_MAIN - 1;

                if ((current_ekran.index_position == INDEX_ML1_VMP) && ((current_settings.configuration & (1<<VMP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_UP) && ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_UMAX) && ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_UMIN) && ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_ZOP) && ((current_settings.configuration & (1<<ZOP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_UROV) && ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_ACHR_CHAPV) && ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_APV) && ((current_settings.configuration & (1<<APV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_TZNP) && ((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_NZZ) && ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_ZDZ) && ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_MTZ) && ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;
                if ((current_ekran.index_position == INDEX_ML1_DZ) && ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position--;


              }
              while (current_ekran.index_position < 0);
              position_in_current_level_menu[EKRAN_MAIN] = current_ekran.index_position;
              
              //Формуємо екран рівня головного меню
              make_ekran_main();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              //current_ekran.index_position вказує номер у повному списку полів
              current_ekran.index_position++;
              do
              {
                if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_MAIN) current_ekran.index_position = 0;
                
                if ((current_ekran.index_position == INDEX_ML1_DZ) && ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_MTZ) && ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_ZDZ) && ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_NZZ) && ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_TZNP) && ((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_APV) && ((current_settings.configuration & (1<<APV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_ACHR_CHAPV) && ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_UROV) && ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_ZOP) && ((current_settings.configuration & (1<<ZOP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_UMIN) && ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_UMAX) && ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_UP) && ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
                if ((current_ekran.index_position == INDEX_ML1_VMP) && ((current_settings.configuration & (1<<VMP_BIT_CONFIGURATION)) == 0))
                  current_ekran.index_position++;
              }
              while (current_ekran.index_position >= MAX_ROW_FOR_EKRAN_MAIN);
              position_in_current_level_menu[EKRAN_MAIN] = current_ekran.index_position;
              
              //Формуємо екран рівня головного меню
              make_ekran_main();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
          
        }
        break;
      }
/******************************************************************************************************************************************/ 

/******************************************************************************************************************************************/ 
    case EKRAN_TIME:
      {
        //Очищаємо всі біти краім упралінський
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        
        if (current_ekran.edition == 1)
          maska_keyboard_bits |= (1<<BIT_KEY_RIGHT) | (1<<BIT_KEY_LEFT) | (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        else if (current_ekran.edition == 0)
          maska_keyboard_bits |= (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        
        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if (current_ekran.edition == 0)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_TIME) current_ekran.index_position = 0;
              /**************************************************/
              //Курсор має бути на першому символі рядка з даними
              /**************************************************/
              if(current_ekran.index_position == ROW_Y_)
              {
                current_ekran.position_cursor_x = COL_DY1;
              }
              else if(current_ekran.index_position == ROW_T_)
              {
                current_ekran.index_position = ROW_Y_;
                current_ekran.position_cursor_x = COL_DY1;
              }
              else if(current_ekran.index_position == ROW_N_)
              {
                current_ekran.index_position = ROW_K_;
                current_ekran.position_cursor_x = COL_SK1;
              }
              else if(current_ekran.index_position == ROW_K_)
              {
                current_ekran.position_cursor_x = COL_SK1;
              }
              /**************************************************/
              position_in_current_level_menu[EKRAN_TIME] = current_ekran.index_position;

              current_ekran.cursor_on = 0;
              current_ekran.cursor_blinking_on = 0;
            }

            //Формуємо екран години-часу
            make_ekran_time();
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              static int tm_isdst;
              //Натиснута кнопка ENTER
              if(current_ekran.edition == 0)
              {
                //Копіюємо текчий масив часу у масив для редагування
                copying_time_dat = 1;
                time_t time_dat_tmp = time_dat_copy;
                int32_t time_ms_tmp = time_ms_copy;
                copying_time_dat = 0;
                struct tm *p;
                p = localtime(&time_dat_tmp);

                time_edit[0] = INT_TO_BCD(time_ms_tmp/10);
                time_edit[1] = INT_TO_BCD(p->tm_sec) & 0x7F;
                time_edit[2] = INT_TO_BCD(p->tm_min) & 0x7F;
                time_edit[3] = INT_TO_BCD(p->tm_hour) & 0x3F;
                time_edit[4] = INT_TO_BCD(p->tm_mday) & 0x3F;
                time_edit[5] = INT_TO_BCD(p->tm_mon + 1) & 0x1F;
                time_edit[6] = INT_TO_BCD(p->tm_year - 100) & 0xFF;

                calibration_edit = calibration;
                  
                //Підготовка до режиму редагування - включаємо мигаючий курсор
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 1;
                if (current_settings.password1 != 0)
                {
                  //Переходимо на меню запиту паролю
                  current_ekran.current_level = EKRAN_LEVEL_PASSWORD;
                  previous_level_in_current_level_menu[current_ekran.current_level] = EKRAN_TIME;
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
                else
                {
                  //Переходимо у режим редагування
                  current_ekran.edition = 1;
                }
              }
              else if (current_ekran.edition == 1)
              {
                //Перевіряємо чи якісь зміни відбулися
                unsigned int found_changes = 0, i = 0;

                copying_time_dat = 1;
                time_t time_dat_tmp = time_dat_copy;
                int32_t time_ms_tmp = time_ms_copy;
                copying_time_dat = 0;
                struct tm *p;
                p = localtime(&time_dat_tmp);
                tm_isdst = p->tm_isdst;

                while ((i < 7) && (found_changes == 0))
                {
                  switch (i)
                  {
                  case 0:
                    {
                      if (INT_TO_BCD(time_ms_tmp/10) != time_edit[0]) found_changes = 1;
                      break;
                    }
                  case 1:
                    {
                      if ((INT_TO_BCD(p->tm_sec) & 0x7F) != time_edit[1]) found_changes = 1;
                      break;
                    }
                  case 2:
                    {
                      if ((INT_TO_BCD(p->tm_min) & 0x7F) != time_edit[2]) found_changes = 1;
                      break;
                    }
                  case 3:
                    {
                      if ((INT_TO_BCD(p->tm_hour) & 0x3F) != time_edit[3]) found_changes = 1;
                      break;
                    }
                  case 4:
                    {
                      if ((INT_TO_BCD(p->tm_mday) & 0x3F) != time_edit[4]) found_changes = 1;
                      break;
                    }
                  case 5:
                    {
                      if ((INT_TO_BCD(p->tm_mon + 1) & 0x1F) != time_edit[5]) found_changes = 1;
                      break;
                    }
                  case 6:
                    {
                      if (INT_TO_BCD(p->tm_year - 100) != time_edit[6]) found_changes = 1;
                      break;
                    }
                  default: break;
                  }
                  i++;
                }
                if (found_changes == 0)
                {
                  if (calibration != calibration_edit) found_changes = 1;
                }
                
                //Виходимо з режиму редагування
                if (found_changes == 0) current_ekran.edition = 0;
                else current_ekran.edition = 2;

                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 2)
              {
                //Перевіряємо достовірність даних
                if (check_data_for_data_time_menu() ==1)
                {
                  //Дані достовірні

                  time_ms_save_l = 0;
                  
                  struct tm orig;
                  unsigned int tmp_reg = time_edit[1];
                  orig.tm_sec = 10*(tmp_reg >> 4) + (tmp_reg & 0xf);

                  tmp_reg = time_edit[2];
                  orig.tm_min = 10*(tmp_reg >> 4) + (tmp_reg & 0xf);

                  tmp_reg = time_edit[3];
                  orig.tm_hour = 10*(tmp_reg >> 4) + (tmp_reg & 0xf);

                  tmp_reg = time_edit[4];
                  orig.tm_mday = 10*(tmp_reg >> 4) + (tmp_reg & 0xf);

                  tmp_reg = time_edit[5];
                  orig.tm_mon = 10*(tmp_reg >> 4) + (tmp_reg & 0xf) - 1;

                  tmp_reg = time_edit[6];
                  orig.tm_year = 10*(tmp_reg >> 4) + (tmp_reg & 0xf) + 100;

                  orig.tm_wday = 0;
                  orig.tm_yday = 0;
                  orig.tm_isdst = (current_settings.dst & MASKA_FOR_BIT(N_BIT_TZ_DST)) ? tm_isdst : 0;
                  //Робота з Watchdog
                  watchdog_routine(UNITED_BITS_WATCHDOG);
                  time_dat_save_l = mktime (&orig);
                  if (current_settings.dst & MASKA_FOR_BIT(N_BIT_TZ_DST))
                  {
                    struct tm *p_tmp = localtime(&time_dat_save_l);
                    if (tm_isdst != p_tmp->tm_isdst) 
                    {
                      orig.tm_isdst = p_tmp->tm_isdst;
                      //Робота з Watchdog
                      watchdog_routine(UNITED_BITS_WATCHDOG);
                      time_dat_save_l = mktime (&orig);
                    }
                  }
                  save_time_dat_l = 3;
                  
                  calibration = calibration_edit;
                  current_ekran.edition = 0;
                }
                else
                {
                  //Дані недостовірні - повідомляємо про це
                  current_ekran.edition = 3;
                }

                //Виходимо з режиму редагування
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 3)
              {
                //Вихід у режимі редагування
                current_ekran.edition = 0;
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }

              
              if(current_ekran.edition == 2) make_ekran_ask_rewrite();
              else if(current_ekran.edition == 3) 
              {
                static const unsigned char information_about_error[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  " Неверные данные",
                  "  Невірні дані  ",
                  "   False data   ",
                  " Неверные данные"
                };
                make_ekran_about_error(information_about_error);
              }
              else
                //Виставляємо біт обновлення екрану
                new_state_keyboard |= (1<<BIT_REWRITE);
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              //Натиснута кнопка ESC

              if(current_ekran.edition == 0)
              {
                //Вихід у режимі спостерігання
                //Переходимо у попереднє меню
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else
              {
                //Вихід у режимі редагування без введення змін
                current_ekran.edition = 0;
                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(current_ekran.edition == 0)
              {
                //Переміщення у режимі спостерігання
                current_ekran.index_position -=MAX_ROW_LCD;
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EKRAN_TIME - MAX_ROW_LCD;
                /**************************************************/
                //Курсор має бути на першому символі рядка з даними
                /**************************************************/
                if(current_ekran.index_position == ROW_Y_)
                {
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_T_)
                {
                  current_ekran.index_position = ROW_Y_;
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_N_)
                {
                  current_ekran.index_position = ROW_K_;
                  current_ekran.position_cursor_x = COL_SK1;
                }
                else if(current_ekran.index_position == ROW_K_)
                {
                  current_ekran.position_cursor_x = COL_SK1;
                }
                /**************************************************/
                position_in_current_level_menu[EKRAN_TIME] = current_ekran.index_position;
              }
              else
              {
                //Редагування числа
                edit_time(1);
              }

              //Формуємо екран рівня 2
              make_ekran_time();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(current_ekran.edition == 0)
              {
                //Переміщення у режимі спостерігання
                current_ekran.index_position +=MAX_ROW_LCD;
                if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_TIME) current_ekran.index_position = 0;
                /**************************************************/
                //Курсор має бути на першому символі рядка з даними
                /**************************************************/
                if(current_ekran.index_position == ROW_Y_)
                {
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_T_)
                {
                  current_ekran.index_position = ROW_Y_;
                  current_ekran.position_cursor_x = COL_DY1;
                }
                else if(current_ekran.index_position == ROW_N_)
                {
                  current_ekran.index_position = ROW_K_;
                  current_ekran.position_cursor_x = COL_SK1;
                }
                else if(current_ekran.index_position == ROW_K_)
                {
                  current_ekran.position_cursor_x = COL_SK1;
                }
                /**************************************************/
                position_in_current_level_menu[EKRAN_TIME] = current_ekran.index_position;
              }
              else
              {
                //Редагування числа
                edit_time(0);
              }

              //Формуємо екран години-часу
              make_ekran_time();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_RIGHT))
            {
              if(current_ekran.index_position == ROW_Y_)
              {
                if(current_ekran.position_cursor_x == COL_DY1) current_ekran.position_cursor_x = COL_DY2;
                else if(current_ekran.position_cursor_x == COL_DY2) current_ekran.position_cursor_x = COL_MY1;
                else if(current_ekran.position_cursor_x == COL_MY1) current_ekran.position_cursor_x = COL_MY2;
                else if(current_ekran.position_cursor_x == COL_MY2) current_ekran.position_cursor_x = COL_SY1;
                else if(current_ekran.position_cursor_x == COL_SY1) current_ekran.position_cursor_x = COL_SY2;
                else if(current_ekran.position_cursor_x == COL_SY2)
                {
                  current_ekran.index_position = ROW_T_;
                  current_ekran.position_cursor_x = COL_HT1;
                }
              }
              else if(current_ekran.index_position == ROW_T_)
              {
                if(current_ekran.position_cursor_x == COL_HT1) current_ekran.position_cursor_x = COL_HT2;
                else if(current_ekran.position_cursor_x == COL_HT2) current_ekran.position_cursor_x = COL_MT1;
                else if(current_ekran.position_cursor_x == COL_MT1) current_ekran.position_cursor_x = COL_MT2;
                else if(current_ekran.position_cursor_x == COL_MT2) current_ekran.position_cursor_x = COL_ST1;
                else if(current_ekran.position_cursor_x == COL_ST1) current_ekran.position_cursor_x = COL_ST2;
                else if(current_ekran.position_cursor_x == COL_ST2)
                {
                  current_ekran.index_position = ROW_K_;
                  current_ekran.position_cursor_x = COL_SK1;
                }
              }
              else if(current_ekran.index_position == ROW_K_)
              {
                if(current_ekran.position_cursor_x == COL_SK1) current_ekran.position_cursor_x = COL_VK1;
                else if(current_ekran.position_cursor_x == COL_VK1) current_ekran.position_cursor_x = COL_VK2;
                else if(current_ekran.position_cursor_x == COL_VK2)
                {
                  current_ekran.index_position = ROW_Y_;
                  current_ekran.position_cursor_x = COL_DY1;
                }
              }
              //Формуємо екран години-часу
              make_ekran_time();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_LEFT))
            {
              if(current_ekran.index_position == ROW_Y_)
              {
                if(current_ekran.position_cursor_x == COL_SY2) current_ekran.position_cursor_x = COL_SY1;
                else if(current_ekran.position_cursor_x == COL_SY1) current_ekran.position_cursor_x = COL_MY2;
                else if(current_ekran.position_cursor_x == COL_MY2) current_ekran.position_cursor_x = COL_MY1;
                else if(current_ekran.position_cursor_x == COL_MY1) current_ekran.position_cursor_x = COL_DY2;
                else if(current_ekran.position_cursor_x == COL_DY2) current_ekran.position_cursor_x = COL_DY1;
                else if(current_ekran.position_cursor_x == COL_DY1)
                {
                  current_ekran.index_position = ROW_K_;
                  current_ekran.position_cursor_x = COL_VK2;
                }
              }
              else if(current_ekran.index_position == ROW_T_)
              {
                if(current_ekran.position_cursor_x == COL_ST2) current_ekran.position_cursor_x = COL_ST1;
                else if(current_ekran.position_cursor_x == COL_ST1) current_ekran.position_cursor_x = COL_MT2;
                else if(current_ekran.position_cursor_x == COL_MT2) current_ekran.position_cursor_x = COL_MT1;
                else if(current_ekran.position_cursor_x == COL_MT1) current_ekran.position_cursor_x = COL_HT2;
                else if(current_ekran.position_cursor_x == COL_HT2) current_ekran.position_cursor_x = COL_HT1;
                else if(current_ekran.position_cursor_x == COL_HT1)
                {
                  current_ekran.index_position = ROW_Y_;
                  current_ekran.position_cursor_x = COL_SY2;
                }
              }
              else if(current_ekran.index_position == ROW_K_)
              {
                if(current_ekran.position_cursor_x == COL_VK2) current_ekran.position_cursor_x = COL_VK1;
                else if(current_ekran.position_cursor_x == COL_VK1) current_ekran.position_cursor_x = COL_SK1;
                else if(current_ekran.position_cursor_x == COL_SK1)
                {
                  current_ekran.index_position = ROW_T_;
                  current_ekran.position_cursor_x = COL_ST2;
                }
              }
              //Формуємо екран години-часу
              make_ekran_time();
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 

/******************************************************************************************************************************************/      
    case EKRAN_COFIGURATION:
      {
        //Змінна для редагування конфігурації
        static unsigned int configuration_edit;
        
        //Очищаємо всі біти краім упралінський
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        
        if (current_ekran.edition == 1)
          maska_keyboard_bits |= (1<<BIT_KEY_RIGHT) | (1<<BIT_KEY_LEFT) | (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        else if (current_ekran.edition == 0)
          maska_keyboard_bits |= (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        
        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if(current_ekran.index_position >= (EL_BIT_CONFIGURATION)) current_ekran.index_position = 0;
            position_in_current_level_menu[EKRAN_COFIGURATION] = current_ekran.index_position;
            //Формуємо екран конфігурації
            make_ekran_configuration(configuration_edit);
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              if(current_ekran.edition == 0)
              {
                //Копіюємо настройки у структуру для редагування
                configuration_edit = current_settings.configuration;
                  
                //Підготовка до режиму редагування - включаємо мигаючий курсор
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 1;
                if (current_settings.password1 != 0)
                {
                  //Переходимо на меню запиту паролю
                  current_ekran.current_level = EKRAN_LEVEL_PASSWORD;
                  previous_level_in_current_level_menu[current_ekran.current_level] = EKRAN_COFIGURATION;
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
                else
                {
                  //Переходимо у режим редагування
                  current_ekran.edition = 1;
                }
              }
              else if (current_ekran.edition == 1)
              {
                //Перевіряємо чи якісь зміни відбулися
                if (configuration_edit == current_settings.configuration) current_ekran.edition = 0;
                else current_ekran.edition = 2;

                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 2)
              {
                //Помічаємо, що поле структури зараз буде змінене
                changed_settings = CHANGED_ETAP_EXECUTION;

                //Обновляємо значення
                action_after_changing_of_configuration(configuration_edit, &current_settings);
                //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                fix_change_settings(0, 1);
                current_ekran.edition = 0;
                
                //Виходимо з режиму редагування
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              
              if(current_ekran.edition == 2) make_ekran_ask_rewrite();
              else
                //Виставляємо біт обновлення екрану
                new_state_keyboard |= (1<<BIT_REWRITE);

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              //Натиснута кнопка ESC

              if(current_ekran.edition == 0)
              {
                //Вихід у режимі спостерігання
                //Переходимо у попереднє меню
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else
              {
                //Вихід у режимі редагування без введення змін
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              current_ekran.edition = 0;

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP

              if(--current_ekran.index_position < 0 ) current_ekran.index_position = EL_BIT_CONFIGURATION - 1;
              position_in_current_level_menu[EKRAN_COFIGURATION] = current_ekran.index_position;
              //Формуємо екран конфігурації
              make_ekran_configuration(configuration_edit);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN

              if(++current_ekran.index_position >= EL_BIT_CONFIGURATION) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_COFIGURATION] = current_ekran.index_position;
              //Формуємо екран конфігурації
              make_ekran_configuration(configuration_edit);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else if ((new_state_keyboard == (1<<BIT_KEY_LEFT)) || (new_state_keyboard == (1<<BIT_KEY_RIGHT)))
            { 
              //Натиснута кнопка LEFT або RIGHT
                unsigned long RU32_l1;
                RU32_l1 = current_ekran.index_position;
                if(RU32_l1 >= CHP){
                    RU32_l1++;
                    configuration_edit ^= (1<<RU32_l1); 
                }else {
                    configuration_edit ^= (1<<RU32_l1);
                }
              
              //configuration_edit ^= (1<<current_ekran.index_position);

              //Формуємо екран конфігурації
              make_ekran_configuration(configuration_edit);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~((1<<BIT_KEY_LEFT) | (1<<BIT_KEY_RIGHT)));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 

/****************************************************************************************************************************************/      
    case EKRAN_MEASURMENT:
    case EKRAN_MEASURMENT_CURRENT:
    case EKRAN_MEASURMENT_VOLTAGE_LINE:
    case EKRAN_MEASURMENT_FREQUENCY:
    case EKRAN_MEASURMENT_ANGLE:
    case EKRAN_MEASURMENT_POWER:
    case EKRAN_ENERGY:
    case EKRAN_MEASURMENT_RESISTANCE:
    case EKRAN_CHOOSE_SETTINGS_MTZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_MTZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_MTZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_MTZ:
    case EKRAN_CHOOSE_SETTINGS_DZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_DZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_DZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_DZ:
    case EKRAN_CHOOSE_SETTINGS_ZDZ:
    case EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ:
    case EKRAN_CHOOSE_TIMEOUT_GROUP2_ZDZ:
    case EKRAN_CHOOSE_TIMEOUT_GROUP3_ZDZ:
    case EKRAN_CHOOSE_TIMEOUT_GROUP4_ZDZ:
    case EKRAN_CHOOSE_SETTINGS_ZZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_ZZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_ZZ:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZZ:
    case EKRAN_CHOOSE_SETTINGS_TZNP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_TZNP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_TZNP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_TZNP:
    case EKRAN_CHOOSE_SETTINGS_APV:
    case EKRAN_CHOOSE_TIMEOUT_GROUP1_APV:
    case EKRAN_CHOOSE_TIMEOUT_GROUP2_APV:
    case EKRAN_CHOOSE_TIMEOUT_GROUP3_APV:
    case EKRAN_CHOOSE_TIMEOUT_GROUP4_APV:
    case EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_ACHR_CHAPV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_ACHR_CHAPV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ACHR_CHAPV:
    case EKRAN_CHOOSE_SETTINGS_UROV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_UROV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_UROV:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UROV:
    case EKRAN_CHOOSE_SETTINGS_ZOP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_ZOP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_ZOP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZOP:
    case EKRAN_CHOOSE_SETTINGS_UMIN:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_UMIN:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_UMIN:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMIN:
    case EKRAN_CHOOSE_SETTINGS_UMAX:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_UMAX:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_UMAX:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMAX:
    case EKRAN_CHOOSE_SETTINGS_UP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP2_UP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP3_UP:
    case EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UP:
    case EKRAN_TRANSFORMATOR_INFO:
    case EKRAN_CHOSE_SETTINGS:
    case EKRAN_LEVEL_CHOOSE_PASSWORDS:
    case EKRAN_LIST_INPUTS_FOR_RANGUVANNJA:
    case EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA:
    case EKRAN_LIST_LEDS_FOR_RANGUVANNJA:
    
    case EKRAN_CHOOSE_SETTINGS_SWITCHER:
    case EKRAN_CHOOSE_RANG_SWITCH:
    case EKRAN_CHOOSE_LIST_SWITCH_L_H:
    case EKRAN_CHOOSE_SETTINGS_SWITCHER_H:
    case EKRAN_CHOOSE_SETTINGS_SWITCHER_L:
    case EKRAN_CHOOSE_RANG_SWITCH_H:
    case EKRAN_CHOOSE_RANG_SWITCH_L:
    
    case EKRAN_CHOOSE_SETTINGS_UVV:
    case EKRAN_CHOSE_COMMUNICATION_PARAMETERS:
    case EKRAN_VIEW_NAME_OF_CELL:
    case EKRAN_CHOSE_SETTING_RS485:
    case EKRAN_CHOSE_DATA_TIME:
    case EKRAN_VIEW_LIST_OF_REGISTRATORS:
    case EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS:
    case EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS:
    case EKRAN_EXTENDED_LIGIC:
    case EKRAN_LIST_SETTINGS_FOR_DF:
    case EKRAN_LIST_DF_FOR_RANGUVANNJA:
    case EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS:
    case EKRAN_LIST_TYPE_SOURCE_DF1:
    case EKRAN_LIST_TYPE_SOURCE_DF2:
    case EKRAN_LIST_TYPE_SOURCE_DF3:
    case EKRAN_LIST_TYPE_SOURCE_DF4:
    case EKRAN_LIST_TYPE_SOURCE_DF5:
    case EKRAN_LIST_TYPE_SOURCE_DF6:
    case EKRAN_LIST_TYPE_SOURCE_DF7:
    case EKRAN_LIST_TYPE_SOURCE_DF8:
    case EKRAN_LIST_TYPE_SOURCE_DF9:
    case EKRAN_LIST_TYPE_SOURCE_DF10:
    case EKRAN_LIST_TYPE_SOURCE_DF11:
    case EKRAN_LIST_TYPE_SOURCE_DF12:
    case EKRAN_LIST_TYPE_SOURCE_DF13:
    case EKRAN_LIST_TYPE_SOURCE_DF14:
    case EKRAN_LIST_TYPE_SOURCE_DF15:
    case EKRAN_LIST_TYPE_SOURCE_DF16:
    case EKRAN_LIST_DT:
    case EKRAN_SET_RESET_DT1:
    case EKRAN_SET_RESET_DT2:
    case EKRAN_SET_RESET_DT3:
    case EKRAN_SET_RESET_DT4:
    case EKRAN_SET_DT1:
    case EKRAN_RESET_DT1:
    case EKRAN_SET_DT2:
    case EKRAN_RESET_DT2:
    case EKRAN_SET_DT3:
    case EKRAN_RESET_DT3:
    case EKRAN_SET_DT4:
    case EKRAN_RESET_DT4:
    case EKRAN_LIST_D_AND:
    case EKRAN_LIST_D_OR:
    case EKRAN_LIST_D_XOR:
    case EKRAN_LIST_D_NOT:
    case EKRAN_LIST_TF_FOR_RANGUVANNJA:
    case EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA:
    case EKRAN_INFO:
    case EKRAN_DATE_TIME_PZ:
    case EKRAN_POINT_TIME_SETTINGS:
    case EKRAN_POINT_TIME_SETPOINT:
    case EKRAN_POINT_TIME_RANGUVANNJA:
    case EKRAN_DIAGNOSTYKA:
    case EKRAN_LIST_INPUTS_OUTPUTS:
    case EKRAN_STATE_INPUTS:
    case EKRAN_STATE_OUTPUTS:
    case EKRAN_LIST_REGISTRATORS:
    case EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS:
    case EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS:
    case EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS:
    case EKRAN_TITLES_DIGITAL_REGISTRATOR:
    case EKRAN_CHANGES_SIGNALS_DR:
    case EKRAN_TITLE_MAX_VALUES:
    case EKRAN_MAX_VALUES:
    case EKRAN_CHANGES_DIAGNOSTICS_PR_ERR:
    case EKRAN_CHOOSE_SETTINGS_VMP:
      {
        //Очищаємо всі біти краім упралінських
        new_state_keyboard &= (1<<BIT_KEY_ENTER)|(1<<BIT_KEY_ESC)|(1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN)|(1<<BIT_REWRITE);
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if(current_ekran.current_level == EKRAN_MEASURMENT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT] = current_ekran.index_position;
              //Формуємо екран списку вимірювання
              make_ekran_measurement();
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_CURRENT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_CURRENT) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_CURRENT] = current_ekran.index_position;
              //Формуємо екран вимірювання струмів
              make_ekran_current(pervynna_vtorynna);
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_VOLTAGE_LINE)
            {
              int max_row = 3;
              if(current_ekran.index_position >= max_row) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_VOLTAGE_LINE] = current_ekran.index_position;
              //Формуємо екран вимірювання лінійних напруг
              make_ekran_voltage_line(pervynna_vtorynna);
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_FREQUENCY)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_FREQUENCY) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_FREQUENCY] = current_ekran.index_position;
              //Формуємо екран відображення частоти
              make_ekran_frequency();
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_ANGLE)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_ANGLE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_ANGLE] = current_ekran.index_position;
              //Формуємо екран відображення кутів
              make_ekran_angle();
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_POWER)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_POWER) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_POWER] = current_ekran.index_position;
              //Формуємо екран відображення потужностей
              make_ekran_power(pervynna_vtorynna);
            }
            else if (current_ekran.current_level == EKRAN_ENERGY)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ENERGY) current_ekran.index_position = 0;
              current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
              position_in_current_level_menu[EKRAN_ENERGY] = current_ekran.index_position;
              //Формуємо екран відображення вікна технічного обліку електроенергії
              make_ekran_energy(pervynna_vtorynna);
            }
            else if(current_ekran.current_level == EKRAN_MEASURMENT_RESISTANCE)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_RESISTANCE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_MEASURMENT_RESISTANCE] = current_ekran.index_position;
              //Формуємо екран відображення опорів
              make_ekran_resistance(pervynna_vtorynna);
            }
            else if (
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_DZ        )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_MTZ       )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZDZ       )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZZ        )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_TZNP      )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_APV       )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV)|| 
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UROV      )|| 
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZOP       )|| 
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMIN      )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMAX      )||
                     (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UP        )
                    )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TWO_GROUP) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран група1-...-групаN-настройки для всіх захистів де використовуються групи уставок
              make_ekran_chose_settings_protection_with_groups();
            }
            else if (
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_DZ)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_MTZ)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZZ)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_TZNP)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ACHR_CHAPV)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UROV)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZOP)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMIN)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMAX)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UP)
                     )
                    )
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETPOINTS_TIMEOUTS) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставки-витримкидля захистів у яких є дві групи уставок
              make_ekran_chose_setpoint_and_timeout();
            }
            else if (
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_ZDZ)
                     )
                     ||  
                     (
                      (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_APV) &&
                      (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_APV)
                     )
                    )
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TIMEOUT) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран витримки для захистів у яких є багато груп уставок
              make_ekran_chose_timeout();
            }
            else if (current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO)
            {
              //?if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_SETPOINTS_CONTROL) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_TR_WITH_SETPOINTS_CONTROL) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO] = current_ekran.index_position;

              //Формуємо екран уставки-настройки
              //?make_ekran_chose_setpoint_control_transformator();
              make_ekran_chose_setpoint_transformator();
            }
            else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER) current_ekran.index_position = 0;
              
              position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_SWITCHER] = current_ekran.index_position;

              //Формуємо екран уставки-витримки-настройки-ранжування вимикача
              make_ekran_chose_settings_switcher();
            }
            else if (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_RANG_SWITCH) current_ekran.index_position = 0;
              
              position_in_current_level_menu[EKRAN_CHOOSE_RANG_SWITCH] = current_ekran.index_position;

              //Формуємо екран БВимк./БУвімк.
              make_ekran_choose_CBOn_CBOff();
            }
            else if (current_ekran.current_level == EKRAN_CHOOSE_LIST_SWITCH_L_H)
            {
              if(current_ekran.index_position >= NUMBER_OFF_ON) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CHOOSE_LIST_SWITCH_L_H] = current_ekran.index_position;
            
              //Формуємо екран заголовків Блоків Увімкнення/Вимкнення
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OFF_ON);
            }
            else if (
                     (current_ekran.current_level ==  EKRAN_CHOOSE_SETTINGS_SWITCHER_H)//(current_ekran.current_level >=  EKRAN_CHOOSE_SETTINGS_SWITCHER_H) 
                     //&&(current_ekran.current_level  < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                    )   
            //else if (current_ekran.current_level ==  EKRAN_CHOOSE_SETTINGS_SWITCHER_H)
			
			{
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER) current_ekran.index_position = 0;
              
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставки-витримки-настройки-ранжування вимикача
              make_ekran_chose_settings_switcher();
            }  
            else if (current_ekran.current_level ==  EKRAN_CHOOSE_SETTINGS_SWITCHER_H+1)
			{
              if(current_ekran.index_position >= (MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER-1)) current_ekran.index_position = 0;
              
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
			
              //Формуємо екран уставки-витримки-настройки-ранжування вимикача
              make_ekran_chose_settings_switcher_L();
            }  
             
			 else if (
                     (current_ekran.current_level >= EKRAN_CHOOSE_RANG_SWITCH_H) &&
                     (current_ekran.current_level < (EKRAN_CHOOSE_RANG_SWITCH_H + NUMBER_OFF_ON))
                    )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_RANG_SWITCH) current_ekran.index_position = 0;
              
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран БВимк./БУвімк.
              make_ekran_choose_CBOn_CBOff_(current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
            }
            
            else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_VMP)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_VMP) current_ekran.index_position = 0;
              
              position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_VMP] = current_ekran.index_position;

              //Формуємо екран налаштувань вперед-назад
              make_ekran_chose_settings_vmp();
            }
            else if (current_ekran.current_level == EKRAN_CHOSE_SETTINGS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS) current_ekran.index_position = 0;
              while(
                    ((current_settings.configuration & (1 << EL_BIT_CONFIGURATION)) == 0)
                    &&
                    (current_ekran.index_position == INDEX_OF_EXTENDED_LOGIC)
                   )
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS) current_ekran.index_position = 0;
              }

              position_in_current_level_menu[EKRAN_CHOSE_SETTINGS] = current_ekran.index_position;
            
              //Формуємо екран заголовків настроювання
              make_ekran_chose_settings();
            }
            else if (current_ekran.current_level == EKRAN_LEVEL_CHOOSE_PASSWORDS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOOSE_PASSWORDS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LEVEL_CHOOSE_PASSWORDS] = current_ekran.index_position;
            
              //Формуємо екран заголовків паролів
              make_ekran_chose_passwords();
            }
            else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UVV)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_UVV) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_UVV] = current_ekran.index_position;
                //Формуємо екран вибору настройок УВВ
              make_ekran_chose_settings_uvv();
            }
            else if (current_ekran.current_level == EKRAN_LIST_INPUTS_FOR_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_INPUTS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_INPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
            
              //Формуємо екран заголовків дискретних входів для ранжування
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_INPUT);
            }
            else if (current_ekran.current_level == EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_OUTPUTS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
            
              //Формуємо екран заголовків дискретних виходів для ранжування
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OUTPUT);
            }
            else if (current_ekran.current_level == EKRAN_LIST_LEDS_FOR_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_LEDS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_LEDS_FOR_RANGUVANNJA] = current_ekran.index_position;
            
              //Формуємо екран заголовків світоіндикаторів для ранжування
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_LED);
            }
            else if (current_ekran.current_level == EKRAN_CHOSE_COMMUNICATION_PARAMETERS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_COMMUNICATION_PARAMETERS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CHOSE_COMMUNICATION_PARAMETERS] = current_ekran.index_position;
              //Формуємо екран вибору настройок парамеирів комунікації
              make_ekran_chose_communication_parameters();
            }
            else if (current_ekran.current_level == EKRAN_VIEW_NAME_OF_CELL)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_NAME_OF_CELL) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_NAME_OF_CELL] = current_ekran.index_position;
              //Формуємо екран відображення імені ячейки
              make_ekran_name_of_cell();
            }
            else if (current_ekran.current_level == EKRAN_CHOSE_SETTING_RS485)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTING_RS485) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CHOSE_SETTING_RS485] = current_ekran.index_position;
              //Формуємо екран відображення списку настройок для інтерфейсу RS-485
              make_ekran_chose_setting_rs485();
            }
            else if (current_ekran.current_level == EKRAN_CHOSE_DATA_TIME)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS) current_ekran.index_position = 0;
              if ((current_settings.dst & MASKA_FOR_BIT(N_BIT_TZ_DST)) == 0)
              {
                while(
                      (current_ekran.index_position == INDEX_ML_CHDT_DST_ON) ||
                      (current_ekran.index_position == INDEX_ML_CHDT_DST_OFF)
                     )
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS) current_ekran.index_position = 0;
                }
              }

              position_in_current_level_menu[EKRAN_CHOSE_DATA_TIME] = current_ekran.index_position;
              //Формуємо екран вибору налаштувань дати і часу
              make_ekran_chose_data_time_settings();
            }
            else if (current_ekran.current_level == EKRAN_VIEW_LIST_OF_REGISTRATORS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_OF_REGISTRATORS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_LIST_OF_REGISTRATORS] = current_ekran.index_position;
              //Формуємо екран вибору реєстратора
              make_ekran_chose_registrators();
            }
            else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETTINGS_OF_ANALOG_REGISTRATOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS] = current_ekran.index_position;
              //Формуємо екран вибору ностройок аналогового реєстратора
              make_ekran_settings_analog_registrators();
            }
            else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETTINGS_OF_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS] = current_ekran.index_position;
              //Формуємо екран вибору ностройок аналогового реєстратора
              make_ekran_settings_digital_registrators();
            }
            else if (current_ekran.current_level == EKRAN_EXTENDED_LIGIC)
            {
              do
              {
                if(current_ekran.index_position >= MAX_ROW_FOR_EXTENDED_LIGIC) current_ekran.index_position = 0;
                
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_FUNCTIONS) && (current_settings.number_defined_df  == 0))
//                  current_ekran.index_position++;
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_TRIGGERS) && (current_settings.number_defined_dt  == 0))
//                  current_ekran.index_position++;
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_AND) && (current_settings.number_defined_and  == 0))
//                  current_ekran.index_position++;
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_OR) && (current_settings.number_defined_or  == 0))
//                  current_ekran.index_position++;
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_XOR) && (current_settings.number_defined_xor  == 0))
//                  current_ekran.index_position++;
//                if ((current_ekran.index_position == INDEX_OF_DEFINED_NOT) && (current_settings.number_defined_not  == 0))
//                  current_ekran.index_position++;
              }
              while (current_ekran.index_position >= MAX_ROW_FOR_EXTENDED_LIGIC);

              position_in_current_level_menu[EKRAN_EXTENDED_LIGIC] = current_ekran.index_position;
              //Формуємо екран вибору налаштувань розширеної логіки
              make_ekran_extended_logic();
            }
            else if (current_ekran.current_level == EKRAN_LIST_SETTINGS_FOR_DF)
            {
              if(current_ekran.index_position >= MAX_ROW_SETTINGS_DF) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_SETTINGS_FOR_DF] = current_ekran.index_position;
              //Формуємо екран відображення списку настройок для опреділювальних функцій
              make_ekran_chose_settings_df();
            }
            else if ((current_ekran.current_level == EKRAN_LIST_DF_FOR_RANGUVANNJA) || (current_ekran.current_level == EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS))
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_DF) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
            
              //Формуємо екран заголовків опреділювальних функцій
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DF);
            }
            else if ((current_ekran.current_level >= EKRAN_LIST_TYPE_SOURCE_DF1) && (current_ekran.current_level <= EKRAN_LIST_TYPE_SOURCE_DF16))
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_TYPE_SOURCE_DF) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
            
              //Формуємо екран заголовків типів джерел опреділювальних функцій
              make_ekran_list_type_source_df();
            }
            else if (current_ekran.current_level == EKRAN_LIST_DT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_DT) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_DT] = current_ekran.index_position;
              //Формуємо екран заголовків опреділювальних триґерів
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DT);
            }
            else if ((current_ekran.current_level >= EKRAN_SET_RESET_DT1) && (current_ekran.current_level <= EKRAN_SET_RESET_DT4))
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_SET_RESET_DT) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран заголовків активація-деактивація опреділювальних триґерів
              make_ekran_set_reset_trigger();
            }
            else if ((current_ekran.current_level >= EKRAN_SET_DT1) && (current_ekran.current_level <= EKRAN_RESET_DT4))
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_TYPE_SOURCE_DT) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран заголовків типів джерел опреділювальних триґерів
              make_ekran_list_type_source_dt();
            }
            else if (current_ekran.current_level == EKRAN_LIST_D_AND)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_D_AND) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_D_AND] = current_ekran.index_position;
              //Формуємо екран заголовків визначуваних "І"
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_AND);
            }
            else if (current_ekran.current_level == EKRAN_LIST_D_OR)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_D_OR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_D_OR] = current_ekran.index_position;
              //Формуємо екран заголовків визначуваних "АБО"
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OR);
            }
            else if (current_ekran.current_level == EKRAN_LIST_D_XOR)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_D_XOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_D_XOR] = current_ekran.index_position;
              //Формуємо екран заголовків визначуваних "Викл.АБО"
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_XOR);
            }
            else if (current_ekran.current_level == EKRAN_LIST_D_NOT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_D_NOT) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_D_NOT] = current_ekran.index_position;
              //Формуємо екран заголовків визначуваних "НЕ"
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_NOT);
            }
            else if (current_ekran.current_level == EKRAN_LIST_TF_FOR_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_TF) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
            
              //Формуємо екран заголовків передавальних функцій
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_TF);
            }
            else if (current_ekran.current_level == EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_BUTTONS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA] = current_ekran.index_position;
            
              //Формуємо екран заголовків функціональних кнопок для ранжування
              make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DB);
            }
            else if (current_ekran.current_level == EKRAN_INFO)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_INFO) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_INFO] = current_ekran.index_position;
              //Формуємо екран інформації
              make_ekran_info();
            }
            else if (current_ekran.current_level == EKRAN_DATE_TIME_PZ)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_DATE_TIME_PZ) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_DATE_TIME_PZ] = current_ekran.index_position;
              //Формуємо екран відображення міти дати і часу прошивки
              make_ekran_date_time_pz();
            }
            else if (current_ekran.current_level == EKRAN_POINT_TIME_SETTINGS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETTINGS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_POINT_TIME_SETTINGS] = current_ekran.index_position;
              //Формуємо екран вибору міток настроювання
              make_ekran_chose_item_of_point_time_settings();
            }
            else if (current_ekran.current_level == EKRAN_POINT_TIME_SETPOINT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_POINT_TIME_SETPOINT] = current_ekran.index_position;
              //Формуємо екран відображення міти останніх змін у уставках-витримках-управлінчькій інформації
              make_ekran_time_settings(0);
            }
            else if (current_ekran.current_level == EKRAN_POINT_TIME_RANGUVANNJA)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_POINT_TIME_RANGUVANNJA] = current_ekran.index_position;
              //Формуємо екран відображення міти останніх змін у ранжування
              make_ekran_time_settings(1);
            }
            else if(current_ekran.current_level == EKRAN_DIAGNOSTYKA)
            {
              if(current_ekran.index_position >= ((int)MAX_ROW_FOR_DIAGNOSTYKA)) current_ekran.index_position = 0;
              
              unsigned int diagnostyka_tmp[N_DIAGN];
              for (size_t i = 0; i < N_DIAGN; i++) diagnostyka_tmp[i] = diagnostyka[i];
              
              unsigned int not_null = false;
              for (size_t i = 0; i < N_DIAGN; i++) 
              {
                not_null |= (diagnostyka_tmp[i] != 0);
                if (not_null) break;
              }
              
              if (not_null)
              {
                while (_CHECK_SET_BIT(diagnostyka_tmp, current_ekran.index_position) ==0)
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= ((int)MAX_ROW_FOR_DIAGNOSTYKA)) current_ekran.index_position = 0;
                }
              }
              else
              {
                current_ekran.index_position = 0;
              }

              position_in_current_level_menu[EKRAN_DIAGNOSTYKA] = current_ekran.index_position;
              //Формуємо екран діагностики
              make_ekran_diagnostyka(diagnostyka_tmp);
            }
            else if (current_ekran.current_level == EKRAN_LIST_INPUTS_OUTPUTS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_INPUTS_OUTPUTS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_INPUTS_OUTPUTS] = current_ekran.index_position;
              //Формуємо екран вибору станів входів-виходів
              make_ekran_list_inputs_outputs();
            }
            else if ((current_ekran.current_level == EKRAN_STATE_INPUTS) || (current_ekran.current_level == EKRAN_STATE_OUTPUTS))
            {
              if (current_ekran.current_level == EKRAN_STATE_INPUTS)
              {
                if(current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
              }
              else
              {
                if(current_ekran.index_position >= (
                                                    NUMBER_SIMPLE_OUTPUTS
#ifdef NUMBER_DS
                                                       + ((current_settings.configuration & (1 << DS_BIT_CONFIGURATION)) != 0)*NUMBER_DS
#endif
                                                   )) current_ekran.index_position = 0;
              }
              
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран станів входів або виходыв 
              make_ekran_state_inputs_or_outputs(current_ekran.current_level - EKRAN_STATE_INPUTS);
            }
            else if (current_ekran.current_level == EKRAN_LIST_REGISTRATORS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_LIST_REGISTRATORS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_REGISTRATORS] = current_ekran.index_position;
              //Формуємо екран вибору відображення реєстраторів
              make_ekran_list_registrators();
            }
            else if (
                     (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS ) ||
                     (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS) ||
                     (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
                    )
            {
              unsigned int number_records = 0;
              unsigned int type_registrator = 0;
  
              if (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS)
              {
                unsigned int first_number = (info_rejestrator_ar.first_number < 0) ? 0 : (info_rejestrator_ar.first_number + 1);
                unsigned int last_number  = (info_rejestrator_ar.last_number  < 0) ? 0 : (info_rejestrator_ar.last_number + 1);
                
                if (first_number == 0) number_records = 0;
                else if (first_number >= last_number) number_records = first_number - last_number + 1;
                else number_records = NUMBER_FATFS_NAME - last_number + first_number + 1;
                
                type_registrator = INDEX_ML_ANALOG_REGISTRATOR_INFO;
              }
              else if (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS)
              {
                number_records = info_rejestrator_dr.number_records;
                type_registrator = INDEX_ML_DIGITAL_REGISTRATOR_INFO;
              }
              else if (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
              {
                number_records = info_rejestrator_pr_err.number_records;
                type_registrator = INDEX_ML_PROGRAM_ERROE_REGISTRATOR_INFO;
              }
              else
              {
                total_error_sw_fixed();
              }
              
              if(current_ekran.index_position >= ((int)number_records)) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран відображення записів
              //make_ekran_data_and_time_elem_d_p_a_registrator(type_registrator);
              if (type_registrator == INDEX_ML_ANALOG_REGISTRATOR_INFO) _SET_STATE(FATFS_command, FATFS_READ_DATA_FOR_MENU);
              else make_ekran_list_records_registrator(type_registrator);
            }
            else if (current_ekran.current_level == EKRAN_TITLES_DIGITAL_REGISTRATOR)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TITLES_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TITLES_DIGITAL_REGISTRATOR] = current_ekran.index_position;
              //Формуємо екран відображення заголовків груп для дискретного реєстратора
              make_ekran_list_titles_for_record_of_digital_registrator();
            }
            else if (current_ekran.current_level == EKRAN_CHANGES_SIGNALS_DR)
            {
              //Формуємо екран відображення змін сигналів - записаних у дискретному реєстраторі
              make_ekran_changing_signals_digital_registrator();
            }
            else if (current_ekran.current_level == EKRAN_TITLE_MAX_VALUES)
            {
              unsigned int number_records = buffer_for_manu_read_record[FIRST_INDEX_NUMBER_MAX_PHASE_O_DR + type_view_max_values_dr - IDENTIFIER_BIT_ARRAY_MAX_CURRENT_PHASE_O];

              if(current_ekran.index_position >= ((int)number_records)) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TITLE_MAX_VALUES] = current_ekran.index_position;

              //Формуємо екран відображення міток часу записів міксації максимальних струмів
              make_ekran_title_analog_value_records_digital_registrator();
            }
            else if (current_ekran.current_level == EKRAN_MAX_VALUES)
            {
              do
              {
                if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR) current_ekran.index_position = 0;
                
                while (
                       (type_view_max_values_dr != IDENTIFIER_BIT_ARRAY_MIN_R_O) && 
                       (current_ekran.index_position == (MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR - 1))  
                      )   
                  current_ekran.index_position++;
              }
              while (current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR);

              //Формуємо екран відображення аналогових значень з запису дискретного реєстратора
              make_ekran_analog_value_records_digital_registrator(pervynna_vtorynna);
            }
            else if (current_ekran.current_level == EKRAN_CHANGES_DIAGNOSTICS_PR_ERR)
            {
              //Формуємо екран відображення змін діагностик - записаних у реєстраторі програмних подій
              make_ekran_changing_diagnostics_pr_err_registrator();
            }
            
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              int temp_current_level = current_ekran.current_level;
              
              if (current_ekran.current_level == EKRAN_MEASURMENT)
              {
                //Ми у вікні відображення списку вимірювань
                if(current_ekran.index_position == INDEX_ML_MEASURMENT_CURRENT)
                {
                  //Переходимо на меню вибору відображення вимірювань струмів
                  current_ekran.current_level = EKRAN_MEASURMENT_CURRENT;
                
                  //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення , які поступають на аналогові входи приладу
                  pervynna_vtorynna = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_MEASURMENT_VOLTAGE)
                {
                  //Переходимо на меню вибору відображення вимірювань напруг
                  current_ekran.current_level = EKRAN_MEASURMENT_VOLTAGE_LINE;
                
                  //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення , які поступають на аналогові входи приладу
                  pervynna_vtorynna = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_MEASURMENT_FREQUENCY)
                {
                  //Переходимо на меню вибору відображення вимірювань частот
                  current_ekran.current_level = EKRAN_MEASURMENT_FREQUENCY;
                }
                else if(current_ekran.index_position == INDEX_ML_MEASURMENT_ANGLE)
                {
                  //Переходимо на меню вибору відображення вимірювань кутів
                  current_ekran.current_level = EKRAN_MEASURMENT_ANGLE;
                }
                else if(current_ekran.index_position == INDEX_ML_MEASURMENT_POWER)
                {
                  //Переходимо на меню вибору відображення вимірювань потужностей
                  current_ekran.current_level = EKRAN_MEASURMENT_POWER;
               
                  //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення, які поступають на аналогові входи приладу
                  pervynna_vtorynna = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_MEASURMENT_RESISTANCE)
                {
                  //Переходимо на меню вибору відображення опорів
                  current_ekran.current_level = EKRAN_MEASURMENT_RESISTANCE;
               
                  //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення, які поступають на аналогові входи приладу
                  pervynna_vtorynna = 0;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level == EKRAN_MEASURMENT_CURRENT) ||
                       (current_ekran.current_level == EKRAN_MEASURMENT_VOLTAGE_LINE) ||
                       (current_ekran.current_level == EKRAN_MEASURMENT_POWER) ||
                       (current_ekran.current_level == EKRAN_ENERGY) ||
                       (current_ekran.current_level == EKRAN_MEASURMENT_RESISTANCE)
                      )   
              {
                //Ми у вікні відображення або струмів, напруг, потужностей, опорів, енергій
                
                //Переключаємося між відображенням для первинної обмотки і вторинної обмотки
                pervynna_vtorynna ^= 0x1;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_MTZ)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки МТЗ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення атбраної групи уставок для МТЗ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для МТЗ
                  current_ekran.current_level = EKRAN_CONTROL_MTZ;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_MTZ)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок МТЗ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для МТЗ
                  current_ekran.current_level = EKRAN_SETPOINT_MTZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для МТЗ
                  current_ekran.current_level = EKRAN_TIMEOUT_MTZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_DZ)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки ДЗ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення атбраної групи уставок для ДЗ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ДЗ
                  current_ekran.current_level = EKRAN_CONTROL_DZ;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_DZ)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок ДЗ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для ДЗ
                  current_ekran.current_level = EKRAN_SETPOINT_DZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для ДЗ
                  current_ekran.current_level = EKRAN_TIMEOUT_DZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZDZ)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки ЗДЗ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для ЗДЗ
                  current_ekran.current_level = EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ЗДЗ
                  current_ekran.current_level = EKRAN_CONTROL_ZDZ;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_ZDZ)
                      )
              {
                //Натисну кнопка Enter у вікні вибору витримок ЗДЗ
                if(current_ekran.index_position == INDEX_ML_WITH_TIMEOUT_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для ЗДЗ
                  current_ekran.current_level = EKRAN_TIMEOUT_ZDZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZZ)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки ЗЗ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для ЗЗ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ЗЗ
                  current_ekran.current_level = EKRAN_CONTROL_ZZ;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZZ)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок ЗЗ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для ЗЗ
                  current_ekran.current_level = EKRAN_SETPOINT_ZZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для ЗЗ
                  current_ekran.current_level = EKRAN_TIMEOUT_ZZ_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_TZNP)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки ТЗНП
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для ТЗНП
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ТЗНП
                  current_ekran.current_level = EKRAN_CONTROL_TZNP;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_TZNP)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок ТЗНП
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для ТЗНП
                  current_ekran.current_level = EKRAN_SETPOINT_TZNP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для ТЗНП
                  current_ekran.current_level = EKRAN_TIMEOUT_TZNP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_APV)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки АПВ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для АПВ
                  current_ekran.current_level = EKRAN_CHOOSE_TIMEOUT_GROUP1_APV + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для АПВ
                  current_ekran.current_level = EKRAN_CONTROL_APV;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_APV) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_APV)
                      )
              {
                //Натисну кнопка Enter у вікні вибору витримок АПВ
                if(current_ekran.index_position == INDEX_ML_WITH_TIMEOUT_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для АПВ
                  current_ekran.current_level = EKRAN_TIMEOUT_APV_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_TIMEOUT_GROUP1_APV);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки АЧР-ЧАПВ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для АЧР-ЧАПВ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для АЧР-ЧАПВ
                  current_ekran.current_level = EKRAN_CONTROL_ACHR_CHAPV;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ACHR_CHAPV)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок АЧР-ЧАПВ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для АЧР-ЧАПВ
                  current_ekran.current_level = EKRAN_SETPOINT_ACHR_CHAPV_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для АЧР-ЧАПВ
                  current_ekran.current_level = EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UROV)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки УРОВ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для УРОВ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для УРОВ
                  current_ekran.current_level = EKRAN_CONTROL_UROV;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UROV)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок УРОВ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для УРОВ
                  current_ekran.current_level = EKRAN_SETPOINT_UROV_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для УРОВ
                  current_ekran.current_level = EKRAN_TIMEOUT_UROV_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZOP)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки ЗОП(КОФ)
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для ЗОП(КОФ)
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ЗОП(КОФ)
                  current_ekran.current_level = EKRAN_CONTROL_ZOP;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZOP)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок ЗОП(КОФ)
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для ЗОП(КОФ)
                  current_ekran.current_level = EKRAN_SETPOINT_ZOP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для ЗОП(КОФ)
                  current_ekran.current_level = EKRAN_TIMEOUT_ZOP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMIN)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки Umin
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для Umin
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для Umin
                  current_ekran.current_level = EKRAN_CONTROL_UMIN;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMIN)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок Umin
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для Umin
                  current_ekran.current_level = EKRAN_SETPOINT_UMIN_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для Umin
                  current_ekran.current_level = EKRAN_TIMEOUT_UMIN_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMAX)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки Umax
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для Umax
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для Umax
                  current_ekran.current_level = EKRAN_CONTROL_UMAX;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMAX)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок Umax
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для Umax
                  current_ekran.current_level = EKRAN_SETPOINT_UMAX_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для Umax
                  current_ekran.current_level = EKRAN_TIMEOUT_UMAX_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UP)
              {
                //Натисну кнопка Enter у вікні вибору група1-...-групаN-настройки УЗ
                if(
                   (current_ekran.index_position >= INDEX_ML_GROUP1) &&
                   (current_ekran.index_position <= INDEX_ML_GROUP4)
                  )  
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення обраної групи уставок для УЗ
                  current_ekran.current_level = EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP + (current_ekran.index_position - INDEX_ML_GROUP1);
                }
                else if (current_ekran.index_position == INDEX_ML_CONTROL_WITH_GROUPS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для УЗ
                  current_ekran.current_level = EKRAN_CONTROL_UP;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP) &&
                       (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UP)
                      )
              {
                //Натисну кнопка Enter у вікні вибору уставок-витримок УЗ
                if(current_ekran.index_position == INDEX_ML_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для УЗ
                  current_ekran.current_level = EKRAN_SETPOINT_UP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP);
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для УЗ
                  current_ekran.current_level = EKRAN_TIMEOUT_UP_GROUP1 + (current_ekran.current_level - EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP);
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (
                     (current_ekran.current_level >=  EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                     (current_ekran.current_level  < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                  //Натисну кнопка Enter у вікні вибору настройок виключателя
                  if(current_ekran.index_position == INDEX_ML_SETPOINT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для вимикача
                  if(current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER_H)
                   current_ekran.current_level = EKRAN_SETPOINT_SWITCH;
                  //else   
                     
                }
                else if (current_ekran.index_position == INDEX_ML_TIMEOUT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для вимикача
                  current_ekran.current_level = EKRAN_TIMEOUT_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                } 
                else if (current_ekran.index_position == INDEX_ML_CONTROL_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для вимикача
                  current_ekran.current_level = EKRAN_CONTROL_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                
                } 
                else if (current_ekran.index_position == INDEX_ML_RANG_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування управління вимикачем
                  current_ekran.current_level = EKRAN_CHOOSE_RANG_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                       (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH_H) ||
                       (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH_L)
                      )   
              {
                //  //Натисну кнопка Enter у вікні вибору Бвимк./БУвімк.
                if(current_ekran.index_position == INDEX_ML_RANG_OFF_CB)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування ББвимк.
                  current_ekran.current_level = EKRAN_RANGUVANNJA_OFF_CB_H + (current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                }
                else if (current_ekran.index_position == INDEX_ML_RANG_ON_CB)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування ББувімк.
                  current_ekran.current_level = EKRAN_RANGUVANNJA_ON_CB_H + (current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              
              
              }  
              else if (current_ekran.current_level == EKRAN_CHOOSE_LIST_SWITCH_L_H)
              {
                //
                //Переходимо на меню відображення списку Блоків Увімкнення/Вимкнення
                current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_SWITCHER_H + current_ekran.index_position;

                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO)
              {
                //Натисну кнопка Enter у вікні вибору уставок-настройок трансформатора
                if(current_ekran.index_position == INDEX_ML_WITH_SETPOINT_CONTROL_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для вимикача
                  current_ekran.current_level = EKRAN_TRANSFORMATOR_INFO_SETPOINT;
                }
                else if (current_ekran.index_position == INDEX_ML_WITH_SETPOINT_CONTROL_CONTROL)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для вимикача
                  //!current_ekran.current_level = EKRAN_TRANSFORMATOR_INFO_CONTROL;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER)
              {
                //Натисну кнопка Enter у вікні вибору настройок виключателя
                if(current_ekran.index_position == INDEX_ML_SETPOINT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для вимикача
                  current_ekran.current_level = EKRAN_SETPOINT_SWITCH;
                }
                else if (current_ekran.index_position == INDEX_ML_TIMEOUT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для вимикача
                  current_ekran.current_level = EKRAN_TIMEOUT_SWITCH;
                } 
                else if (current_ekran.index_position == INDEX_ML_CONTROL_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для вимикача
                  current_ekran.current_level = EKRAN_CONTROL_SWITCH;
                } 
                else if (current_ekran.index_position == INDEX_ML_RANG_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування управління вимикачем
                  current_ekran.current_level = EKRAN_CHOOSE_RANG_SWITCH;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
                
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH)
              {
                //Натисну кнопка Enter у вікні вибору Бвимк./БУвімк.
                if(current_ekran.index_position == INDEX_ML_RANG_OFF_CB)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування ББвимк.
                  current_ekran.current_level = EKRAN_RANGUVANNJA_OFF_CB;
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                }
                else if (current_ekran.index_position == INDEX_ML_RANG_ON_CB)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування БУвімк.
                  current_ekran.current_level = EKRAN_RANGUVANNJA_ON_CB;
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (
                     (current_ekran.current_level >=  EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                     (current_ekran.current_level  < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                 //Натисну кнопка Enter у вікні вибору настройок виключателя
                if(current_ekran.index_position == INDEX_ML_SETPOINT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для вимикача
                  current_ekran.current_level = EKRAN_SETPOINT_SWITCH;
                }
                else if (current_ekran.index_position == INDEX_ML_TIMEOUT_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для вимикача
                  current_ekran.current_level = EKRAN_TIMEOUT_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                } 
                else if (current_ekran.index_position == INDEX_ML_CONTROL_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для вимикача
                  current_ekran.current_level = EKRAN_CONTROL_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                } 
                else if (current_ekran.index_position == INDEX_ML_RANG_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення ранжування управління вимикачем
                  current_ekran.current_level = EKRAN_CHOOSE_RANG_SWITCH_H + (current_ekran.current_level - EKRAN_CHOOSE_SETTINGS_SWITCHER_H);
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;     
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_VMP)
              {
                //Натисну кнопка Enter у вікні вибору настройок для ВМП
                if(current_ekran.index_position == INDEX_ML_FORWARD_SETTINGS_VMP)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення уставок для напрямку ВПЕРЕД
                  current_ekran.current_level = EKRAN_SETPOINT_VMP_FORWARD;
                }
                else if (current_ekran.index_position == INDEX_ML_BACKWARD_SETTINGS_VMP)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для напрямку НАЗАД
                  current_ekran.current_level = EKRAN_SETPOINT_VMP_BACKWARD;
                } 
                else if (current_ekran.index_position == INDEX_ML_CONTROL_SETTINGS_VMP)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управлінської інформації для ВМП
                  current_ekran.current_level = EKRAN_CONTROL_VMP;
                } 
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTINGS)
              {
                //Натисну кнопка Enter у вікні вибору настройок
                if(current_ekran.index_position == INDEX_OF_INFO)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення інформації по версії програмного забезпечення і версії карти пам'яті
                  current_ekran.current_level = EKRAN_INFO;
                }
                else if(current_ekran.index_position == INDEX_OF_SETTINGS_POINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення вибору міток настройок
                  current_ekran.current_level = EKRAN_POINT_TIME_SETTINGS;
                }
                else if(current_ekran.index_position == INDEX_OF_INPUTS_RANGUVANNJA)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних входів
                  current_ekran.current_level = EKRAN_LIST_INPUTS_FOR_RANGUVANNJA;
                }
                else if(current_ekran.index_position == INDEX_OF_OUTPUTS_RANGUVANNJA)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних виходів
                  current_ekran.current_level = EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA;
                }
                else if(current_ekran.index_position == INDEX_OF_LEDS_RANGUVANNJA)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних світодіодів
                  current_ekran.current_level = EKRAN_LIST_LEDS_FOR_RANGUVANNJA;
                }
                else if(current_ekran.index_position == INDEX_OF_SWITCHER)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення вибору настройок виключателя
                  //!current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_SWITCHER;
                  current_ekran.current_level = EKRAN_CHOOSE_LIST_SWITCH_L_H;
                }
                else if(current_ekran.index_position == INDEX_OF_TRANSFORMATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення настройок трансорматора
                  current_ekran.current_level = EKRAN_TRANSFORMATOR_INFO;
                }
                else if(current_ekran.index_position == INDEX_OF_CONTROL_INPUTS_OUTPUTS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення настройок УВВ
                  current_ekran.current_level = EKRAN_CHOOSE_SETTINGS_UVV;
                }
                else if(current_ekran.index_position == INDEX_OF_COMMUNICATION)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення настройок комунікації
                  current_ekran.current_level = EKRAN_CHOSE_COMMUNICATION_PARAMETERS;
                }
                else if(current_ekran.index_position == INDEX_OF_DATA_AND_TIME)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення налаштувань дати і часу
                  current_ekran.current_level = EKRAN_CHOSE_DATA_TIME;
                }
                else if(current_ekran.index_position == INDEX_OF_REGISTRATORS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку наявних реєстраторів
                  current_ekran.current_level = EKRAN_VIEW_LIST_OF_REGISTRATORS;
                }
                else if(current_ekran.index_position == INDEX_OF_EXTENDED_LOGIC)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку розширеної логіки
                  current_ekran.current_level = EKRAN_EXTENDED_LIGIC;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_BUTTONS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку настроювання функціональних кнопок
                  current_ekran.current_level = EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA;
                }
                else if(current_ekran.index_position == INDEX_OF_GRUPA_USTAVOK)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню вибору груп уставок
                  current_ekran.current_level = EKRAN_VIEW_GRUPA_USTAVOK;
                }
                else if(current_ekran.index_position == INDEX_OF_EXTRA_SETTINGS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню додаткових нлаштувань
                  current_ekran.current_level = EKRAN_CHOSE_EXTRA_SETTINGS;
                }
                else if(current_ekran.index_position == INDEX_OF_LIST_PASSWORDS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню списку паролів
                  current_ekran.current_level = EKRAN_LEVEL_CHOOSE_PASSWORDS;
                }
//                else if(current_ekran.index_position == INDEX_OF_PASSWORD)
//                {
//                  //Запам'ятовуємо поперердній екран
//                  //Переходимо на меню зміни паролю
//                  current_ekran.current_level = EKRAN_LEVEL_SET_NEW_PASSWORD;
//                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
//                if (current_ekran.current_level != EKRAN_LEVEL_SET_NEW_PASSWORD) current_ekran.edition = 0;
//                else current_ekran.edition = 1;
              }
              else if (current_ekran.current_level == EKRAN_LEVEL_CHOOSE_PASSWORDS)
              {
                //Натисну кнопка Enter у вікні вибору паролів
                if(current_ekran.index_position == INDEX_OF_PASSWORD1)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню зміни паролю
                  current_ekran.current_level = EKRAN_LEVEL_SET_NEW_PASSWORD1;
                }
                else if(current_ekran.index_position == INDEX_OF_PASSWORD2)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню зміни паролю
                  current_ekran.current_level = EKRAN_LEVEL_SET_NEW_PASSWORD2;
                }
                else 
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню зміни паролю
                  current_ekran.current_level = EKRAN_LEVEL_SET_NEW_PASSWORD3;
                }
                
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 1;
              }
              else if (current_ekran.current_level == EKRAN_LIST_INPUTS_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран BOOK6
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_INPUT_1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран BOOK7
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_OUTPUT_1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_LEDS_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_LED_1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UVV)
              {
                //Натисну кнопка Enter у вікні вибору вікна настройок УВВ
                if(current_ekran.index_position == INDEX_ML_UVV_DOPUSKT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних входів
                  current_ekran.current_level = EKRAN_DOPUSK_DV_UVV;
                }
                else if(current_ekran.index_position == INDEX_ML_UVV_TYPE_INPUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних входів
                  current_ekran.current_level = EKRAN_TYPE_INPUT_UVV;
                }
                else if(current_ekran.index_position == INDEX_ML_UVV_TYPE_INPUT_SIGNAL)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку дискретних входів
                  current_ekran.current_level = EKRAN_TYPE_INPUT_SIGNAL_UVV;
                }
                else if(current_ekran.index_position == INDEX_ML_UVV_TYPE_OUTPUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення типу виходів
                  current_ekran.current_level = EKRAN_TYPE_OUTPUT_UVV;
                }
                else if(current_ekran.index_position == INDEX_ML_UVV_TYPE_LED)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення типу свівтлоіндикаторів
                  current_ekran.current_level = EKRAN_TYPE_LED_UVV;
                }
                else if(current_ekran.index_position == INDEX_ML_UVV_TYPE_DB)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення типу ФК
                  current_ekran.current_level = EKRAN_TYPE_BUTTON_UVV;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_COMMUNICATION_PARAMETERS)
              {
                //Натисну кнопка Enter у вікні вибору вікна настройок комунікації
                if(current_ekran.index_position == INDEX_ML_CHCP_NAME)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення імені ячейки
                  current_ekran.current_level = EKRAN_VIEW_NAME_OF_CELL;
                }
                else if(current_ekran.index_position == INDEX_ML_CHCP_ADDRESS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення мережевої адреси
                  current_ekran.current_level = EKRAN_ADDRESS;
                }
                else if(current_ekran.index_position == INDEX_ML_CHCP_SETTING_RS485)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення мережевої адреси
                  current_ekran.current_level = EKRAN_CHOSE_SETTING_RS485;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTING_RS485)
              {
                //Натисну кнопка Enter у вікні вибору вікна настройок RS-485
                if(current_ekran.index_position == INDEX_ML_CHSRS485_SPEED)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення швидкості обміну
                  current_ekran.current_level = EKRAN_VIEW_SPEED_RS485;
                }
                else if(current_ekran.index_position == INDEX_ML_CHSRS485_PARE_BIT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення інформації по бітупаритету
                  current_ekran.current_level = EKRAN_VIEW_PARE_RS485;
                }
                else if(current_ekran.index_position == INDEX_ML_CHSRS485_NUMBER_STOP_BIT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення інфрпмації по стоп-біту
                  current_ekran.current_level = EKRAN_VIEW_STOP_BITS_RS485;
                }
                else if(current_ekran.index_position == INDEX_ML_CHSRS485_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення інфрпмації по time-out наступного символу
                  current_ekran.current_level = EKRAN_VIEW_TIMEOUT_RS485;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_DATA_TIME)
              {
                //Натисну кнопка Enter у вікні вибору вікна настройок налаштувань дл дати і часу
                if(current_ekran.index_position == INDEX_ML_CHDT_TIME_ZONE)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення налаштувань часової зони і правил переходу на літній час
                  current_ekran.current_level = EKRAN_TIME_ZONE;
                }
                else if(
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_ON) ||
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_OFF)
                       )
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення правил переходу між літнім часом і стандартним часом
                  current_ekran.current_level = EKRAN_DST_RULE;
                }

                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_VIEW_LIST_OF_REGISTRATORS)
              {
                if(current_ekran.index_position == INDEX_ML_DIGITAL_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку ранжованих функцій для дискретного реєстратора
                  current_ekran.current_level = EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS;//!@EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR;
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  //!@position_in_current_level_menu[current_ekran.current_level] = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_ANALOG_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку настройок для аналогового реєстратора
                  current_ekran.current_level = EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS)
              {
                if(current_ekran.index_position == INDEX_ML_SOURCE_ANALOG_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку ранжованих функцій для аналогового реєстратора
                  current_ekran.current_level = EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR;
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT_ANALOG_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для аналогового реєстратора
                  current_ekran.current_level = EKRAN_TIMEOUT_ANALOG_REGISTRATOR;
                }
                else if(current_ekran.index_position == INDEX_ML_CONTROL_ANALOG_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення управління для аналогового реєстратора
                  current_ekran.current_level = EKRAN_CONTROL_AR;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS)
              {
                if(current_ekran.index_position == INDEX_ML_SOURCE_DIGITAL_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку ранжованих функцій для аналогового реєстратора
                  current_ekran.current_level = EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR;
                  //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                  position_in_current_level_menu[current_ekran.current_level] = 0;
                }
                else if(current_ekran.index_position == INDEX_ML_TIMEOUT_DIGITAL_REGISTRATOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення витримок для аналогового реєстратора
                  current_ekran.current_level = EKRAN_TIMEOUT_DIGITAL_REGISTRATOR;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_EXTENDED_LIGIC)
              {
                if(current_ekran.index_position == INDEX_OF_GENERAL_PICKUP_EL)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення загальних уставок для розширеної логіки
                  current_ekran.current_level = EKRAN_GENERAL_PICKUPS_EL;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_FUNCTIONS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку настроювання опреділювальних функцій
                  current_ekran.current_level = EKRAN_LIST_SETTINGS_FOR_DF;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_TRIGGERS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку опреділювальних триґерів
                  current_ekran.current_level = EKRAN_LIST_DT;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_AND)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку визначуваних "І"
                  current_ekran.current_level = EKRAN_LIST_D_AND;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_OR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку визначуваних "АБО"
                  current_ekran.current_level = EKRAN_LIST_D_OR;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_XOR)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку визначуваних "Викл.АБО"
                  current_ekran.current_level = EKRAN_LIST_D_XOR;
                }
                else if(current_ekran.index_position == INDEX_OF_DEFINED_NOT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку визначуваних "НЕ"
                  current_ekran.current_level = EKRAN_LIST_D_NOT;
                }
                else if(current_ekran.index_position == INDEX_OF_TRANSFER_FUNCTIONS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку визначуваних "НЕ"
                  current_ekran.current_level = EKRAN_LIST_TF_FOR_RANGUVANNJA;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_SETTINGS_FOR_DF)
              {
                //Натисну кнопка Enter у вікні вибору вікна настройок опреділювальнтої функції
                if(current_ekran.index_position == INDEX_ML_SETTING_DF_SOURCE)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку оперділювальних функцій для їх ранжування
                  current_ekran.current_level = EKRAN_LIST_DF_FOR_RANGUVANNJA;
                }
                else if(current_ekran.index_position == INDEX_ML_SETTING_DF_TIMEOUT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення списку оперділювальних функцій для їх параметрування часу павзи і роботи
                  current_ekran.current_level = EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS;
                }
                else if(current_ekran.index_position == INDEX_ML_SETTING_DF_TYPE)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення типу опреділювальних функцій
                  current_ekran.current_level = EKRAN_LIST_TYPE_DF;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_TIMEOUT_DF1 + current_ekran.index_position;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_DF_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення вибору типу джерел для ранжування опреділюваної функції
                current_ekran.current_level = EKRAN_LIST_TYPE_SOURCE_DF1 + current_ekran.index_position;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if ((current_ekran.current_level >= EKRAN_LIST_TYPE_SOURCE_DF1) && (current_ekran.current_level <= EKRAN_LIST_TYPE_SOURCE_DF16))
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_DF1_PLUS + 3*(current_ekran.current_level - EKRAN_LIST_TYPE_SOURCE_DF1) + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_DT)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення заголовків активація-деактивація опреділювальних триґерів
                current_ekran.current_level = EKRAN_SET_RESET_DT1 + current_ekran.index_position;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if ((current_ekran.current_level >= EKRAN_SET_RESET_DT1) && (current_ekran.current_level <= EKRAN_SET_RESET_DT4))
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення заголовків джерел активації-деактивації опреділювальних триґерів
                current_ekran.current_level = EKRAN_SET_DT1 + 2*(current_ekran.current_level - EKRAN_SET_RESET_DT1) + current_ekran.index_position;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if ((current_ekran.current_level >= EKRAN_SET_DT1) && (current_ekran.current_level <= EKRAN_RESET_DT4))
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_SET_DT1_PLUS + 2*(current_ekran.current_level - EKRAN_SET_DT1) + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_AND)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_D_AND1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_OR)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_D_OR1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_XOR)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_D_XOR1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_NOT)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_D_NOT1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_TF_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення вибору типу джерел для ранжування передавальної функції
                current_ekran.current_level = EKRAN_LIST_SOURCE_TF1 + current_ekran.index_position;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA)
              {
                //Запам'ятовуємо поперердній екран
                //Переходимо на меню відображення списку ранжованих функцій
                current_ekran.current_level = EKRAN_RANGUVANNJA_BUTTON_1 + current_ekran.index_position;
                //Для того, щоб при першому входженні завжди список починався із першої ранжованої функції обнуляємо цю позицію
                position_in_current_level_menu[current_ekran.current_level] = 0;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_INFO)
              {
                //Натисну кнопка Enter у вікні інформації по версії прошивки і карти пам'яті
                if(
                   (current_ekran.index_position == INDEX_ML_INFO_FIRMWARE) 
#if (((MODYFIKACIA_VERSII_PZ / 10) & 0x1) != 0)
                   ||
                   (current_ekran.index_position == INDEX_ML_INFO_FIRMWARE_CB)
#endif
                  )   
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення кдати і часу створення прошивки
                  current_ekran.current_level = EKRAN_DATE_TIME_PZ;

                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                  current_ekran.edition = 0;
                }
                else if (current_ekran.index_position == INDEX_ML_REPROGRAM)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню активації режиму перепрограмування
                  current_ekran.current_level = EKRAN_REPROGRAM;

                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                  current_ekran.edition = 0; 
                  
                  //Щоб зразу перейти на запит паролю
                  previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;
                  temp_current_level = current_ekran.current_level;
                  current_ekran.current_level = EKRAN_LEVEL_PASSWORD_REPROGRAM;
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
              }
              else if (current_ekran.current_level == EKRAN_POINT_TIME_SETTINGS)
              {
                //Натисну кнопка Enter у вікні вибору міток останніх настройок
                if(current_ekran.index_position == INDEX_ML_TIME_SETPOINT)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення часу останніх настройк уставок-витримок-управлінської інформації
                  current_ekran.current_level = EKRAN_POINT_TIME_SETPOINT;
                }
                else if(current_ekran.index_position == INDEX_ML_TIME_RANGUVANNJA)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення часу останніх настройк ранжування
                  current_ekran.current_level = EKRAN_POINT_TIME_RANGUVANNJA;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_INPUTS_OUTPUTS)
              {
                //Натисну кнопка Enter у вікні вибору станів входів-виходів
                if(current_ekran.index_position == INDEX_ML_STATE_INPUTS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення станів входів
                  current_ekran.current_level = EKRAN_STATE_INPUTS;
                }
                else
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення станів виходів
                  current_ekran.current_level = EKRAN_STATE_OUTPUTS;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_INPUTS_OUTPUTS)
              {
                //Натисну кнопка Enter у вікні вибору станів входів-виходів
                if(current_ekran.index_position == INDEX_ML_STATE_INPUTS)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення станів входів
                  current_ekran.current_level = EKRAN_STATE_INPUTS;
                }
                else
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення станів виходів
                  current_ekran.current_level = EKRAN_STATE_OUTPUTS;
                }
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_LIST_REGISTRATORS)
              {
                //Натисну кнопка Enter у вікні вибору реєстраторів
                if(current_ekran.index_position == INDEX_ML_ANALOG_REGISTRATOR_INFO)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення аналогового реєстратора
                  current_ekran.current_level = EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS;
                }
                else if(current_ekran.index_position == INDEX_ML_DIGITAL_REGISTRATOR_INFO)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення дискретного реєстратора
                  current_ekran.current_level = EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS;
                }
                else if(current_ekran.index_position == INDEX_ML_PROGRAM_ERROE_REGISTRATOR_INFO)
                {
                  //Запам'ятовуємо поперердній екран
                  //Переходимо на меню відображення реєстратора програмних помилок
                  current_ekran.current_level = EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS;
                }
                current_ekran.index_position = 0; //При відкриванні цих вікон з старших розділів меню завжди треба попадати на найновіший запис
                current_ekran.edition = 0;
              }
              else if (
                       (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS) && 
                       (info_rejestrator_dr.number_records > 0) &&
                       ((clean_rejestrators & CLEAN_DR) == 0)
                      )
              {
                //Натисну кнопка Enter у вікні вибору запису дискретного реєстратора і реально є записи для відображення
                
                //Запам'ятовуємо, який номер запису дискретного реєстратори ми намагаємося продивитися
                number_record_of_dr_for_menu = current_ekran.index_position;
                
                //Виставляємо першу частину запису
                part_reading_dr_from_dataflash_for_menu = 0;
                //Подаємо команду зчитати дані у бувер пам'яті
								mutex_spi1 = true;
                control_tasks_dataflash |= TASK_MAMORY_READ_DATAFLASH_FOR_DR_MENU;
								mutex_spi1 = false;
                
                //Виставляємо повідомлення, що поки дані не будуть зчитані, то екран треба перерисовувати кожну секунду
                rewrite_ekran_once_more = 1;
                //Виставляємо новий екран, який треба відобразити на РКІ
                current_ekran.current_level = EKRAN_TITLES_DIGITAL_REGISTRATOR;
                current_ekran.index_position = 0; //При відкриванні цих вікон з старших розділів меню завжди треба попадати на найновіший запис
                current_ekran.edition = 0;
              }
              else if (current_ekran.current_level == EKRAN_TITLES_DIGITAL_REGISTRATOR)
              {
                //Натисну кнопка Enter у вікні вибору груп інформації по запису дискретного реєстра
                if (rewrite_ekran_once_more == 0)
                {
                  if(current_ekran.index_position == INDEX_ML_TITLE_DR_CHANGES_SIGNALS)
                  {
                    //Переходимо на меню відображення зафіксованих змін сигналів у запису дискретного реєстратора
                    current_ekran.current_level = EKRAN_CHANGES_SIGNALS_DR;
                  }
                  else
                  {
                    //Переходимо на меню відображення зафіксованих аналоговихзначень у запису дискретного реєстратора
                    current_ekran.current_level = EKRAN_TITLE_MAX_VALUES;
                    type_view_max_values_dr = (current_ekran.index_position - INDEX_ML_TITLE_DR_MAX_PHASE_O) + IDENTIFIER_BIT_ARRAY_MAX_CURRENT_PHASE_O;
                  }
                  current_ekran.index_position = 0;
                  current_ekran.edition = 0;
                }
              }
              else if (current_ekran.current_level == EKRAN_TITLE_MAX_VALUES)
              {
                //Натиснута кнопка Enter у вікні списку зафіксованих максимальних струмів
                if((index_cell_into_array_for_min_max_measurement_dr >= FIRST_INDEX_FIRST_BLOCK_DR) && (index_cell_into_array_for_min_max_measurement_dr <= ((int)(FIRST_INDEX_FIRST_DATA_DR - sizeof(unsigned int)*SIZE_ARRAY_FIX_MAX_MEASUREMENTS))))
                {
                  //Переходимо у нове вікно тільки у тому випадку, якщо ми попередньо зафіксували з якого місця розміщається блок, який визначений курсором
                  current_ekran.current_level = EKRAN_MAX_VALUES;

                  //Спочатку відображаємо інформацію на вторинній обмотці трансворматора - значення , які поступають на аналогові входи приладу
                  pervynna_vtorynna = 0;
                  
                  current_ekran.index_position = 0; //Завжди починаэмо з першого вікна
                  current_ekran.edition = 0;
                }
              }
              else if (
                       (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS) &&
                       (info_rejestrator_pr_err.number_records > 0) &&
                       ((clean_rejestrators & CLEAN_PR_ERR) == 0)
                      )
              {
                //Натисну кнопка Enter у вікні вибору запису реєстратора програмних подій і реально є записи для відображення
                
                //Запам'ятовуємо, який номер запису реєстратора програмних подій ми намагаємося продивитися
                number_record_of_pr_err_into_menu = current_ekran.index_position;
                
                //Подаємо команду зчитати дані у бувер пам'яті
								mutex_spi1 = true;
                control_tasks_dataflash |= TASK_MAMORY_READ_DATAFLASH_FOR_PR_ERR_MENU;
								mutex_spi1 = false;
                
                //Виставляємо новий екран, який треба відобразити на РКІ
                current_ekran.current_level = EKRAN_CHANGES_DIAGNOSTICS_PR_ERR;
                current_ekran.index_position = 0; //При відкриванні цих вікон з старших розділів меню завжди треба попадати на найновіший запис
                current_ekran.edition = 0;
              }
             
              //У разі, якщо текучий екран змінився, то запам'ятовуємо екран в який требе буде повернутися
              if (temp_current_level != current_ekran.current_level) 
              {
                previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;
              
                if(
                   ((current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD1) && (current_settings.password1 != 0)) ||
                    (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD2) ||
                    (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD3)
                  )   
                {
                  //У випавдку, якщо ми намагаємося перейти у вікно зміни паролю, то спочатку треба запитати старий пароль доступу, якщо він встановлений
                  if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD1) 
                  {
                    current_ekran.current_level = EKRAN_LEVEL_PASSWORD;
                    previous_level_in_current_level_menu[current_ekran.current_level] = EKRAN_LEVEL_SET_NEW_PASSWORD1;
                  }
                  else if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD2)
                  {
                    current_ekran.current_level = EKRAN_LEVEL_PASSWORD_HARD;
                    previous_level_in_current_level_menu[current_ekran.current_level] = EKRAN_LEVEL_SET_NEW_PASSWORD2;
                  }
                  else if (current_ekran.current_level == EKRAN_LEVEL_SET_NEW_PASSWORD3)
                  {
                    current_ekran.current_level = EKRAN_LEVEL_PASSWORD_REPROGRAM;
                    previous_level_in_current_level_menu[current_ekran.current_level] = EKRAN_LEVEL_SET_NEW_PASSWORD3;
                  }
                  else
                  {
                    //Теоретично цього ніколи не мало б бути
                    total_error_sw_fixed();
                  }
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                  current_ekran.cursor_on = 1;
                  current_ekran.cursor_blinking_on = 1;
                }
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              //Переходимо у попереднє меню
              current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
              current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              current_ekran.edition = 0;

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(current_ekran.current_level == EKRAN_MEASURMENT)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT] = current_ekran.index_position;
                //Формуємо екран списку вимірювань вікна
                make_ekran_measurement();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_CURRENT)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT_CURRENT - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT_CURRENT] = current_ekran.index_position;
                //Формуємо екран вимірювання струмів вікна
                make_ekran_current(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_VOLTAGE_LINE)
              {
                int max_row = 3;

                if(--current_ekran.index_position < 0) current_ekran.index_position = max_row - 1;
                if(current_ekran.index_position < 0) 
                {
                  //Цього не малоб ніколи бути - це просто перестраховка
                  current_ekran.index_position = 0;
                }
                position_in_current_level_menu[EKRAN_MEASURMENT_VOLTAGE_LINE] = current_ekran.index_position;
                //Формуємо екран вимірювання напруг вікна
                make_ekran_voltage_line(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_FREQUENCY)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT_FREQUENCY - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT_FREQUENCY] = current_ekran.index_position;
                //Формуємо екран вимірювання частот вікна
                make_ekran_frequency();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_ANGLE)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT_ANGLE - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT_ANGLE] = current_ekran.index_position;
                //Формуємо екран вимірювання кутів
                make_ekran_angle();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_POWER)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT_POWER - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT_POWER] = current_ekran.index_position;
                //Формуємо екран відображення вікна потужностей
                make_ekran_power(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_ENERGY)
              {
                current_ekran.index_position -= (MAX_ROW_LCD >> 1);
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EKRAN_ENERGY - 1;
                current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
                position_in_current_level_menu[EKRAN_ENERGY] = current_ekran.index_position;
                //Формуємо екран відображення вікна технічного обліку келектроенергії
                make_ekran_energy(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_RESISTANCE)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_MEASURMENT_RESISTANCE - 1;
                position_in_current_level_menu[EKRAN_MEASURMENT_RESISTANCE] = current_ekran.index_position;
                //Формуємо екран відображення опорів
                make_ekran_resistance(pervynna_vtorynna);
              }
              else if (
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_DZ        )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_MTZ       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZZ        )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZDZ       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_TZNP      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_APV       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV)||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UROV      )|| 
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZOP       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMIN      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMAX      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UP        )
                      )   
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TWO_GROUP - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран група1-...-групаN-настройки для всіх захистів де використовуються групи уставок
                make_ekran_chose_settings_protection_with_groups();
              }
              else if (
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_DZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_MTZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_TZNP)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ACHR_CHAPV)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UROV)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZOP)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMIN)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMAX)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UP)
                       )
                      )
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETPOINTS_TIMEOUTS - 1;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримкидля захистів у яких є дві групи уставок
                make_ekran_chose_setpoint_and_timeout();
              }
              else if (
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_ZDZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_APV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_APV)
                       )
                      )
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TIMEOUT - 1;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран витримки для захистів у яких є багато груп уставок
                make_ekran_chose_timeout();
              }
              else if (current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO)
              {
                //?if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_SETPOINTS_CONTROL - 1;
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_TR_WITH_SETPOINTS_CONTROL - 1;
                position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO] = current_ekran.index_position;

                //Формуємо екран уставки-настройки
                //?make_ekran_chose_setpoint_control_transformator();
                make_ekran_chose_setpoint_transformator();
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER - 1;
              
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_SWITCHER] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher();
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_RANG_SWITCH - 1;
              
                position_in_current_level_menu[EKRAN_CHOOSE_RANG_SWITCH] = current_ekran.index_position;

                //Формуємо екран БВимк./БУвімк.
                make_ekran_choose_CBOn_CBOff();
              }
              else if (
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER_H)//?(current_ekran.current_level >= EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                       //?(current_ekran.current_level < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER - 1;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher();
              }
              else if (
                       (current_ekran.current_level == (EKRAN_CHOOSE_SETTINGS_SWITCHER_H +1))//? (current_ekran.current_level >= EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                       //?(current_ekran.current_level < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER - 2;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher_L();//?make_ekran_chose_settings_switcher();
              }
              
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_RANG_SWITCH_H) &&
                       (current_ekran.current_level < (EKRAN_CHOOSE_RANG_SWITCH_H + NUMBER_OFF_ON))
                      )   
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_RANG_SWITCH - 1;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран БВимк./БУвімк.
                make_ekran_choose_CBOn_CBOff_(current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_LIST_SWITCH_L_H)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_OFF_ON - 1;
                position_in_current_level_menu[EKRAN_CHOOSE_LIST_SWITCH_L_H] = current_ekran.index_position;
              
                //Формуємо екран заголовків Блоків Увімкнення/Вимкнення
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OFF_ON);
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_VMP)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_VMP - 1;
              
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_VMP] = current_ekran.index_position;

                //Формуємо екран налаштувань вперед-назад
                make_ekran_chose_settings_vmp();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTINGS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS - 1;
                while(
                      ((current_settings.configuration & (1 << EL_BIT_CONFIGURATION)) == 0)
                      &&
                      (current_ekran.index_position == INDEX_OF_EXTENDED_LOGIC)
                    )
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS - 1;
                }
                
                position_in_current_level_menu[EKRAN_CHOSE_SETTINGS] = current_ekran.index_position;
                //Формуємо екран заголовків настроювання
                make_ekran_chose_settings();
              }
              else if (current_ekran.current_level == EKRAN_LEVEL_CHOOSE_PASSWORDS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOOSE_PASSWORDS - 1;
                position_in_current_level_menu[EKRAN_LEVEL_CHOOSE_PASSWORDS] = current_ekran.index_position;
                //Формуємо екран заголовків паролів
                make_ekran_chose_passwords();
              }
              else if (current_ekran.current_level == EKRAN_LIST_INPUTS_FOR_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_INPUTS_FOR_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_LIST_INPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків дискретних входів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_INPUT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_OUTPUTS_FOR_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків дискретних виходів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OUTPUT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_LEDS_FOR_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_LEDS_FOR_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_LIST_LEDS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків світоіндикаторів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_LED);
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UVV)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTINGS_UVV - 1;
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_UVV] = current_ekran.index_position;
                //Формуємо екран вибору настройок УВВ
                make_ekran_chose_settings_uvv();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_COMMUNICATION_PARAMETERS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_COMMUNICATION_PARAMETERS - 1;
                position_in_current_level_menu[EKRAN_CHOSE_COMMUNICATION_PARAMETERS] = current_ekran.index_position;
                //Формуємо екран вибору настройок парамеирів комунікації
                make_ekran_chose_communication_parameters();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_NAME_OF_CELL)
              {
                current_ekran.index_position -= MAX_ROW_LCD;
                if(current_ekran.index_position < 0) current_ekran.index_position = (MAX_ROW_FOR_VIEW_NAME_OF_CELL - 1) & (~(MAX_ROW_LCD - 1));
                position_in_current_level_menu[EKRAN_VIEW_NAME_OF_CELL] = current_ekran.index_position;
                //Формуємо екран відображення імені ячейки
                make_ekran_name_of_cell();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTING_RS485)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_SETTING_RS485 - 1;
                position_in_current_level_menu[EKRAN_CHOSE_SETTING_RS485] = current_ekran.index_position;
               //Формуємо екран відображення списку настройок для інтерфейсу RS-485
               make_ekran_chose_setting_rs485();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_DATA_TIME)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS - 1;
                if ((current_settings.dst & MASKA_FOR_BIT(N_BIT_TZ_DST)) == 0)
                {
                  while(
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_ON) ||
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_OFF)
                       )
                  {
                    if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS - 1;
                  }
                }

                position_in_current_level_menu[EKRAN_CHOSE_DATA_TIME] = current_ekran.index_position;
                //Формуємо екран вибору налаштувань дати і часу
                make_ekran_chose_data_time_settings();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_LIST_OF_REGISTRATORS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_LIST_OF_REGISTRATORS - 1;
                position_in_current_level_menu[EKRAN_VIEW_LIST_OF_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору реєстратора
                make_ekran_chose_registrators();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETTINGS_OF_DIGITAL_REGISTRATOR - 1;
                position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору настройок аналогового реєстратора
                make_ekran_settings_digital_registrators();
              }  
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETTINGS_OF_ANALOG_REGISTRATOR - 1;
                position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору настройок аналогового реєстратора
                make_ekran_settings_analog_registrators();
              }
              else if (current_ekran.current_level == EKRAN_EXTENDED_LIGIC)
              {
                current_ekran.index_position--;
                do
                {
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EXTENDED_LIGIC - 1;

//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_NOT) && (current_settings.number_defined_not  == 0))
//                    current_ekran.index_position--;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_XOR) && (current_settings.number_defined_xor  == 0))
//                    current_ekran.index_position--;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_OR) && (current_settings.number_defined_or  == 0))
//                    current_ekran.index_position--;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_AND) && (current_settings.number_defined_and  == 0))
//                    current_ekran.index_position--;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_TRIGGERS) && (current_settings.number_defined_dt  == 0))
//                    current_ekran.index_position--;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_FUNCTIONS) && (current_settings.number_defined_df  == 0))
//                    current_ekran.index_position--;
                }
                while (current_ekran.index_position < 0);
                
                position_in_current_level_menu[EKRAN_EXTENDED_LIGIC] = current_ekran.index_position;
                //Формуємо екран вибору налаштувань розширеної логіки
                make_ekran_extended_logic();
              }
              else if (current_ekran.current_level == EKRAN_LIST_SETTINGS_FOR_DF)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_SETTINGS_DF - 1;
                position_in_current_level_menu[EKRAN_LIST_SETTINGS_FOR_DF] = current_ekran.index_position;
                //Формуємо екран відображення списку настройок для опреділювальних функцій
                make_ekran_chose_settings_df();
              }
              else if ((current_ekran.current_level == EKRAN_LIST_DF_FOR_RANGUVANNJA) || (current_ekran.current_level == EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_DF - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків опреділювальних функцій
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DF);
              }
              else if ((current_ekran.current_level >= EKRAN_LIST_TYPE_SOURCE_DF1) && (current_ekran.current_level <= EKRAN_LIST_TYPE_SOURCE_DF16))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_TYPE_SOURCE_DF - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків типів джерел опреділювальних функцій
                make_ekran_list_type_source_df();
              }
              else if (current_ekran.current_level == EKRAN_LIST_DT)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_DT - 1;
                position_in_current_level_menu[EKRAN_LIST_DT] = current_ekran.index_position;
                //Формуємо екран заголовків опреділювальних триґерів
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DT);
              }
              else if ((current_ekran.current_level >= EKRAN_SET_RESET_DT1) && (current_ekran.current_level <= EKRAN_SET_RESET_DT4))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_LIST_SET_RESET_DT - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків активація-деактивація опреділювальних триґерів
                make_ekran_set_reset_trigger();
              }
              else if ((current_ekran.current_level >= EKRAN_SET_DT1) && (current_ekran.current_level <= EKRAN_RESET_DT4))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_TYPE_SOURCE_DT - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків типів джерел опреділювальних триґерів
                make_ekran_list_type_source_dt();
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_AND)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_D_AND - 1;
                position_in_current_level_menu[EKRAN_LIST_D_AND] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "І"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_AND);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_OR)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_D_OR - 1;
                position_in_current_level_menu[EKRAN_LIST_D_OR] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "АБО"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OR);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_XOR)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_D_XOR - 1;
                position_in_current_level_menu[EKRAN_LIST_D_XOR] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "Викл.АБО"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_XOR);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_NOT)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_D_NOT - 1;
                position_in_current_level_menu[EKRAN_LIST_D_NOT] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "НЕ"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_NOT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_TF_FOR_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_FOR_LIST_TF - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків передавальних функцій
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_TF);
              }
              else if (current_ekran.current_level == EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position =  MAX_ROW_LIST_BUTTONS_FOR_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків функціональних кнопок для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DB);
              }
              else if(current_ekran.current_level == EKRAN_INFO)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_INFO - 1;
                position_in_current_level_menu[EKRAN_INFO] = current_ekran.index_position;
                //Формуємо екран інформації
                make_ekran_info();
              }
              else if(current_ekran.current_level == EKRAN_DATE_TIME_PZ)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_DATE_TIME_PZ - 1;
                position_in_current_level_menu[EKRAN_DATE_TIME_PZ] = current_ekran.index_position;
                //Формуємо екран відображення міти дати і часу прошивки
                make_ekran_date_time_pz();
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_SETTINGS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_POINT_TIME_SETTINGS - 1;
                position_in_current_level_menu[EKRAN_POINT_TIME_SETTINGS] = current_ekran.index_position;
                //Формуємо екран вибору міток настроювання
                make_ekran_chose_item_of_point_time_settings();
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_SETPOINT)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_POINT_TIME_SETPOINT] = current_ekran.index_position;
                //Формуємо екран відображення міти останніх змін у уставках-витримках-управлінчькій інформації
                make_ekran_time_settings(0);
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_RANGUVANNJA)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA - 1;
                position_in_current_level_menu[EKRAN_POINT_TIME_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран відображення міти останніх змін у ранжування
                make_ekran_time_settings(1);
              }
              else if(current_ekran.current_level == EKRAN_DIAGNOSTYKA)
              {
                unsigned int diagnostyka_tmp[N_DIAGN];
                for (size_t i = 0; i < N_DIAGN; i++) diagnostyka_tmp[i] = diagnostyka[i];
              
                unsigned int not_null = false;
                for (size_t i = 0; i < N_DIAGN; i++) 
                {
                  not_null |= (diagnostyka_tmp[i] != 0);
                  if (not_null) break;
                }
              
                if (not_null)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_DIAGNOSTYKA - 1;
                  while (_CHECK_SET_BIT(diagnostyka_tmp, current_ekran.index_position) ==0)
                  {
                    current_ekran.index_position--;
                    if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_DIAGNOSTYKA - 1;
                  }
                }
                else
                {
                  current_ekran.index_position = 0;
                }

                position_in_current_level_menu[EKRAN_DIAGNOSTYKA] = current_ekran.index_position;
                //Формуємо екран діагностики
                make_ekran_diagnostyka(diagnostyka_tmp);
              }
              else if(current_ekran.current_level == EKRAN_LIST_INPUTS_OUTPUTS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_LIST_INPUTS_OUTPUTS - 1;
                position_in_current_level_menu[EKRAN_LIST_INPUTS_OUTPUTS] = current_ekran.index_position;
                //Формуємо екран вибору станів входів-виходів
                make_ekran_list_inputs_outputs();
              }
              else if ((current_ekran.current_level == EKRAN_STATE_INPUTS) || (current_ekran.current_level == EKRAN_STATE_OUTPUTS))
              {
                if (current_ekran.current_level == EKRAN_STATE_INPUTS)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_INPUTS - 1;
                }
                else
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_SIMPLE_OUTPUTS
#ifdef NUMBER_DS
                                                                                        + ((current_settings.configuration & (1 << DS_BIT_CONFIGURATION)) != 0)*NUMBER_DS
#endif
                    - 1;
                }
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран станів входів або виходыв 
                make_ekran_state_inputs_or_outputs(current_ekran.current_level - EKRAN_STATE_INPUTS);
              }
              else if(current_ekran.current_level == EKRAN_LIST_REGISTRATORS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_LIST_REGISTRATORS - 1;
                position_in_current_level_menu[EKRAN_LIST_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору реєстраторів
                make_ekran_list_registrators();
              }
              else if (
                       (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS ) ||
                       (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS) ||
                       (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
                      )
              {
                unsigned int number_records = 0;
                unsigned int type_registrator = 0;
  
                if (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS)
                {
                  unsigned int first_number = (info_rejestrator_ar.first_number < 0) ? 0 : (info_rejestrator_ar.first_number + 1);
                  unsigned int last_number  = (info_rejestrator_ar.last_number  < 0) ? 0 : (info_rejestrator_ar.last_number + 1);
                
                  if (first_number == 0) number_records = 0;
                  else if (first_number >= last_number) number_records = first_number - last_number + 1;
                  else number_records = NUMBER_FATFS_NAME - last_number + first_number + 1;

                  type_registrator = INDEX_ML_ANALOG_REGISTRATOR_INFO;
                }
                else if (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS)
                {
                  number_records = info_rejestrator_dr.number_records;
                  type_registrator = INDEX_ML_DIGITAL_REGISTRATOR_INFO;
                }
                else if (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
                {
                  number_records = info_rejestrator_pr_err.number_records;
                  type_registrator = INDEX_ML_PROGRAM_ERROE_REGISTRATOR_INFO;
                }
                else
                {
                  total_error_sw_fixed();
                }
                
                --current_ekran.index_position;
                if((current_ekran.index_position < 0) || (current_ekran.index_position >= ((int)number_records))) 
                {
                  if (number_records == 0) current_ekran.index_position = 0;
                  else current_ekran.index_position = number_records - 1;
                }
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран відображення записів
                if (type_registrator == INDEX_ML_ANALOG_REGISTRATOR_INFO) _SET_STATE(FATFS_command, FATFS_READ_DATA_FOR_MENU);
                else make_ekran_list_records_registrator(type_registrator);
              }
              else if (current_ekran.current_level == EKRAN_TITLES_DIGITAL_REGISTRATOR)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TITLES_DIGITAL_REGISTRATOR - 1;
                position_in_current_level_menu[EKRAN_TITLES_DIGITAL_REGISTRATOR] = current_ekran.index_position;
                //Формуємо екран відображення заголовків груп для дискретного реєстратора
                make_ekran_list_titles_for_record_of_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_CHANGES_SIGNALS_DR)
              {
                current_ekran.index_position -= (MAX_ROW_LCD >> 1);
                //Формуємо екран відображення змін сигналів - записаних у дискретному реєстраторі
                make_ekran_changing_signals_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_TITLE_MAX_VALUES)
              {
                unsigned int number_records = buffer_for_manu_read_record[FIRST_INDEX_NUMBER_MAX_PHASE_O_DR + type_view_max_values_dr - IDENTIFIER_BIT_ARRAY_MAX_CURRENT_PHASE_O];

                if(--current_ekran.index_position < 0) current_ekran.index_position = number_records -1;
                position_in_current_level_menu[EKRAN_TITLE_MAX_VALUES] = current_ekran.index_position;

                //Формуємо екран відображення міток часу записів міксації максимальних струмів
                make_ekran_title_analog_value_records_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_MAX_VALUES)
              {
                current_ekran.index_position--;
                do
                { 
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR - 1;

                  while (
                         (type_view_max_values_dr != IDENTIFIER_BIT_ARRAY_MIN_R_O) && 
                         (current_ekran.index_position == (MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR - 1))  
                        )   
                    current_ekran.index_position--;
                }
                while (current_ekran.index_position < 0);
                
                //Формуємо екран відображення аналогових значень з запису дискретного реєстратора
                make_ekran_analog_value_records_digital_registrator(pervynna_vtorynna);
              }
              else if (current_ekran.current_level == EKRAN_CHANGES_DIAGNOSTICS_PR_ERR)
              {
                current_ekran.index_position--;
                //Формуємо екран відображення змін діагностик - записаних у реєстраторі програмних подій
                make_ekran_changing_diagnostics_pr_err_registrator();
              }
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(current_ekran.current_level == EKRAN_MEASURMENT)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT] = current_ekran.index_position;
                //Формуємо екран списку вимірювань вікна
                make_ekran_measurement();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_CURRENT)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_CURRENT) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_CURRENT] = current_ekran.index_position;
                //Формуємо екран вимірювання струмів вікна
                make_ekran_current(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_VOLTAGE_LINE)
              {
                int max_row = 3;

                if(++current_ekran.index_position >= max_row) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_VOLTAGE_LINE] = current_ekran.index_position;
                //Формуємо екран вимірювання напруг вікна
                make_ekran_voltage_line(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_FREQUENCY)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_FREQUENCY) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_FREQUENCY] = current_ekran.index_position;
                //Формуємо екран вимірювання частот вікна
                make_ekran_frequency();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_ANGLE)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_ANGLE) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_ANGLE] = current_ekran.index_position;
                //Формуємо екран вимірювання кутів
                make_ekran_angle();
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_POWER)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_POWER) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_POWER] = current_ekran.index_position;
                //Формуємо екран відображення вікна потужностей
                make_ekran_power(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_ENERGY)
              {
                current_ekran.index_position += (MAX_ROW_LCD >> 1);
                if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ENERGY) current_ekran.index_position =  0;
                current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
                position_in_current_level_menu[EKRAN_ENERGY] = current_ekran.index_position;
                //Формуємо екран відображення вікна технічного обліку келектроенергії
                make_ekran_energy(pervynna_vtorynna);
              }
              else if(current_ekran.current_level == EKRAN_MEASURMENT_RESISTANCE)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_MEASURMENT_RESISTANCE) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_MEASURMENT_RESISTANCE] = current_ekran.index_position;
                //Формуємо екран відображення опорів
                make_ekran_resistance(pervynna_vtorynna);
              }
              else if (
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_DZ        )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_MTZ       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZDZ       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZZ        )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_TZNP      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_APV       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ACHR_CHAPV)||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UROV      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_ZOP       )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMIN      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UMAX      )||
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UP        )
                      )   
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TWO_GROUP) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран група1-...-групаN-настройки для всіх захистів де використовуються групи уставок
                make_ekran_chose_settings_protection_with_groups();
              }
              else if (
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_DZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_DZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_MTZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_MTZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_TZNP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_TZNP)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ACHR_CHAPV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ACHR_CHAPV)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UROV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UROV)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_ZOP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_ZOP)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMIN) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMIN)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UMAX) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UMAX)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP1_UP) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_SETPOINT_TIMEOUT_GROUP4_UP)
                       )
                      )
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETPOINTS_TIMEOUTS) current_ekran.index_position = 0;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримкидля захистів у яких є дві групи уставок
                make_ekran_chose_setpoint_and_timeout();
              }
              else if (
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_ZDZ) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_ZDZ)
                       )
                       ||  
                       (
                        (current_ekran.current_level >= EKRAN_CHOOSE_TIMEOUT_GROUP1_APV) &&
                        (current_ekran.current_level <= EKRAN_CHOOSE_TIMEOUT_GROUP4_APV)
                       )
                      )
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_TIMEOUT) current_ekran.index_position = 0;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран витримки для захистів у яких є багато груп уставок
                make_ekran_chose_timeout();
              }
              else if (current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO)
              {
                //?if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_PROTECTION_WITH_SETPOINTS_CONTROL) current_ekran.index_position = 0;
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_TR_WITH_SETPOINTS_CONTROL) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO] = current_ekran.index_position;

                //Формуємо екран уставки-настройки
                //?make_ekran_chose_setpoint_control_transformator();
                make_ekran_chose_setpoint_transformator();
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER) current_ekran.index_position = 0;
              
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_SWITCHER] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher();
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_RANG_SWITCH)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_RANG_SWITCH) current_ekran.index_position = 0;
              
                position_in_current_level_menu[EKRAN_CHOOSE_RANG_SWITCH] = current_ekran.index_position;

                //Формуємо екран БВимк./БУвімк.
                make_ekran_choose_CBOn_CBOff();
              }
              else if (
                       (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_SWITCHER_H)//?(current_ekran.current_level >=  EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                       //?(current_ekran.current_level  < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER) current_ekran.index_position = 0;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher();
              }
              else if (
                       (current_ekran.current_level == (EKRAN_CHOOSE_SETTINGS_SWITCHER_H +1))//?(current_ekran.current_level >=  EKRAN_CHOOSE_SETTINGS_SWITCHER_H) &&
                       //?(current_ekran.current_level  < (EKRAN_CHOOSE_SETTINGS_SWITCHER_H + NUMBER_OFF_ON))
                      )   
              {
                if(++current_ekran.index_position >= (MAX_ROW_FOR_CHOSE_SETTINGS_SWITCHER-1)) current_ekran.index_position = 0;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран уставки-витримки-настройки-ранжування вимикача
                make_ekran_chose_settings_switcher_L();
              }
              else if (
                       (current_ekran.current_level >= EKRAN_CHOOSE_RANG_SWITCH_H) &&
                       (current_ekran.current_level < (EKRAN_CHOOSE_RANG_SWITCH_H + NUMBER_OFF_ON))
                      )   
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_RANG_SWITCH) current_ekran.index_position = 0;
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                //Формуємо екран БВимк./БУвімк.
                make_ekran_choose_CBOn_CBOff_(current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
              }
              //?else if (
              //?         (current_ekran.current_level >= EKRAN_CHOOSE_RANG_SWITCH_H) &&
              //?         (current_ekran.current_level < (EKRAN_CHOOSE_RANG_SWITCH_H + NUMBER_OFF_ON))
              //?        )   
              //?{
              //?  if(++current_ekran.index_position >= MAX_ROW_FOR_RANG_SWITCH) current_ekran.index_position = 0;
              //?
              //?  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //?
              //?  //Формуємо екран БВимк./БУвімк.
              //?  make_ekran_choose_CBOn_CBOff_(current_ekran.current_level - EKRAN_CHOOSE_RANG_SWITCH_H);
              //?}
              else if (current_ekran.current_level == EKRAN_CHOOSE_LIST_SWITCH_L_H)
              {
                if(++current_ekran.index_position >= NUMBER_OFF_ON) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOOSE_LIST_SWITCH_L_H] = current_ekran.index_position;
              
                //Формуємо екран заголовків Блоків Увімкнення/Вимкнення
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OFF_ON);
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_VMP)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_VMP) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_VMP] = current_ekran.index_position;
            
                //Формуємо екран налаштувань вперед-назад
                make_ekran_chose_settings_vmp();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTINGS)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS) current_ekran.index_position = 0;
                while(
                      ((current_settings.configuration & (1 << EL_BIT_CONFIGURATION)) == 0)
                      &&
                      (current_ekran.index_position == INDEX_OF_EXTENDED_LOGIC)
                    )
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS) current_ekran.index_position = 0;
                }
                
                position_in_current_level_menu[EKRAN_CHOSE_SETTINGS] = current_ekran.index_position;
            
                //Формуємо екран заголовків настроювання
                make_ekran_chose_settings();
              }
              else if (current_ekran.current_level == EKRAN_LEVEL_CHOOSE_PASSWORDS)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOOSE_PASSWORDS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LEVEL_CHOOSE_PASSWORDS] = current_ekran.index_position;
            
                //Формуємо екран заголовків паролів
                make_ekran_chose_passwords();
              }
              else if (current_ekran.current_level == EKRAN_LIST_INPUTS_FOR_RANGUVANNJA)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_LIST_INPUTS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_INPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків дискретних входів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_INPUT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_LIST_OUTPUTS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_OUTPUTS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків дискретних виходів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OUTPUT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_LEDS_FOR_RANGUVANNJA)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_LIST_LEDS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_LEDS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків світоіндикаторів для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_LED);
              }
              else if (current_ekran.current_level == EKRAN_CHOOSE_SETTINGS_UVV)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTINGS_UVV) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOOSE_SETTINGS_UVV] = current_ekran.index_position;
                //Формуємо екран вибору настройок УВВ
                make_ekran_chose_settings_uvv();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_COMMUNICATION_PARAMETERS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_COMMUNICATION_PARAMETERS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOSE_COMMUNICATION_PARAMETERS] = current_ekran.index_position;
                //Формуємо екран вибору настройок парамеирів комунікації
                make_ekran_chose_communication_parameters();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_NAME_OF_CELL)
              {
                current_ekran.index_position += MAX_ROW_LCD;
                if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_NAME_OF_CELL) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_VIEW_NAME_OF_CELL] = current_ekran.index_position;
                //Формуємо екран відображення імені ячейки
                make_ekran_name_of_cell();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_SETTING_RS485)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_SETTING_RS485) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOSE_SETTING_RS485] = current_ekran.index_position;
               //Формуємо екран відображення списку настройок для інтерфейсу RS-485
                make_ekran_chose_setting_rs485();
              }
              else if (current_ekran.current_level == EKRAN_CHOSE_DATA_TIME)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS) current_ekran.index_position = 0;
                if ((current_settings.dst & MASKA_FOR_BIT(N_BIT_TZ_DST)) == 0)
                {
                  while(
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_ON) ||
                        (current_ekran.index_position == INDEX_ML_CHDT_DST_OFF)
                       )
                  {
                    if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_DATA_TIME_SETTINGS) current_ekran.index_position = 0;
                  }
                }

                position_in_current_level_menu[EKRAN_CHOSE_DATA_TIME] = current_ekran.index_position;
                //Формуємо екран вибору налаштувань дати і часу
                make_ekran_chose_data_time_settings();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_LIST_OF_REGISTRATORS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_OF_REGISTRATORS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_VIEW_LIST_OF_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору реєстратора
                make_ekran_chose_registrators();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_SETTINGS_OF_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_DIGITAL_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору настройок аналогового реєстратора
                make_ekran_settings_digital_registrators();
              }
              else if (current_ekran.current_level == EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_SETTINGS_OF_ANALOG_REGISTRATOR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_VIEW_SETTINGS_OF_ANALOG_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору настройок аналогового реєстратора
                make_ekran_settings_analog_registrators();
              }
              else if (current_ekran.current_level == EKRAN_EXTENDED_LIGIC)
              {
                current_ekran.index_position++;
                do
                {
                  if(current_ekran.index_position >= MAX_ROW_FOR_EXTENDED_LIGIC) current_ekran.index_position = 0;
                
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_FUNCTIONS) && (current_settings.number_defined_df == 0))
//                    current_ekran.index_position++;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_TRIGGERS) && (current_settings.number_defined_dt == 0))
//                    current_ekran.index_position++;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_AND) && (current_settings.number_defined_and == 0))
//                    current_ekran.index_position++;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_OR) && (current_settings.number_defined_or == 0))
//                    current_ekran.index_position++;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_XOR) && (current_settings.number_defined_xor == 0))
//                    current_ekran.index_position++;
//                  if ((current_ekran.index_position == INDEX_OF_DEFINED_NOT) && (current_settings.number_defined_not == 0))
//                    current_ekran.index_position++;
                }
                while (current_ekran.index_position >= MAX_ROW_FOR_EXTENDED_LIGIC);
              
                position_in_current_level_menu[EKRAN_EXTENDED_LIGIC] = current_ekran.index_position;
                //Формуємо екран вибору налаштувань розширеної логіки
                make_ekran_extended_logic();
              }
              else if (current_ekran.current_level == EKRAN_LIST_SETTINGS_FOR_DF)
              {
                if(++current_ekran.index_position >= MAX_ROW_SETTINGS_DF) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_SETTINGS_FOR_DF] = current_ekran.index_position;
                //Формуємо екран відображення списку настройок для опреділювальних функцій
                make_ekran_chose_settings_df();
              }
              else if ((current_ekran.current_level == EKRAN_LIST_DF_FOR_RANGUVANNJA) || (current_ekran.current_level == EKRAN_LIST_DF_FOR_TIMEOUT_SETTINGS))
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_DF) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків опреділювальних функцій
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DF);
              }
              else if ((current_ekran.current_level >= EKRAN_LIST_TYPE_SOURCE_DF1) && (current_ekran.current_level <= EKRAN_LIST_TYPE_SOURCE_DF16))
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_LIST_TYPE_SOURCE_DF) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків типів джерел опреділювальних функцій
                make_ekran_list_type_source_df();
              }
              else if (current_ekran.current_level == EKRAN_LIST_DT)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_DT) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_DT] = current_ekran.index_position;
                //Формуємо екран заголовків опреділювальних триґерів
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DT);
              }
              else if ((current_ekran.current_level >= EKRAN_SET_RESET_DT1) && (current_ekran.current_level <= EKRAN_SET_RESET_DT4))
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_SET_RESET_DT) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків активація-деактивація опреділювальних триґерів
                make_ekran_set_reset_trigger();
              }
              else if ((current_ekran.current_level >= EKRAN_SET_DT1) && (current_ekran.current_level <= EKRAN_RESET_DT4))
              {
                if(++current_ekran.index_position >= MAX_ROW_LIST_TYPE_SOURCE_DT) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків типів джерел опреділювальних триґерів
                make_ekran_list_type_source_dt();
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_AND)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_D_AND) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_D_AND] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "І"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_AND);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_OR)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_D_OR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_D_OR] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "АБО"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_OR);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_XOR)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_D_XOR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_D_XOR] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "Викл.АБО"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_XOR);
              }
              else if (current_ekran.current_level == EKRAN_LIST_D_NOT)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_D_NOT) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_D_NOT] = current_ekran.index_position;
                //Формуємо екран заголовків визначуваних "НЕ"
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_NOT);
              }
              else if (current_ekran.current_level == EKRAN_LIST_TF_FOR_RANGUVANNJA)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_TF) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран заголовків передавальних функцій
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_TF);
              }
              else if (current_ekran.current_level == EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA)
              {
                //Натиснута кнопка DOWN
                if(++current_ekran.index_position >= MAX_ROW_LIST_BUTTONS_FOR_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_BUTTONS_FOR_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран заголовків функціональних кнопок для ранжування
                make_ekran_chose_of_inputs_outputs_leds_df_buttons_for_ranguvannja(ID_DB);
              }
              else if(current_ekran.current_level == EKRAN_INFO)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_INFO) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_INFO] = current_ekran.index_position;
                //Формуємо екран інформації
                make_ekran_info();
              }
              else if(current_ekran.current_level == EKRAN_DATE_TIME_PZ)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_DATE_TIME_PZ) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_DATE_TIME_PZ] = current_ekran.index_position;
                //Формуємо екран відображення міти дати і часу прошивки
                make_ekran_date_time_pz();
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_SETTINGS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETTINGS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_POINT_TIME_SETTINGS] = current_ekran.index_position;
                //Формуємо екран вибору міток настроювання
                make_ekran_chose_item_of_point_time_settings();
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_SETPOINT)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_POINT_TIME_SETPOINT] = current_ekran.index_position;
                //Формуємо екран відображення міти останніх змін у уставках-витримках-управлінчькій інформації
                make_ekran_time_settings(0);
              }
              else if(current_ekran.current_level == EKRAN_POINT_TIME_RANGUVANNJA)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_POINT_TIME_SETPOINT_RANGUVANNJA) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_POINT_TIME_RANGUVANNJA] = current_ekran.index_position;
                //Формуємо екран відображення міти останніх змін у ронжуваннях
                make_ekran_time_settings(1);
              }
              else if(current_ekran.current_level == EKRAN_DIAGNOSTYKA)
              {
                unsigned int diagnostyka_tmp[N_DIAGN];
                for (size_t i = 0; i < N_DIAGN; i++) diagnostyka_tmp[i] = diagnostyka[i];
              
                unsigned int not_null = false;
                for (size_t i = 0; i < N_DIAGN; i++) 
                {
                  not_null |= (diagnostyka_tmp[i] != 0);
                  if (not_null) break;
                }
              
                if (not_null)
                {
                  if(++current_ekran.index_position >= ((int)MAX_ROW_FOR_DIAGNOSTYKA)) current_ekran.index_position = 0;
                  while (_CHECK_SET_BIT(diagnostyka_tmp, current_ekran.index_position) ==0)
                  {
                    current_ekran.index_position++;
                    if(current_ekran.index_position >= ((int)MAX_ROW_FOR_DIAGNOSTYKA)) current_ekran.index_position = 0;
                  }
                }
                else
                {
                  current_ekran.index_position = 0;
                }

                position_in_current_level_menu[EKRAN_DIAGNOSTYKA] = current_ekran.index_position;
                //Формуємо екран діагностики
                make_ekran_diagnostyka(diagnostyka_tmp);
              }
              else if(current_ekran.current_level == EKRAN_LIST_INPUTS_OUTPUTS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_INPUTS_OUTPUTS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_INPUTS_OUTPUTS] = current_ekran.index_position;
                //Формуємо екран вибору станів входів-виходів
                make_ekran_list_inputs_outputs();
              }
              else if ((current_ekran.current_level == EKRAN_STATE_INPUTS) || (current_ekran.current_level == EKRAN_STATE_OUTPUTS))
              {
                if (current_ekran.current_level == EKRAN_STATE_INPUTS)
                {
                  if(++current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
                }
                else
                {
                  if(++current_ekran.index_position >= (NUMBER_SIMPLE_OUTPUTS
#ifdef NUMBER_DS
                                                       + ((current_settings.configuration & (1 << DS_BIT_CONFIGURATION)) != 0)*NUMBER_DS
#endif
                                                       )) current_ekran.index_position = 0;
                }
              
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран станів входів або виходыв 
                make_ekran_state_inputs_or_outputs(current_ekran.current_level - EKRAN_STATE_INPUTS);
              }
              else if(current_ekran.current_level == EKRAN_LIST_REGISTRATORS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_LIST_REGISTRATORS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_REGISTRATORS] = current_ekran.index_position;
                //Формуємо екран вибору реєстраторів
                make_ekran_list_registrators();
              }
              else if (
                       (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS) ||
                       (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS) ||
                       (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
                      )
              {
                unsigned int number_records = 0;
                unsigned int type_registrator = 0;
  
                if (current_ekran.current_level == EKRAN_LIST_ANALOG_REGISTRATOR_RECORDS)
                {
                  unsigned int first_number = (info_rejestrator_ar.first_number < 0) ? 0 : (info_rejestrator_ar.first_number + 1);
                  unsigned int last_number  = (info_rejestrator_ar.last_number  < 0) ? 0 : (info_rejestrator_ar.last_number + 1);
                
                  if (first_number == 0) number_records = 0;
                  else if (first_number >= last_number) number_records = first_number - last_number + 1;
                  else number_records = NUMBER_FATFS_NAME - last_number + first_number + 1;
                
                  type_registrator = INDEX_ML_ANALOG_REGISTRATOR_INFO;
                }
                else if (current_ekran.current_level == EKRAN_LIST_DIGITAL_REGISTRATOR_RECORDS)
                {
                  number_records = info_rejestrator_dr.number_records;
                  type_registrator = INDEX_ML_DIGITAL_REGISTRATOR_INFO;
                }
                else if (current_ekran.current_level == EKRAN_LIST_REGISTRATOR_PROGRAM_ERROR_RECORDS)
                {
                  number_records = info_rejestrator_pr_err.number_records;
                  type_registrator = INDEX_ML_PROGRAM_ERROE_REGISTRATOR_INFO;
                }
                else
                {
                  total_error_sw_fixed();
                }
                
                if(++current_ekran.index_position >= ((int)number_records)) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран відображення записів
                make_ekran_list_records_registrator(type_registrator);
              }
              else if (current_ekran.current_level == EKRAN_TITLES_DIGITAL_REGISTRATOR)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_TITLES_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TITLES_DIGITAL_REGISTRATOR] = current_ekran.index_position;
                //Формуємо екран відображення заголовків груп для дискретного реєстратора
                make_ekran_list_titles_for_record_of_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_CHANGES_SIGNALS_DR)
              {
                current_ekran.index_position += (MAX_ROW_LCD >> 1);
                //Формуємо екран відображення змін сигналів - записаних у дискретному реєстраторі
                make_ekran_changing_signals_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_TITLE_MAX_VALUES)
              {
                unsigned int number_records = buffer_for_manu_read_record[FIRST_INDEX_NUMBER_MAX_PHASE_O_DR + type_view_max_values_dr - IDENTIFIER_BIT_ARRAY_MAX_CURRENT_PHASE_O];

                if(++current_ekran.index_position >= ((int)number_records)) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TITLE_MAX_VALUES] = current_ekran.index_position;

                //Формуємо екран відображення міток часу записів міксації максимальних струмів
                make_ekran_title_analog_value_records_digital_registrator();
              }
              else if (current_ekran.current_level == EKRAN_MAX_VALUES)
              {
                current_ekran.index_position++;
                do
                {
                  if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR) current_ekran.index_position = 0;
                
                  while (
                         (type_view_max_values_dr != IDENTIFIER_BIT_ARRAY_MIN_R_O) && 
                         (current_ekran.index_position == (MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR - 1))  
                        )   
                    current_ekran.index_position++;
                }
                while (current_ekran.index_position >= MAX_ROW_FOR_EKRAN_ANALOG_VALUES_DR);

                //Формуємо екран відображення аналогових значень з запису дискретного реєстратора
                make_ekran_analog_value_records_digital_registrator(pervynna_vtorynna);
              }
              else if (current_ekran.current_level == EKRAN_CHANGES_DIAGNOSTICS_PR_ERR)
              {
                current_ekran.index_position++;
                //Формуємо екран відображення змін діагностик - записаних у реєстраторі програмних подій
                make_ekran_changing_diagnostics_pr_err_registrator();
              }
            
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/****************************************************************************************************************************************/ 

/******************************************************************************************************************************************/      
    case EKRAN_SETPOINT_DZ_GROUP1:
    case EKRAN_SETPOINT_DZ_GROUP2:
    case EKRAN_SETPOINT_DZ_GROUP3:
    case EKRAN_SETPOINT_DZ_GROUP4:
    case EKRAN_TIMEOUT_DZ_GROUP1:
    case EKRAN_TIMEOUT_DZ_GROUP2:
    case EKRAN_TIMEOUT_DZ_GROUP3:
    case EKRAN_TIMEOUT_DZ_GROUP4:
    case EKRAN_CONTROL_DZ:
    case EKRAN_SETPOINT_MTZ_GROUP1:
    case EKRAN_SETPOINT_MTZ_GROUP2:
    case EKRAN_SETPOINT_MTZ_GROUP3:
    case EKRAN_SETPOINT_MTZ_GROUP4:
    case EKRAN_TIMEOUT_MTZ_GROUP1:
    case EKRAN_TIMEOUT_MTZ_GROUP2:
    case EKRAN_TIMEOUT_MTZ_GROUP3:
    case EKRAN_TIMEOUT_MTZ_GROUP4:
    case EKRAN_CONTROL_MTZ:
    case EKRAN_TIMEOUT_ZDZ_GROUP1:
    case EKRAN_TIMEOUT_ZDZ_GROUP2:
    case EKRAN_TIMEOUT_ZDZ_GROUP3:
    case EKRAN_TIMEOUT_ZDZ_GROUP4:
    case EKRAN_CONTROL_ZDZ:
    case EKRAN_SETPOINT_ZZ_GROUP1:
    case EKRAN_SETPOINT_ZZ_GROUP2:
    case EKRAN_SETPOINT_ZZ_GROUP3:
    case EKRAN_SETPOINT_ZZ_GROUP4:
    case EKRAN_TIMEOUT_ZZ_GROUP1:
    case EKRAN_TIMEOUT_ZZ_GROUP2:
    case EKRAN_TIMEOUT_ZZ_GROUP3:
    case EKRAN_TIMEOUT_ZZ_GROUP4:
    case EKRAN_CONTROL_ZZ:
    case EKRAN_SETPOINT_TZNP_GROUP1:
    case EKRAN_SETPOINT_TZNP_GROUP2:
    case EKRAN_SETPOINT_TZNP_GROUP3:
    case EKRAN_SETPOINT_TZNP_GROUP4:
    case EKRAN_TIMEOUT_TZNP_GROUP1:
    case EKRAN_TIMEOUT_TZNP_GROUP2:
    case EKRAN_TIMEOUT_TZNP_GROUP3:
    case EKRAN_TIMEOUT_TZNP_GROUP4:
    case EKRAN_CONTROL_TZNP:
    case EKRAN_TIMEOUT_APV_GROUP1:
    case EKRAN_TIMEOUT_APV_GROUP2:
    case EKRAN_TIMEOUT_APV_GROUP3:
    case EKRAN_TIMEOUT_APV_GROUP4:
    case EKRAN_CONTROL_APV:
    case EKRAN_SETPOINT_ACHR_CHAPV_GROUP1:
    case EKRAN_SETPOINT_ACHR_CHAPV_GROUP2:
    case EKRAN_SETPOINT_ACHR_CHAPV_GROUP3:
    case EKRAN_SETPOINT_ACHR_CHAPV_GROUP4:
    case EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1:
    case EKRAN_TIMEOUT_ACHR_CHAPV_GROUP2:
    case EKRAN_TIMEOUT_ACHR_CHAPV_GROUP3:
    case EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4:
    case EKRAN_CONTROL_ACHR_CHAPV:
    case EKRAN_SETPOINT_UROV_GROUP1:
    case EKRAN_SETPOINT_UROV_GROUP2:
    case EKRAN_SETPOINT_UROV_GROUP3:
    case EKRAN_SETPOINT_UROV_GROUP4:
    case EKRAN_TIMEOUT_UROV_GROUP1:
    case EKRAN_TIMEOUT_UROV_GROUP2:
    case EKRAN_TIMEOUT_UROV_GROUP3:
    case EKRAN_TIMEOUT_UROV_GROUP4:
    case EKRAN_CONTROL_UROV:
    case EKRAN_SETPOINT_ZOP_GROUP1:
    case EKRAN_SETPOINT_ZOP_GROUP2:
    case EKRAN_SETPOINT_ZOP_GROUP3:
    case EKRAN_SETPOINT_ZOP_GROUP4:
    case EKRAN_TIMEOUT_ZOP_GROUP1:
    case EKRAN_TIMEOUT_ZOP_GROUP2:
    case EKRAN_TIMEOUT_ZOP_GROUP3:
    case EKRAN_TIMEOUT_ZOP_GROUP4:
    case EKRAN_CONTROL_ZOP:
    case EKRAN_SETPOINT_UMIN_GROUP1:
    case EKRAN_SETPOINT_UMIN_GROUP2:
    case EKRAN_SETPOINT_UMIN_GROUP3:
    case EKRAN_SETPOINT_UMIN_GROUP4:
    case EKRAN_TIMEOUT_UMIN_GROUP1:
    case EKRAN_TIMEOUT_UMIN_GROUP2:
    case EKRAN_TIMEOUT_UMIN_GROUP3:
    case EKRAN_TIMEOUT_UMIN_GROUP4:
    case EKRAN_CONTROL_UMIN:
    case EKRAN_SETPOINT_UMAX_GROUP1:
    case EKRAN_SETPOINT_UMAX_GROUP2:
    case EKRAN_SETPOINT_UMAX_GROUP3:
    case EKRAN_SETPOINT_UMAX_GROUP4:
    case EKRAN_TIMEOUT_UMAX_GROUP1:
    case EKRAN_TIMEOUT_UMAX_GROUP2:
    case EKRAN_TIMEOUT_UMAX_GROUP3:
    case EKRAN_TIMEOUT_UMAX_GROUP4:
    case EKRAN_CONTROL_UMAX:
    case EKRAN_SETPOINT_UP_GROUP1:
    case EKRAN_SETPOINT_UP_GROUP2:
    case EKRAN_SETPOINT_UP_GROUP3:
    case EKRAN_SETPOINT_UP_GROUP4:
    case EKRAN_TIMEOUT_UP_GROUP1:
    case EKRAN_TIMEOUT_UP_GROUP2:
    case EKRAN_TIMEOUT_UP_GROUP3:
    case EKRAN_TIMEOUT_UP_GROUP4:
    case EKRAN_CONTROL_UP:
    case EKRAN_TRANSFORMATOR_INFO_SETPOINT:
    case EKRAN_TRANSFORMATOR_INFO_CONTROL:
    case EKRAN_SETPOINT_SWITCH:
    case EKRAN_TIMEOUT_SWITCH:
    case EKRAN_CONTROL_SWITCH:
    case EKRAN_TIMEOUT_SWITCH_H:
    case EKRAN_TIMEOUT_SWITCH_L:
    case EKRAN_CONTROL_SWITCH_H:
    case EKRAN_CONTROL_SWITCH_L:
    case EKRAN_DOPUSK_DV_UVV:
    case EKRAN_TYPE_INPUT_UVV:
    case EKRAN_TYPE_INPUT_SIGNAL_UVV:
    case EKRAN_TYPE_OUTPUT_UVV:
    case EKRAN_TYPE_LED_UVV:
    case EKRAN_TYPE_BUTTON_UVV:
    case EKRAN_ADDRESS:
    case EKRAN_VIEW_SPEED_RS485:
    case EKRAN_VIEW_PARE_RS485:
    case EKRAN_VIEW_STOP_BITS_RS485:
    case EKRAN_VIEW_TIMEOUT_RS485:
    case EKRAN_TIME_ZONE:
    case EKRAN_DST_RULE:
    case EKRAN_GENERAL_PICKUPS_EL:
    case EKRAN_LIST_TYPE_DF:
    case EKRAN_TIMEOUT_DF1:
    case EKRAN_TIMEOUT_DF2:
    case EKRAN_TIMEOUT_DF3:
    case EKRAN_TIMEOUT_DF4:
    case EKRAN_TIMEOUT_DF5:
    case EKRAN_TIMEOUT_DF6:
    case EKRAN_TIMEOUT_DF7:
    case EKRAN_TIMEOUT_DF8:
    case EKRAN_TIMEOUT_DF9:
    case EKRAN_TIMEOUT_DF10:
    case EKRAN_TIMEOUT_DF11:
    case EKRAN_TIMEOUT_DF12:
    case EKRAN_TIMEOUT_DF13:
    case EKRAN_TIMEOUT_DF14:
    case EKRAN_TIMEOUT_DF15:
    case EKRAN_TIMEOUT_DF16:
    case EKRAN_TIMEOUT_ANALOG_REGISTRATOR:
    case EKRAN_TIMEOUT_DIGITAL_REGISTRATOR:
    case EKRAN_CONTROL_AR:
    case EKRAN_VIEW_SETTING_LANGUAGE:
    case EKRAN_CHOSE_EXTRA_SETTINGS:
    case EKRAN_VIEW_GRUPA_USTAVOK:
    case EKRAN_SETPOINT_VMP_FORWARD:
    case EKRAN_SETPOINT_VMP_BACKWARD:
    case EKRAN_CONTROL_VMP:
    case (EKRAN_LIST_SOURCE_TF1 + 0):
    case (EKRAN_LIST_SOURCE_TF1 + 1):
    case (EKRAN_LIST_SOURCE_TF1 + 2):
    case (EKRAN_LIST_SOURCE_TF1 + 3):
    case (EKRAN_LIST_SOURCE_TF1 + 4):
    case (EKRAN_LIST_SOURCE_TF1 + 5):
    case (EKRAN_LIST_SOURCE_TF1 + 6):
    case (EKRAN_LIST_SOURCE_TF1 + 7):
    case (EKRAN_LIST_SOURCE_TF1 + 8):
    case (EKRAN_LIST_SOURCE_TF1 + 9):
    case (EKRAN_LIST_SOURCE_TF1 + 10):
    case (EKRAN_LIST_SOURCE_TF1 + 11):
    case (EKRAN_LIST_SOURCE_TF1 + 12):
    case (EKRAN_LIST_SOURCE_TF1 + 13):
    case (EKRAN_LIST_SOURCE_TF1 + 14):
    case (EKRAN_LIST_SOURCE_TF1 + 15):
      {
        //Очищаємо всі біти краім упралінських
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        
        if (current_ekran.edition == 1)
          maska_keyboard_bits |= (1<<BIT_KEY_RIGHT) | (1<<BIT_KEY_LEFT) | (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        else if (current_ekran.edition == 0)
          maska_keyboard_bits |= (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        
        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {

            if(
               (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
               (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
              )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_MTZ) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок МТЗ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
              make_ekran_setpoint_mtz(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                   )  
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_MTZ) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок МТЗ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
              make_ekran_timeout_mtz(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZ) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_MTZ] = current_ekran.index_position;

              //Формуємо екран управлінської інформації для МТЗ
              make_ekran_control_mtz();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_DZO) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ДЗ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
              make_ekran_setpoint_dzo(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                   )  
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_DZO) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок ДЗ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
              make_ekran_timeout_dzo(group);//make_ekran_timeout_dz(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
            {
              //!if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZ) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZO) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_DZ] = current_ekran.index_position;

              //Формуємо екран управлінської інформації для МТЗ 0.4кВ
              make_ekran_control_dzo();//make_ekran_control_dz();2
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ZDZ) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок ЗДЗ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
              make_ekran_timeout_zdz(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZDZ) current_ekran.index_position = 0;
              while(
                    (
                     (
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ1_BIT) ||
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ2_BIT) ||
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ3_BIT) ||
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ4_BIT)
                     )   
                     &&
                     ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                    )
                    ||  
                    (
                     (
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN1_BIT) ||
                      (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN2_BIT)
                     )   
                     &&
                     ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                    )
                   )
              {
                current_ekran.index_position++;
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZDZ) current_ekran.index_position = 0;
              }

              position_in_current_level_menu[EKRAN_CONTROL_ZDZ] = current_ekran.index_position;
              
              //Формуємо екран управлінської інформації для ЗДЗ
              make_ekran_control_zdz();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                   )   
            {
              //!if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ZZ) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_MTZO) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ЗЗ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
              make_ekran_setpoint_mtzo(group);//make_ekran_setpoint_zz(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_MTZO) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ЗЗ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
              make_ekran_timeout_mtzo(group);//make_ekran_timeout_zz(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZO) current_ekran.index_position = 0;


              position_in_current_level_menu[EKRAN_CONTROL_ZZ] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для ЗЗ
              make_ekran_control_mtzo();//.make_ekran_control_zz();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_TZNP) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ТЗНП
              int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
              make_ekran_setpoint_mtzr(group);//make_ekran_setpoint_tznp(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_TZNP) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ТЗНП
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
              make_ekran_timeout_mtzr(group);//make_ekran_timeout_tznp(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
            {
              //?if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_TZNP) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_TZNP] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для ТЗНП
              make_ekran_control_mtzr();//.make_ekran_control_tznp();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_APV) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок АПВ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
              make_ekran_timeout_apv(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_APV)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_APV) current_ekran.index_position = 0;
              while(
                    (
                     (  
                      (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_DZ1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_AMTDZ4) 
                     )   
                    &&
                    ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                    ) 
                    ||
                    (
                     (  
                      (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_MTZ1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_MTZ4)
                     )   
                    &&
                    //!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                    ((current_settings.configuration & (1<<MCZO_BIT_CONFIGURATION)) == 0)
                    ) 
                    //!||
                    //!(
                    //! (  
                    //!  (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_TZNP1) &&
                    //!  (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_TZNP3)
                    //! )   
                    //!&&
                    //!((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0)
                    //!) 
                    ||  
                    (
                     (current_ekran.index_position == INDEX_ML_CTRAPV_BLK_CTRL_PRVV2)
                     &&
                     ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0)
                    )
                  )
              {
                current_ekran.index_position++;
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_APV) current_ekran.index_position = 0;
              }

              position_in_current_level_menu[EKRAN_CONTROL_APV] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для АПВ
              make_ekran_control_apv();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ACHR_CHAPV) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок АЧР-ЧАПВ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
              make_ekran_setpoint_achr_chapv(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ACHR_CHAPV) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок АЧР-ЧАПВ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
              make_ekran_timeout_achr_chapv(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ACHR_CHAPV) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_ACHR_CHAPV] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для АЧР-ЧАПВ
              make_ekran_control_achr_chapv();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UROV) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок УРОВ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
              make_ekran_setpoint_urov(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UROV) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок УРОВ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
              make_ekran_timeout_urov(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UROV) current_ekran.index_position = 0;
              while(
                    (
                     (  
                      (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_DZ1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_AMTDZ4) 
                     )   
                    &&
                    ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                    ) 
                    ||
                    (
                     (
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ1) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ2) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ3) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ4)
                     )   
                     &&
                     //!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                     ((current_settings.configuration & (1<<MCZO_BIT_CONFIGURATION)) == 0)
                    )  
                    ||
                    (
                     (
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ZDZ)
                     )   
                     &&
                     ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0)
                    )  
                    ||
                    (
                     (
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN1) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN2)
                     )   
                     &&
                     ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                    )  
                    ||
                    (
                     (
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX1) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX2)
                     )   
                     &&
                     ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0)
                    )  
                    ||
                    (
                     (
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR1) ||
                      (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR2)
                     )   
                     &&
                     ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0)
                    )
                    ||
                    (
                     (
                      (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_UP1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_UP1 + NUMBER_UP - 1)
                     )   
                     &&
                     ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0)
                    )
                   )
              {
                current_ekran.index_position++;
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UROV) current_ekran.index_position = 0;
              }

              position_in_current_level_menu[EKRAN_CONTROL_UROV] = current_ekran.index_position;

              //Формуємо екран управлінської інформації для УРОВ
              make_ekran_control_urov();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                   )   
            {
              //if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ZOP) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_DZR) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок ЗОП(КОФ)
              int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
               make_ekran_setpoint_dzr(group); //make_ekran_setpoint_zop(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                   )   
            {
              //if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ZOP) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_DZR) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок ЗОП(КОФ)
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
              make_ekran_timeout_dzr(group);//make_ekran_timeout_zop(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
            {
              //if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZOP) current_ekran.index_position = 0;
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_ZOP] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для ЗОП(КОФ)
              make_ekran_control_dzr();//make_ekran_control_zop();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UMIN) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок Umin
              int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
              make_ekran_setpoint_Umin(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UMIN) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок Umin
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
              make_ekran_timeout_Umin(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UMIN) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_UMIN] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для Umin
              make_ekran_control_Umin();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UMAX) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок Umax
              int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
              make_ekran_setpoint_Umax(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UMAX) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок Umax
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
              make_ekran_timeout_Umax(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UMAX) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_UMAX] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для Umax
              make_ekran_control_Umax();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_SETPOINT_UP)) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран уставок УЗ
              int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
              make_ekran_setpoint_UP_A01(group);//!?make_ekran_setpoint_UP(group);
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                    (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                   )   
            {
              if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_TIMEOUT_UP)) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

              //Формуємо екран витримок УЗ
              int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
              make_ekran_timeout_UP(group);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_UP)
            {
              //!if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_UP)) current_ekran.index_position = 0;
              //!__SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
              //!uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
              //!while (
              //!       ((current_ekran.index_position % (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)) == CTR_UP_OR_AND_BIT) &&
              //!       (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
              //!       (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
              //!       (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
              //!      )
              //!{
              //!  current_ekran.index_position++;
              //!  if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UP) current_ekran.index_position = 0;
              //!  
              //!  ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
              //!}
              if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_A01_UP)) current_ekran.index_position = 0;
              __SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
              uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
              while (
                     ((current_ekran.index_position % (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)) == (CTR_UP_OR_AND_BIT+3)) &&
                     (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
                     (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
                     (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
                    )
              {
                current_ekran.index_position++;
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_A01_UP) current_ekran.index_position = 0;
                
                ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
              }
              
              position_in_current_level_menu[EKRAN_CONTROL_UP] = current_ekran.index_position;
              
              //Формуємо екран управлінської інформації для УЗ
              make_ekran_control_UP_A01();//!make_ekran_control_UP();
            }
            else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TRANSFORMATOR_INFO_SETPOINT) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_SETPOINT] = current_ekran.index_position;
              //Формуємо екран інфтрмації по трансформаторах
              make_ekran_transformator();
            }
            else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TRANSFORMATOR_INFO_CONTROL) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_CONTROL] = current_ekran.index_position;
              //Формуємо екран відображення налаштувань для меню "Трансформатор"
              //!make_ekran_transformator_control();
            }
            else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_SWITCH) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_SETPOINT_SWITCH] = current_ekran.index_position;
              //Формуємо екран уставок виключателя
              make_ekran_setpoint_switch();
            }
            else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_SWITCH) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TIMEOUT_SWITCH] = current_ekran.index_position;
              //Формуємо екран витримок виключателя
              make_ekran_timeout_switch();
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_SWITCH) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_SWITCH] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для вимикача
              make_ekran_control_switch();
            }
            else if(
                    (current_ekran.current_level >= EKRAN_TIMEOUT_SWITCH_H) &&
                    (current_ekran.current_level  < (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                   )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_SWITCH) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран витримок виключателя
              make_ekran_timeout_switch_(current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H);
            }
            else if (
                     (current_ekran.current_level >= EKRAN_CONTROL_SWITCH_H) &&
                     (current_ekran.current_level  < (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                    )   
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_SWITCH) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для вимикача
              make_ekran_control_switch_(current_ekran.current_level - EKRAN_CONTROL_SWITCH_H);
            }
            else if(
                    (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                    (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                   )
            {
              int lines, forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
              if (current_ekran.edition == 0) lines = current_settings.lines[forward_backward];
              else lines = edition_settings.lines[forward_backward];
              
              if(current_ekran.index_position >= (1 + 2*lines)) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран уставок для ВМП
              make_ekran_setpoint_VMP(forward_backward);
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_VMP) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_VMP] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для ВМП
              make_ekran_control_VMP();
            }
            else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
            {
              if(current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_DOPUSK_DV_UVV] = current_ekran.index_position;
              //Формуємо екран інфтрмації по допусках ДВ
              make_ekran_dopusk_dv();
            }
            else if((current_ekran.current_level == EKRAN_TYPE_INPUT_UVV) || (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV))
            {
              if(current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран управлінської інформації для УВВ
              if (current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                make_ekran_type_input_uvv(0);
              else
                make_ekran_type_input_uvv(1);
            }
            else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
            {
              if(current_ekran.index_position >= NUMBER_SIMPLE_OUTPUTS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TYPE_OUTPUT_UVV] = current_ekran.index_position;
              //Формуємо екран типу виходу
              make_ekran_type_output_uvv();
            }
            else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
            {
              if(current_ekran.index_position >= NUMBER_LEDS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TYPE_LED_UVV] = current_ekran.index_position;
              //Формуємо екран типу світилоіндикаторів
              make_ekran_type_led_uvv();
            }
            else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
            {
              if(current_ekran.index_position >= NUMBER_DEFINED_BUTTONS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TYPE_BUTTON_UVV] = current_ekran.index_position;
              //Формуємо екран типу ФК
              make_ekran_type_button_uvv();
            }
            else if(current_ekran.current_level == EKRAN_ADDRESS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_ADDRESS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_ADDRESS] = current_ekran.index_position;
              //Формуємо екран інфтрмації по комунікаційній адресі
              make_ekran_address();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_SPEED_INTERFACE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_SPEED_RS485] = current_ekran.index_position;
              //Формуємо екран інформації по швидкості обміну
              make_ekran_speed_interface();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_PARE_INTERFACE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_PARE_RS485] = current_ekran.index_position;
              //Формуємо екран інформації по контролю парності
              make_ekran_pare_interface();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_STOP_BITS_INTERFACE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_STOP_BITS_RS485] = current_ekran.index_position;
              //Формуємо екран інформації по кількості стопових біт
              make_ekran_stopbits_interface();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_TIMEOUT_INTERFACE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_TIMEOUT_RS485] = current_ekran.index_position;
              //Формуємо екран інформації по time-out наступного символу
              make_ekran_timeout_interface();
            }
            else if(current_ekran.current_level == EKRAN_TIME_ZONE)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEZONE_SETTINGS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TIME_ZONE] = current_ekran.index_position;
              //Формуємо екран
              make_ekran_timezone_dst();
            }
            else if(current_ekran.current_level == EKRAN_DST_RULE)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_DST_RULE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_DST_RULE] = current_ekran.index_position;
              
              __SETTINGS *p_settings = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
              uint32_t rule = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? p_settings->dst_on_rule : p_settings->dst_off_rule;
              //Формуємо екран
              make_ekran_dst_rule(rule);
            }
            else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_GENERAL_PICKUPS_EL) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_GENERAL_PICKUPS_EL] = current_ekran.index_position;
              //Формуємо екран відображення загальних витримок для розширеної логіки
              make_ekran_general_pickups_el();
            }
            else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TYPE_DF) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_LIST_TYPE_DF] = current_ekran.index_position;
              //Формуємо екран відображення типу опреділювальної функції
              make_ekran_type_df();
            }
            else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
            {
              if(current_ekran.index_position >= MAX_ROW_TIMEOUT_DF) current_ekran.index_position = 0;
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран таймерів опреділюваних функцій
              make_ekran_timeout_df(current_ekran.current_level - EKRAN_TIMEOUT_DF1);
            }
            else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
            {
              if(current_ekran.index_position >= MAX_ROW_LIST_SOURCE_TF) current_ekran.index_position = 0;
              //Формуємо екран
              make_ekran_list_source_tf();
            }
            else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
            {
              if(current_ekran.index_position >= MAX_ROW_RANGUVANNJA_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TIMEOUT_DIGITAL_REGISTRATOR] = current_ekran.index_position;
              //Формуємо екран витримок аналогового реєстратора
              make_ekran_timeout_digital_registrator();
            }
            else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ANALOG_REGISTRATOR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_TIMEOUT_ANALOG_REGISTRATOR] = current_ekran.index_position;
              //Формуємо екран витримок аналогового реєстратора
              make_ekran_timeout_analog_registrator();
            }
            else if(current_ekran.current_level == EKRAN_CONTROL_AR)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_AR) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CONTROL_AR] = current_ekran.index_position;
              //Формуємо екран управління аналогового реєстратора
              make_ekran_control_ar();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_SETTING_LANGUAGE) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_SETTING_LANGUAGE] = current_ekran.index_position;
              //Формуємо екран інформації по мові меню
              make_ekran_setting_language();
            }
            else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_CHOSE_EXTRA_SETTINGS) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_CHOSE_EXTRA_SETTINGS] = current_ekran.index_position;
              //Формуємо екран відображення додаткових налаштувань
              make_ekran_chose_extra_settings();
            }
            else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
            {
              if(current_ekran.index_position >= MAX_ROW_FOR_VIEW_GRUPA_USTAVOK) current_ekran.index_position = 0;
              position_in_current_level_menu[EKRAN_VIEW_GRUPA_USTAVOK] = current_ekran.index_position;
              //Формуємо екран інформації по групах уставок
              make_ekran_grupa_ustavok();
            }

            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              if(current_ekran.edition == 0)
              {
                int temp_current_level = current_ekran.current_level;
                
                //Копіюємо текчі настройки у структуру для редагування
                if(
                   (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                   (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                  )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                  {
                    edition_settings.setpoint_mtz_1[group] = current_settings.setpoint_mtz_1[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                  {
                    edition_settings.setpoint_mtz_1_n_vpered[group] = current_settings.setpoint_mtz_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                  {
                    edition_settings.setpoint_mtz_1_n_nazad[group] = current_settings.setpoint_mtz_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                  {
                    edition_settings.setpoint_mtz_1_angle[group] = current_settings.setpoint_mtz_1_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtz_1_po_napruzi[group] = current_settings.setpoint_mtz_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                  {
                    edition_settings.setpoint_mtz_1_U[group] = current_settings.setpoint_mtz_1_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2)
                  {
                    edition_settings.setpoint_mtz_2[group] = current_settings.setpoint_mtz_2[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                  {
                    edition_settings.setpoint_mtz_2_n_vpered[group] = current_settings.setpoint_mtz_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                  {
                    edition_settings.setpoint_mtz_2_n_nazad[group] = current_settings.setpoint_mtz_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                  {
                    edition_settings.setpoint_mtz_2_angle[group] = current_settings.setpoint_mtz_2_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtz_2_po_napruzi[group] = current_settings.setpoint_mtz_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                  {
                    edition_settings.setpoint_mtz_2_U[group] = current_settings.setpoint_mtz_2_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3)
                  {
                    edition_settings.setpoint_mtz_3[group] = current_settings.setpoint_mtz_3[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                  {
                    edition_settings.setpoint_mtz_3_n_vpered[group] = current_settings.setpoint_mtz_3_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                  {
                    edition_settings.setpoint_mtz_3_n_nazad[group] = current_settings.setpoint_mtz_3_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                  {
                    edition_settings.setpoint_mtz_3_angle[group] = current_settings.setpoint_mtz_3_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtz_3_po_napruzi[group] = current_settings.setpoint_mtz_3_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                  {
                    edition_settings.setpoint_mtz_3_U[group] = current_settings.setpoint_mtz_3_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4)
                  {
                    edition_settings.setpoint_mtz_4[group] = current_settings.setpoint_mtz_4[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                  {
                    edition_settings.setpoint_mtz_4_n_vpered[group] = current_settings.setpoint_mtz_4_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                  {
                    edition_settings.setpoint_mtz_4_n_nazad[group] = current_settings.setpoint_mtz_4_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                  {
                    edition_settings.setpoint_mtz_4_angle[group] = current_settings.setpoint_mtz_4_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtz_4_po_napruzi[group] = current_settings.setpoint_mtz_4_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                  {
                    edition_settings.setpoint_mtz_4_U[group] = current_settings.setpoint_mtz_4_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_U_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOMTZ1)
                  {
                    edition_settings.timeout_mtz_1[group] = current_settings.timeout_mtz_1[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                  {
                    edition_settings.timeout_mtz_1_n_vpered[group] = current_settings.timeout_mtz_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                  {
                    edition_settings.timeout_mtz_1_n_nazad[group] = current_settings.timeout_mtz_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtz_1_po_napruzi[group] = current_settings.timeout_mtz_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2)
                  {
                    edition_settings.timeout_mtz_2[group] = current_settings.timeout_mtz_2[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                  {
                    edition_settings.timeout_mtz_2_pr[group] = current_settings.timeout_mtz_2_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                  {
                    edition_settings.timeout_mtz_2_n_vpered[group] = current_settings.timeout_mtz_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                  {
                    edition_settings.timeout_mtz_2_n_vpered_pr[group] = current_settings.timeout_mtz_2_n_vpered_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                  {
                    edition_settings.timeout_mtz_2_n_nazad[group] = current_settings.timeout_mtz_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                  {
                    edition_settings.timeout_mtz_2_n_nazad_pr[group] = current_settings.timeout_mtz_2_n_nazad_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtz_2_po_napruzi[group] = current_settings.timeout_mtz_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                  {
                    edition_settings.timeout_mtz_2_po_napruzi_pr[group] = current_settings.timeout_mtz_2_po_napruzi_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                  {
                    edition_settings.timeout_mtz_2_vvid_pr[group] = current_settings.timeout_mtz_2_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3)
                  {
                    edition_settings.timeout_mtz_3[group] = current_settings.timeout_mtz_3[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                  {
                    edition_settings.timeout_mtz_3_n_vpered[group] = current_settings.timeout_mtz_3_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                  {
                    edition_settings.timeout_mtz_3_n_nazad[group] = current_settings.timeout_mtz_3_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtz_3_po_napruzi[group] = current_settings.timeout_mtz_3_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4)
                  {
                    edition_settings.timeout_mtz_4[group] = current_settings.timeout_mtz_4[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                  {
                    edition_settings.timeout_mtz_4_n_vpered[group] = current_settings.timeout_mtz_4_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                  {
                    edition_settings.timeout_mtz_4_n_nazad[group] = current_settings.timeout_mtz_4_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtz_4_po_napruzi[group] = current_settings.timeout_mtz_4_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_PO_NAPRUZI_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
                {
                  edition_settings.type_mtz1 = current_settings.type_mtz1;
                  edition_settings.type_mtz2 = current_settings.type_mtz2;
                  edition_settings.type_mtz3 = current_settings.type_mtz3;
                  edition_settings.type_mtz4 = current_settings.type_mtz4;
                  edition_settings.control_mtz = current_settings.control_mtz;
                }
//+++++++++++++#include "ekran/ekran_dz_enter.ci"+++++++++++++++++++++++++
              //Натиснута кнопка ENTER
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                  /*
                  if (current_ekran.index_position == INDEX_ML_STP_K_DZ)
                  {
                    edition_settings.pickup_dz_k[group] = current_settings.pickup_dz_k[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ_K_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1)
                  {
                    edition_settings.pickup_dz1[group] = current_settings.pickup_dz1[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1_AMTZ)
                  {
                    edition_settings.pickup_dz1_amtz[group] = current_settings.pickup_dz1_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_ANGLE)
                  {
                    edition_settings.pickup_dz2_angle[group] = current_settings.pickup_dz2_angle[group];
                    current_ekran.position_cursor_x = COL_SDZ2_ANGLE;//COL_PICKUP_DZ2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_DIR)
                  {
                    edition_settings.pickup_dz2_dir[group] = current_settings.pickup_dz2_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_INV)
                  {
                    edition_settings.pickup_dz2_inv[group] = current_settings.pickup_dz2_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_AMTZ)
                  {
                    edition_settings.pickup_dz2_amtz[group] = current_settings.pickup_dz2_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_AMTZ_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_ANGLE)
                  {
                    edition_settings.pickup_dz3_angle[group] = current_settings.pickup_dz3_angle[group];
                    current_ekran.position_cursor_x = COL_SDZ3_ANGLE;//COL_PICKUP_DZ3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_DIR)
                  {
                    edition_settings.pickup_dz3_dir[group] = current_settings.pickup_dz3_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_INV)
                  {
                    edition_settings.pickup_dz3_inv[group] = current_settings.pickup_dz3_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_AMTZ)
                  {
                    edition_settings.pickup_dz3_amtz[group] = current_settings.pickup_dz3_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_AMTZ_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_ANGLE)
                  {
                    edition_settings.pickup_dz4_angle[group] = current_settings.pickup_dz4_angle[group];
                    current_ekran.position_cursor_x = COL_SDZ4_ANGLE;//COL_PICKUP_DZ4_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_DIR)
                  {
                    edition_settings.pickup_dz4_dir[group] = current_settings.pickup_dz4_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_INV)
                  {
                    edition_settings.pickup_dz4_inv[group] = current_settings.pickup_dz4_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_AMTZ)
                  {
                    edition_settings.pickup_dz4_amtz[group] = current_settings.pickup_dz4_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_AMTZ_BEGIN;
                  }*/
                    if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                  {
                    edition_settings.pickup_dzo_Io3g_Io1g[group] = current_settings.pickup_dzo_Io3g_Io1g[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO_K_ICE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1)
                  {
                    edition_settings.pickup_dzo1[group] = current_settings.pickup_dzo1[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                  {
                    edition_settings.pickup_dzo1_amtz[group] = current_settings.pickup_dzo1_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                  {
                    edition_settings.pickup_dzo1_blkI[group] = current_settings.pickup_dzo1_blkI[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_I_BLK_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                  {
                    edition_settings.pickup_dzo2_angle[group] = current_settings.pickup_dzo2_angle[group];
                    current_ekran.position_cursor_x = COL_S_DZO2_ANGLE;//COL_PICKUP_DZ2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                  {
                    edition_settings.pickup_dzo2_dir[group] = current_settings.pickup_dzo2_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                  {
                    edition_settings.pickup_dzo2_inv[group] = current_settings.pickup_dzo2_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                  {
                    edition_settings.pickup_dzo2_amtz[group] = current_settings.pickup_dzo2_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_AMTZ_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H)
                  {
                    edition_settings.pickup_dzo3_angle_h[group] = current_settings.pickup_dzo3_angle_h[group];
                    edition_settings.pickup_dzo3_angle_l[group] = current_settings.pickup_dzo3_angle_l[group];
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_H;//COL_PICKUP_DZ3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                  {
                    edition_settings.pickup_dzo3_angle_l[group] = current_settings.pickup_dzo3_angle_l[group];
                    edition_settings.pickup_dzo3_angle_h[group] = current_settings.pickup_dzo3_angle_h[group];
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_L;//COL_PICKUP_DZ3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                  {
                    edition_settings.pickup_dzo3_dir[group] = current_settings.pickup_dzo3_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                  {
                    edition_settings.pickup_dzo3_inv[group] = current_settings.pickup_dzo3_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                  {
                    edition_settings.pickup_dzo3_amtz[group] = current_settings.pickup_dzo3_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_AMTZ_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                  {
                    edition_settings.pickup_dzo4_Zo_dir[group] = current_settings.pickup_dzo4_Zo_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                  {
                    edition_settings.pickup_dzo4_Xo_dir[group] = current_settings.pickup_dzo4_Xo_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_X0_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                  {
                    edition_settings.pickup_dzo4_Zo_inv[group] = current_settings.pickup_dzo4_Zo_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                  {
                    edition_settings.pickup_dzo4_Xo_inv[group] = current_settings.pickup_dzo4_Xo_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_X0_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                  {
                    edition_settings.pickup_dzo4_amtz[group] = current_settings.pickup_dzo4_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_AMTZ_BEGIN;
                  }

                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                  /*
                  if (current_ekran.index_position == INDEX_ML_TMO_DZ1)
                  {
                    edition_settings.timeout_dz1[group] = current_settings.timeout_dz1[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                  {
                    edition_settings.timeout_dz1_amtz[group] = current_settings.timeout_dz1_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                  {
                    edition_settings.timeout_dz2_dir[group] = current_settings.timeout_dz2_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                  {
                    edition_settings.timeout_dz2_dir_pr[group] = current_settings.timeout_dz2_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                  {
                    edition_settings.timeout_dz2_inv[group] = current_settings.timeout_dz2_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                  {
                    edition_settings.timeout_dz2_inv_pr[group] = current_settings.timeout_dz2_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                  {
                    edition_settings.timeout_dz2_amtz[group] = current_settings.timeout_dz2_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                  {
                    edition_settings.timeout_dz2_amtz_pr[group] = current_settings.timeout_dz2_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                  {
                    edition_settings.timeout_dz2_vvid_pr[group] = current_settings.timeout_dz2_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dz2_amtz_vvid_pr[group] = current_settings.timeout_dz2_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_VVID_PR_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                  {
                    edition_settings.timeout_dz3_dir[group] = current_settings.timeout_dz3_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                  {
                    edition_settings.timeout_dz3_dir_pr[group] = current_settings.timeout_dz3_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                  {
                    edition_settings.timeout_dz3_inv[group] = current_settings.timeout_dz3_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                  {
                    edition_settings.timeout_dz3_inv_pr[group] = current_settings.timeout_dz3_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                  {
                    edition_settings.timeout_dz3_amtz[group] = current_settings.timeout_dz3_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                  {
                    edition_settings.timeout_dz3_amtz_pr[group] = current_settings.timeout_dz3_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                  {
                    edition_settings.timeout_dz3_vvid_pr[group] = current_settings.timeout_dz3_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dz3_amtz_vvid_pr[group] = current_settings.timeout_dz3_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                  {
                    edition_settings.timeout_dz4_dir[group] = current_settings.timeout_dz4_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                  {
                    edition_settings.timeout_dz4_dir_pr[group] = current_settings.timeout_dz4_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                  {
                    edition_settings.timeout_dz4_inv[group] = current_settings.timeout_dz4_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                  {
                    edition_settings.timeout_dz4_inv_pr[group] = current_settings.timeout_dz4_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                  {
                    edition_settings.timeout_dz4_amtz[group] = current_settings.timeout_dz4_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                  {
                    edition_settings.timeout_dz4_amtz_pr[group] = current_settings.timeout_dz4_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                  {
                    edition_settings.timeout_dz4_vvid_pr[group] = current_settings.timeout_dz4_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dz4_amtz_vvid_pr[group] = current_settings.timeout_dz4_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                  {
                    edition_settings.timeout_nkn_dz[group] = current_settings.timeout_nkn_dz[group];
                    current_ekran.position_cursor_x = COL_TMO_NKN_DZ_BEGIN;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_TMO_DZO1)
                  {
                    edition_settings.timeout_dzo1[group] = current_settings.timeout_dzo1[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                  {
                    edition_settings.timeout_dzo1_amtz[group] = current_settings.timeout_dzo1_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                  {
                    edition_settings.timeout_dzo2_dir[group] = current_settings.timeout_dzo2_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                  {
                    edition_settings.timeout_dzo2_dir_pr[group] = current_settings.timeout_dzo2_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                  {
                    edition_settings.timeout_dzo2_inv[group] = current_settings.timeout_dzo2_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                  {
                    edition_settings.timeout_dzo2_inv_pr[group] = current_settings.timeout_dzo2_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                  {
                    edition_settings.timeout_dzo2_amtz[group] = current_settings.timeout_dzo2_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                  {
                    edition_settings.timeout_dzo2_amtz_pr[group] = current_settings.timeout_dzo2_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                  {
                    edition_settings.timeout_dzo2_vvid_pr[group] = current_settings.timeout_dzo2_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dzo2_amtz_vvid_pr[group] = current_settings.timeout_dzo2_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_VVID_PR_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                  {
                    edition_settings.timeout_dzo3_dir[group] = current_settings.timeout_dzo3_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                  {
                    edition_settings.timeout_dzo3_dir_pr[group] = current_settings.timeout_dzo3_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                  {
                    edition_settings.timeout_dzo3_inv[group] = current_settings.timeout_dzo3_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                  {
                    edition_settings.timeout_dzo3_inv_pr[group] = current_settings.timeout_dzo3_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                  {
                    edition_settings.timeout_dzo3_amtz[group] = current_settings.timeout_dzo3_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                  {
                    edition_settings.timeout_dzo3_amtz_pr[group] = current_settings.timeout_dzo3_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                  {
                    edition_settings.timeout_dzo3_vvid_pr[group] = current_settings.timeout_dzo3_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dzo3_amtz_vvid_pr[group] = current_settings.timeout_dzo3_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_VVID_PR_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                  {
                    edition_settings.timeout_dzo4_dir[group] = current_settings.timeout_dzo4_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO4_DIR_BEGIN;
                  }
                  //else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                  //{
                  //  edition_settings.timeout_dz4_dir_pr[group] = current_settings.timeout_dz4_dir_pr[group];
                  //  current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_PR_BEGIN;
                  //}
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                  {
                    edition_settings.timeout_dzo4_inv[group] = current_settings.timeout_dzo4_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO4_INV_BEGIN;
                  }
                  //else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                  //{
                  //  edition_settings.timeout_dz4_inv_pr[group] = current_settings.timeout_dz4_inv_pr[group];
                  //  current_ekran.position_cursor_x = COL_TMO_DZ4_INV_PR_BEGIN;
                  //}
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                  {
                    edition_settings.timeout_dzo4_amtz[group] = current_settings.timeout_dzo4_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZO4_AMTZ_BEGIN;
                  }
                  //else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                  //{
                  //  edition_settings.timeout_dz4_amtz_pr[group] = current_settings.timeout_dz4_amtz_pr[group];
                  //  current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_PR_BEGIN;
                  //}
                 //else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                 //{
                 //  edition_settings.timeout_dz4_vvid_pr[group] = current_settings.timeout_dz4_vvid_pr[group];
                 //  current_ekran.position_cursor_x = COL_TMO_DZ4_VVID_PR_BEGIN;
                 //}
                 //else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                 //{
                 //  edition_settings.timeout_dz4_amtz_vvid_pr[group] = current_settings.timeout_dz4_amtz_vvid_pr[group];
                 //  current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN;
                 //}
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                  {
                    edition_settings.timeout_nkn_dzo[group] = current_settings.timeout_nkn_dzo[group];
                    current_ekran.position_cursor_x = COL_TMO_NKN_DZO_BEGIN;
                  }

                }
                else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
                {
                  edition_settings.control_dzo = current_settings.control_dzo;
                }
//-------------#include "ekran/ekran_dz_enter.ci"-------------------------
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);

                  if (current_ekran.index_position == INDEX_ML_TMOZDZ)
                  {
                    edition_settings.timeout_zdz[group] = current_settings.timeout_zdz[group];
                    current_ekran.position_cursor_x = COL_TMO_ZDZ_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
                {
                  edition_settings.control_zdz = current_settings.control_zdz;
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                  edition_settings.zdz_ovd_porig = current_settings.zdz_ovd_porig;
#endif
                  edition_settings.ctrl_zdz_type = current_settings.ctrl_zdz_type;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);

                  //if (current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                  //{
                  //  edition_settings.setpoint_zz_3I0[group] = current_settings.setpoint_zz_3I0[group];
                  //  current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3I0_BEGIN;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                  //{
                  //  edition_settings.setpoint_zz_3U0[group] = current_settings.setpoint_zz_3U0[group];
                  //  current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3U0_BEGIN;
                  //}
                  if (current_ekran.index_position == INDEX_ML_STPMTZO1)
                  {
                    edition_settings.setpoint_mtzo_1[group] = current_settings.setpoint_mtzo_1[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                  {
                    edition_settings.setpoint_mtzo_1_n_vpered[group] = current_settings.setpoint_mtzo_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzo_1_n_nazad[group] = current_settings.setpoint_mtzo_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                  {
                    edition_settings.setpoint_mtzo_1_angle[group] = current_settings.setpoint_mtzo_1_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzo_1_po_napruzi[group] = current_settings.setpoint_mtzo_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                  {
                    edition_settings.setpoint_mtzo_1_U[group] = current_settings.setpoint_mtzo_1_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2)
                  {
                    edition_settings.setpoint_mtzo_2[group] = current_settings.setpoint_mtzo_2[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                  {
                    edition_settings.setpoint_mtzo_2_n_vpered[group] = current_settings.setpoint_mtzo_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzo_2_n_nazad[group] = current_settings.setpoint_mtzo_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                  {
                    edition_settings.setpoint_mtzo_2_angle[group] = current_settings.setpoint_mtzo_2_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzo_2_po_napruzi[group] = current_settings.setpoint_mtzo_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                  {
                    edition_settings.setpoint_mtzo_2_U[group] = current_settings.setpoint_mtzo_2_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3)
                  {
                    edition_settings.setpoint_mtzo_3[group] = current_settings.setpoint_mtzo_3[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                  {
                    edition_settings.setpoint_mtzo_3_n_vpered[group] = current_settings.setpoint_mtzo_3_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzo_3_n_nazad[group] = current_settings.setpoint_mtzo_3_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                  {
                    edition_settings.setpoint_mtzo_3_angle[group] = current_settings.setpoint_mtzo_3_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzo_3_po_napruzi[group] = current_settings.setpoint_mtzo_3_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                  {
                    edition_settings.setpoint_mtzo_3_U[group] = current_settings.setpoint_mtzo_3_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4)
                  {
                    edition_settings.setpoint_mtzo_4[group] = current_settings.setpoint_mtzo_4[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                  {
                    edition_settings.setpoint_mtzo_4_n_vpered[group] = current_settings.setpoint_mtzo_4_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzo_4_n_nazad[group] = current_settings.setpoint_mtzo_4_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                  {
                    edition_settings.setpoint_mtzo_4_angle[group] = current_settings.setpoint_mtzo_4_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzo_4_po_napruzi[group] = current_settings.setpoint_mtzo_4_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                  {
                    edition_settings.setpoint_mtzo_4_U[group] = current_settings.setpoint_mtzo_4_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_U_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);

                  //if (current_ekran.index_position == INDEX_ML_TMOZZ1_3I0)
                  //{
                  //  edition_settings.timeout_zz_3I0[group] = current_settings.timeout_zz_3I0[group];
                  //  current_ekran.position_cursor_x = COL_TMO_ZZ1_3I0_BEGIN;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_TMOZZ1_3U0)
                  //{
                  //  edition_settings.timeout_zz_3U0[group] = current_settings.timeout_zz_3U0[group];
                  //  current_ekran.position_cursor_x = COL_TMO_ZZ1_3U0_BEGIN;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_TMOZZ1_NZZ)
                  //{
                  //  edition_settings.timeout_nzz[group] = current_settings.timeout_nzz[group];
                  //  current_ekran.position_cursor_x = COL_TMO_ZZ1_NZZ_BEGIN;
                  //}
                  if (current_ekran.index_position == INDEX_ML_TMOMTZO1)
                  {
                    edition_settings.timeout_mtzo_1[group] = current_settings.timeout_mtzo_1[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                  {
                    edition_settings.timeout_mtzo_1_n_vpered[group] = current_settings.timeout_mtzo_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                  {
                    edition_settings.timeout_mtzo_1_n_nazad[group] = current_settings.timeout_mtzo_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzo_1_po_napruzi[group] = current_settings.timeout_mtzo_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2)
                  {
                    edition_settings.timeout_mtzo_2[group] = current_settings.timeout_mtzo_2[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                  {
                    edition_settings.timeout_mtzo_2_pr[group] = current_settings.timeout_mtzo_2_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                  {
                    edition_settings.timeout_mtzo_2_n_vpered[group] = current_settings.timeout_mtzo_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                  {
                    edition_settings.timeout_mtzo_2_n_vpered_pr[group] = current_settings.timeout_mtzo_2_n_vpered_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                  {
                    edition_settings.timeout_mtzo_2_n_nazad[group] = current_settings.timeout_mtzo_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                  {
                    edition_settings.timeout_mtzo_2_n_nazad_pr[group] = current_settings.timeout_mtzo_2_n_nazad_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzo_2_po_napruzi[group] = current_settings.timeout_mtzo_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                  {
                    edition_settings.timeout_mtzo_2_po_napruzi_pr[group] = current_settings.timeout_mtzo_2_po_napruzi_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                  {
                    edition_settings.timeout_mtzo_2_vvid_pr[group] = current_settings.timeout_mtzo_2_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3)
                  {
                    edition_settings.timeout_mtzo_3[group] = current_settings.timeout_mtzo_3[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                  {
                    edition_settings.timeout_mtzo_3_n_vpered[group] = current_settings.timeout_mtzo_3_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                  {
                    edition_settings.timeout_mtzo_3_n_nazad[group] = current_settings.timeout_mtzo_3_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzo_3_po_napruzi[group] = current_settings.timeout_mtzo_3_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4)
                  {
                    edition_settings.timeout_mtzo_4[group] = current_settings.timeout_mtzo_4[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                  {
                    edition_settings.timeout_mtzo_4_n_vpered[group] = current_settings.timeout_mtzo_4_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                  {
                    edition_settings.timeout_mtzo_4_n_nazad[group] = current_settings.timeout_mtzo_4_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzo_4_po_napruzi[group] = current_settings.timeout_mtzo_4_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_PO_NAPRUZI_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
                {
                  //edition_settings.control_zz = current_settings.control_zz;
                    edition_settings.type_mtzo1 = current_settings.type_mtzo1;
                    edition_settings.type_mtzo2 = current_settings.type_mtzo2;
                    edition_settings.type_mtzo3 = current_settings.type_mtzo3;
                    edition_settings.type_mtzo4 = current_settings.type_mtzo4;
                    edition_settings.control_mtzo = current_settings.control_mtzo;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                  /*
                  if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                  {
                    edition_settings.setpoint_tznp_1_3I0_vpered[group] = current_settings.setpoint_tznp_1_3I0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                  {
                    edition_settings.setpoint_tznp_1_3U0_vpered[group] = current_settings.setpoint_tznp_1_3U0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_1_3I0_nazad[group] = current_settings.setpoint_tznp_1_3I0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_1_3U0_nazad[group] = current_settings.setpoint_tznp_1_3U0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                  {
                    edition_settings.setpoint_tznp_1_angle[group] = current_settings.setpoint_tznp_1_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                  {
                    edition_settings.setpoint_tznp_2_3I0_vpered[group] = current_settings.setpoint_tznp_2_3I0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                  {
                    edition_settings.setpoint_tznp_2_3U0_vpered[group] = current_settings.setpoint_tznp_2_3U0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_2_3I0_nazad[group] = current_settings.setpoint_tznp_2_3I0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_2_3U0_nazad[group] = current_settings.setpoint_tznp_2_3U0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                  {
                    edition_settings.setpoint_tznp_2_angle[group] = current_settings.setpoint_tznp_2_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                  {
                    edition_settings.setpoint_tznp_3_3I0_vpered[group] = current_settings.setpoint_tznp_3_3I0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                  {
                    edition_settings.setpoint_tznp_3_3U0_vpered[group] = current_settings.setpoint_tznp_3_3U0_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_3_3I0_nazad[group] = current_settings.setpoint_tznp_3_3I0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                  {
                    edition_settings.setpoint_tznp_3_3U0_nazad[group] = current_settings.setpoint_tznp_3_3U0_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                  {
                    edition_settings.setpoint_tznp_3_angle[group] = current_settings.setpoint_tznp_3_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_ANGLE_BEGIN;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_STPMTZR1)
                  {
                    edition_settings.setpoint_mtzr_1[group] = current_settings.setpoint_mtzr_1[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                  {
                    edition_settings.setpoint_mtzr_1_n_vpered[group] = current_settings.setpoint_mtzr_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzr_1_n_nazad[group] = current_settings.setpoint_mtzr_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                  {
                    edition_settings.setpoint_mtzr_1_angle[group] = current_settings.setpoint_mtzr_1_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzr_1_po_napruzi[group] = current_settings.setpoint_mtzr_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                  {
                    edition_settings.setpoint_mtzr_1_U[group] = current_settings.setpoint_mtzr_1_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_U_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2)
                  {
                    edition_settings.setpoint_mtzr_2[group] = current_settings.setpoint_mtzr_2[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                  {
                    edition_settings.setpoint_mtzr_2_n_vpered[group] = current_settings.setpoint_mtzr_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                  {
                    edition_settings.setpoint_mtzr_2_n_nazad[group] = current_settings.setpoint_mtzr_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                  {
                    edition_settings.setpoint_mtzr_2_angle[group] = current_settings.setpoint_mtzr_2_angle[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                  {
                    edition_settings.setpoint_mtzr_2_po_napruzi[group] = current_settings.setpoint_mtzr_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                  {
                    edition_settings.setpoint_mtzr_2_U[group] = current_settings.setpoint_mtzr_2_U[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_U_BEGIN;
                  }
                  
                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
                  
                  /*if (current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                  {
                    edition_settings.timeout_tznp_1_vpered[group] = current_settings.timeout_tznp_1_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                  {
                    edition_settings.timeout_tznp_1_nazad[group] = current_settings.timeout_tznp_1_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                  {
                    edition_settings.timeout_tznp_2_vpered[group] = current_settings.timeout_tznp_2_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                  {
                    edition_settings.timeout_tznp_2_nazad[group] = current_settings.timeout_tznp_2_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                  {
                    edition_settings.timeout_tznp_3_vpered[group] = current_settings.timeout_tznp_3_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                  {
                    edition_settings.timeout_tznp_3_nazad[group] = current_settings.timeout_tznp_3_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_NAZAD_BEGIN;
                  }*/
                  
                  if (current_ekran.index_position == INDEX_ML_TMOMTZR1)
                  {
                    edition_settings.timeout_mtzr_1[group] = current_settings.timeout_mtzr_1[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                  {
                    edition_settings.timeout_mtzr_1_n_vpered[group] = current_settings.timeout_mtzr_1_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                  {
                    edition_settings.timeout_mtzr_1_n_nazad[group] = current_settings.timeout_mtzr_1_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzr_1_po_napruzi[group] = current_settings.timeout_mtzr_1_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_PO_NAPRUZI_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2)
                  {
                    edition_settings.timeout_mtzr_2[group] = current_settings.timeout_mtzr_2[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                  {
                    edition_settings.timeout_mtzr_2_n_vpered[group] = current_settings.timeout_mtzr_2_n_vpered[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_VPERED_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                  {
                    edition_settings.timeout_mtzr_2_n_nazad[group] = current_settings.timeout_mtzr_2_n_nazad[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_NAZAD_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                  {
                    edition_settings.timeout_mtzr_2_po_napruzi[group] = current_settings.timeout_mtzr_2_po_napruzi[group];
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_PO_NAPRUZI_BEGIN;
                  }
                  
                  
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
                {
                  //edition_settings.control_tznp = current_settings.control_tznp;
                  edition_settings.type_mtzr1 = current_settings.type_mtzr1;
                  edition_settings.type_mtzr2 = current_settings.type_mtzr2;

                  edition_settings.control_mtzr = current_settings.control_mtzr;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);

                  if (current_ekran.index_position == INDEX_ML_TMOAPV1)
                  {
                    edition_settings.timeout_apv_1[group] = current_settings.timeout_apv_1[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV2)
                  {
                    edition_settings.timeout_apv_2[group] = current_settings.timeout_apv_2[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV3)
                  {
                    edition_settings.timeout_apv_3[group] = current_settings.timeout_apv_3[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV4)
                  {
                    edition_settings.timeout_apv_4[group] = current_settings.timeout_apv_4[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                  {
                    edition_settings.timeout_apv_block_vid_apv1[group] = current_settings.timeout_apv_block_vid_apv1[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                  {
                    edition_settings.timeout_apv_block_vid_apv2[group] = current_settings.timeout_apv_block_vid_apv2[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                  {
                    edition_settings.timeout_apv_block_vid_apv3[group] = current_settings.timeout_apv_block_vid_apv3[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV3_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                  {
                    edition_settings.timeout_apv_block_vid_apv4[group] = current_settings.timeout_apv_block_vid_apv4[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV4_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                  {
                    edition_settings.timeout_apv_block_vid_VV[group] = current_settings.timeout_apv_block_vid_VV[group];
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_VV_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_APV)
                {
                  edition_settings.control_apv = current_settings.control_apv;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);

                  if (current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                  {
                    edition_settings.setpoint_achr_chapv_uf[group] = current_settings.setpoint_achr_chapv_uf[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR_CHAPV_UF_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                  {
                    edition_settings.setpoint_achr1_f_rab[group] = current_settings.setpoint_achr1_f_rab[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR1_F_RAB_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                  {
                    edition_settings.setpoint_chapv1_f_rab[group] = current_settings.setpoint_chapv1_f_rab[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV1_F_RAB_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                  {
                    edition_settings.setpoint_achr2_f_rab[group] = current_settings.setpoint_achr2_f_rab[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR2_F_RAB_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                  {
                    edition_settings.setpoint_chapv2_f_rab[group] = current_settings.setpoint_chapv2_f_rab[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV2_F_RAB_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);

                  if (current_ekran.index_position == INDEX_ML_TMOACHR1)
                  {
                    edition_settings.timeout_achr_1[group] = current_settings.timeout_achr_1[group];
                    current_ekran.position_cursor_x = COL_TMO_ACHR1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                  {
                    edition_settings.timeout_chapv_1[group] = current_settings.timeout_chapv_1[group];
                    current_ekran.position_cursor_x = COL_TMO_CHAPV1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOACHR2)
                  {
                    edition_settings.timeout_achr_2[group] = current_settings.timeout_achr_2[group];
                    current_ekran.position_cursor_x = COL_TMO_ACHR2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                  {
                    edition_settings.timeout_chapv_2[group] = current_settings.timeout_chapv_2[group];
                    current_ekran.position_cursor_x = COL_TMO_CHAPV2_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
                {
                  edition_settings.control_achr_chapv = current_settings.control_achr_chapv;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);

                  edition_settings.setpoint_urov[group] = current_settings.setpoint_urov[group];
                  current_ekran.position_cursor_x = COL_SETPOINT_UROV_BEGIN;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);

                  if (current_ekran.index_position == INDEX_ML_TMOUROV1)
                  {
                    edition_settings.timeout_urov_1[group] = current_settings.timeout_urov_1[group];
                    current_ekran.position_cursor_x = COL_TMO_UROV_1_BEGIN;
                  }
                  else
                  {
                    edition_settings.timeout_urov_2[group] = current_settings.timeout_urov_2[group];
                    current_ekran.position_cursor_x = COL_TMO_UROV_2_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
                {
                  edition_settings.control_urov = current_settings.control_urov;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);

                  //edition_settings.setpoint_zop[group] = current_settings.setpoint_zop[group];
                  //edition_settings.setpoint_zop[group] = current_settings.setpoint_zop[group];
                  
                  
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                  {
                    edition_settings.pickup_dzr_Io3g_Io1g[group] = current_settings.pickup_dzr_Io3g_Io1g[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR_K_ICE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1)
                  {
                    edition_settings.pickup_dzr1[group] = current_settings.pickup_dzr1[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                  {
                    edition_settings.pickup_dzr1_amtz[group] = current_settings.pickup_dzr1_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_AMTZ_BEGIN;//.COL_PICKUP_DZ1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                  {
                    edition_settings.pickup_dzr1_blkI[group] = current_settings.pickup_dzr1_blkI[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_I_BLK_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                  {
                    edition_settings.pickup_dzr2_angle[group] = current_settings.pickup_dzr2_angle[group];
                    current_ekran.position_cursor_x = COL_S_DZR2_ANGLE;//COL_PICKUP_DZ2_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                  {
                    edition_settings.pickup_dzr2_dir[group] = current_settings.pickup_dzr2_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                  {
                    edition_settings.pickup_dzr2_inv[group] = current_settings.pickup_dzr2_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                  {
                    edition_settings.pickup_dzr2_amtz[group] = current_settings.pickup_dzr2_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_AMTZ_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H)
                  {
                    edition_settings.pickup_dzr3_angle_h[group] = current_settings.pickup_dzr3_angle_h[group];
                    edition_settings.pickup_dzr3_angle_l[group] = current_settings.pickup_dzr3_angle_l[group];
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_H;//COL_PICKUP_DZ3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                  {
                    edition_settings.pickup_dzr3_angle_l[group] = current_settings.pickup_dzr3_angle_l[group];
                    edition_settings.pickup_dzr3_angle_h[group] = current_settings.pickup_dzr3_angle_h[group];
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_L;//COL_PICKUP_DZ3_ANGLE_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                  {
                    edition_settings.pickup_dzr3_dir[group] = current_settings.pickup_dzr3_dir[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                  {
                    edition_settings.pickup_dzr3_inv[group] = current_settings.pickup_dzr3_inv[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                  {
                    edition_settings.pickup_dzr3_amtz[group] = current_settings.pickup_dzr3_amtz[group];
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_AMTZ_BEGIN;
                  }
                
                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);

                  //edition_settings.timeout_zop[group] = current_settings.timeout_zop[group];
                  //current_ekran.position_cursor_x = COL_TMO_ZOP_BEGIN;
                  if (current_ekran.index_position == INDEX_ML_TMO_DZR1)
                  {
                    edition_settings.timeout_dzr1[group] = current_settings.timeout_dzr1[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                  {
                    edition_settings.timeout_dzr1_amtz[group] = current_settings.timeout_dzr1_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR1_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                  {
                    edition_settings.timeout_dzr2_dir[group] = current_settings.timeout_dzr2_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                  {
                    edition_settings.timeout_dzr2_dir_pr[group] = current_settings.timeout_dzr2_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                  {
                    edition_settings.timeout_dzr2_inv[group] = current_settings.timeout_dzr2_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                  {
                    edition_settings.timeout_dzr2_inv_pr[group] = current_settings.timeout_dzr2_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                  {
                    edition_settings.timeout_dzr2_amtz[group] = current_settings.timeout_dzr2_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                  {
                    edition_settings.timeout_dzr2_amtz_pr[group] = current_settings.timeout_dzr2_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                  {
                    edition_settings.timeout_dzr2_vvid_pr[group] = current_settings.timeout_dzr2_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dzr2_amtz_vvid_pr[group] = current_settings.timeout_dzr2_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_VVID_PR_BEGIN;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                  {
                    edition_settings.timeout_dzr3_dir[group] = current_settings.timeout_dzr3_dir[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                  {
                    edition_settings.timeout_dzr3_dir_pr[group] = current_settings.timeout_dzr3_dir_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                  {
                    edition_settings.timeout_dzr3_inv[group] = current_settings.timeout_dzr3_inv[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                  {
                    edition_settings.timeout_dzr3_inv_pr[group] = current_settings.timeout_dzr3_inv_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                  {
                    edition_settings.timeout_dzr3_amtz[group] = current_settings.timeout_dzr3_amtz[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                  {
                    edition_settings.timeout_dzr3_amtz_pr[group] = current_settings.timeout_dzr3_amtz_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                  {
                    edition_settings.timeout_dzr3_vvid_pr[group] = current_settings.timeout_dzr3_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_VVID_PR_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                  {
                    edition_settings.timeout_dzr3_amtz_vvid_pr[group] = current_settings.timeout_dzr3_amtz_vvid_pr[group];
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_VVID_PR_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
                {
                  //edition_settings.control_zop = current_settings.control_zop;
                  edition_settings.control_dzr = current_settings.control_dzr;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPUMIN1)
                  {
                    edition_settings.setpoint_Umin1[group] = current_settings.setpoint_Umin1[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                  {
                    edition_settings.setpoint_Umin1_Iblk[group] = current_settings.setpoint_Umin1_Iblk[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_IBLK_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2)
                  {
                    edition_settings.setpoint_Umin2[group] = current_settings.setpoint_Umin2[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                  {
                    edition_settings.setpoint_Umin2_Iblk[group] = current_settings.setpoint_Umin2_Iblk[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_IBLK_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMIN1)
                  {
                    edition_settings.timeout_Umin1[group] = current_settings.timeout_Umin1[group];
                    current_ekran.position_cursor_x = COL_TMO_UMIN1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMIN2)
                  {
                    edition_settings.timeout_Umin2[group] = current_settings.timeout_Umin2[group];
                    current_ekran.position_cursor_x = COL_TMO_UMIN2_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
                {
                  edition_settings.control_Umin = current_settings.control_Umin;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPUMAX1)
                  {
                    edition_settings.setpoint_Umax1[group] = current_settings.setpoint_Umax1[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMAX2)
                  {
                    edition_settings.setpoint_Umax2[group] = current_settings.setpoint_Umax2[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX2_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                  {
                    edition_settings.setpoint_kp_Umax[group] = current_settings.setpoint_kp_Umax[group];
                    current_ekran.position_cursor_x = COL_SETPOINT_KP_UMAX_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMAX1)
                  {
                    edition_settings.timeout_Umax1[group] = current_settings.timeout_Umax1[group];
                    current_ekran.position_cursor_x = COL_TMO_UMAX1_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMAX2)
                  {
                    edition_settings.timeout_Umax2[group] = current_settings.timeout_Umax2[group];
                    current_ekran.position_cursor_x = COL_TMO_UMAX2_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
                {
                  edition_settings.control_Umax = current_settings.control_Umax;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                  if (_n_index == INDEX_ML_STP_UP)
                  {
                    edition_settings.setpoint_UP[_n_UP][0][group] = current_settings.setpoint_UP[_n_UP][0][group];
                    switch (current_settings.ctrl_UP_input[_n_UP])
                    {
                    case UP_CTRL_Ia_Ib_Ic:
                    case UP_CTRL_Ia:
                    case UP_CTRL_Ib:
                    case UP_CTRL_Ic:
                    case UP_CTRL_I1:
                    case UP_CTRL_I2:
                    case UP_CTRL_3I0_r:
                      {
                        current_ekran.position_cursor_x = COL_SETPOINT_UP_I_BEGIN;
                        break;
                      }
                    case UP_CTRL_3I0:
                    case UP_CTRL_3I0_others:
                      {
                        current_ekran.position_cursor_x = COL_SETPOINT_UP_3I0_BEGIN;
                        break;
                      }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                      {
                        current_ekran.position_cursor_x = COL_SETPOINT_UP_U_BEGIN;
                        break;
                      }
                    case UP_CTRL_P:
                    case UP_CTRL_Q:
                      {
                        current_ekran.position_cursor_x = COL_SETPOINT_UP_PQ_BEGIN - 1;
                        break;
                      }
                    case UP_CTRL_S:
                      {
                        current_ekran.position_cursor_x = COL_SETPOINT_UP_S_BEGIN;
                        break;
                      }
                    default:
                      {
                        //Теоретично цього ніколи не мало б бути
                        total_error_sw_fixed();
                      }
                    }
                  }
                  else if (_n_index == INDEX_ML_STP_UP_KP)
                  {
                    edition_settings.setpoint_UP_KP[_n_UP][0][group] = current_settings.setpoint_UP_KP[_n_UP][0][group];
                    current_ekran.position_cursor_x = COL_SETPOINT_UP_KP_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                       )
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_TIMEOUT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;
                  if (_n_index == INDEX_ML_TMOUP)
                  {
                    edition_settings.timeout_UP[_n_UP][0][group] = current_settings.timeout_UP[_n_UP][0][group];
                    current_ekran.position_cursor_x = COL_TMO_UP_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UP)
                {
                  edition_settings.control_UP = current_settings.control_UP;
                  for (size_t i = 0; i < NUMBER_UP; i++) edition_settings.ctrl_UP_input[i] = current_settings.ctrl_UP_input[i];
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
                {
                  if (current_ekran.index_position == INDEX_ML_T_MN)
                  {
                    edition_settings.Tmn = current_settings.Tmn;
                    current_ekran.position_cursor_x = COL_T_MN_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_T_BP)
                  {
                    edition_settings.Tbp = current_settings.Tbp;
                    current_ekran.position_cursor_x = COL_T_BP_BEGIN;
                  }
                  else
                  {
                    edition_settings.TVoltage = current_settings.TVoltage;
                    current_ekran.position_cursor_x = COL_TN_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
                {
                  edition_settings.control_transformator = current_settings.control_transformator;
                }
                else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_STPInom)
                  {
                    edition_settings.setpoint_Inom = current_settings.setpoint_Inom;
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                  {
                    edition_settings.setpoint_r_kom_st_Inom = current_settings.setpoint_r_kom_st_Inom;
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                  {
                    edition_settings.setpoint_Inom_vymk = current_settings.setpoint_Inom_vymk;
                    current_ekran.position_cursor_x = COL_SETPOINT_Inom_vymk_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                  {
                    edition_settings.setpoint_r_kom_st_Inom_vymk = current_settings.setpoint_r_kom_st_Inom_vymk;
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_vymk_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                  {
                    edition_settings.setpoint_pochatkovyj_resurs = current_settings.setpoint_pochatkovyj_resurs;
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVYJ_RESURS_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                  {
                    edition_settings.setpoint_krytychnyj_resurs = current_settings.setpoint_krytychnyj_resurs;
                    current_ekran.position_cursor_x = COL_SETPOINT_KRYTYCHNYJ_RESURS_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                  {
                    edition_settings.setpoint_pochatkova_k_vymk = current_settings.setpoint_pochatkova_k_vymk;
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVA_K_VYMK_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    edition_settings.timeout_swch_on = current_settings.timeout_swch_on;
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    edition_settings.timeout_swch_off = current_settings.timeout_swch_off;
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    edition_settings.timeout_swch_udl_blk_on = current_settings.timeout_swch_udl_blk_on;
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    edition_settings.timeout_pryvoda_VV = current_settings.timeout_pryvoda_VV;
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
                {
                  edition_settings.control_switch = current_settings.control_switch;
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                        (current_ekran.current_level  < (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H;
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    edition_settings.timeout_swch_on_[on_off] = current_settings.timeout_swch_on_[on_off];
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    edition_settings.timeout_swch_off_[on_off] = current_settings.timeout_swch_off_[on_off];
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    edition_settings.timeout_swch_udl_blk_on_[on_off] = current_settings.timeout_swch_udl_blk_on_[on_off];
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_BEGIN;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    edition_settings.timeout_pryvoda_VV_[on_off] = current_settings.timeout_pryvoda_VV_[on_off];
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_BEGIN;
                  }
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                        (current_ekran.current_level  < (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_CONTROL_SWITCH_H;
                  edition_settings.control_switch_[on_off] = current_settings.control_switch_[on_off];
                }
                else if(
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                       )   
                {
                  int forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
                  edition_settings.lines[forward_backward] = current_settings.lines[forward_backward]; //Цю операцію треба виконати для того, щоб правильно визначати кількість рядків для відображення у режимі редагування
                  
                  if (current_ekran.index_position == INDEX_ML_LINES)
                  {
                    //edition_settings.lines[forward_backward] = current_settings.lines[forward_backward]; //(!!!) Ця операція вже є фактично виконаною при вході у else if {}, тому я її закоментував (!!!)
                    current_ekran.position_cursor_x = COL_SETPOINT_LINES_BEGIN;
                  }
                  else
                  {
                    int _tmp = current_ekran.index_position - 1;
                    int dilanka = _tmp >> 1;
                    if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                    {
                      edition_settings.dovgyna[forward_backward][dilanka] = current_settings.dovgyna[forward_backward][dilanka];
                      current_ekran.position_cursor_x = COL_SETPOINT_DOVGYNA_BEGIN;
                    }
                    else
                    {
                      edition_settings.opir[forward_backward][dilanka] = current_settings.opir[forward_backward][dilanka];
                      current_ekran.position_cursor_x = COL_SETPOINT_OPIR_BEGIN;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
                {
                  edition_settings.control_vmp = current_settings.control_vmp;
                }
                else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
                {
                  edition_settings.dopusk_dv[current_ekran.index_position] = current_settings.dopusk_dv[current_ekran.index_position];
                  current_ekran.position_cursor_x = COL_DOPUSK_DV_BEGIN;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                {
                  edition_settings.type_of_input = current_settings.type_of_input;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV)
                {
                  edition_settings.type_of_input_signal = current_settings.type_of_input_signal;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
                {
                  edition_settings.type_of_output       = current_settings.type_of_output;
                  edition_settings.type_of_output_modif = current_settings.type_of_output_modif;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
                {
                  edition_settings.type_of_led = current_settings.type_of_led;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
                {
                  edition_settings.buttons_mode = current_settings.buttons_mode;
                }
                else if(current_ekran.current_level == EKRAN_ADDRESS)
                {
                  edition_settings.address = current_settings.address;
                  current_ekran.position_cursor_x = COL_ADDRESS_BEGIN;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
                {
                  edition_settings.speed_RS485 = current_settings.speed_RS485;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
                {
                  edition_settings.pare_bit_RS485 = current_settings.pare_bit_RS485;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
                {
                  edition_settings.number_stop_bit_RS485 = current_settings.number_stop_bit_RS485;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
                {
                  edition_settings.time_out_1_RS485 = current_settings.time_out_1_RS485;
                  current_ekran.position_cursor_x = COL_TIMEOUT_INTERFACE_BEGIN;
                }
                else if(current_ekran.current_level == EKRAN_TIME_ZONE)
                {
                  edition_settings.time_zone = current_settings.time_zone;
                  edition_settings.dst = current_settings.dst;
                }
                else if(current_ekran.current_level == EKRAN_DST_RULE)
                {
                  if (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON)
                  {
                    edition_settings.dst_on_rule = current_settings.dst_on_rule;
                  }
                  else
                  {
                    edition_settings.dst_off_rule = current_settings.dst_off_rule;
                  }
                }
                else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
                {
                  if (current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                  {
                    edition_settings.number_iteration_el = current_settings.number_iteration_el;
                    current_ekran.position_cursor_x = COL_NUMBER_INERATION_BEGIN;
                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                  {
//                    edition_settings.number_defined_df = current_settings.number_defined_df;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_FUNCTIONS_BEGIN;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                  {
//                    edition_settings.number_defined_dt = current_settings.number_defined_dt;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_TRIGGERS_BEGIN;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                  {
//                    edition_settings.number_defined_and = current_settings.number_defined_and;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_AND_BEGIN;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                  {
//                    edition_settings.number_defined_or = current_settings.number_defined_or;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_OR_BEGIN;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                  {
//                    edition_settings.number_defined_xor = current_settings.number_defined_xor;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_XOR_BEGIN;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                  {
//                    edition_settings.number_defined_not = current_settings.number_defined_not;
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_NOT_BEGIN;
//                  }
                }
                else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
                {
                  edition_settings.type_df = current_settings.type_df;
                }
                else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                  {
                    edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      current_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1];
                    current_ekran.position_cursor_x = COL_TMO_DF_PAUSE_BEGIN;
                  }
                  else
                  {
                    edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      current_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1];
                    current_ekran.position_cursor_x = COL_TMO_DF_PAUSE_BEGIN;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1))
                {
                  edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] = current_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1];
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_AR)
                {
                  edition_settings.control_ar = current_settings.control_ar;
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_ELONGATION)
                  {
                    edition_settings.timeout_prolongation_work_digital_registrator = current_settings.timeout_prolongation_work_digital_registrator;
                    current_ekran.position_cursor_x = COL_TMO_ELONGATION_BEGIN;//if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)

                  }
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  {
                    edition_settings.prefault_number_periods = current_settings.prefault_number_periods;
                    current_ekran.position_cursor_x = COL_TMO_PREFAULT_BEGIN;
                  }
                  else
                  {
                    edition_settings.postfault_number_periods = current_settings.postfault_number_periods;
                    current_ekran.position_cursor_x = COL_TMO_POSTFAULT_BEGIN;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
                {
                  edition_settings.language = current_settings.language;
                }
                else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
                {
                  edition_settings.control_extra_settings_1 = current_settings.control_extra_settings_1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
                {
                  edition_settings.grupa_ustavok = current_settings.grupa_ustavok;
                }

                //Підготовка до режиму редагування - включаємо мигаючий курсор
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 1;
                if (current_settings.password1 != 0)
                {
                  //Переходимо на меню запиту паролю
                  current_ekran.current_level = EKRAN_LEVEL_PASSWORD;
                  previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
                else
                {
                  //Переходимо у режим редагування
                  current_ekran.edition = 1;
                }
              }
              else if (current_ekran.edition == 1)
              {
                //Перевіряємо чи якісь зміни відбулися
                unsigned int found_changes = 0;

                if(
                   (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                   (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                  )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                  {
                    if (edition_settings.setpoint_mtz_1[group] != current_settings.setpoint_mtz_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtz_1_n_vpered[group] != current_settings.setpoint_mtz_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtz_1_n_nazad[group] != current_settings.setpoint_mtz_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                  {
                    if (edition_settings.setpoint_mtz_1_angle[group] != current_settings.setpoint_mtz_1_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtz_1_po_napruzi[group] != current_settings.setpoint_mtz_1_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                  {
                    if (edition_settings.setpoint_mtz_1_U[group] != current_settings.setpoint_mtz_1_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2)
                  {
                    if (edition_settings.setpoint_mtz_2[group] != current_settings.setpoint_mtz_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtz_2_n_vpered[group] != current_settings.setpoint_mtz_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtz_2_n_nazad[group] != current_settings.setpoint_mtz_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                  {
                    if (edition_settings.setpoint_mtz_2_angle[group] != current_settings.setpoint_mtz_2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtz_2_po_napruzi[group] != current_settings.setpoint_mtz_2_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                  {
                    if (edition_settings.setpoint_mtz_2_U[group] != current_settings.setpoint_mtz_2_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3)
                  {
                    if (edition_settings.setpoint_mtz_3[group] != current_settings.setpoint_mtz_3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtz_3_n_vpered[group] != current_settings.setpoint_mtz_3_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtz_3_n_nazad[group] != current_settings.setpoint_mtz_3_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                  {
                    if (edition_settings.setpoint_mtz_3_angle[group] != current_settings.setpoint_mtz_3_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtz_3_po_napruzi[group] != current_settings.setpoint_mtz_3_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                  {
                    if (edition_settings.setpoint_mtz_3_U[group] != current_settings.setpoint_mtz_3_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4)
                  {
                    if (edition_settings.setpoint_mtz_4[group] != current_settings.setpoint_mtz_4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtz_4_n_vpered[group] != current_settings.setpoint_mtz_4_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtz_4_n_nazad[group] != current_settings.setpoint_mtz_4_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                  {
                    if (edition_settings.setpoint_mtz_4_angle[group] != current_settings.setpoint_mtz_4_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtz_4_po_napruzi[group] != current_settings.setpoint_mtz_4_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                  {
                    if (edition_settings.setpoint_mtz_4_U[group] != current_settings.setpoint_mtz_4_U[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOMTZ1)
                  {
                    if (edition_settings.timeout_mtz_1[group] != current_settings.timeout_mtz_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                  {
                    if (edition_settings.timeout_mtz_1_n_vpered[group] != current_settings.timeout_mtz_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtz_1_n_nazad[group] != current_settings.timeout_mtz_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtz_1_po_napruzi[group] != current_settings.timeout_mtz_1_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2)
                  {
                    if (edition_settings.timeout_mtz_2[group] != current_settings.timeout_mtz_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                  {
                    if (edition_settings.timeout_mtz_2_pr[group] != current_settings.timeout_mtz_2_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                  {
                    if (edition_settings.timeout_mtz_2_n_vpered[group] != current_settings.timeout_mtz_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                  {
                    if (edition_settings.timeout_mtz_2_n_vpered_pr[group] != current_settings.timeout_mtz_2_n_vpered_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtz_2_n_nazad[group] != current_settings.timeout_mtz_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                  {
                    if (edition_settings.timeout_mtz_2_n_nazad_pr[group] != current_settings.timeout_mtz_2_n_nazad_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtz_2_po_napruzi[group] != current_settings.timeout_mtz_2_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                  {
                    if (edition_settings.timeout_mtz_2_po_napruzi_pr[group] != current_settings.timeout_mtz_2_po_napruzi_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                  {
                    if (edition_settings.timeout_mtz_2_vvid_pr[group] != current_settings.timeout_mtz_2_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3)
                  {
                    if (edition_settings.timeout_mtz_3[group] != current_settings.timeout_mtz_3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                  {
                    if (edition_settings.timeout_mtz_3_n_vpered[group] != current_settings.timeout_mtz_3_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtz_3_n_nazad[group] != current_settings.timeout_mtz_3_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtz_3_po_napruzi[group] != current_settings.timeout_mtz_3_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4)
                  {
                    if (edition_settings.timeout_mtz_4[group] != current_settings.timeout_mtz_4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                  {
                    if (edition_settings.timeout_mtz_4_n_vpered[group] != current_settings.timeout_mtz_4_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtz_4_n_nazad[group] != current_settings.timeout_mtz_4_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtz_4_po_napruzi[group] != current_settings.timeout_mtz_4_po_napruzi[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
                {
                  if (
                      (edition_settings.control_mtz != current_settings.control_mtz) ||
                      (edition_settings.type_mtz1 != current_settings.type_mtz1) ||
                      (edition_settings.type_mtz2 != current_settings.type_mtz2) || 
                      (edition_settings.type_mtz3 != current_settings.type_mtz3) || 
                      (edition_settings.type_mtz4 != current_settings.type_mtz4)  
                     )   
                    found_changes = 1;
                }
//++++++++++++++#include "ekran/ekran_dz_1.ci"++++++++++++++++++++++++++
                //Перевіряємо чи якісь зміни відбулися
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                  {
                    if (edition_settings.pickup_dzo_Io3g_Io1g[group] != current_settings.pickup_dzo_Io3g_Io1g[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1)
                  {
                    if (edition_settings.pickup_dzo1[group] != current_settings.pickup_dzo1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                  {
                    if (edition_settings.pickup_dzo1_amtz[group] != current_settings.pickup_dzo1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                  {
                    if (edition_settings.pickup_dzo1_blkI[group] != current_settings.pickup_dzo1_blkI[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                  {
                    if (edition_settings.pickup_dzo2_angle[group] != current_settings.pickup_dzo2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                  {
                    if (edition_settings.pickup_dzo2_dir[group] != current_settings.pickup_dzo2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                  {
                    if (edition_settings.pickup_dzo2_inv[group] != current_settings.pickup_dzo2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                  {
                    if (edition_settings.pickup_dzo2_amtz[group] != current_settings.pickup_dzo2_amtz[group]) found_changes = 1;
                  }

                  else if (
                           (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H) ||
                           (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                          )   
                  {
                    if (
                        (edition_settings.pickup_dzo3_angle_h[group] != current_settings.pickup_dzo3_angle_h[group]) ||
                        (edition_settings.pickup_dzo3_angle_l[group] != current_settings.pickup_dzo3_angle_l[group])
                       )found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                  {
                    if (edition_settings.pickup_dzo3_dir[group] != current_settings.pickup_dzo3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                  {
                    if (edition_settings.pickup_dzo3_inv[group] != current_settings.pickup_dzo3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                  {
                    if (edition_settings.pickup_dzo3_amtz[group] != current_settings.pickup_dzo3_amtz[group]) found_changes = 1;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                  {
                    if (edition_settings.pickup_dzo4_Zo_dir[group] != current_settings.pickup_dzo4_Zo_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                  {
                    if (edition_settings.pickup_dzo4_Xo_dir[group] != current_settings.pickup_dzo4_Xo_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                  {
                    if (edition_settings.pickup_dzo4_Zo_inv[group] != current_settings.pickup_dzo4_Zo_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                  {
                    if (edition_settings.pickup_dzo4_Xo_inv[group] != current_settings.pickup_dzo4_Xo_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                  {
                    if (edition_settings.pickup_dzo4_amtz[group] != current_settings.pickup_dzo4_amtz[group]) found_changes = 1;
                  }
                 /*
                  if (current_ekran.index_position == INDEX_ML_STP_K_DZ)
                  {
                    if (edition_settings.pickup_dz_k[group] != current_settings.pickup_dz_k[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1)
                  {
                    if (edition_settings.pickup_dz1[group] != current_settings.pickup_dz1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1_AMTZ)
                  {
                    if (edition_settings.pickup_dz1_amtz[group] != current_settings.pickup_dz1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_ANGLE)
                  {
                    if (edition_settings.pickup_dz2_angle[group] != current_settings.pickup_dz2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_DIR)
                  {
                    if (edition_settings.pickup_dz2_dir[group] != current_settings.pickup_dz2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_INV)
                  {
                    if (edition_settings.pickup_dz2_inv[group] != current_settings.pickup_dz2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_AMTZ)
                  {
                    if (edition_settings.pickup_dz2_amtz[group] != current_settings.pickup_dz2_amtz[group]) found_changes = 1;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_ANGLE)
                  {
                    if (edition_settings.pickup_dz3_angle[group] != current_settings.pickup_dz3_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_DIR)
                  {
                    if (edition_settings.pickup_dz3_dir[group] != current_settings.pickup_dz3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_INV)
                  {
                    if (edition_settings.pickup_dz3_inv[group] != current_settings.pickup_dz3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_AMTZ)
                  {
                    if (edition_settings.pickup_dz3_amtz[group] != current_settings.pickup_dz3_amtz[group]) found_changes = 1;
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_ANGLE)
                  {
                    if (edition_settings.pickup_dz4_angle[group] != current_settings.pickup_dz4_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_DIR)
                  {
                    if (edition_settings.pickup_dz4_dir[group] != current_settings.pickup_dz4_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_INV)
                  {
                    if (edition_settings.pickup_dz4_inv[group] != current_settings.pickup_dz4_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_AMTZ)
                  {
                    if (edition_settings.pickup_dz4_amtz[group] != current_settings.pickup_dz4_amtz[group]) found_changes = 1;
                  }*/

                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                  /*
                  if (current_ekran.index_position == INDEX_ML_TMO_DZ1)
                  {
                    if (edition_settings.timeout_dz1[group] != current_settings.timeout_dz1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                  {
                    if (edition_settings.timeout_dz1_amtz[group] != current_settings.timeout_dz1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                  {
                    if (edition_settings.timeout_dz2_dir[group] != current_settings.timeout_dz2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                  {
                    if (edition_settings.timeout_dz2_dir_pr[group] != current_settings.timeout_dz2_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                  {
                    if (edition_settings.timeout_dz2_inv[group] != current_settings.timeout_dz2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                  {
                    if (edition_settings.timeout_dz2_inv_pr[group] != current_settings.timeout_dz2_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                  {
                    if (edition_settings.timeout_dz2_amtz[group] != current_settings.timeout_dz2_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                  {
                    if (edition_settings.timeout_dz2_amtz_pr[group] != current_settings.timeout_dz2_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                  {
                    if (edition_settings.timeout_dz2_vvid_pr[group] != current_settings.timeout_dz2_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                  {
                    if (edition_settings.timeout_dz2_amtz_vvid_pr[group] != current_settings.timeout_dz2_amtz_vvid_pr[group]) found_changes = 1;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                  {
                    if (edition_settings.timeout_dz3_dir[group] != current_settings.timeout_dz3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                  {
                    if (edition_settings.timeout_dz3_dir_pr[group] != current_settings.timeout_dz3_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                  {
                    if (edition_settings.timeout_dz3_inv[group] != current_settings.timeout_dz3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                  {
                    if (edition_settings.timeout_dz3_inv_pr[group] != current_settings.timeout_dz3_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                  {
                    if (edition_settings.timeout_dz3_amtz[group] != current_settings.timeout_dz3_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                  {
                    if (edition_settings.timeout_dz3_amtz_pr[group] != current_settings.timeout_dz3_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                  {
                    if (edition_settings.timeout_dz3_vvid_pr[group] != current_settings.timeout_dz3_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                  {
                    if (edition_settings.timeout_dz3_amtz_vvid_pr[group] != current_settings.timeout_dz3_amtz_vvid_pr[group]) found_changes = 1;
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                  {
                    if (edition_settings.timeout_dz4_dir[group] != current_settings.timeout_dz4_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                  {
                    if (edition_settings.timeout_dz4_dir_pr[group] != current_settings.timeout_dz4_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                  {
                    if (edition_settings.timeout_dz4_inv[group] != current_settings.timeout_dz4_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                  {
                    if (edition_settings.timeout_dz4_inv_pr[group] != current_settings.timeout_dz4_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                  {
                    if (edition_settings.timeout_dz4_amtz[group] != current_settings.timeout_dz4_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                  {
                    if (edition_settings.timeout_dz4_amtz_pr[group] != current_settings.timeout_dz4_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                  {
                    if (edition_settings.timeout_dz4_vvid_pr[group] != current_settings.timeout_dz4_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                  {
                    if (edition_settings.timeout_dz4_amtz_vvid_pr[group] != current_settings.timeout_dz4_amtz_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                  {
                    if (edition_settings.timeout_nkn_dz[group] != current_settings.timeout_nkn_dz[group]) found_changes = 1;
                  }*/
                    if (current_ekran.index_position == INDEX_ML_TMO_DZO1)//
                  {
                    if (edition_settings.timeout_dzo1[group] != current_settings.timeout_dzo1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)//
                  {
                    if (edition_settings.timeout_dzo1_amtz[group] != current_settings.timeout_dzo1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)//
                  {
                    if (edition_settings.timeout_dzo2_dir[group] != current_settings.timeout_dzo2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)//
                  {
                    if (edition_settings.timeout_dzo2_dir_pr[group] != current_settings.timeout_dzo2_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)//
                  {
                    if (edition_settings.timeout_dzo2_inv[group] != current_settings.timeout_dzo2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)//
                  {
                    if (edition_settings.timeout_dzo2_inv_pr[group] != current_settings.timeout_dzo2_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)//
                  {
                    if (edition_settings.timeout_dzo2_amtz[group] != current_settings.timeout_dzo2_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)//
                  {
                    if (edition_settings.timeout_dzo2_amtz_pr[group] != current_settings.timeout_dzo2_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzo2_vvid_pr[group] != current_settings.timeout_dzo2_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzo2_amtz_vvid_pr[group] != current_settings.timeout_dzo2_amtz_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)//
                  {
                    if (edition_settings.timeout_dzo3_dir[group] != current_settings.timeout_dzo3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)//
                  {
                    if (edition_settings.timeout_dzo3_dir_pr[group] != current_settings.timeout_dzo3_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)//
                  {
                    if (edition_settings.timeout_dzo3_inv[group] != current_settings.timeout_dzo3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)//
                  {
                    if (edition_settings.timeout_dzo3_inv_pr[group] != current_settings.timeout_dzo3_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)//
                  {
                    if (edition_settings.timeout_dzo3_amtz[group] != current_settings.timeout_dzo3_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)//
                  {
                    if (edition_settings.timeout_dzo3_amtz_pr[group] != current_settings.timeout_dzo3_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzo3_vvid_pr[group] != current_settings.timeout_dzo3_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzo3_amtz_vvid_pr[group] != current_settings.timeout_dzo3_amtz_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)//
                  {
                    if (edition_settings.timeout_dzo4_dir[group] != current_settings.timeout_dzo4_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)//
                  {
                    if (edition_settings.timeout_dzo4_inv[group] != current_settings.timeout_dzo4_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)//
                  {
                    if (edition_settings.timeout_dzo4_amtz[group] != current_settings.timeout_dzo4_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)//
                  {
                    if (edition_settings.timeout_nkn_dzo[group] != current_settings.timeout_nkn_dzo[group]) found_changes = 1;
                  }

                }
                else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
                {
                  if (
                      (edition_settings.control_dzo != current_settings.control_dzo)
                     )   
                    found_changes = 1;
                }
//--------------#include "ekran/ekran_dz_1.ci"--------------------------
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_TMOZDZ)
                  {
                    if (edition_settings.timeout_zdz[group] != current_settings.timeout_zdz[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
                {
                  if (
                      (edition_settings.control_zdz != current_settings.control_zdz) ||
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                      (edition_settings.zdz_ovd_porig != current_settings.zdz_ovd_porig) ||
#endif
                      (edition_settings.ctrl_zdz_type != current_settings.ctrl_zdz_type)
                     )
                    found_changes = 1;
                       
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                 
                  //if (current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                  //{
                  //  if (edition_settings.setpoint_zz_3I0[group] != current_settings.setpoint_zz_3I0[group]) found_changes = 1;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                  //{
                  //  if (edition_settings.setpoint_zz_3U0[group] != current_settings.setpoint_zz_3U0[group]) found_changes = 1;
                  //}
                  if (current_ekran.index_position == INDEX_ML_STPMTZO1)
                  {
                    if (edition_settings.setpoint_mtzo_1[group] != current_settings.setpoint_mtzo_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzo_1_n_vpered[group] != current_settings.setpoint_mtzo_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzo_1_n_nazad[group] != current_settings.setpoint_mtzo_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzo_1_angle[group] != current_settings.setpoint_mtzo_1_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzo_1_po_napruzi[group] != current_settings.setpoint_mtzo_1_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                  {
                    if (edition_settings.setpoint_mtzo_1_U[group] != current_settings.setpoint_mtzo_1_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2)
                  {
                    if (edition_settings.setpoint_mtzo_2[group] != current_settings.setpoint_mtzo_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzo_2_n_vpered[group] != current_settings.setpoint_mtzo_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzo_2_n_nazad[group] != current_settings.setpoint_mtzo_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzo_2_angle[group] != current_settings.setpoint_mtzo_2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzo_2_po_napruzi[group] != current_settings.setpoint_mtzo_2_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                  {
                    if (edition_settings.setpoint_mtzo_2_U[group] != current_settings.setpoint_mtzo_2_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3)
                  {
                    if (edition_settings.setpoint_mtzo_3[group] != current_settings.setpoint_mtzo_3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzo_3_n_vpered[group] != current_settings.setpoint_mtzo_3_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzo_3_n_nazad[group] != current_settings.setpoint_mtzo_3_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzo_3_angle[group] != current_settings.setpoint_mtzo_3_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzo_3_po_napruzi[group] != current_settings.setpoint_mtzo_3_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                  {
                    if (edition_settings.setpoint_mtzo_3_U[group] != current_settings.setpoint_mtzo_3_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4)
                  {
                    if (edition_settings.setpoint_mtzo_4[group] != current_settings.setpoint_mtzo_4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzo_4_n_vpered[group] != current_settings.setpoint_mtzo_4_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzo_4_n_nazad[group] != current_settings.setpoint_mtzo_4_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzo_4_angle[group] != current_settings.setpoint_mtzo_4_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzo_4_po_napruzi[group] != current_settings.setpoint_mtzo_4_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                  {
                    if (edition_settings.setpoint_mtzo_4_U[group] != current_settings.setpoint_mtzo_4_U[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                 
                  //if (current_ekran.index_position == INDEX_ML_TMOZZ1_3I0)
                  //{
                  //  if (edition_settings.timeout_zz_3I0[group] != current_settings.timeout_zz_3I0[group]) found_changes = 1;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_TMOZZ1_3U0)
                  //{
                  //  if (edition_settings.timeout_zz_3U0[group] != current_settings.timeout_zz_3U0[group]) found_changes = 1;
                  //}
                  //else if (current_ekran.index_position == INDEX_ML_TMOZZ1_NZZ)
                  //{
                  //  if (edition_settings.timeout_nzz[group] != current_settings.timeout_nzz[group]) found_changes = 1;
                  //}
                  if (current_ekran.index_position == INDEX_ML_TMOMTZO1)
                  {
                    if (edition_settings.timeout_mtzo_1[group] != current_settings.timeout_mtzo_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzo_1_n_vpered[group] != current_settings.timeout_mtzo_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzo_1_n_nazad[group] != current_settings.timeout_mtzo_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzo_1_po_napruzi[group] != current_settings.timeout_mtzo_1_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2)
                  {
                    if (edition_settings.timeout_mtzo_2[group] != current_settings.timeout_mtzo_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                  {
                    if (edition_settings.timeout_mtzo_2_pr[group] != current_settings.timeout_mtzo_2_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzo_2_n_vpered[group] != current_settings.timeout_mtzo_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                  {
                    if (edition_settings.timeout_mtzo_2_n_vpered_pr[group] != current_settings.timeout_mtzo_2_n_vpered_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzo_2_n_nazad[group] != current_settings.timeout_mtzo_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                  {
                    if (edition_settings.timeout_mtzo_2_n_nazad_pr[group] != current_settings.timeout_mtzo_2_n_nazad_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzo_2_po_napruzi[group] != current_settings.timeout_mtzo_2_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                  {
                    if (edition_settings.timeout_mtzo_2_po_napruzi_pr[group] != current_settings.timeout_mtzo_2_po_napruzi_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                  {
                    if (edition_settings.timeout_mtzo_2_vvid_pr[group] != current_settings.timeout_mtzo_2_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3)
                  {
                    if (edition_settings.timeout_mtzo_3[group] != current_settings.timeout_mtzo_3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzo_3_n_vpered[group] != current_settings.timeout_mtzo_3_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzo_3_n_nazad[group] != current_settings.timeout_mtzo_3_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzo_3_po_napruzi[group] != current_settings.timeout_mtzo_3_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4)
                  {
                    if (edition_settings.timeout_mtzo_4[group] != current_settings.timeout_mtzo_4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzo_4_n_vpered[group] != current_settings.timeout_mtzo_4_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzo_4_n_nazad[group] != current_settings.timeout_mtzo_4_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzo_4_po_napruzi[group] != current_settings.timeout_mtzo_4_po_napruzi[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
                {
                  //if (edition_settings.control_zz != current_settings.control_zz) found_changes = 1;
                  if (
                      (edition_settings.control_mtzo != current_settings.control_mtzo) ||
                      (edition_settings.type_mtzo1 != current_settings.type_mtzo1) ||
                      (edition_settings.type_mtzo2 != current_settings.type_mtzo2) || 
                      (edition_settings.type_mtzo3 != current_settings.type_mtzo3) || 
                      (edition_settings.type_mtzo4 != current_settings.type_mtzo4)  
                     )   
                    found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                 
                  /*if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_1_3I0_vpered[group] != current_settings.setpoint_tznp_1_3I0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_1_3U0_vpered[group] != current_settings.setpoint_tznp_1_3U0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_1_3I0_nazad[group] != current_settings.setpoint_tznp_1_3I0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_1_3U0_nazad[group] != current_settings.setpoint_tznp_1_3U0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                  {
                    if (edition_settings.setpoint_tznp_1_angle[group] != current_settings.setpoint_tznp_1_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_2_3I0_vpered[group] != current_settings.setpoint_tznp_2_3I0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_2_3U0_vpered[group] != current_settings.setpoint_tznp_2_3U0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_2_3I0_nazad[group] != current_settings.setpoint_tznp_2_3I0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_2_3U0_nazad[group] != current_settings.setpoint_tznp_2_3U0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                  {
                    if (edition_settings.setpoint_tznp_2_angle[group] != current_settings.setpoint_tznp_2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_3_3I0_vpered[group] != current_settings.setpoint_tznp_3_3I0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                  {
                    if (edition_settings.setpoint_tznp_3_3U0_vpered[group] != current_settings.setpoint_tznp_3_3U0_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_3_3I0_nazad[group] != current_settings.setpoint_tznp_3_3I0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                  {
                    if (edition_settings.setpoint_tznp_3_3U0_nazad[group] != current_settings.setpoint_tznp_3_3U0_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                  {
                    if (edition_settings.setpoint_tznp_3_angle[group] != current_settings.setpoint_tznp_3_angle[group]) found_changes = 1;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_STPMTZR1)
                  {
                    if (edition_settings.setpoint_mtzr_1[group] != current_settings.setpoint_mtzr_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzr_1_n_vpered[group] != current_settings.setpoint_mtzr_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzr_1_n_nazad[group] != current_settings.setpoint_mtzr_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzr_1_angle[group] != current_settings.setpoint_mtzr_1_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzr_1_po_napruzi[group] != current_settings.setpoint_mtzr_1_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                  {
                    if (edition_settings.setpoint_mtzr_1_U[group] != current_settings.setpoint_mtzr_1_U[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2)
                  {
                    if (edition_settings.setpoint_mtzr_2[group] != current_settings.setpoint_mtzr_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                  {
                    if (edition_settings.setpoint_mtzr_2_n_vpered[group] != current_settings.setpoint_mtzr_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                  {
                    if (edition_settings.setpoint_mtzr_2_n_nazad[group] != current_settings.setpoint_mtzr_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                  {
                    if (edition_settings.setpoint_mtzr_2_angle[group] != current_settings.setpoint_mtzr_2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                  {
                    if (edition_settings.setpoint_mtzr_2_po_napruzi[group] != current_settings.setpoint_mtzr_2_po_napruzi[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                  {
                    if (edition_settings.setpoint_mtzr_2_U[group] != current_settings.setpoint_mtzr_2_U[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
                  
                  /*if (current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                  {
                    if (edition_settings.timeout_tznp_1_vpered[group] != current_settings.timeout_tznp_1_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                  {
                    if (edition_settings.timeout_tznp_1_nazad[group] != current_settings.timeout_tznp_1_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                  {
                    if (edition_settings.timeout_tznp_2_vpered[group] != current_settings.timeout_tznp_2_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                  {
                    if (edition_settings.timeout_tznp_2_nazad[group] != current_settings.timeout_tznp_2_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                  {
                    if (edition_settings.timeout_tznp_3_vpered[group] != current_settings.timeout_tznp_3_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                  {
                    if (edition_settings.timeout_tznp_3_nazad[group] != current_settings.timeout_tznp_3_nazad[group]) found_changes = 1;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_TMOMTZR1)
                  {
                    if (edition_settings.timeout_mtzr_1[group] != current_settings.timeout_mtzr_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzr_1_n_vpered[group] != current_settings.timeout_mtzr_1_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzr_1_n_nazad[group] != current_settings.timeout_mtzr_1_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzr_1_po_napruzi[group] != current_settings.timeout_mtzr_1_po_napruzi[group]) found_changes = 1;
                  }
                  
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2)
                  {
                    if (edition_settings.timeout_mtzr_2[group] != current_settings.timeout_mtzr_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                  {
                    if (edition_settings.timeout_mtzr_2_n_vpered[group] != current_settings.timeout_mtzr_2_n_vpered[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                  {
                    if (edition_settings.timeout_mtzr_2_n_nazad[group] != current_settings.timeout_mtzr_2_n_nazad[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                  {
                    if (edition_settings.timeout_mtzr_2_po_napruzi[group] != current_settings.timeout_mtzr_2_po_napruzi[group]) found_changes = 1;
                  }

                }
                else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
                {
                  //if (edition_settings.control_tznp != current_settings.control_mtz) found_changes = 1;
                  if (edition_settings.control_mtzr != current_settings.control_mtzr) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_TMOAPV1)
                  {
                    if (edition_settings.timeout_apv_1[group] != current_settings.timeout_apv_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV2)
                  {
                    if (edition_settings.timeout_apv_2[group] != current_settings.timeout_apv_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV3)
                  {
                    if (edition_settings.timeout_apv_3[group] != current_settings.timeout_apv_3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV4)
                  {
                    if (edition_settings.timeout_apv_4[group] != current_settings.timeout_apv_4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                  {
                    if (edition_settings.timeout_apv_block_vid_apv1[group] != current_settings.timeout_apv_block_vid_apv1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                  {
                    if (edition_settings.timeout_apv_block_vid_apv2[group] != current_settings.timeout_apv_block_vid_apv2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                  {
                    if (edition_settings.timeout_apv_block_vid_apv3[group] != current_settings.timeout_apv_block_vid_apv3[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                  {
                    if (edition_settings.timeout_apv_block_vid_apv4[group] != current_settings.timeout_apv_block_vid_apv4[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                  {
                    if (edition_settings.timeout_apv_block_vid_VV[group] != current_settings.timeout_apv_block_vid_VV[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_APV)
                {
                  if (edition_settings.control_apv != current_settings.control_apv) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                  {
                    if (edition_settings.setpoint_achr_chapv_uf[group] != current_settings.setpoint_achr_chapv_uf[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                  {
                    if (edition_settings.setpoint_achr1_f_rab[group] != current_settings.setpoint_achr1_f_rab[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                  {
                    if (edition_settings.setpoint_chapv1_f_rab[group] != current_settings.setpoint_chapv1_f_rab[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                  {
                    if (edition_settings.setpoint_achr2_f_rab[group] != current_settings.setpoint_achr2_f_rab[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                  {
                    if (edition_settings.setpoint_chapv2_f_rab[group] != current_settings.setpoint_chapv2_f_rab[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOACHR1)
                  {
                    if (edition_settings.timeout_achr_1[group] != current_settings.timeout_achr_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                  {
                    if (edition_settings.timeout_chapv_1[group] != current_settings.timeout_chapv_1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOACHR2)
                  {
                    if (edition_settings.timeout_achr_2[group] != current_settings.timeout_achr_2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                  {
                    if (edition_settings.timeout_chapv_2[group] != current_settings.timeout_chapv_2[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
                {
                  if (edition_settings.control_achr_chapv != current_settings.control_achr_chapv) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
                 
                  if (edition_settings.setpoint_urov[group] != current_settings.setpoint_urov[group]) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_TMOUROV1)
                  {
                    if (edition_settings.timeout_urov_1[group] != current_settings.timeout_urov_1[group]) found_changes = 1;
                  }
                  else
                  {
                    if (edition_settings.timeout_urov_2[group] != current_settings.timeout_urov_2[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
                {
                  if (edition_settings.control_urov != current_settings.control_urov) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
                 
                  //!if (edition_settings.setpoint_zop[group] != current_settings.setpoint_zop[group]) found_changes = 1;
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                  {
                    if (edition_settings.pickup_dzr_Io3g_Io1g[group] != current_settings.pickup_dzr_Io3g_Io1g[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1)
                  {
                    if (edition_settings.pickup_dzr1[group] != current_settings.pickup_dzr1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                  {
                    if (edition_settings.pickup_dzr1_amtz[group] != current_settings.pickup_dzr1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                  {
                    if (edition_settings.pickup_dzr1_blkI[group] != current_settings.pickup_dzr1_blkI[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                  {
                    if (edition_settings.pickup_dzr2_angle[group] != current_settings.pickup_dzr2_angle[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                  {
                    if (edition_settings.pickup_dzr2_dir[group] != current_settings.pickup_dzr2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                  {
                    if (edition_settings.pickup_dzr2_inv[group] != current_settings.pickup_dzr2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                  {
                    if (edition_settings.pickup_dzr2_amtz[group] != current_settings.pickup_dzr2_amtz[group]) found_changes = 1;
                  }

                  else if (
                           (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H) ||
                           (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                          )   
                  {
                    if (
                        (edition_settings.pickup_dzr3_angle_h[group] != current_settings.pickup_dzr3_angle_h[group]) ||
                        (edition_settings.pickup_dzr3_angle_l[group] != current_settings.pickup_dzr3_angle_l[group])
                       )found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                  {
                    if (edition_settings.pickup_dzr3_dir[group] != current_settings.pickup_dzr3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                  {
                    if (edition_settings.pickup_dzr3_inv[group] != current_settings.pickup_dzr3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                  {
                    if (edition_settings.pickup_dzr3_amtz[group] != current_settings.pickup_dzr3_amtz[group]) found_changes = 1;
                  }

                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
                 
                  //!if (edition_settings.timeout_zop[group] != current_settings.timeout_zop[group]) found_changes = 1;
                   if (current_ekran.index_position == INDEX_ML_TMO_DZR1)//
                  {
                    if (edition_settings.timeout_dzr1[group] != current_settings.timeout_dzr1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)//
                  {
                    if (edition_settings.timeout_dzr1_amtz[group] != current_settings.timeout_dzr1_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)//
                  {
                    if (edition_settings.timeout_dzr2_dir[group] != current_settings.timeout_dzr2_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)//
                  {
                    if (edition_settings.timeout_dzr2_dir_pr[group] != current_settings.timeout_dzr2_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)//
                  {
                    if (edition_settings.timeout_dzr2_inv[group] != current_settings.timeout_dzr2_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)//
                  {
                    if (edition_settings.timeout_dzr2_inv_pr[group] != current_settings.timeout_dzr2_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)//
                  {
                    if (edition_settings.timeout_dzr2_amtz[group] != current_settings.timeout_dzr2_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)//
                  {
                    if (edition_settings.timeout_dzr2_amtz_pr[group] != current_settings.timeout_dzr2_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzr2_vvid_pr[group] != current_settings.timeout_dzr2_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzr2_amtz_vvid_pr[group] != current_settings.timeout_dzr2_amtz_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)//
                  {
                    if (edition_settings.timeout_dzr3_dir[group] != current_settings.timeout_dzr3_dir[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)//
                  {
                    if (edition_settings.timeout_dzr3_dir_pr[group] != current_settings.timeout_dzr3_dir_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)//
                  {
                    if (edition_settings.timeout_dzr3_inv[group] != current_settings.timeout_dzr3_inv[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)//
                  {
                    if (edition_settings.timeout_dzr3_inv_pr[group] != current_settings.timeout_dzr3_inv_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)//
                  {
                    if (edition_settings.timeout_dzr3_amtz[group] != current_settings.timeout_dzr3_amtz[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)//
                  {
                    if (edition_settings.timeout_dzr3_amtz_pr[group] != current_settings.timeout_dzr3_amtz_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzr3_vvid_pr[group] != current_settings.timeout_dzr3_vvid_pr[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)//
                  {
                    if (edition_settings.timeout_dzr3_amtz_vvid_pr[group] != current_settings.timeout_dzr3_amtz_vvid_pr[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
                {
                  //!if (edition_settings.control_zop != current_settings.control_zop) found_changes = 1;
                  if (edition_settings.control_dzr != current_settings.control_dzr) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_STPUMIN1)
                  {
                    if (edition_settings.setpoint_Umin1[group] != current_settings.setpoint_Umin1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                  {
                    if (edition_settings.setpoint_Umin1_Iblk[group] != current_settings.setpoint_Umin1_Iblk[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2)
                  {
                    if (edition_settings.setpoint_Umin2[group] != current_settings.setpoint_Umin2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                  {
                    if (edition_settings.setpoint_Umin2_Iblk[group] != current_settings.setpoint_Umin2_Iblk[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMIN1)
                  {
                    if (edition_settings.timeout_Umin1[group] != current_settings.timeout_Umin1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMIN2)
                  {
                    if (edition_settings.timeout_Umin2[group] != current_settings.timeout_Umin2[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
                {
                  if (edition_settings.control_Umin != current_settings.control_Umin) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                 
                  if (current_ekran.index_position == INDEX_ML_STPUMAX1)
                  {
                    if (edition_settings.setpoint_Umax1[group] != current_settings.setpoint_Umax1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMAX2)
                  {
                    if (edition_settings.setpoint_Umax2[group] != current_settings.setpoint_Umax2[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                  {
                    if (edition_settings.setpoint_kp_Umax[group] != current_settings.setpoint_kp_Umax[group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMAX1)
                  {
                    if (edition_settings.timeout_Umax1[group] != current_settings.timeout_Umax1[group]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMAX2)
                  {
                    if (edition_settings.timeout_Umax2[group] != current_settings.timeout_Umax2[group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
                {
                  if (edition_settings.control_Umax != current_settings.control_Umax) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                  if (_n_index == INDEX_ML_STP_UP)
                  {
                    if (edition_settings.setpoint_UP[_n_UP][0][group] != current_settings.setpoint_UP[_n_UP][0][group]) found_changes = 1;
                  }
                  else if (_n_index == INDEX_ML_STP_UP_KP)
                  {
                    if (edition_settings.setpoint_UP_KP[_n_UP][0][group] != current_settings.setpoint_UP_KP[_n_UP][0][group]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                       )
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_TIMEOUT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;
                  if (_n_index == INDEX_ML_TMOUP)
                  {
                    if (edition_settings.timeout_UP[_n_UP][0][group] != current_settings.timeout_UP[_n_UP][0][group]) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UP)
                {
                  if (edition_settings.control_UP != current_settings.control_UP) found_changes = 1;
                  else
                  {
                    for (size_t i = 0; ((i < NUMBER_UP) && (found_changes == 0)); i++)
                    {
                      if (edition_settings.ctrl_UP_input[i] != current_settings.ctrl_UP_input[i]) found_changes = 1;
                    }
                  }
                       
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
                {
                  if (current_ekran.index_position == INDEX_ML_T_BP)
                  {
                    if (edition_settings.Tbp != current_settings.Tbp) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_T_MN)
                  {
                    if (edition_settings.Tmn != current_settings.Tmn) found_changes = 1;
                  }
                  else
                  {
                    if (edition_settings.TVoltage != current_settings.TVoltage) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
                {
                  if (edition_settings.control_transformator != current_settings.control_transformator) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_STPInom)
                  {
                    if (edition_settings.setpoint_Inom != current_settings.setpoint_Inom) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                  {
                    if (edition_settings.setpoint_r_kom_st_Inom != current_settings.setpoint_r_kom_st_Inom) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                  {
                    if (edition_settings.setpoint_Inom_vymk != current_settings.setpoint_Inom_vymk) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                  {
                    if (edition_settings.setpoint_r_kom_st_Inom_vymk != current_settings.setpoint_r_kom_st_Inom_vymk) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                  {
                    if (edition_settings.setpoint_pochatkovyj_resurs != current_settings.setpoint_pochatkovyj_resurs) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                  {
                    if (edition_settings.setpoint_krytychnyj_resurs != current_settings.setpoint_krytychnyj_resurs) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                  {
                    if (edition_settings.setpoint_pochatkova_k_vymk != current_settings.setpoint_pochatkova_k_vymk) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    if (edition_settings.timeout_swch_on != current_settings.timeout_swch_on) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    if (edition_settings.timeout_swch_off != current_settings.timeout_swch_off) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    if (edition_settings.timeout_swch_udl_blk_on != current_settings.timeout_swch_udl_blk_on) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    if (edition_settings.timeout_pryvoda_VV != current_settings.timeout_pryvoda_VV) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
                {
                  if (edition_settings.control_switch != current_settings.control_switch) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                        (current_ekran.current_level  < (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H;
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    if (edition_settings.timeout_swch_on_[on_off] != current_settings.timeout_swch_on_[on_off]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    if (edition_settings.timeout_swch_off_[on_off] != current_settings.timeout_swch_off_[on_off]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    if (edition_settings.timeout_swch_udl_blk_on_[on_off] != current_settings.timeout_swch_udl_blk_on_[on_off]) found_changes = 1;
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    if (edition_settings.timeout_pryvoda_VV_[on_off] != current_settings.timeout_pryvoda_VV_[on_off]) found_changes = 1;
                  }
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                        (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_CONTROL_SWITCH_H;
                  if (edition_settings.control_switch_[on_off] != current_settings.control_switch_[on_off]) found_changes = 1;
                }
                else if(
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                       )   
                {
                  int forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
                  
                  if (current_ekran.index_position == INDEX_ML_LINES)
                  {
                    if (edition_settings.lines[forward_backward] != current_settings.lines[forward_backward]) found_changes = 1;
                  }
                  else
                  {
                    int _tmp = current_ekran.index_position - 1;
                    int dilanka = _tmp >> 1;
                    if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                    {
                      if (edition_settings.dovgyna[forward_backward][dilanka] != current_settings.dovgyna[forward_backward][dilanka]) found_changes = 1;
                    }
                    else
                    {
                      if (edition_settings.opir[forward_backward][dilanka] != current_settings.opir[forward_backward][dilanka]) found_changes = 1;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
                {
                  if (edition_settings.control_vmp != current_settings.control_vmp) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
                {
                  if (edition_settings.dopusk_dv[current_ekran.index_position] != current_settings.dopusk_dv[current_ekran.index_position])
                    found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                {
                  if (edition_settings.type_of_input != current_settings.type_of_input) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV)
                {
                  if (edition_settings.type_of_input_signal != current_settings.type_of_input_signal) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
                {
                  if (
                      (edition_settings.type_of_output       != current_settings.type_of_output      ) ||
                      (edition_settings.type_of_output_modif != current_settings.type_of_output_modif)
                     ) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
                {
                  if (edition_settings.type_of_led != current_settings.type_of_led) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
                {
                  if (edition_settings.buttons_mode != current_settings.buttons_mode) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_ADDRESS)
                {
                  unsigned int edit_value = edition_settings.address;
                  if (edit_value != current_settings.address) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
                {
                  if (edition_settings.speed_RS485 != current_settings.speed_RS485) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
                {
                  if (edition_settings.pare_bit_RS485 != current_settings.pare_bit_RS485) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
                {
                  if (edition_settings.number_stop_bit_RS485 != current_settings.number_stop_bit_RS485) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
                {
                  if (edition_settings.time_out_1_RS485 != current_settings.time_out_1_RS485) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TIME_ZONE)
                {
                  if (
                      (edition_settings.time_zone != current_settings.time_zone) ||
                      (edition_settings.dst != current_settings.dst)
                     )found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_DST_RULE)
                {
                  if (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON)
                  {
                    if (edition_settings.dst_on_rule != current_settings.dst_on_rule)  found_changes = 1;
                  }
                  else
                  {
                    if (edition_settings.dst_off_rule != current_settings.dst_off_rule)  found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
                {
                  if (current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                  {
                    if (edition_settings.number_iteration_el != current_settings.number_iteration_el) found_changes = 1;
                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                  {
//                    if (edition_settings.number_defined_df != current_settings.number_defined_df) found_changes = 1;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                  {
//                    if (edition_settings.number_defined_dt != current_settings.number_defined_dt) found_changes = 1;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                  {
//                    if (edition_settings.number_defined_and != current_settings.number_defined_and) found_changes = 1;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                  {
//                    if (edition_settings.number_defined_or != current_settings.number_defined_or) found_changes = 1;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                  {
//                    if (edition_settings.number_defined_xor != current_settings.number_defined_xor) found_changes = 1;
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                  {
//                    if (edition_settings.number_defined_not != current_settings.number_defined_not) found_changes = 1;
//                  }
                }
                else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
                {
                  if (edition_settings.type_df != current_settings.type_df) found_changes = 1;
                }
                else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                  {
                    if (edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] != 
                        current_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1])
                      found_changes = 1;
                  }
                  else
                  {
                    if (edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] != 
                        current_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1])
                      found_changes = 1;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
                {
                  if (edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] != current_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1]) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_ELONGATION)
                  {
                    if (edition_settings.timeout_prolongation_work_digital_registrator != current_settings.timeout_prolongation_work_digital_registrator) found_changes = 1;
                  }

                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  {
                    if (edition_settings.prefault_number_periods != current_settings.prefault_number_periods) found_changes = 1;
                  }
                  else
                  {
                    if (edition_settings.postfault_number_periods != current_settings.postfault_number_periods) found_changes = 1;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_AR)
                {
                  if (edition_settings.control_ar != current_settings.control_ar) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
                {
                  if (edition_settings.language != current_settings.language) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
                {
                  if (edition_settings.control_extra_settings_1 != current_settings.control_extra_settings_1) found_changes = 1;
                }
                else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
                {
                  if (edition_settings.grupa_ustavok != current_settings.grupa_ustavok) found_changes = 1;
                }

                //Виходимо з режиму редагування
                if (found_changes == 0) current_ekran.edition = 0;
                else current_ekran.edition = 2;

                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 2)
              {
                //Попередньо виставляємо повідомлення, що дані не достовірні
                current_ekran.edition = 3;
                //Перевіряємо достовірність даних
                if(
                   (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                   (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                  )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1[group], SETPOINT_MTZ1_MIN, SETPOINT_MTZ1_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1[group] != current_settings.setpoint_mtz_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_1[group] = edition_settings.setpoint_mtz_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1_n_vpered[group], SETPOINT_MTZ1_N_VPERED_MIN, SETPOINT_MTZ1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1_n_vpered[group] != current_settings.setpoint_mtz_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_1_n_vpered[group] = edition_settings.setpoint_mtz_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1_n_nazad[group], SETPOINT_MTZ1_N_NAZAD_MIN, SETPOINT_MTZ1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1_n_nazad[group] != current_settings.setpoint_mtz_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_1_n_nazad[group] = edition_settings.setpoint_mtz_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1_angle[group], SETPOINT_MTZ1_ANGLE_MIN, SETPOINT_MTZ1_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1_angle[group] != current_settings.setpoint_mtz_1_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtz_1_angle[group];
                        current_settings.setpoint_mtz_1_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtz_1_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtz_1_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1_po_napruzi[group], SETPOINT_MTZ1_PO_NAPRUZI_MIN, SETPOINT_MTZ1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1_po_napruzi[group] != current_settings.setpoint_mtz_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_1_po_napruzi[group] = edition_settings.setpoint_mtz_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_1_U[group], SETPOINT_MTZ1_U_MIN, SETPOINT_MTZ1_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_1_U[group] != current_settings.setpoint_mtz_1_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_1_U[group] = edition_settings.setpoint_mtz_1_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2[group], SETPOINT_MTZ2_MIN, SETPOINT_MTZ2_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2[group] != current_settings.setpoint_mtz_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_2[group] = edition_settings.setpoint_mtz_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2_n_vpered[group], SETPOINT_MTZ2_N_VPERED_MIN, SETPOINT_MTZ2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2_n_vpered[group] != current_settings.setpoint_mtz_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_2_n_vpered[group] = edition_settings.setpoint_mtz_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2_n_nazad[group], SETPOINT_MTZ2_N_NAZAD_MIN, SETPOINT_MTZ2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2_n_nazad[group] != current_settings.setpoint_mtz_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_2_n_nazad[group] = edition_settings.setpoint_mtz_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2_angle[group], SETPOINT_MTZ2_ANGLE_MIN, SETPOINT_MTZ2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2_angle[group] != current_settings.setpoint_mtz_2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtz_2_angle[group];
                        current_settings.setpoint_mtz_2_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtz_2_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtz_2_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2_po_napruzi[group], SETPOINT_MTZ2_PO_NAPRUZI_MIN, SETPOINT_MTZ2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2_po_napruzi[group] != current_settings.setpoint_mtz_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_2_po_napruzi[group] = edition_settings.setpoint_mtz_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_2_U[group], SETPOINT_MTZ2_U_MIN, SETPOINT_MTZ2_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_2_U[group] != current_settings.setpoint_mtz_2_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_2_U[group] = edition_settings.setpoint_mtz_2_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3[group], SETPOINT_MTZ3_MIN, SETPOINT_MTZ3_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3[group] != current_settings.setpoint_mtz_3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_3[group] = edition_settings.setpoint_mtz_3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3_n_vpered[group], SETPOINT_MTZ3_N_VPERED_MIN, SETPOINT_MTZ3_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3_n_vpered[group] != current_settings.setpoint_mtz_3_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_3_n_vpered[group] = edition_settings.setpoint_mtz_3_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3_n_nazad[group], SETPOINT_MTZ3_N_NAZAD_MIN, SETPOINT_MTZ3_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3_n_nazad[group] != current_settings.setpoint_mtz_3_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_3_n_nazad[group] = edition_settings.setpoint_mtz_3_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3_angle[group], SETPOINT_MTZ3_ANGLE_MIN, SETPOINT_MTZ3_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3_angle[group] != current_settings.setpoint_mtz_3_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtz_3_angle[group];
                        current_settings.setpoint_mtz_3_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtz_3_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtz_3_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3_po_napruzi[group], SETPOINT_MTZ3_PO_NAPRUZI_MIN, SETPOINT_MTZ3_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3_po_napruzi[group] != current_settings.setpoint_mtz_3_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_3_po_napruzi[group] = edition_settings.setpoint_mtz_3_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_3_U[group], SETPOINT_MTZ3_U_MIN, SETPOINT_MTZ3_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_3_U[group] != current_settings.setpoint_mtz_3_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_3_U[group] = edition_settings.setpoint_mtz_3_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4[group], SETPOINT_MTZ4_MIN, SETPOINT_MTZ4_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4[group] != current_settings.setpoint_mtz_4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_4[group] = edition_settings.setpoint_mtz_4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4_n_vpered[group], SETPOINT_MTZ4_N_VPERED_MIN, SETPOINT_MTZ4_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4_n_vpered[group] != current_settings.setpoint_mtz_4_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_4_n_vpered[group] = edition_settings.setpoint_mtz_4_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4_n_nazad[group], SETPOINT_MTZ4_N_NAZAD_MIN, SETPOINT_MTZ4_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4_n_nazad[group] != current_settings.setpoint_mtz_4_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_4_n_nazad[group] = edition_settings.setpoint_mtz_4_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4_angle[group], SETPOINT_MTZ4_ANGLE_MIN, SETPOINT_MTZ4_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4_angle[group] != current_settings.setpoint_mtz_4_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtz_4_angle[group];
                        current_settings.setpoint_mtz_4_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtz_4_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtz_4_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4_po_napruzi[group], SETPOINT_MTZ4_PO_NAPRUZI_MIN, SETPOINT_MTZ4_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4_po_napruzi[group] != current_settings.setpoint_mtz_4_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_4_po_napruzi[group] = edition_settings.setpoint_mtz_4_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtz_4_U[group], SETPOINT_MTZ4_U_MIN, SETPOINT_MTZ4_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtz_4_U[group] != current_settings.setpoint_mtz_4_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtz_4_U[group] = edition_settings.setpoint_mtz_4_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOMTZ1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_1[group], TIMEOUT_MTZ1_MIN, TIMEOUT_MTZ1_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_1[group] != current_settings.timeout_mtz_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_1[group] = edition_settings.timeout_mtz_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_1_n_vpered[group], TIMEOUT_MTZ1_N_VPERED_MIN, TIMEOUT_MTZ1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_1_n_vpered[group] != current_settings.timeout_mtz_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_1_n_vpered[group] = edition_settings.timeout_mtz_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_1_n_nazad[group], TIMEOUT_MTZ1_N_NAZAD_MIN, TIMEOUT_MTZ1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_1_n_nazad[group] != current_settings.timeout_mtz_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_1_n_nazad[group] = edition_settings.timeout_mtz_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_1_po_napruzi[group], TIMEOUT_MTZ1_PO_NAPRUZI_MIN, TIMEOUT_MTZ1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_1_po_napruzi[group] != current_settings.timeout_mtz_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_1_po_napruzi[group] = edition_settings.timeout_mtz_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2[group], TIMEOUT_MTZ2_MIN, TIMEOUT_MTZ2_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2[group] != current_settings.timeout_mtz_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2[group] = edition_settings.timeout_mtz_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_pr[group], TIMEOUT_MTZ2_PR_MIN, TIMEOUT_MTZ2_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_pr[group] != current_settings.timeout_mtz_2_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_pr[group] = edition_settings.timeout_mtz_2_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_n_vpered[group], TIMEOUT_MTZ2_N_VPERED_MIN, TIMEOUT_MTZ2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_n_vpered[group] != current_settings.timeout_mtz_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_n_vpered[group] = edition_settings.timeout_mtz_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_n_vpered_pr[group], TIMEOUT_MTZ2_N_VPERED_PR_MIN, TIMEOUT_MTZ2_N_VPERED_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_n_vpered_pr[group] != current_settings.timeout_mtz_2_n_vpered_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_n_vpered_pr[group] = edition_settings.timeout_mtz_2_n_vpered_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_n_nazad[group], TIMEOUT_MTZ2_N_NAZAD_MIN, TIMEOUT_MTZ2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_n_nazad[group] != current_settings.timeout_mtz_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_n_nazad[group] = edition_settings.timeout_mtz_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_n_nazad_pr[group], TIMEOUT_MTZ2_N_NAZAD_PR_MIN, TIMEOUT_MTZ2_N_NAZAD_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_n_nazad_pr[group] != current_settings.timeout_mtz_2_n_nazad_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_n_nazad_pr[group] = edition_settings.timeout_mtz_2_n_nazad_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_po_napruzi[group], TIMEOUT_MTZ2_PO_NAPRUZI_MIN, TIMEOUT_MTZ2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_po_napruzi[group] != current_settings.timeout_mtz_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_po_napruzi[group] = edition_settings.timeout_mtz_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_po_napruzi_pr[group], TIMEOUT_MTZ2_PO_NAPRUZI_PR_MIN, TIMEOUT_MTZ2_PO_NAPRUZI_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_po_napruzi_pr[group] != current_settings.timeout_mtz_2_po_napruzi_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_po_napruzi_pr[group] = edition_settings.timeout_mtz_2_po_napruzi_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_2_vvid_pr[group], TIMEOUT_MTZ2_VVID_PR_MIN, TIMEOUT_MTZ2_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_2_vvid_pr[group] != current_settings.timeout_mtz_2_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_2_vvid_pr[group] = edition_settings.timeout_mtz_2_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_3[group], TIMEOUT_MTZ3_MIN, TIMEOUT_MTZ3_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_3[group] != current_settings.timeout_mtz_3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_3[group] = edition_settings.timeout_mtz_3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_3_n_vpered[group], TIMEOUT_MTZ3_N_VPERED_MIN, TIMEOUT_MTZ3_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_3_n_vpered[group] != current_settings.timeout_mtz_3_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_3_n_vpered[group] = edition_settings.timeout_mtz_3_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_3_n_nazad[group], TIMEOUT_MTZ3_N_NAZAD_MIN, TIMEOUT_MTZ3_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_3_n_nazad[group] != current_settings.timeout_mtz_3_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_3_n_nazad[group] = edition_settings.timeout_mtz_3_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_3_po_napruzi[group], TIMEOUT_MTZ3_PO_NAPRUZI_MIN, TIMEOUT_MTZ3_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_3_po_napruzi[group] != current_settings.timeout_mtz_3_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_3_po_napruzi[group] = edition_settings.timeout_mtz_3_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_4[group], TIMEOUT_MTZ4_MIN, TIMEOUT_MTZ4_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_4[group] != current_settings.timeout_mtz_4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_4[group] = edition_settings.timeout_mtz_4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_4_n_vpered[group], TIMEOUT_MTZ4_N_VPERED_MIN, TIMEOUT_MTZ4_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_4_n_vpered[group] != current_settings.timeout_mtz_4_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_4_n_vpered[group] = edition_settings.timeout_mtz_4_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_4_n_nazad[group], TIMEOUT_MTZ4_N_NAZAD_MIN, TIMEOUT_MTZ4_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_4_n_nazad[group] != current_settings.timeout_mtz_4_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_4_n_nazad[group] = edition_settings.timeout_mtz_4_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtz_4_po_napruzi[group], TIMEOUT_MTZ4_PO_NAPRUZI_MIN, TIMEOUT_MTZ4_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtz_4_po_napruzi[group] != current_settings.timeout_mtz_4_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtz_4_po_napruzi[group] = edition_settings.timeout_mtz_4_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
                {
                  if (
                      ((edition_settings.control_mtz  & ((unsigned int)(~CTR_MTZ_MASKA))) == 0) &&
                      (edition_settings.type_mtz1 <= TYPE_MTZ_VOLTAGE        ) &&
                      (edition_settings.type_mtz2 <= TYPE_MTZ_DEPENDENT_RTV_I) &&
                      (edition_settings.type_mtz3 <= TYPE_MTZ_VOLTAGE        ) &&
                      (edition_settings.type_mtz4 <= TYPE_MTZ_VOLTAGE        )
                     )   
                  {
                    if (
                        (edition_settings.control_mtz != current_settings.control_mtz) ||
                        (edition_settings.type_mtz1 != current_settings.type_mtz1) ||
                        (edition_settings.type_mtz2 != current_settings.type_mtz2) || 
                        (edition_settings.type_mtz3 != current_settings.type_mtz3) || 
                        (edition_settings.type_mtz4 != current_settings.type_mtz4)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.type_mtz1 = edition_settings.type_mtz1;
                      current_settings.type_mtz2 = edition_settings.type_mtz2;
                      current_settings.type_mtz3 = edition_settings.type_mtz3;
                      current_settings.type_mtz4 = edition_settings.type_mtz4;
                      current_settings.control_mtz = edition_settings.control_mtz;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
//++++++++++++++#include "ekran/ekran_dz_2.ci"++++++++++++++++++++
                //Перевіряємо достовірність даних
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                  #ifdef  DZ_NOT_DZO
                  if (current_ekran.index_position == INDEX_ML_STP_K_DZ)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dz_k[group], PICKUP_DZ_K_MIN, PICKUP_DZ_K_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz_k[group] != current_settings.pickup_dz_k[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz_k[group] = edition_settings.pickup_dz_k[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1)
                  {
                   if (check_data_setpoint(edition_settings.pickup_dz1[group], PICKUP_DZ1_MIN, PICKUP_DZ1_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz1[group] != current_settings.pickup_dz1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz1[group] = edition_settings.pickup_dz1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1_AMTZ)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dz1_amtz[group], PICKUP_DZ1_AMTZ_MIN, PICKUP_DZ1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz1_amtz[group] != current_settings.pickup_dz1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz1_amtz[group] = edition_settings.pickup_dz1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_ANGLE)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz2_angle[group], PICKUP_DZ2_ANGLE_MIN, PICKUP_DZ2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz2_angle[group] != current_settings.pickup_dz2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        int angle = edition_settings.pickup_dz2_angle[group];
                        current_settings.pickup_dz2_angle[group] = angle;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.pickup_dz2_angle_cos1[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz2_angle_sin1[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz2_angle_cos2[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        current_settings.pickup_dz2_angle_sin2[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz2_dir[group], PICKUP_DZ2_DIR_MIN, PICKUP_DZ2_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz2_dir[group] != current_settings.pickup_dz2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz2_dir[group] = edition_settings.pickup_dz2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz2_inv[group], PICKUP_DZ2_INV_MIN, PICKUP_DZ2_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz2_inv[group] != current_settings.pickup_dz2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz2_inv[group] = edition_settings.pickup_dz2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz2_amtz[group], PICKUP_DZ2_AMTZ_MIN, PICKUP_DZ2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz2_amtz[group] != current_settings.pickup_dz2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz2_amtz[group] = edition_settings.pickup_dz2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_ANGLE)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz3_angle[group], PICKUP_DZ3_ANGLE_MIN, PICKUP_DZ3_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz3_angle[group] != current_settings.pickup_dz3_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;

                        int angle = edition_settings.pickup_dz3_angle[group];
                        current_settings.pickup_dz3_angle[group] = angle;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.pickup_dz3_angle_cos1[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz3_angle_sin1[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz3_angle_cos2[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        current_settings.pickup_dz3_angle_sin2[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz3_dir[group], PICKUP_DZ3_DIR_MIN, PICKUP_DZ3_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz3_dir[group] != current_settings.pickup_dz3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz3_dir[group] = edition_settings.pickup_dz3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz3_inv[group], PICKUP_DZ3_INV_MIN, PICKUP_DZ3_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz3_inv[group] != current_settings.pickup_dz3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz3_inv[group] = edition_settings.pickup_dz3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz3_amtz[group], PICKUP_DZ3_AMTZ_MIN, PICKUP_DZ3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz3_amtz[group] != current_settings.pickup_dz3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz3_amtz[group] = edition_settings.pickup_dz3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }


                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_ANGLE)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz4_angle[group], PICKUP_DZ4_ANGLE_MIN, PICKUP_DZ4_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz4_angle[group] != current_settings.pickup_dz4_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        int angle = edition_settings.pickup_dz4_angle[group];
                        current_settings.pickup_dz4_angle[group] = angle;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.pickup_dz4_angle_cos1[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz4_angle_sin1[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dz4_angle_cos2[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        current_settings.pickup_dz4_angle_sin2[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz4_dir[group], PICKUP_DZ4_DIR_MIN, PICKUP_DZ4_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz4_dir[group] != current_settings.pickup_dz4_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz4_dir[group] = edition_settings.pickup_dz4_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz4_inv[group], PICKUP_DZ4_INV_MIN, PICKUP_DZ4_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz4_inv[group] != current_settings.pickup_dz4_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz4_inv[group] = edition_settings.pickup_dz4_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dz4_amtz[group], PICKUP_DZ4_AMTZ_MIN, PICKUP_DZ4_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dz4_amtz[group] != current_settings.pickup_dz4_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dz4_amtz[group] = edition_settings.pickup_dz4_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  #endif //DZ_NOT_DZO
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzo_Io3g_Io1g[group], PICKUP_DZO_K_3G_DIV_1G_MIN, PICKUP_DZO_K_3G_DIV_1G_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo_Io3g_Io1g[group] != current_settings.pickup_dzo_Io3g_Io1g[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo_Io3g_Io1g[group] = edition_settings.pickup_dzo_Io3g_Io1g[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1)
                  {
                   if (check_data_setpoint(edition_settings.pickup_dzo1[group], PICKUP_DZO1_MIN, PICKUP_DZO1_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo1[group] != current_settings.pickup_dzo1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo1[group] = edition_settings.pickup_dzo1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzo1_amtz[group], PICKUP_DZO1_AMTZ_MIN, PICKUP_DZO1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo1_amtz[group] != current_settings.pickup_dzo1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo1_amtz[group] = edition_settings.pickup_dzo1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzo1_blkI[group], PICKUP_DZO1_BLKI_MIN, PICKUP_DZO1_BLKI_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo1_blkI[group] != current_settings.pickup_dzo1_blkI[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo1_blkI[group] = edition_settings.pickup_dzo1_blkI[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo2_angle[group], PICKUP_DZO2_ANGLE_MIN, PICKUP_DZO2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo2_angle[group] != current_settings.pickup_dzo2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        int angle = edition_settings.pickup_dzo2_angle[group];
                        current_settings.pickup_dzo2_angle[group] = angle;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.pickup_dzo2_angle_cos1[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dzo2_angle_sin1[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dzo2_angle_cos2[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        current_settings.pickup_dzo2_angle_sin2[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo2_dir[group], PICKUP_DZO2_DIR_MIN, PICKUP_DZO2_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo2_dir[group] != current_settings.pickup_dzo2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo2_dir[group] = edition_settings.pickup_dzo2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo2_inv[group], PICKUP_DZO2_INV_MIN, PICKUP_DZO2_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo2_inv[group] != current_settings.pickup_dzo2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo2_inv[group] = edition_settings.pickup_dzo2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo2_amtz[group], PICKUP_DZO2_AMTZ_MIN, PICKUP_DZO2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo2_amtz[group] != current_settings.pickup_dzo2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo2_amtz[group] = edition_settings.pickup_dzo2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (
                           (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H) ||
                           (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                          )   
                  {
                    if (
                        (check_data_setpoint_sign(edition_settings.pickup_dzo3_angle_h[group], PICKUP_DZO3_ANGLE_H_MIN, PICKUP_DZO3_ANGLE_H_MAX) == 1) &&
                        (check_data_setpoint_sign(edition_settings.pickup_dzo3_angle_l[group], PICKUP_DZO3_ANGLE_L_MIN, PICKUP_DZO3_ANGLE_L_MAX) == 1)
                       )   
                    {
                      int32_t diffPhi = edition_settings.pickup_dzo3_angle_h[group] - edition_settings.pickup_dzo3_angle_l[group];
                      while (diffPhi <    0) diffPhi += 360;
                      while (diffPhi >= 360) diffPhi -= 360;
                      
                      if (check_data_setpoint_sign(diffPhi, PICKUP_DZO3_ANGLE_DIFF_MIN, PICKUP_DZO3_ANGLE_DIFF_MAX) == 1)
                      {
                        if (
                            (edition_settings.pickup_dzo3_angle_h[group] != current_settings.pickup_dzo3_angle_h[group]) ||
                            (edition_settings.pickup_dzo3_angle_l[group] != current_settings.pickup_dzo3_angle_l[group])
                           )   
                        {
                          //Помічаємо, що поле структури зараз буде змінене
                          changed_settings = CHANGED_ETAP_EXECUTION;

                          //Верхня границя
                          int angle = edition_settings.pickup_dzo3_angle_h[group];
                          current_settings.pickup_dzo3_angle_h[group] = angle;

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          float angle_f = (float)angle;
                          current_settings.pickup_dzo3_angle_cos1_h[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzo3_angle_sin1_h[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzo3_angle_cos2_h[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                          current_settings.pickup_dzo3_angle_sin2_h[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                          //Нижня границя
                          angle = edition_settings.pickup_dzo3_angle_l[group];
                          current_settings.pickup_dzo3_angle_l[group] = angle;

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          angle_f = (float)angle;
                          current_settings.pickup_dzo3_angle_cos1_l[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzo3_angle_sin1_l[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzo3_angle_cos2_l[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                          current_settings.pickup_dzo3_angle_sin2_l[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          fix_change_settings(0, 1);
                        }
                        //Виходимо з режиму редагування
                        current_ekran.edition = 0;
                      }
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo3_dir[group], PICKUP_DZO3_DIR_MIN, PICKUP_DZO3_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo3_dir[group] != current_settings.pickup_dzo3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo3_dir[group] = edition_settings.pickup_dzo3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo3_inv[group], PICKUP_DZO3_INV_MIN, PICKUP_DZO3_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo3_inv[group] != current_settings.pickup_dzo3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo3_inv[group] = edition_settings.pickup_dzo3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo3_amtz[group], PICKUP_DZO3_AMTZ_MIN, PICKUP_DZO3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo3_amtz[group] != current_settings.pickup_dzo3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo3_amtz[group] = edition_settings.pickup_dzo3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }


                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo4_Zo_dir[group], PICKUP_DZO4_Z0_DIR_MIN, PICKUP_DZO4_Z0_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo4_Zo_dir[group] != current_settings.pickup_dzo4_Zo_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo4_Zo_dir[group] = edition_settings.pickup_dzo4_Zo_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo4_Xo_dir[group], PICKUP_DZO4_X0_DIR_MIN, PICKUP_DZO4_X0_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo4_Xo_dir[group] != current_settings.pickup_dzo4_Xo_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo4_Xo_dir[group] = edition_settings.pickup_dzo4_Xo_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo4_Zo_inv[group], PICKUP_DZO4_Z0_INV_MIN, PICKUP_DZO4_Z0_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo4_Zo_inv[group] != current_settings.pickup_dzo4_Zo_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo4_Zo_inv[group] = edition_settings.pickup_dzo4_Zo_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo4_Xo_inv[group], PICKUP_DZO4_X0_INV_MIN, PICKUP_DZO4_X0_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo4_Xo_inv[group] != current_settings.pickup_dzo4_Xo_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo4_Xo_inv[group] = edition_settings.pickup_dzo4_Xo_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzo4_amtz[group], PICKUP_DZO4_AMTZ_MIN, PICKUP_DZO4_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzo4_amtz[group] != current_settings.pickup_dzo4_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzo4_amtz[group] = edition_settings.pickup_dzo4_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  
                  
                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                  /*
                  if (current_ekran.index_position == INDEX_ML_TMO_DZ1)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz1[group], TIMEOUT_DZ1_MIN, TIMEOUT_DZ1_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz1[group] != current_settings.timeout_dz1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz1[group] = edition_settings.timeout_dz1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz1_amtz[group], TIMEOUT_DZ1_AMTZ_MIN, TIMEOUT_DZ1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz1_amtz[group] != current_settings.timeout_dz1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz1_amtz[group] = edition_settings.timeout_dz1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_dir[group], TIMEOUT_DZ2_DIR_MIN, TIMEOUT_DZ2_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_dir[group] != current_settings.timeout_dz2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_dir[group] = edition_settings.timeout_dz2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_dir_pr[group], TIMEOUT_DZ2_DIR_PR_MIN, TIMEOUT_DZ2_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_dir_pr[group] != current_settings.timeout_dz2_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_dir_pr[group] = edition_settings.timeout_dz2_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_inv[group], TIMEOUT_DZ2_INV_MIN, TIMEOUT_DZ2_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_inv[group] != current_settings.timeout_dz2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_inv[group] = edition_settings.timeout_dz2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_inv_pr[group], TIMEOUT_DZ2_INV_PR_MIN, TIMEOUT_DZ2_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_inv_pr[group] != current_settings.timeout_dz2_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_inv_pr[group] = edition_settings.timeout_dz2_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_amtz[group], TIMEOUT_DZ2_AMTZ_MIN, TIMEOUT_DZ2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_amtz[group] != current_settings.timeout_dz2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_amtz[group] = edition_settings.timeout_dz2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_amtz_pr[group], TIMEOUT_DZ2_AMTZ_PR_MIN, TIMEOUT_DZ2_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_amtz_pr[group] != current_settings.timeout_dz2_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_amtz_pr[group] = edition_settings.timeout_dz2_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_vvid_pr[group], TIMEOUT_DZ2_VVID_PR_MIN, TIMEOUT_DZ2_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_vvid_pr[group] != current_settings.timeout_dz2_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_vvid_pr[group] = edition_settings.timeout_dz2_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz2_amtz_vvid_pr[group], TIMEOUT_DZ2_AMTZ_VVID_PR_MIN, TIMEOUT_DZ2_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz2_amtz_vvid_pr[group] != current_settings.timeout_dz2_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz2_amtz_vvid_pr[group] = edition_settings.timeout_dz2_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_dir[group], TIMEOUT_DZ3_DIR_MIN, TIMEOUT_DZ3_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_dir[group] != current_settings.timeout_dz3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_dir[group] = edition_settings.timeout_dz3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_dir_pr[group], TIMEOUT_DZ3_DIR_PR_MIN, TIMEOUT_DZ3_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_dir_pr[group] != current_settings.timeout_dz3_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_dir_pr[group] = edition_settings.timeout_dz3_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_inv[group], TIMEOUT_DZ3_INV_MIN, TIMEOUT_DZ3_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_inv[group] != current_settings.timeout_dz3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_inv[group] = edition_settings.timeout_dz3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_inv_pr[group], TIMEOUT_DZ3_INV_PR_MIN, TIMEOUT_DZ3_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_inv_pr[group] != current_settings.timeout_dz3_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_inv_pr[group] = edition_settings.timeout_dz3_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_amtz[group], TIMEOUT_DZ3_AMTZ_MIN, TIMEOUT_DZ3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_amtz[group] != current_settings.timeout_dz3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_amtz[group] = edition_settings.timeout_dz3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_amtz_pr[group], TIMEOUT_DZ3_AMTZ_PR_MIN, TIMEOUT_DZ3_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_amtz_pr[group] != current_settings.timeout_dz3_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_amtz_pr[group] = edition_settings.timeout_dz3_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_vvid_pr[group], TIMEOUT_DZ3_VVID_PR_MIN, TIMEOUT_DZ3_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_vvid_pr[group] != current_settings.timeout_dz3_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_vvid_pr[group] = edition_settings.timeout_dz3_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz3_amtz_vvid_pr[group], TIMEOUT_DZ3_AMTZ_VVID_PR_MIN, TIMEOUT_DZ3_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz3_amtz_vvid_pr[group] != current_settings.timeout_dz3_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz3_amtz_vvid_pr[group] = edition_settings.timeout_dz3_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_dir[group], TIMEOUT_DZ4_DIR_MIN, TIMEOUT_DZ4_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_dir[group] != current_settings.timeout_dz4_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_dir[group] = edition_settings.timeout_dz4_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_dir_pr[group], TIMEOUT_DZ4_DIR_PR_MIN, TIMEOUT_DZ4_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_dir_pr[group] != current_settings.timeout_dz4_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_dir_pr[group] = edition_settings.timeout_dz4_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_inv[group], TIMEOUT_DZ4_INV_MIN, TIMEOUT_DZ4_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_inv[group] != current_settings.timeout_dz4_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_inv[group] = edition_settings.timeout_dz4_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_inv_pr[group], TIMEOUT_DZ4_INV_PR_MIN, TIMEOUT_DZ4_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_inv_pr[group] != current_settings.timeout_dz4_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_inv_pr[group] = edition_settings.timeout_dz4_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_amtz[group], TIMEOUT_DZ4_AMTZ_MIN, TIMEOUT_DZ4_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_amtz[group] != current_settings.timeout_dz4_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_amtz[group] = edition_settings.timeout_dz4_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_amtz_pr[group], TIMEOUT_DZ4_AMTZ_PR_MIN, TIMEOUT_DZ4_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_amtz_pr[group] != current_settings.timeout_dz4_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_amtz_pr[group] = edition_settings.timeout_dz4_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_vvid_pr[group], TIMEOUT_DZ4_VVID_PR_MIN, TIMEOUT_DZ4_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_vvid_pr[group] != current_settings.timeout_dz4_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_vvid_pr[group] = edition_settings.timeout_dz4_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dz4_amtz_vvid_pr[group], TIMEOUT_DZ4_AMTZ_VVID_PR_MIN, TIMEOUT_DZ4_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dz4_amtz_vvid_pr[group] != current_settings.timeout_dz4_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dz4_amtz_vvid_pr[group] = edition_settings.timeout_dz4_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_nkn_dz[group], TIMEOUT_NKN_DZ_MIN, TIMEOUT_NKN_DZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_nkn_dz[group] != current_settings.timeout_nkn_dz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_nkn_dz[group] = edition_settings.timeout_nkn_dz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }*/
                  if (current_ekran.index_position == INDEX_ML_TMO_DZO1)//////DZO
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo1[group], TIMEOUT_DZO1_MIN, TIMEOUT_DZO1_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo1[group] != current_settings.timeout_dzo1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo1[group] = edition_settings.timeout_dzo1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo1_amtz[group], TIMEOUT_DZO1_AMTZ_MIN, TIMEOUT_DZO1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo1_amtz[group] != current_settings.timeout_dzo1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo1_amtz[group] = edition_settings.timeout_dzo1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_dir[group], TIMEOUT_DZO2_DIR_MIN, TIMEOUT_DZO2_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_dir[group] != current_settings.timeout_dzo2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_dir[group] = edition_settings.timeout_dzo2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_dir_pr[group], TIMEOUT_DZO2_DIR_PR_MIN, TIMEOUT_DZO2_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_dir_pr[group] != current_settings.timeout_dzo2_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_dir_pr[group] = edition_settings.timeout_dzo2_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_inv[group], TIMEOUT_DZO2_INV_MIN, TIMEOUT_DZO2_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_inv[group] != current_settings.timeout_dzo2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_inv[group] = edition_settings.timeout_dzo2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_inv_pr[group], TIMEOUT_DZO2_INV_PR_MIN, TIMEOUT_DZO2_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_inv_pr[group] != current_settings.timeout_dzo2_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_inv_pr[group] = edition_settings.timeout_dzo2_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_amtz[group], TIMEOUT_DZO2_AMTZ_MIN, TIMEOUT_DZO2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_amtz[group] != current_settings.timeout_dzo2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_amtz[group] = edition_settings.timeout_dzo2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_amtz_pr[group], TIMEOUT_DZO2_AMTZ_PR_MIN, TIMEOUT_DZO2_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_amtz_pr[group] != current_settings.timeout_dzo2_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_amtz_pr[group] = edition_settings.timeout_dzo2_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_vvid_pr[group], TIMEOUT_DZO2_VVID_PR_MIN, TIMEOUT_DZO2_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_vvid_pr[group] != current_settings.timeout_dzo2_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_vvid_pr[group] = edition_settings.timeout_dzo2_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo2_amtz_vvid_pr[group], TIMEOUT_DZO2_AMTZ_VVID_PR_MIN, TIMEOUT_DZO2_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo2_amtz_vvid_pr[group] != current_settings.timeout_dzo2_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo2_amtz_vvid_pr[group] = edition_settings.timeout_dzo2_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_dir[group], TIMEOUT_DZO3_DIR_MIN, TIMEOUT_DZO3_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_dir[group] != current_settings.timeout_dzo3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_dir[group] = edition_settings.timeout_dzo3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_dir_pr[group], TIMEOUT_DZO3_DIR_PR_MIN, TIMEOUT_DZO3_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_dir_pr[group] != current_settings.timeout_dzo3_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_dir_pr[group] = edition_settings.timeout_dzo3_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_inv[group], TIMEOUT_DZO3_INV_MIN, TIMEOUT_DZO3_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_inv[group] != current_settings.timeout_dzo3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_inv[group] = edition_settings.timeout_dzo3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_inv_pr[group], TIMEOUT_DZO3_INV_PR_MIN, TIMEOUT_DZO3_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_inv_pr[group] != current_settings.timeout_dzo3_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_inv_pr[group] = edition_settings.timeout_dzo3_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_amtz[group], TIMEOUT_DZO3_AMTZ_MIN, TIMEOUT_DZO3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_amtz[group] != current_settings.timeout_dzo3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_amtz[group] = edition_settings.timeout_dzo3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_amtz_pr[group], TIMEOUT_DZO3_AMTZ_PR_MIN, TIMEOUT_DZO3_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_amtz_pr[group] != current_settings.timeout_dzo3_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_amtz_pr[group] = edition_settings.timeout_dzo3_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_vvid_pr[group], TIMEOUT_DZO3_VVID_PR_MIN, TIMEOUT_DZO3_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_vvid_pr[group] != current_settings.timeout_dzo3_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_vvid_pr[group] = edition_settings.timeout_dzo3_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo3_amtz_vvid_pr[group], TIMEOUT_DZO3_AMTZ_VVID_PR_MIN, TIMEOUT_DZO3_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo3_amtz_vvid_pr[group] != current_settings.timeout_dzo3_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo3_amtz_vvid_pr[group] = edition_settings.timeout_dzo3_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo4_dir[group], TIMEOUT_DZO4_DIR_MIN, TIMEOUT_DZO4_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo4_dir[group] != current_settings.timeout_dzo4_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo4_dir[group] = edition_settings.timeout_dzo4_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                 
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo4_inv[group], TIMEOUT_DZO4_INV_MIN, TIMEOUT_DZO4_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo4_inv[group] != current_settings.timeout_dzo4_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo4_inv[group] = edition_settings.timeout_dzo4_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
             
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzo4_amtz[group], TIMEOUT_DZO4_AMTZ_MIN, TIMEOUT_DZO4_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzo4_amtz[group] != current_settings.timeout_dzo4_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzo4_amtz[group] = edition_settings.timeout_dzo4_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  
                  
                 
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_nkn_dzo[group], TIMEOUT_NKN_DZO_MIN, TIMEOUT_NKN_DZO_MAX) == 1)
                    {
                      if (edition_settings.timeout_nkn_dzo[group] != current_settings.timeout_nkn_dzo[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_nkn_dzo[group] = edition_settings.timeout_nkn_dzo[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
                {
                  if (
                      //!((edition_settings.control_dzo  & ((unsigned int)(~CTR_DZ_MASKA))) == 0)
                      ((edition_settings.control_dzo  & ((unsigned int)(~CTR_DZO_MASKA))) == 0)
                     )   
                  {
                    if (
                        (edition_settings.control_dzo != current_settings.control_dzo) 
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_dzo = edition_settings.control_dzo;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
//--------------#include "ekran/ekran_dz_2.ci"--------------------
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOZDZ)
                  {
                    if (check_data_setpoint(edition_settings.timeout_zdz[group], TIMEOUT_ZDZ_MIN, TIMEOUT_ZDZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_zdz[group] != current_settings.timeout_zdz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_zdz[group] = edition_settings.timeout_zdz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
                {
                  if (
                      ((edition_settings.control_zdz & ((unsigned int)(~CTR_ZDZ_MASKA))) == 0) &&
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                      (edition_settings.zdz_ovd_porig < ZDZ_CTRL_PORIG_N) &&
#endif
                      (edition_settings.ctrl_zdz_type < _ZDZ_CTRL_NUMBER)
                     )   
                  {
                    if (
                        (edition_settings.control_zdz != current_settings.control_zdz) ||
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                        (edition_settings.zdz_ovd_porig != current_settings.zdz_ovd_porig) ||
#endif
                        (edition_settings.ctrl_zdz_type != current_settings.ctrl_zdz_type)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_zdz = edition_settings.control_zdz;
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                      current_settings.zdz_ovd_porig = edition_settings.zdz_ovd_porig;
#endif
                      current_settings.ctrl_zdz_type = edition_settings.ctrl_zdz_type;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                  
                  /*if (current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_zz_3I0[group], SETPOINT_ZZ_3I0_MIN, SETPOINT_ZZ_3I0_MAX) == 1)
                    {
                      if (edition_settings.setpoint_zz_3I0[group] != current_settings.setpoint_zz_3I0[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                          
                        current_settings.setpoint_zz_3I0[group] = edition_settings.setpoint_zz_3I0[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_zz_3U0[group], SETPOINT_ZZ_3U0_MIN, SETPOINT_ZZ_3U0_MAX) == 1)
                    {
                      if (edition_settings.setpoint_zz_3U0[group] != current_settings.setpoint_zz_3U0[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                          
                        current_settings.setpoint_zz_3U0[group] = edition_settings.setpoint_zz_3U0[group];
                        //Формуємо запис у таблиці настройок про зміну і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }*/
                  
                 
                  if (current_ekran.index_position == INDEX_ML_STPMTZO1)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1[group], SETPOINT_MTZO1_MIN, SETPOINT_MTZO1_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1[group] != current_settings.setpoint_mtzo_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_1[group] = edition_settings.setpoint_mtzo_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1_n_vpered[group], SETPOINT_MTZO1_N_VPERED_MIN, SETPOINT_MTZO1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1_n_vpered[group] != current_settings.setpoint_mtzo_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_1_n_vpered[group] = edition_settings.setpoint_mtzo_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1_n_nazad[group], SETPOINT_MTZO1_N_NAZAD_MIN, SETPOINT_MTZO1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1_n_nazad[group] != current_settings.setpoint_mtzo_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_1_n_nazad[group] = edition_settings.setpoint_mtzo_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1_angle[group], SETPOINT_MTZO1_ANGLE_MIN, SETPOINT_MTZO1_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1_angle[group] != current_settings.setpoint_mtzo_1_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzo_1_angle[group];
                        current_settings.setpoint_mtzo_1_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzo_1_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzo_1_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1_po_napruzi[group], SETPOINT_MTZO1_PO_NAPRUZI_MIN, SETPOINT_MTZO1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1_po_napruzi[group] != current_settings.setpoint_mtzo_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_1_po_napruzi[group] = edition_settings.setpoint_mtzo_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_1_U[group], SETPOINT_MTZO1_U_MIN, SETPOINT_MTZO1_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_1_U[group] != current_settings.setpoint_mtzo_1_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_1_U[group] = edition_settings.setpoint_mtzo_1_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2[group], SETPOINT_MTZO2_MIN, SETPOINT_MTZO2_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2[group] != current_settings.setpoint_mtzo_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_2[group] = edition_settings.setpoint_mtzo_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2_n_vpered[group], SETPOINT_MTZO2_N_VPERED_MIN, SETPOINT_MTZO2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2_n_vpered[group] != current_settings.setpoint_mtzo_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_2_n_vpered[group] = edition_settings.setpoint_mtzo_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2_n_nazad[group], SETPOINT_MTZO2_N_NAZAD_MIN, SETPOINT_MTZO2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2_n_nazad[group] != current_settings.setpoint_mtzo_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_2_n_nazad[group] = edition_settings.setpoint_mtzo_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2_angle[group], SETPOINT_MTZO2_ANGLE_MIN, SETPOINT_MTZO2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2_angle[group] != current_settings.setpoint_mtzo_2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzo_2_angle[group];
                        current_settings.setpoint_mtzo_2_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzo_2_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzo_2_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2_po_napruzi[group], SETPOINT_MTZO2_PO_NAPRUZI_MIN, SETPOINT_MTZO2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2_po_napruzi[group] != current_settings.setpoint_mtzo_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_2_po_napruzi[group] = edition_settings.setpoint_mtzo_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_2_U[group], SETPOINT_MTZO2_U_MIN, SETPOINT_MTZO2_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_2_U[group] != current_settings.setpoint_mtzo_2_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_2_U[group] = edition_settings.setpoint_mtzo_2_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3[group], SETPOINT_MTZO3_MIN, SETPOINT_MTZO3_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3[group] != current_settings.setpoint_mtzo_3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_3[group] = edition_settings.setpoint_mtzo_3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3_n_vpered[group], SETPOINT_MTZO3_N_VPERED_MIN, SETPOINT_MTZO3_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3_n_vpered[group] != current_settings.setpoint_mtzo_3_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_3_n_vpered[group] = edition_settings.setpoint_mtzo_3_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3_n_nazad[group], SETPOINT_MTZO3_N_NAZAD_MIN, SETPOINT_MTZO3_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3_n_nazad[group] != current_settings.setpoint_mtzo_3_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_3_n_nazad[group] = edition_settings.setpoint_mtzo_3_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3_angle[group], SETPOINT_MTZO3_ANGLE_MIN, SETPOINT_MTZO3_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3_angle[group] != current_settings.setpoint_mtzo_3_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzo_3_angle[group];
                        current_settings.setpoint_mtzo_3_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzo_3_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzo_3_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3_po_napruzi[group], SETPOINT_MTZO3_PO_NAPRUZI_MIN, SETPOINT_MTZO3_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3_po_napruzi[group] != current_settings.setpoint_mtzo_3_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_3_po_napruzi[group] = edition_settings.setpoint_mtzo_3_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_3_U[group], SETPOINT_MTZO3_U_MIN, SETPOINT_MTZO3_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_3_U[group] != current_settings.setpoint_mtzo_3_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_3_U[group] = edition_settings.setpoint_mtzo_3_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4[group], SETPOINT_MTZO4_MIN, SETPOINT_MTZO4_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4[group] != current_settings.setpoint_mtzo_4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_4[group] = edition_settings.setpoint_mtzo_4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4_n_vpered[group], SETPOINT_MTZO4_N_VPERED_MIN, SETPOINT_MTZO4_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4_n_vpered[group] != current_settings.setpoint_mtzo_4_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_4_n_vpered[group] = edition_settings.setpoint_mtzo_4_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4_n_nazad[group], SETPOINT_MTZO4_N_NAZAD_MIN, SETPOINT_MTZO4_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4_n_nazad[group] != current_settings.setpoint_mtzo_4_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_4_n_nazad[group] = edition_settings.setpoint_mtzo_4_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4_angle[group], SETPOINT_MTZO4_ANGLE_MIN, SETPOINT_MTZO4_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4_angle[group] != current_settings.setpoint_mtzo_4_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzo_4_angle[group];
                        current_settings.setpoint_mtzo_4_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzo_4_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzo_4_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4_po_napruzi[group], SETPOINT_MTZO4_PO_NAPRUZI_MIN, SETPOINT_MTZO4_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4_po_napruzi[group] != current_settings.setpoint_mtzo_4_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_4_po_napruzi[group] = edition_settings.setpoint_mtzo_4_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzo_4_U[group], SETPOINT_MTZO4_U_MIN, SETPOINT_MTZO4_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzo_4_U[group] != current_settings.setpoint_mtzo_4_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzo_4_U[group] = edition_settings.setpoint_mtzo_4_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                 
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                  
                  /*if (current_ekran.index_position == INDEX_ML_TMOZZ1_3I0)
                  {
                    if (check_data_setpoint(edition_settings.timeout_zz_3I0[group], TIMEOUT_ZZ_3I0_MIN, TIMEOUT_ZZ_3I0_MAX) == 1)
                    {
                      if (edition_settings.timeout_zz_3I0[group] != current_settings.timeout_zz_3I0[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_zz_3I0[group] = edition_settings.timeout_zz_3I0[group];
                        //Формуємо запис у таблиці настройок про зміну і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOZZ1_3U0)
                  {
                    if (check_data_setpoint(edition_settings.timeout_zz_3U0[group], TIMEOUT_ZZ_3U0_MIN, TIMEOUT_ZZ_3U0_MAX) == 1)
                    {
                      if (edition_settings.timeout_zz_3U0[group] != current_settings.timeout_zz_3U0[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_zz_3U0[group] = edition_settings.timeout_zz_3U0[group];
                        //Формуємо запис у таблиці настройок про зміну і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOZZ1_NZZ)
                  {
                    if (check_data_setpoint(edition_settings.timeout_nzz[group], TIMEOUT_NZZ_MIN, TIMEOUT_NZZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_nzz[group] != current_settings.timeout_nzz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_nzz[group] = edition_settings.timeout_nzz[group];
                        //Формуємо запис у таблиці настройок про зміну і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }*/
                  if (current_ekran.index_position == INDEX_ML_TMOMTZO1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_1[group], TIMEOUT_MTZO1_MIN, TIMEOUT_MTZO1_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_1[group] != current_settings.timeout_mtzo_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_1[group] = edition_settings.timeout_mtzo_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_1_n_vpered[group], TIMEOUT_MTZO1_N_VPERED_MIN, TIMEOUT_MTZO1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_1_n_vpered[group] != current_settings.timeout_mtzo_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_1_n_vpered[group] = edition_settings.timeout_mtzo_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_1_n_nazad[group], TIMEOUT_MTZO1_N_NAZAD_MIN, TIMEOUT_MTZO1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_1_n_nazad[group] != current_settings.timeout_mtzo_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_1_n_nazad[group] = edition_settings.timeout_mtzo_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_1_po_napruzi[group], TIMEOUT_MTZO1_PO_NAPRUZI_MIN, TIMEOUT_MTZO1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_1_po_napruzi[group] != current_settings.timeout_mtzo_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_1_po_napruzi[group] = edition_settings.timeout_mtzo_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2[group], TIMEOUT_MTZO2_MIN, TIMEOUT_MTZO2_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2[group] != current_settings.timeout_mtzo_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2[group] = edition_settings.timeout_mtzo_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_pr[group], TIMEOUT_MTZO2_PR_MIN, TIMEOUT_MTZO2_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_pr[group] != current_settings.timeout_mtzo_2_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_pr[group] = edition_settings.timeout_mtzo_2_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_n_vpered[group], TIMEOUT_MTZO2_N_VPERED_MIN, TIMEOUT_MTZO2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_n_vpered[group] != current_settings.timeout_mtzo_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_n_vpered[group] = edition_settings.timeout_mtzo_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_n_vpered_pr[group], TIMEOUT_MTZO2_N_VPERED_PR_MIN, TIMEOUT_MTZO2_N_VPERED_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_n_vpered_pr[group] != current_settings.timeout_mtzo_2_n_vpered_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_n_vpered_pr[group] = edition_settings.timeout_mtzo_2_n_vpered_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_n_nazad[group], TIMEOUT_MTZO2_N_NAZAD_MIN, TIMEOUT_MTZO2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_n_nazad[group] != current_settings.timeout_mtzo_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_n_nazad[group] = edition_settings.timeout_mtzo_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_n_nazad_pr[group], TIMEOUT_MTZO2_N_NAZAD_PR_MIN, TIMEOUT_MTZO2_N_NAZAD_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_n_nazad_pr[group] != current_settings.timeout_mtzo_2_n_nazad_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_n_nazad_pr[group] = edition_settings.timeout_mtzo_2_n_nazad_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_po_napruzi[group], TIMEOUT_MTZO2_PO_NAPRUZI_MIN, TIMEOUT_MTZO2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_po_napruzi[group] != current_settings.timeout_mtzo_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_po_napruzi[group] = edition_settings.timeout_mtzo_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_po_napruzi_pr[group], TIMEOUT_MTZO2_PO_NAPRUZI_PR_MIN, TIMEOUT_MTZO2_PO_NAPRUZI_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_po_napruzi_pr[group] != current_settings.timeout_mtzo_2_po_napruzi_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_po_napruzi_pr[group] = edition_settings.timeout_mtzo_2_po_napruzi_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_2_vvid_pr[group], TIMEOUT_MTZO2_VVID_PR_MIN, TIMEOUT_MTZO2_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_2_vvid_pr[group] != current_settings.timeout_mtzo_2_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_2_vvid_pr[group] = edition_settings.timeout_mtzo_2_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_3[group], TIMEOUT_MTZO3_MIN, TIMEOUT_MTZO3_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_3[group] != current_settings.timeout_mtzo_3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_3[group] = edition_settings.timeout_mtzo_3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_3_n_vpered[group], TIMEOUT_MTZO3_N_VPERED_MIN, TIMEOUT_MTZO3_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_3_n_vpered[group] != current_settings.timeout_mtzo_3_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_3_n_vpered[group] = edition_settings.timeout_mtzo_3_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_3_n_nazad[group], TIMEOUT_MTZO3_N_NAZAD_MIN, TIMEOUT_MTZO3_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_3_n_nazad[group] != current_settings.timeout_mtzo_3_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_3_n_nazad[group] = edition_settings.timeout_mtzo_3_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_3_po_napruzi[group], TIMEOUT_MTZO3_PO_NAPRUZI_MIN, TIMEOUT_MTZO3_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_3_po_napruzi[group] != current_settings.timeout_mtzo_3_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_3_po_napruzi[group] = edition_settings.timeout_mtzo_3_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_4[group], TIMEOUT_MTZO4_MIN, TIMEOUT_MTZO4_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_4[group] != current_settings.timeout_mtzo_4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_4[group] = edition_settings.timeout_mtzo_4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_4_n_vpered[group], TIMEOUT_MTZO4_N_VPERED_MIN, TIMEOUT_MTZO4_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_4_n_vpered[group] != current_settings.timeout_mtzo_4_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_4_n_vpered[group] = edition_settings.timeout_mtzo_4_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_4_n_nazad[group], TIMEOUT_MTZO4_N_NAZAD_MIN, TIMEOUT_MTZO4_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_4_n_nazad[group] != current_settings.timeout_mtzo_4_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_4_n_nazad[group] = edition_settings.timeout_mtzo_4_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzo_4_po_napruzi[group], TIMEOUT_MTZO4_PO_NAPRUZI_MIN, TIMEOUT_MTZO4_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzo_4_po_napruzi[group] != current_settings.timeout_mtzo_4_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzo_4_po_napruzi[group] = edition_settings.timeout_mtzo_4_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
                {
                  if (
                      ((edition_settings.control_mtzo  & ((unsigned int)(~CTR_MTZO_MASKA))) == 0) &&
                      (edition_settings.type_mtzo1 <= TYPE_MTZ_VOLTAGE        ) &&
                      (edition_settings.type_mtzo2 <= TYPE_MTZ_DEPENDENT_RTV_I) &&
                      (edition_settings.type_mtzo3 <= TYPE_MTZ_VOLTAGE        ) &&
                      (edition_settings.type_mtzo4 <= TYPE_MTZ_VOLTAGE        )
                     )   
                  {
                    if (
                        (edition_settings.control_mtzo != current_settings.control_mtzo) ||
                        (edition_settings.type_mtzo1 != current_settings.type_mtzo1) ||
                        (edition_settings.type_mtzo2 != current_settings.type_mtzo2) || 
                        (edition_settings.type_mtzo3 != current_settings.type_mtzo3) || 
                        (edition_settings.type_mtzo4 != current_settings.type_mtzo4)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.type_mtzo1 = edition_settings.type_mtzo1;
                      current_settings.type_mtzo2 = edition_settings.type_mtzo2;
                      current_settings.type_mtzo3 = edition_settings.type_mtzo3;
                      current_settings.type_mtzo4 = edition_settings.type_mtzo4;
                      current_settings.control_mtzo = edition_settings.control_mtzo;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                  #ifdef TZNP_ACTIVE
                  if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_1_3I0_vpered[group], SETPOINT_TZNP1_3I0_VPERED_MIN, SETPOINT_TZNP1_3I0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_1_3I0_vpered[group] != current_settings.setpoint_tznp_1_3I0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_1_3I0_vpered[group] = edition_settings.setpoint_tznp_1_3I0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_1_3U0_vpered[group], SETPOINT_TZNP1_3U0_VPERED_MIN, SETPOINT_TZNP1_3U0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_1_3U0_vpered[group] != current_settings.setpoint_tznp_1_3U0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_1_3U0_vpered[group] = edition_settings.setpoint_tznp_1_3U0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_1_3I0_nazad[group], SETPOINT_TZNP1_3I0_NAZAD_MIN, SETPOINT_TZNP1_3I0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_1_3I0_nazad[group] != current_settings.setpoint_tznp_1_3I0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_1_3I0_nazad[group] = edition_settings.setpoint_tznp_1_3I0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_1_3U0_nazad[group], SETPOINT_TZNP1_3U0_NAZAD_MIN, SETPOINT_TZNP1_3U0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_1_3U0_nazad[group] != current_settings.setpoint_tznp_1_3U0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_1_3U0_nazad[group] = edition_settings.setpoint_tznp_1_3U0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_1_angle[group], SETPOINT_TZNP1_ANGLE_MIN, SETPOINT_TZNP1_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_1_angle[group] != current_settings.setpoint_tznp_1_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_tznp_1_angle[group];
                        current_settings.setpoint_tznp_1_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_tznp_1_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_tznp_1_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_2_3I0_vpered[group], SETPOINT_TZNP2_3I0_VPERED_MIN, SETPOINT_TZNP2_3I0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_2_3I0_vpered[group] != current_settings.setpoint_tznp_2_3I0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_2_3I0_vpered[group] = edition_settings.setpoint_tznp_2_3I0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_2_3U0_vpered[group], SETPOINT_TZNP2_3U0_VPERED_MIN, SETPOINT_TZNP2_3U0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_2_3U0_vpered[group] != current_settings.setpoint_tznp_2_3U0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_2_3U0_vpered[group] = edition_settings.setpoint_tznp_2_3U0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_2_3I0_nazad[group], SETPOINT_TZNP2_3I0_NAZAD_MIN, SETPOINT_TZNP2_3I0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_2_3I0_nazad[group] != current_settings.setpoint_tznp_2_3I0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_2_3I0_nazad[group] = edition_settings.setpoint_tznp_2_3I0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_2_3U0_nazad[group], SETPOINT_TZNP2_3U0_NAZAD_MIN, SETPOINT_TZNP2_3U0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_2_3U0_nazad[group] != current_settings.setpoint_tznp_2_3U0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_2_3U0_nazad[group] = edition_settings.setpoint_tznp_2_3U0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_2_angle[group], SETPOINT_TZNP2_ANGLE_MIN, SETPOINT_TZNP2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_2_angle[group] != current_settings.setpoint_tznp_2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_tznp_2_angle[group];
                        current_settings.setpoint_tznp_2_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_tznp_2_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_tznp_2_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_3_3I0_vpered[group], SETPOINT_TZNP3_3I0_VPERED_MIN, SETPOINT_TZNP3_3I0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_3_3I0_vpered[group] != current_settings.setpoint_tznp_3_3I0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_3_3I0_vpered[group] = edition_settings.setpoint_tznp_3_3I0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_3_3U0_vpered[group], SETPOINT_TZNP3_3U0_VPERED_MIN, SETPOINT_TZNP3_3U0_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_3_3U0_vpered[group] != current_settings.setpoint_tznp_3_3U0_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_3_3U0_vpered[group] = edition_settings.setpoint_tznp_3_3U0_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_3_3I0_nazad[group], SETPOINT_TZNP3_3I0_NAZAD_MIN, SETPOINT_TZNP3_3I0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_3_3I0_nazad[group] != current_settings.setpoint_tznp_3_3I0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_3_3I0_nazad[group] = edition_settings.setpoint_tznp_3_3I0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_3_3U0_nazad[group], SETPOINT_TZNP3_3U0_NAZAD_MIN, SETPOINT_TZNP3_3U0_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_3_3U0_nazad[group] != current_settings.setpoint_tznp_3_3U0_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_tznp_3_3U0_nazad[group] = edition_settings.setpoint_tznp_3_3U0_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_tznp_3_angle[group], SETPOINT_TZNP3_ANGLE_MIN, SETPOINT_TZNP3_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_tznp_3_angle[group] != current_settings.setpoint_tznp_3_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_tznp_3_angle[group];
                        current_settings.setpoint_tznp_3_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_tznp_3_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_tznp_3_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  #endif
                  if (current_ekran.index_position == INDEX_ML_STPMTZR1)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1[group], SETPOINT_MTZR1_MIN, SETPOINT_MTZR1_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1[group] != current_settings.setpoint_mtzr_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_1[group] = edition_settings.setpoint_mtzr_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1_n_vpered[group], SETPOINT_MTZR1_N_VPERED_MIN, SETPOINT_MTZR1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1_n_vpered[group] != current_settings.setpoint_mtzr_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_1_n_vpered[group] = edition_settings.setpoint_mtzr_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1_n_nazad[group], SETPOINT_MTZR1_N_NAZAD_MIN, SETPOINT_MTZR1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1_n_nazad[group] != current_settings.setpoint_mtzr_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_1_n_nazad[group] = edition_settings.setpoint_mtzr_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1_angle[group], SETPOINT_MTZR1_ANGLE_MIN, SETPOINT_MTZR1_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1_angle[group] != current_settings.setpoint_mtzr_1_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzr_1_angle[group];
                        current_settings.setpoint_mtzr_1_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzr_1_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzr_1_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1_po_napruzi[group], SETPOINT_MTZR1_PO_NAPRUZI_MIN, SETPOINT_MTZR1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1_po_napruzi[group] != current_settings.setpoint_mtzr_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_1_po_napruzi[group] = edition_settings.setpoint_mtzr_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_1_U[group], SETPOINT_MTZR1_U_MIN, SETPOINT_MTZR1_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_1_U[group] != current_settings.setpoint_mtzr_1_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_1_U[group] = edition_settings.setpoint_mtzr_1_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2[group], SETPOINT_MTZR2_MIN, SETPOINT_MTZR2_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2[group] != current_settings.setpoint_mtzr_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_2[group] = edition_settings.setpoint_mtzr_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2_n_vpered[group], SETPOINT_MTZR2_N_VPERED_MIN, SETPOINT_MTZR2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2_n_vpered[group] != current_settings.setpoint_mtzr_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_2_n_vpered[group] = edition_settings.setpoint_mtzr_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2_n_nazad[group], SETPOINT_MTZR2_N_NAZAD_MIN, SETPOINT_MTZR2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2_n_nazad[group] != current_settings.setpoint_mtzr_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_2_n_nazad[group] = edition_settings.setpoint_mtzr_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2_angle[group], SETPOINT_MTZR2_ANGLE_MIN, SETPOINT_MTZR2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2_angle[group] != current_settings.setpoint_mtzr_2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        unsigned int angle = edition_settings.setpoint_mtzr_2_angle[group];
                        current_settings.setpoint_mtzr_2_angle[group] = angle;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.setpoint_mtzr_2_angle_cos[group] = (int) (AMPLITUDA_FI*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.setpoint_mtzr_2_angle_sin[group] = (int) (AMPLITUDA_FI*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2_po_napruzi[group], SETPOINT_MTZR2_PO_NAPRUZI_MIN, SETPOINT_MTZR2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2_po_napruzi[group] != current_settings.setpoint_mtzr_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_2_po_napruzi[group] = edition_settings.setpoint_mtzr_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_mtzr_2_U[group], SETPOINT_MTZR2_U_MIN, SETPOINT_MTZR2_U_MAX) == 1)
                    {
                      if (edition_settings.setpoint_mtzr_2_U[group] != current_settings.setpoint_mtzr_2_U[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_mtzr_2_U[group] = edition_settings.setpoint_mtzr_2_U[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
                  #ifdef TZNP_ACTIVE
                  if (current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_1_vpered[group], TIMEOUT_TZNP1_VPERED_MIN, TIMEOUT_TZNP1_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_1_vpered[group] != current_settings.timeout_tznp_1_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_1_vpered[group] = edition_settings.timeout_tznp_1_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_1_nazad[group], TIMEOUT_TZNP1_NAZAD_MIN, TIMEOUT_TZNP1_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_1_nazad[group] != current_settings.timeout_tznp_1_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_1_nazad[group] = edition_settings.timeout_tznp_1_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_2_vpered[group], TIMEOUT_TZNP2_VPERED_MIN, TIMEOUT_TZNP2_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_2_vpered[group] != current_settings.timeout_tznp_2_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_2_vpered[group] = edition_settings.timeout_tznp_2_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_2_nazad[group], TIMEOUT_TZNP2_NAZAD_MIN, TIMEOUT_TZNP2_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_2_nazad[group] != current_settings.timeout_tznp_2_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_2_nazad[group] = edition_settings.timeout_tznp_2_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_3_vpered[group], TIMEOUT_TZNP3_VPERED_MIN, TIMEOUT_TZNP3_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_3_vpered[group] != current_settings.timeout_tznp_3_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_3_vpered[group] = edition_settings.timeout_tznp_3_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_tznp_3_nazad[group], TIMEOUT_TZNP3_NAZAD_MIN, TIMEOUT_TZNP3_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_tznp_3_nazad[group] != current_settings.timeout_tznp_3_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_tznp_3_nazad[group] = edition_settings.timeout_tznp_3_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  #endif
                   if (current_ekran.index_position == INDEX_ML_TMOMTZR1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_1[group], TIMEOUT_MTZR1_MIN, TIMEOUT_MTZR1_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_1[group] != current_settings.timeout_mtzr_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_1[group] = edition_settings.timeout_mtzr_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_1_n_vpered[group], TIMEOUT_MTZR1_N_VPERED_MIN, TIMEOUT_MTZR1_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_1_n_vpered[group] != current_settings.timeout_mtzr_1_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_1_n_vpered[group] = edition_settings.timeout_mtzr_1_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_1_n_nazad[group], TIMEOUT_MTZR1_N_NAZAD_MIN, TIMEOUT_MTZR1_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_1_n_nazad[group] != current_settings.timeout_mtzr_1_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_1_n_nazad[group] = edition_settings.timeout_mtzr_1_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_1_po_napruzi[group], TIMEOUT_MTZR1_PO_NAPRUZI_MIN, TIMEOUT_MTZR1_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_1_po_napruzi[group] != current_settings.timeout_mtzr_1_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_1_po_napruzi[group] = edition_settings.timeout_mtzr_1_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_2[group], TIMEOUT_MTZR2_MIN, TIMEOUT_MTZR2_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_2[group] != current_settings.timeout_mtzr_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_2[group] = edition_settings.timeout_mtzr_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_2_n_vpered[group], TIMEOUT_MTZR2_N_VPERED_MIN, TIMEOUT_MTZR2_N_VPERED_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_2_n_vpered[group] != current_settings.timeout_mtzr_2_n_vpered[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_2_n_vpered[group] = edition_settings.timeout_mtzr_2_n_vpered[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_2_n_nazad[group], TIMEOUT_MTZR2_N_NAZAD_MIN, TIMEOUT_MTZR2_N_NAZAD_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_2_n_nazad[group] != current_settings.timeout_mtzr_2_n_nazad[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_2_n_nazad[group] = edition_settings.timeout_mtzr_2_n_nazad[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                  {
                    if (check_data_setpoint(edition_settings.timeout_mtzr_2_po_napruzi[group], TIMEOUT_MTZR2_PO_NAPRUZI_MIN, TIMEOUT_MTZR2_PO_NAPRUZI_MAX) == 1)
                    {
                      if (edition_settings.timeout_mtzr_2_po_napruzi[group] != current_settings.timeout_mtzr_2_po_napruzi[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_mtzr_2_po_napruzi[group] = edition_settings.timeout_mtzr_2_po_napruzi[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
                {
                  //if ((edition_settings.control_mtz  & ((unsigned int)(~CTR_TZNP_MASKA))) == 0)
                  //{
                  //  if (edition_settings.control_tznp != current_settings.control_tznp)
                  //  {
                  //    //Помічаємо, що поле структури зараз буде змінене
                  //    changed_settings = CHANGED_ETAP_EXECUTION;
                  //      
                  //    current_settings.control_tznp = edition_settings.control_tznp;
                  //    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                  //    fix_change_settings(0, 1);
                  //  }
                  //  //Виходимо з режиму редагування
                  //  current_ekran.edition = 0;
                  //   
                  //}
                  if (
                      ((edition_settings.control_mtzr  & ((unsigned int)(~CTR_MTZR_MASKA))) == 0) &&
                      (edition_settings.type_mtzr1 <= TYPE_MTZ_VOLTAGE        ) &&
                      //(edition_settings.type_mtzr2 <= TYPE_MTZ_DEPENDENT_RTV_I) &&
                      //(edition_settings.type_mtzr3 <= TYPE_MTZ_VOLTAGE        ) &&
                      (edition_settings.type_mtzr2 <= TYPE_MTZ_VOLTAGE        )
                     )   
                  {
                    if (
                        (edition_settings.control_mtzr != current_settings.control_mtzr) ||
                        (edition_settings.type_mtzr1 != current_settings.type_mtzr1) ||
                        (edition_settings.type_mtzr2 != current_settings.type_mtzr2) //|| 
                        //(edition_settings.type_mtzr3 != current_settings.type_mtzr3) || 
                        //(edition_settings.type_mtzr4 != current_settings.type_mtzr4)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.type_mtzr1 = edition_settings.type_mtzr1;
                      current_settings.type_mtzr2 = edition_settings.type_mtzr2;
                      //current_settings.type_mtzr3 = edition_settings.type_mtzr3;
                      //current_settings.type_mtzr4 = edition_settings.type_mtzr4;
                      current_settings.control_mtzr = edition_settings.control_mtzr;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOAPV1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_1[group], TIMEOUT_APV1_MIN, TIMEOUT_APV1_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_1[group] != current_settings.timeout_apv_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_1[group] = edition_settings.timeout_apv_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_2[group], TIMEOUT_APV2_MIN, TIMEOUT_APV2_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_2[group] != current_settings.timeout_apv_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_2[group] = edition_settings.timeout_apv_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV3)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_3[group], TIMEOUT_APV3_MIN, TIMEOUT_APV3_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_3[group] != current_settings.timeout_apv_3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_3[group] = edition_settings.timeout_apv_3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV4)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_4[group], TIMEOUT_APV4_MIN, TIMEOUT_APV4_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_4[group] != current_settings.timeout_apv_4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_4[group] = edition_settings.timeout_apv_4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_block_vid_apv1[group], TIMEOUT_APV_BLOCK_VID_APV1_MIN, TIMEOUT_APV_BLOCK_VID_APV1_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_block_vid_apv1[group] != current_settings.timeout_apv_block_vid_apv1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_block_vid_apv1[group] = edition_settings.timeout_apv_block_vid_apv1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_block_vid_apv2[group], TIMEOUT_APV_BLOCK_VID_APV2_MIN, TIMEOUT_APV_BLOCK_VID_APV2_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_block_vid_apv2[group] != current_settings.timeout_apv_block_vid_apv2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_block_vid_apv2[group] = edition_settings.timeout_apv_block_vid_apv2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_block_vid_apv3[group], TIMEOUT_APV_BLOCK_VID_APV3_MIN, TIMEOUT_APV_BLOCK_VID_APV3_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_block_vid_apv3[group] != current_settings.timeout_apv_block_vid_apv3[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_block_vid_apv3[group] = edition_settings.timeout_apv_block_vid_apv3[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_block_vid_apv4[group], TIMEOUT_APV_BLOCK_VID_APV4_MIN, TIMEOUT_APV_BLOCK_VID_APV4_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_block_vid_apv4[group] != current_settings.timeout_apv_block_vid_apv4[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_block_vid_apv4[group] = edition_settings.timeout_apv_block_vid_apv4[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                  {
                    if (check_data_setpoint(edition_settings.timeout_apv_block_vid_VV[group], TIMEOUT_APV_BLOCK_VID_VV_MIN, TIMEOUT_APV_BLOCK_VID_VV_MAX) == 1)
                    {
                      if (edition_settings.timeout_apv_block_vid_VV[group] != current_settings.timeout_apv_block_vid_VV[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_apv_block_vid_VV[group] = edition_settings.timeout_apv_block_vid_VV[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_APV)
                {
                  if ((edition_settings.control_apv  & ((unsigned int)(~CTR_APV_MASKA))) == 0)
                  {
                    if (edition_settings.control_apv != current_settings.control_apv)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_apv = edition_settings.control_apv;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_achr_chapv_uf[group], SETPOINT_ACHR_CHAPV_UF_MIN, SETPOINT_ACHR_CHAPV_UF_MAX) == 1)
                    {
                      if (edition_settings.setpoint_achr_chapv_uf[group] != current_settings.setpoint_achr_chapv_uf[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_achr_chapv_uf[group] = edition_settings.setpoint_achr_chapv_uf[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_achr1_f_rab[group], SETPOINT_ACHR1_F_RAB_MIN, SETPOINT_ACHR1_F_RAB_MAX) == 1)
                    {
                      if (edition_settings.setpoint_achr1_f_rab[group] != current_settings.setpoint_achr1_f_rab[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_achr1_f_rab[group] = edition_settings.setpoint_achr1_f_rab[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_chapv1_f_rab[group], SETPOINT_CHAPV1_F_RAB_MIN, SETPOINT_CHAPV1_F_RAB_MAX) == 1)
                    {
                      if (edition_settings.setpoint_chapv1_f_rab[group] != current_settings.setpoint_chapv1_f_rab[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_chapv1_f_rab[group] = edition_settings.setpoint_chapv1_f_rab[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_achr2_f_rab[group], SETPOINT_ACHR2_F_RAB_MIN, SETPOINT_ACHR2_F_RAB_MAX) == 1)
                    {
                      if (edition_settings.setpoint_achr2_f_rab[group] != current_settings.setpoint_achr2_f_rab[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_achr2_f_rab[group] = edition_settings.setpoint_achr2_f_rab[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_chapv2_f_rab[group], SETPOINT_CHAPV2_F_RAB_MIN, SETPOINT_CHAPV2_F_RAB_MAX) == 1)
                    {
                      if (edition_settings.setpoint_chapv2_f_rab[group] != current_settings.setpoint_chapv2_f_rab[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_chapv2_f_rab[group] = edition_settings.setpoint_chapv2_f_rab[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOACHR1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_achr_1[group], TIMEOUT_ACHR1_MIN,TIMEOUT_ACHR1_MAX) == 1)
                    {
                      if (edition_settings.timeout_achr_1[group] != current_settings.timeout_achr_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_achr_1[group] = edition_settings.timeout_achr_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_chapv_1[group], TIMEOUT_CHAPV1_MIN, TIMEOUT_CHAPV1_MAX) == 1)
                    {
                      if (edition_settings.timeout_chapv_1[group] != current_settings.timeout_chapv_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_chapv_1[group] = edition_settings.timeout_chapv_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOACHR2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_achr_2[group], TIMEOUT_ACHR2_MIN,TIMEOUT_ACHR2_MAX) == 1)
                    {
                      if (edition_settings.timeout_achr_2[group] != current_settings.timeout_achr_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_achr_2[group] = edition_settings.timeout_achr_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_chapv_2[group], TIMEOUT_CHAPV2_MIN, TIMEOUT_CHAPV2_MAX) == 1)
                    {
                      if (edition_settings.timeout_chapv_2[group] != current_settings.timeout_chapv_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_chapv_2[group] = edition_settings.timeout_chapv_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
                {
                  if ((edition_settings.control_achr_chapv & ((unsigned int)(~CTR_ACHR_CHAPV_MASKA))) == 0)
                  {
                    if (edition_settings.control_achr_chapv != current_settings.control_achr_chapv)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_achr_chapv = edition_settings.control_achr_chapv;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
                  
                  if (check_data_setpoint(edition_settings.setpoint_urov[group], SETPOINT_UROV_MIN, SETPOINT_UROV_MAX) == 1)
                  {
                    if (edition_settings.setpoint_urov[group] != current_settings.setpoint_urov[group])
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.setpoint_urov[group] = edition_settings.setpoint_urov[group];
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                       )
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUROV1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_urov_1[group], TIMEOUT_UROV1_MIN, TIMEOUT_UROV1_MAX) == 1)
                    {
                      if (edition_settings.timeout_urov_1[group] != current_settings.timeout_urov_1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_urov_1[group] = edition_settings.timeout_urov_1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else
                  {
                    if (check_data_setpoint(edition_settings.timeout_urov_2[group], TIMEOUT_UROV2_MIN, TIMEOUT_UROV2_MAX) == 1)
                    {
                      if (edition_settings.timeout_urov_2[group] != current_settings.timeout_urov_2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_urov_2[group] = edition_settings.timeout_urov_2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
                {
                  if ((edition_settings.control_urov  & ((uint64_t)(~CTR_UROV_MASKA))) == 0)
                  {
                    if (edition_settings.control_urov != current_settings.control_urov)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_urov = edition_settings.control_urov;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
                  
                  /*if (check_data_setpoint(edition_settings.setpoint_zop[group], SETPOINT_ZOP_MIN, SETPOINT_ZOP_MAX) == 1)
                  {
                    if (edition_settings.setpoint_zop[group] != current_settings.setpoint_zop[group])
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.setpoint_zop[group] = edition_settings.setpoint_zop[group];
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzr_Io3g_Io1g[group], PICKUP_DZR_K_3G_DIV_1G_MIN, PICKUP_DZR_K_3G_DIV_1G_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr_Io3g_Io1g[group] != current_settings.pickup_dzr_Io3g_Io1g[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr_Io3g_Io1g[group] = edition_settings.pickup_dzr_Io3g_Io1g[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1)
                  {
                   if (check_data_setpoint(edition_settings.pickup_dzr1[group], PICKUP_DZR1_MIN, PICKUP_DZR1_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr1[group] != current_settings.pickup_dzr1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr1[group] = edition_settings.pickup_dzr1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzr1_amtz[group], PICKUP_DZR1_AMTZ_MIN, PICKUP_DZR1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr1_amtz[group] != current_settings.pickup_dzr1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr1_amtz[group] = edition_settings.pickup_dzr1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                  {
                    if (check_data_setpoint(edition_settings.pickup_dzr1_blkI[group], PICKUP_DZR1_BLKI_MIN, PICKUP_DZR1_BLKI_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr1_blkI[group] != current_settings.pickup_dzr1_blkI[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr1_blkI[group] = edition_settings.pickup_dzr1_blkI[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr2_angle[group], PICKUP_DZR2_ANGLE_MIN, PICKUP_DZR2_ANGLE_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr2_angle[group] != current_settings.pickup_dzr2_angle[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        int angle = edition_settings.pickup_dzr2_angle[group];
                        current_settings.pickup_dzr2_angle[group] = angle;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        float angle_f = (float)angle;
                        current_settings.pickup_dzr2_angle_cos1[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dzr2_angle_sin1[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                        current_settings.pickup_dzr2_angle_cos2[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                        current_settings.pickup_dzr2_angle_sin2[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr2_dir[group], PICKUP_DZR2_DIR_MIN, PICKUP_DZR2_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr2_dir[group] != current_settings.pickup_dzr2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr2_dir[group] = edition_settings.pickup_dzr2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr2_inv[group], PICKUP_DZR2_INV_MIN, PICKUP_DZR2_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr2_inv[group] != current_settings.pickup_dzr2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr2_inv[group] = edition_settings.pickup_dzr2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr2_amtz[group], PICKUP_DZR2_AMTZ_MIN, PICKUP_DZR2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr2_amtz[group] != current_settings.pickup_dzr2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr2_amtz[group] = edition_settings.pickup_dzr2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (
                           (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H) ||
                           (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                          )   
                  {
                    if (
                        (check_data_setpoint_sign(edition_settings.pickup_dzr3_angle_h[group], PICKUP_DZR3_ANGLE_H_MIN, PICKUP_DZR3_ANGLE_H_MAX) == 1) &&
                        (check_data_setpoint_sign(edition_settings.pickup_dzr3_angle_l[group], PICKUP_DZR3_ANGLE_L_MIN, PICKUP_DZR3_ANGLE_L_MAX) == 1)
                       )   
                    {
                      int32_t diffPhi = edition_settings.pickup_dzr3_angle_h[group] - edition_settings.pickup_dzr3_angle_l[group];
                      while (diffPhi <    0) diffPhi += 360;
                      while (diffPhi >= 360) diffPhi -= 360;
                      
                      if (check_data_setpoint_sign(diffPhi, PICKUP_DZR3_ANGLE_DIFF_MIN, PICKUP_DZR3_ANGLE_DIFF_MAX) == 1)
                      {
                        if (
                            (edition_settings.pickup_dzr3_angle_h[group] != current_settings.pickup_dzr3_angle_h[group]) ||
                            (edition_settings.pickup_dzr3_angle_l[group] != current_settings.pickup_dzr3_angle_l[group])
                           )   
                        {
                          //Помічаємо, що поле структури зараз буде змінене
                          changed_settings = CHANGED_ETAP_EXECUTION;

                          //Верхня границя
                          int angle = edition_settings.pickup_dzr3_angle_h[group];
                          current_settings.pickup_dzr3_angle_h[group] = angle;

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          float angle_f = (float)angle;
                          current_settings.pickup_dzr3_angle_cos1_h[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzr3_angle_sin1_h[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzr3_angle_cos2_h[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                          current_settings.pickup_dzr3_angle_sin2_h[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                          //Нижня границя
                          angle = edition_settings.pickup_dzr3_angle_l[group];
                          current_settings.pickup_dzr3_angle_l[group] = angle;

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          angle_f = (float)angle;
                          current_settings.pickup_dzr3_angle_cos1_l[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzr3_angle_sin1_l[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*angle_f/180.0f)));
                          current_settings.pickup_dzr3_angle_cos2_l[group] = (int) (AMPLITUDA_SECTOR*/*cos*/arm_cos_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));
                          current_settings.pickup_dzr3_angle_sin2_l[group] = (int) (AMPLITUDA_SECTOR*/*sin*/arm_sin_f32(/*(double)*/(PI*(angle_f - DELTA_SECTOR_DZ)/180.0f)));

                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          fix_change_settings(0, 1);
                        }
                        //Виходимо з режиму редагування
                        current_ekran.edition = 0;
                      }
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr3_dir[group], PICKUP_DZR3_DIR_MIN, PICKUP_DZR3_DIR_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr3_dir[group] != current_settings.pickup_dzr3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr3_dir[group] = edition_settings.pickup_dzr3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr3_inv[group], PICKUP_DZR3_INV_MIN, PICKUP_DZR3_INV_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr3_inv[group] != current_settings.pickup_dzr3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr3_inv[group] = edition_settings.pickup_dzr3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.pickup_dzr3_amtz[group], PICKUP_DZR3_AMTZ_MIN, PICKUP_DZR3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.pickup_dzr3_amtz[group] != current_settings.pickup_dzr3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.pickup_dzr3_amtz[group] = edition_settings.pickup_dzr3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
                  
                  /*if (check_data_setpoint(edition_settings.timeout_zop[group], TIMEOUT_ZOP_MIN, TIMEOUT_ZOP_MAX) == 1)
                  {
                    if (edition_settings.timeout_zop[group] != current_settings.timeout_zop[group])
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.timeout_zop[group] = edition_settings.timeout_zop[group];
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }*/
                  if (current_ekran.index_position == INDEX_ML_TMO_DZR1)//////DZR
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr1[group], TIMEOUT_DZR1_MIN, TIMEOUT_DZR1_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr1[group] != current_settings.timeout_dzr1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr1[group] = edition_settings.timeout_dzr1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr1_amtz[group], TIMEOUT_DZR1_AMTZ_MIN, TIMEOUT_DZR1_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr1_amtz[group] != current_settings.timeout_dzr1_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr1_amtz[group] = edition_settings.timeout_dzr1_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_dir[group], TIMEOUT_DZR2_DIR_MIN, TIMEOUT_DZR2_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_dir[group] != current_settings.timeout_dzr2_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_dir[group] = edition_settings.timeout_dzr2_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_dir_pr[group], TIMEOUT_DZR2_DIR_PR_MIN, TIMEOUT_DZR2_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_dir_pr[group] != current_settings.timeout_dzr2_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_dir_pr[group] = edition_settings.timeout_dzr2_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_inv[group], TIMEOUT_DZR2_INV_MIN, TIMEOUT_DZR2_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_inv[group] != current_settings.timeout_dzr2_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_inv[group] = edition_settings.timeout_dzr2_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_inv_pr[group], TIMEOUT_DZR2_INV_PR_MIN, TIMEOUT_DZR2_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_inv_pr[group] != current_settings.timeout_dzr2_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_inv_pr[group] = edition_settings.timeout_dzr2_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_amtz[group], TIMEOUT_DZR2_AMTZ_MIN, TIMEOUT_DZR2_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_amtz[group] != current_settings.timeout_dzr2_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_amtz[group] = edition_settings.timeout_dzr2_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_amtz_pr[group], TIMEOUT_DZR2_AMTZ_PR_MIN, TIMEOUT_DZR2_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_amtz_pr[group] != current_settings.timeout_dzr2_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_amtz_pr[group] = edition_settings.timeout_dzr2_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_vvid_pr[group], TIMEOUT_DZR2_VVID_PR_MIN, TIMEOUT_DZR2_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_vvid_pr[group] != current_settings.timeout_dzr2_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_vvid_pr[group] = edition_settings.timeout_dzr2_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr2_amtz_vvid_pr[group], TIMEOUT_DZR2_AMTZ_VVID_PR_MIN, TIMEOUT_DZR2_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr2_amtz_vvid_pr[group] != current_settings.timeout_dzr2_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr2_amtz_vvid_pr[group] = edition_settings.timeout_dzr2_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_dir[group], TIMEOUT_DZR3_DIR_MIN, TIMEOUT_DZR3_DIR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_dir[group] != current_settings.timeout_dzr3_dir[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_dir[group] = edition_settings.timeout_dzr3_dir[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_dir_pr[group], TIMEOUT_DZR3_DIR_PR_MIN, TIMEOUT_DZR3_DIR_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_dir_pr[group] != current_settings.timeout_dzr3_dir_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_dir_pr[group] = edition_settings.timeout_dzr3_dir_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_inv[group], TIMEOUT_DZR3_INV_MIN, TIMEOUT_DZR3_INV_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_inv[group] != current_settings.timeout_dzr3_inv[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_inv[group] = edition_settings.timeout_dzr3_inv[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_inv_pr[group], TIMEOUT_DZR3_INV_PR_MIN, TIMEOUT_DZR3_INV_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_inv_pr[group] != current_settings.timeout_dzr3_inv_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_inv_pr[group] = edition_settings.timeout_dzr3_inv_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_amtz[group], TIMEOUT_DZR3_AMTZ_MIN, TIMEOUT_DZR3_AMTZ_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_amtz[group] != current_settings.timeout_dzr3_amtz[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_amtz[group] = edition_settings.timeout_dzr3_amtz[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_amtz_pr[group], TIMEOUT_DZR3_AMTZ_PR_MIN, TIMEOUT_DZR3_AMTZ_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_amtz_pr[group] != current_settings.timeout_dzr3_amtz_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_amtz_pr[group] = edition_settings.timeout_dzr3_amtz_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_vvid_pr[group], TIMEOUT_DZR3_VVID_PR_MIN, TIMEOUT_DZR3_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_vvid_pr[group] != current_settings.timeout_dzr3_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_vvid_pr[group] = edition_settings.timeout_dzr3_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_dzr3_amtz_vvid_pr[group], TIMEOUT_DZR3_AMTZ_VVID_PR_MIN, TIMEOUT_DZR3_AMTZ_VVID_PR_MAX) == 1)
                    {
                      if (edition_settings.timeout_dzr3_amtz_vvid_pr[group] != current_settings.timeout_dzr3_amtz_vvid_pr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_dzr3_amtz_vvid_pr[group] = edition_settings.timeout_dzr3_amtz_vvid_pr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }

                
                  
                 
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZR)
                  {
                    if (check_data_setpoint_sign(edition_settings.timeout_nkn_dzr[group], TIMEOUT_NKN_DZR_MIN, TIMEOUT_NKN_DZR_MAX) == 1)
                    {
                      if (edition_settings.timeout_nkn_dzr[group] != current_settings.timeout_nkn_dzr[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_nkn_dzr[group] = edition_settings.timeout_nkn_dzr[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
                {
                  /*if ((edition_settings.control_zop  & ((unsigned int)(~CTR_ZOP_MASKA))) == 0)
                  {
                    if (edition_settings.control_zop != current_settings.control_zop)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_zop = edition_settings.control_zop;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }*/
                  if (
                      ((edition_settings.control_dzr  & ((unsigned int)(~CTR_DZR_MASKA))) == 0)
                     )   
                  {
                    if (
                        (edition_settings.control_dzr != current_settings.control_dzr) 
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_dzr = edition_settings.control_dzr;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                  
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPUMIN1)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umin1[group], SETPOINT_UMIN1_MIN, SETPOINT_UMIN1_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umin1[group] != current_settings.setpoint_Umin1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umin1[group] = edition_settings.setpoint_Umin1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umin1_Iblk[group], SETPOINT_UMIN1_IBLK_MIN, SETPOINT_UMIN1_IBLK_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umin1_Iblk[group] != current_settings.setpoint_Umin1_Iblk[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umin1_Iblk[group] = edition_settings.setpoint_Umin1_Iblk[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umin2[group], SETPOINT_UMIN2_MIN, SETPOINT_UMIN2_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umin2[group] != current_settings.setpoint_Umin2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umin2[group] = edition_settings.setpoint_Umin2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umin2_Iblk[group], SETPOINT_UMIN2_IBLK_MIN, SETPOINT_UMIN2_IBLK_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umin2_Iblk[group] != current_settings.setpoint_Umin2_Iblk[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umin2_Iblk[group] = edition_settings.setpoint_Umin2_Iblk[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMIN1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_Umin1[group], TIMEOUT_UMIN1_MIN, TIMEOUT_UMIN1_MAX) == 1)
                    {
                      if (edition_settings.timeout_Umin1[group] != current_settings.timeout_Umin1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_Umin1[group] = edition_settings.timeout_Umin1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMIN2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_Umin2[group], TIMEOUT_UMIN2_MIN, TIMEOUT_UMIN2_MAX) == 1)
                    {
                      if (edition_settings.timeout_Umin2[group] != current_settings.timeout_Umin2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_Umin2[group] = edition_settings.timeout_Umin2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
                {
                  if ((edition_settings.control_Umin  & ((unsigned int)(~CTR_UMIN_MASKA))) == 0)
                  {
                    if (edition_settings.control_Umin != current_settings.control_Umin)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_Umin = edition_settings.control_Umin;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_STPUMAX1)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umax1[group], SETPOINT_UMAX1_MIN, SETPOINT_UMAX1_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umax1[group] != current_settings.setpoint_Umax1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umax1[group] = edition_settings.setpoint_Umax1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPUMAX2)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Umax2[group], SETPOINT_UMAX2_MIN, SETPOINT_UMAX2_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Umax2[group] != current_settings.setpoint_Umax2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Umax2[group] = edition_settings.setpoint_Umax2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_kp_Umax[group], SETPOINT_KP_UMAX_MIN, SETPOINT_KP_UMAX_MAX) == 1)
                    {
                      if (edition_settings.setpoint_kp_Umax[group] != current_settings.setpoint_kp_Umax[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_kp_Umax[group] = edition_settings.setpoint_kp_Umax[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1)&&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOUMAX1)
                  {
                    if (check_data_setpoint(edition_settings.timeout_Umax1[group], TIMEOUT_UMAX1_MIN, TIMEOUT_UMAX1_MAX) == 1)
                    {
                      if (edition_settings.timeout_Umax1[group] != current_settings.timeout_Umax1[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_Umax1[group] = edition_settings.timeout_Umax1[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUMAX2)
                  {
                    if (check_data_setpoint(edition_settings.timeout_Umax2[group], TIMEOUT_UMAX2_MIN, TIMEOUT_UMAX2_MAX) == 1)
                    {
                      if (edition_settings.timeout_Umax2[group] != current_settings.timeout_Umax2[group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_Umax2[group] = edition_settings.timeout_Umax2[group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
                {
                  if ((edition_settings.control_Umax  & ((unsigned int)(~CTR_UMAX_MASKA))) == 0)
                  {
                    if (edition_settings.control_Umax != current_settings.control_Umax)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_Umax = edition_settings.control_Umax;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                       )   
                {
                  int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                  if (_n_index == INDEX_ML_STP_UP)
                  {
                    uint32_t min = 0, max = 0, PQ = false;
                    switch (current_settings.ctrl_UP_input[_n_UP])
                    {
                    case UP_CTRL_Ia_Ib_Ic:
                    case UP_CTRL_Ia:
                    case UP_CTRL_Ib:
                    case UP_CTRL_Ic:
                    case UP_CTRL_I1:
                    case UP_CTRL_I2:
                    case UP_CTRL_3I0_r:
                      {
                        min = SETPOINT_UP_I_MIN;
                        max = SETPOINT_UP_I_MAX;
                        break;
                      }
                    case UP_CTRL_3I0:
                    case UP_CTRL_3I0_others:
                      {
                        min = SETPOINT_UP_3I0_MIN;
                        max = SETPOINT_UP_3I0_MAX;
                        break;
                      }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                      {
                        min = SETPOINT_UP_U_MIN;
                        max = SETPOINT_UP_U_MAX;
                        break;
                      }
                    case UP_CTRL_P:
                    case UP_CTRL_Q:
                      {
                        PQ = true;
                        min = SETPOINT_UP_P_MIN;
                        max = SETPOINT_UP_P_MAX;
                        break;
                      }
                    case UP_CTRL_S:
                      {
                        min = SETPOINT_UP_P_MIN;
                        max = SETPOINT_UP_P_MAX;
                        break;
                      }
                    default:
                      {
                        //Теоретично цього ніколи не мало б бути
                        total_error_sw_fixed();
                      }
                    }
                    if (
                        (
                         (PQ == false) &&
                         (check_data_setpoint(edition_settings.setpoint_UP[_n_UP][0][group], min, max) == 1)
                        )   
                        ||  
                        (
                         (PQ == true) &&
                         (check_data_setpoint(abs(edition_settings.setpoint_UP[_n_UP][0][group]), min, max) == 1)
                        )   
                       )   
                    {
                      if (edition_settings.setpoint_UP[_n_UP][0][group] != current_settings.setpoint_UP[_n_UP][0][group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_UP[_n_UP][0][group] = edition_settings.setpoint_UP[_n_UP][0][group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (_n_index == INDEX_ML_STP_UP_KP)
                  {
                    uint32_t maska = MASKA_FOR_BIT(_n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_MORE_LESS_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                    uint32_t min, max;
                    if ((current_settings.control_UP & maska) != 0)
                    {
                      min = SETPOINT_UP_KP_LESS_MIN;
                      max = SETPOINT_UP_KP_LESS_MAX;
                    }
                    else
                    {
                      min = SETPOINT_UP_KP_MORE_MIN;
                      max = SETPOINT_UP_KP_MORE_MAX;
                    }
                    
                    if (check_data_setpoint(edition_settings.setpoint_UP_KP[_n_UP][0][group], min, max) == 1)
                    {
                      if (edition_settings.setpoint_UP_KP[_n_UP][0][group] != current_settings.setpoint_UP_KP[_n_UP][0][group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_UP_KP[_n_UP][0][group] = edition_settings.setpoint_UP_KP[_n_UP][0][group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                        (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                       )
                {
                  int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
                  
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_TIMEOUT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;
                  if (_n_index == INDEX_ML_TMOUP)
                  {
                    if (check_data_setpoint(edition_settings.timeout_UP[_n_UP][0][group], TIMEOUT_UP_MIN, TIMEOUT_UP_MAX) == 1)
                    {
                      if (edition_settings.timeout_UP[_n_UP][0][group] != current_settings.timeout_UP[_n_UP][0][group])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_UP[_n_UP][0][group] = edition_settings.timeout_UP[_n_UP][0][group];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_UP)
                {
                  if (
                      ((edition_settings.control_UP & ((unsigned int)(~CTR_UP_MASKA_A01))) == 0) &&
                      (edition_settings.ctrl_UP_input[0] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[1] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[2] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[3] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[4] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[5] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[6] < _UP_CTRL_A01_NUMBER) &&
                      (edition_settings.ctrl_UP_input[7] < _UP_CTRL_A01_NUMBER)
                     )   
                  {
                    if (
                        (edition_settings.control_UP != current_settings.control_UP) ||
                        (edition_settings.ctrl_UP_input[0] != current_settings.ctrl_UP_input[0]) ||
                        (edition_settings.ctrl_UP_input[1] != current_settings.ctrl_UP_input[1]) ||
                        (edition_settings.ctrl_UP_input[2] != current_settings.ctrl_UP_input[2]) ||
                        (edition_settings.ctrl_UP_input[3] != current_settings.ctrl_UP_input[3]) ||
                        (edition_settings.ctrl_UP_input[4] != current_settings.ctrl_UP_input[4]) ||
                        (edition_settings.ctrl_UP_input[5] != current_settings.ctrl_UP_input[5]) ||
                        (edition_settings.ctrl_UP_input[6] != current_settings.ctrl_UP_input[6]) ||
                        (edition_settings.ctrl_UP_input[7] != current_settings.ctrl_UP_input[7])
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                      
                      for (size_t i = 0; i < NUMBER_UP; i++)
                      {
                        action_after_changing_input_UP(&current_settings, i, edition_settings.ctrl_UP_input[i]);
                      }
                      action_after_changing_ctrl_UP(&current_settings,  edition_settings.control_UP);
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
                {
                  if (current_ekran.index_position == INDEX_ML_T_BP)
                  {
                    if (check_data_setpoint(edition_settings.Tbp, KOEF_T_RSV_MIN, KOEF_T_RSV_MAX) == 1)
                    {
                      if (edition_settings.Tbp != current_settings.Tbp)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.Tbp = edition_settings.Tbp;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_T_MN)
                  {
                    if (check_data_setpoint(edition_settings.Tmn, KOEF_T_OSN_MIN, KOEF_T_OSN_MAX) == 1)
                    {
                      if (edition_settings.Tmn != current_settings.Tmn)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.Tmn = edition_settings.Tmn;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else
                  {
                    if (check_data_setpoint(edition_settings.TVoltage, KOEF_TN_MIN, KOEF_TN_MAX) == 1)
                    {
                      if (edition_settings.TVoltage != current_settings.TVoltage)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.TVoltage = edition_settings.TVoltage;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
                {
                  if ((edition_settings.control_transformator  & ((unsigned int)(~CTR_TRANSFORMATOR_MASKA))) == 0)
                  {
                    if (edition_settings.control_transformator != current_settings.control_transformator)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_transformator = edition_settings.control_transformator;
                      
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_STPInom)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Inom, SETPOINT_Inom_MIN, SETPOINT_Inom_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Inom != current_settings.setpoint_Inom)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Inom = edition_settings.setpoint_Inom;

                        //Розраховуємо коефіцієнти для розрахунку ресурсу вимикача
                        make_koef_for_resurs();

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_r_kom_st_Inom, SETPOINT_RKS_Inom_MIN, SETPOINT_RKS_Inom_MAX) == 1)
                    {
                      if (edition_settings.setpoint_r_kom_st_Inom != current_settings.setpoint_r_kom_st_Inom)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_r_kom_st_Inom = edition_settings.setpoint_r_kom_st_Inom;

                        //Розраховуємо коефіцієнти для розрахунку ресурсу вимикача
                        make_koef_for_resurs();

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_Inom_vymk, SETPOINT_Inom_vymk_MIN, SETPOINT_Inom_vymk_MAX) == 1)
                    {
                      if (edition_settings.setpoint_Inom_vymk != current_settings.setpoint_Inom_vymk)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_Inom_vymk = edition_settings.setpoint_Inom_vymk;

                        //Розраховуємо коефіцієнти для розрахунку ресурсу вимикача
                        make_koef_for_resurs();

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_r_kom_st_Inom_vymk, SETPOINT_RKS_Inom_vymk_MIN, SETPOINT_RKS_Inom_vymk_MAX) == 1)
                    {
                      if (edition_settings.setpoint_r_kom_st_Inom_vymk != current_settings.setpoint_r_kom_st_Inom_vymk)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_r_kom_st_Inom_vymk = edition_settings.setpoint_r_kom_st_Inom_vymk;

                        //Розраховуємо коефіцієнти для розрахунку ресурсу вимикача
                        make_koef_for_resurs();

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_pochatkovyj_resurs, (2*(current_settings.setpoint_r_kom_st_Inom/current_settings.setpoint_r_kom_st_Inom_vymk)), current_settings.setpoint_r_kom_st_Inom) == 1)
                    {
                      if (edition_settings.setpoint_pochatkovyj_resurs != current_settings.setpoint_pochatkovyj_resurs)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_pochatkovyj_resurs = edition_settings.setpoint_pochatkovyj_resurs;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                  {
                    unsigned int chastka = current_settings.setpoint_r_kom_st_Inom/current_settings.setpoint_r_kom_st_Inom_vymk;
                    if (check_data_setpoint(edition_settings.setpoint_krytychnyj_resurs, chastka, (2*chastka)) == 1)
                    {
                      if (edition_settings.setpoint_krytychnyj_resurs != current_settings.setpoint_krytychnyj_resurs)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_krytychnyj_resurs = edition_settings.setpoint_krytychnyj_resurs;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                  {
                    if (check_data_setpoint(edition_settings.setpoint_pochatkova_k_vymk, 0, current_settings.setpoint_r_kom_st_Inom) == 1)
                    {
                      if (edition_settings.setpoint_pochatkova_k_vymk != current_settings.setpoint_pochatkova_k_vymk)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.setpoint_pochatkova_k_vymk = edition_settings.setpoint_pochatkova_k_vymk;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_on, TIMEOUT_SWCH_ON_MIN, TIMEOUT_SWCH_ON_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_on != current_settings.timeout_swch_on)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_on = edition_settings.timeout_swch_on;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_off, TIMEOUT_SWCH_OFF_MIN, TIMEOUT_SWCH_OFF_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_off != current_settings.timeout_swch_off)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_off = edition_settings.timeout_swch_off;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_udl_blk_on, TIMEOUT_SWCH_UDL_BLK_ON_MIN, TIMEOUT_SWCH_UDL_BLK_ON_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_udl_blk_on != current_settings.timeout_swch_udl_blk_on)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_udl_blk_on = edition_settings.timeout_swch_udl_blk_on;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    if (check_data_setpoint(edition_settings.timeout_pryvoda_VV, TIMEOUT_PRYVODA_VV_MIN, TIMEOUT_PRYVODA_VV_MAX) == 1)
                    {
                      if (edition_settings.timeout_pryvoda_VV != current_settings.timeout_pryvoda_VV)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_pryvoda_VV = edition_settings.timeout_pryvoda_VV;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
                {
                  if ((edition_settings.control_switch & ((unsigned int)(~CTR_SWITCH_MASKA))) == 0)
                  {
                    if (edition_settings.control_switch != current_settings.control_switch)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_switch = edition_settings.control_switch;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                        (current_ekran.current_level <  (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H;
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_on_[on_off], TIMEOUT_SWCH_ON_MIN, TIMEOUT_SWCH_ON_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_on_[on_off] != current_settings.timeout_swch_on_[on_off])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_on_[on_off] = edition_settings.timeout_swch_on_[on_off];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_off_[on_off], TIMEOUT_SWCH_OFF_MIN, TIMEOUT_SWCH_OFF_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_off_[on_off] != current_settings.timeout_swch_off_[on_off])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_off_[on_off] = edition_settings.timeout_swch_off_[on_off];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                  {
                    if (check_data_setpoint(edition_settings.timeout_swch_udl_blk_on_[on_off], TIMEOUT_SWCH_UDL_BLK_ON_MIN, TIMEOUT_SWCH_UDL_BLK_ON_MAX) == 1)
                    {
                      if (edition_settings.timeout_swch_udl_blk_on_[on_off] != current_settings.timeout_swch_udl_blk_on_[on_off])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_swch_udl_blk_on_[on_off] = edition_settings.timeout_swch_udl_blk_on_[on_off];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                  {
                    if (check_data_setpoint(edition_settings.timeout_pryvoda_VV_[on_off], TIMEOUT_PRYVODA_VV_MIN, TIMEOUT_PRYVODA_VV_MAX) == 1)
                    {
                      if (edition_settings.timeout_pryvoda_VV_[on_off] != current_settings.timeout_pryvoda_VV_[on_off])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_pryvoda_VV_[on_off] = edition_settings.timeout_pryvoda_VV_[on_off];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(
                        (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                        (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                       )   
                {
                  uint32_t on_off = current_ekran.current_level - EKRAN_CONTROL_SWITCH_H;
                  if ((edition_settings.control_switch_[on_off] & ((unsigned int)(~CTR_SWITCH_MASKA))) == 0)
                  {
                    if (edition_settings.control_switch_[on_off] != current_settings.control_switch_[on_off])
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_switch_[on_off] = edition_settings.control_switch_[on_off];
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                
                else if(
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                        (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                       )   
                {
                  int forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
                  
                  if (current_ekran.index_position == INDEX_ML_LINES)
                  {
                    if (check_data_setpoint(edition_settings.lines[forward_backward], ((forward_backward == 0) ? NUMBER_LINES_FORWARD_MIN:NUMBER_LINES_BACKWARD_MIN), NUMBER_LINES_MAX) == 1)
                    {
                      if (edition_settings.lines[forward_backward] != current_settings.lines[forward_backward])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.lines[forward_backward] = edition_settings.lines[forward_backward];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else
                  {
                    int _tmp = current_ekran.index_position - 1;
                    int dilanka = _tmp >> 1;
                    if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                    {
                      if (check_data_setpoint(edition_settings.dovgyna[forward_backward][dilanka], SETPOINT_DOVGYNA_VMP_MIN, SETPOINT_DOVGYNA_VMP_MAX) == 1)
                      {
                        if (edition_settings.dovgyna[forward_backward][dilanka] != current_settings.dovgyna[forward_backward][dilanka])
                        {
                          //Помічаємо, що поле структури зараз буде змінене
                          changed_settings = CHANGED_ETAP_EXECUTION;
                        
                          current_settings.dovgyna[forward_backward][dilanka] = edition_settings.dovgyna[forward_backward][dilanka];
                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          fix_change_settings(0, 1);
                        }
                        //Виходимо з режиму редагування
                        current_ekran.edition = 0;
                      }
                    }
                    else
                    {
                      if (check_data_setpoint(edition_settings.opir[forward_backward][dilanka], SETPOINT_OPIR_VMP_MIN, SETPOINT_OPIR_VMP_MAX) == 1)
                      {
                        if (edition_settings.opir[forward_backward][dilanka] != current_settings.opir[forward_backward][dilanka])
                        {
                          //Помічаємо, що поле структури зараз буде змінене
                          changed_settings = CHANGED_ETAP_EXECUTION;
                        
                          current_settings.opir[forward_backward][dilanka] = edition_settings.opir[forward_backward][dilanka];
                          //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                          fix_change_settings(0, 1);
                        }
                        //Виходимо з режиму редагування
                        current_ekran.edition = 0;
                      }
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
                {
                  if ((edition_settings.control_vmp & ((unsigned int)(~CTR_VMP_MASKA))) == 0)
                  {
                    if (edition_settings.control_vmp != current_settings.control_vmp)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.control_vmp = edition_settings.control_vmp;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
                {
                  unsigned int min_value;
                  if ((current_settings.type_of_input_signal & (1 << current_ekran.index_position)) == 0)
                    min_value = KOEF_DOPUSK_DV_POST_MIN;
                  else 
                    min_value = KOEF_DOPUSK_DV_ZMIN_MIN;
                  if (check_data_setpoint(edition_settings.dopusk_dv[current_ekran.index_position], min_value, KOEF_DOPUSK_DV_MAX) == 1)
                  {
                    if (edition_settings.dopusk_dv[current_ekran.index_position] != current_settings.dopusk_dv[current_ekran.index_position])
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.dopusk_dv[current_ekran.index_position] = edition_settings.dopusk_dv[current_ekran.index_position];
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                {
                  if ((edition_settings.type_of_input & ((unsigned int)(~((1<<NUMBER_INPUTS)-1)))) == 0)
                  {
                    if (edition_settings.type_of_input != current_settings.type_of_input)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                      
                      current_settings.type_of_input = edition_settings.type_of_input;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV)
                {
                  if ((edition_settings.type_of_input_signal & ((unsigned int)(~((1<<NUMBER_INPUTS)-1)))) == 0)
                  {
                    if (edition_settings.type_of_input_signal != current_settings.type_of_input_signal)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                      
                      correct_dopusk_dv_when_type_of_input_signal_is_changed();
                      current_settings.type_of_input_signal = edition_settings.type_of_input_signal;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
                {
                  if (
                      ((edition_settings.type_of_output       & ((unsigned int)(~((1<<NUMBER_SIMPLE_OUTPUTS)-1)))) == 0) &&
                      ((edition_settings.type_of_output_modif & ((unsigned int)(~((1<<NUMBER_SIMPLE_OUTPUTS)-1)))) == 0)
                     )
                  {
                    if (
                        (edition_settings.type_of_output       != current_settings.type_of_output      ) ||
                        (edition_settings.type_of_output_modif != current_settings.type_of_output_modif)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.type_of_output       = edition_settings.type_of_output;
                      current_settings.type_of_output_modif = edition_settings.type_of_output_modif;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
                {
                  if ((edition_settings.type_of_led & ((unsigned int)(~((1<<NUMBER_LEDS)-1)))) == 0)
                  {
                    if (edition_settings.type_of_led != current_settings.type_of_led)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.type_of_led = edition_settings.type_of_led;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
                {
                  if ((edition_settings.buttons_mode & ((unsigned int)(~((1 << NUMBER_DEFINED_BUTTONS) - 1)))) == 0)
                  {
                    if (edition_settings.buttons_mode != current_settings.buttons_mode)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      //Зміна режиму відбудеться у цій функції рахом з можливими змінами у ранжуванні ФК
                      action_during_changing_button_mode(&current_settings, &edition_settings);

                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_ADDRESS)
                {
                  if (check_data_setpoint(edition_settings.address, KOEF_ADDRESS_MIN, KOEF_ADDRESS_MAX) == 1)
                  {
                    unsigned int edit_value = edition_settings.address;
                    if (edit_value != current_settings.address)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.address = edit_value;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
                {
                  if (check_data_setpoint(edition_settings.speed_RS485, VALUE_SPEED_INTERFACE_MIN, VALUE_SPEED_INTERFACE_MAX) == 1)
                  {
                    if (edition_settings.speed_RS485 != current_settings.speed_RS485)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.speed_RS485 = edition_settings.speed_RS485;
                      //Підраховуємо нову величину затримки у бітах, яка допускається між байтами у RS-485 згідно з визначеними настройками
                      calculate_namber_bit_waiting_for_rs_485();
                      //Виставляємо команду про переконфігурування RS-485
                      make_reconfiguration_RS_485 = 0xff;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
                {
                  if (check_data_setpoint(edition_settings.pare_bit_RS485, VALUE_PARE_INTERFACE_MIN, VALUE_PARE_INTERFACE_MAX) == 1)
                  {
                    if (edition_settings.pare_bit_RS485 != current_settings.pare_bit_RS485)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.pare_bit_RS485 = edition_settings.pare_bit_RS485;
                      //Підраховуємо нову величину затримки у бітах, яка допускається між байтами у RS-485 згідно з визначеними настройками
                      calculate_namber_bit_waiting_for_rs_485();
                      //Виставляємо команду про переконфігурування RS-485
                      make_reconfiguration_RS_485 = 0xff;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
                {
                  if (check_data_setpoint(edition_settings.number_stop_bit_RS485, VALUE_STOP_BITS_INTERFACE_MIN, VALUE_STOP_BITS_INTERFACE_MAX) == 1)
                  {
                    if (edition_settings.number_stop_bit_RS485 != current_settings.number_stop_bit_RS485)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.number_stop_bit_RS485 = edition_settings.number_stop_bit_RS485;
                      //Підраховуємо нову величину затримки у бітах, яка допускається між байтами у RS-485 згідно з визначеними настройками
                      calculate_namber_bit_waiting_for_rs_485();
                      //Виставляємо команду про переконфігурування RS-485
                      make_reconfiguration_RS_485 = 0xff;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
                {
                  if (check_data_setpoint(edition_settings.time_out_1_RS485, VALUE_TIME_OUT_1_INTERFACE_MIN, VALUE_TIME_OUT_1_INTERFACE_MAX) == 1)
                  {
                    if (edition_settings.time_out_1_RS485 != current_settings.time_out_1_RS485)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.time_out_1_RS485 = edition_settings.time_out_1_RS485;
                      //Підраховуємо нову величину затримки у бітах, яка допускається між байтами у RS-485 згідно з визначеними настройками
                      calculate_namber_bit_waiting_for_rs_485();
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TIME_ZONE)
                {
                  if (
                      ((edition_settings.time_zone >= TIME_ZONE_MIN) || (edition_settings.time_zone <= TIME_ZONE_MAX)) &&
                      ((edition_settings.dst  & ((unsigned int)(~CTR_TZ_MASKA))) == 0)
                     )   
                  {
                    if (
                        (edition_settings.time_zone != current_settings.time_zone) ||
                        (edition_settings.dst != current_settings.dst)
                       )   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.time_zone = edition_settings.time_zone;
                      current_settings.dst = edition_settings.dst;
#if (__VER__ >= 8000000)
                      _ForceReloadDstRules();
#endif
                      
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_DST_RULE)
                {
                  uint32_t *p_rule_target = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? &edition_settings.dst_on_rule : &edition_settings.dst_off_rule;
                  int mounth = (*p_rule_target >> POS_MM) & ((1 << SHIFT_MM) - 1);
                  int dow = (*p_rule_target >> POS_DOW) & ((1 << SHIFT_DOW) - 1);
                  int wr = (*p_rule_target >> POS_WR) & ((1 << SHIFT_WR) - 1);
                  int hour = (*p_rule_target >> POS_HH) & ((1 << SHIFT_HH) - 1);

                  if (
                      (
                       (mounth >= DST_RULE_MM_MIN ) && (mounth <= DST_RULE_MM_MAX )) &&
                      ((dow    >= DST_RULE_DOW_MIN) && (dow    <= DST_RULE_DOW_MAX)) &&
                      ((wr     >= DST_RULE_DR_MIN ) && (wr     <= DST_RULE_DR_MAX )) &&
                      ((hour   >= DST_RULE_HH_MIN ) && (hour   <= DST_RULE_HH_MAX ))
                     )   
                  {
                    uint32_t *p_rule_source = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? &current_settings.dst_on_rule : &current_settings.dst_off_rule;
                    if (*p_rule_target != *p_rule_source)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      *p_rule_source = *p_rule_target;
#if (__VER__ >= 8000000)
                      _ForceReloadDstRules();
#endif
                      
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
                {
                  if (current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                  {
                    if (check_data_setpoint(edition_settings.number_iteration_el, NUMBER_ITERATION_EL_MIN, NUMBER_ITERATION_EL_MAX) == 1)
                    {
                      if (edition_settings.number_iteration_el != current_settings.number_iteration_el)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;

                        current_settings.number_iteration_el = edition_settings.number_iteration_el;
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_df, NUMBER_DEFINED_FUNCTIONS_MIN, NUMBER_DEFINED_FUNCTIONS_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_df != current_settings.number_defined_df)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_df = edition_settings.number_defined_df;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 0);
//                      
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_dt, NUMBER_DEFINED_TRIGGERS_MIN, NUMBER_DEFINED_TRIGGERS_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_dt != current_settings.number_defined_dt)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_dt = edition_settings.number_defined_dt;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 1);
//
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_and, NUMBER_DEFINED_AND_MIN, NUMBER_DEFINED_AND_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_and != current_settings.number_defined_and)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_and = edition_settings.number_defined_and;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 2);
//
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_or, NUMBER_DEFINED_OR_MIN, NUMBER_DEFINED_OR_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_or != current_settings.number_defined_or)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_or = edition_settings.number_defined_or;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 3);
//
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_xor, NUMBER_DEFINED_XOR_MIN, NUMBER_DEFINED_XOR_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_xor != current_settings.number_defined_xor)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_xor = edition_settings.number_defined_xor;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 4);
//
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                  {
//                    if (check_data_setpoint(edition_settings.number_defined_not, NUMBER_DEFINED_NOT_MIN, NUMBER_DEFINED_NOT_MAX) == 1)
//                    {
//                      if (edition_settings.number_defined_not != current_settings.number_defined_not)
//                      {
//                        //Помічаємо, що поле структури зараз буде змінене
//                        changed_settings = CHANGED_ETAP_EXECUTION;
//
//                        current_settings.number_defined_not = edition_settings.number_defined_not;
//                        //Обновляємо значення
//                        action_after_changing_number_el(&current_settings, 5);
//
//                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
//                        fix_change_settings(0, 1);
//                      }
//                      //Виходимо з режиму редагування
//                      current_ekran.edition = 0;
//                    }
//                  }
                }
                else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
                {
                  if ((edition_settings.type_df & ((unsigned int)(~((1<<NUMBER_DEFINED_FUNCTIONS)-1)))) == 0)
                  {
                    if (edition_settings.type_df != current_settings.type_df)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.type_df = edition_settings.type_df;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                  {
                    if (check_data_setpoint(edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], TIMEOUT_DF_PAUSE_MIN, TIMEOUT_DF_PAUSE_MAX) == 1)
                    {
                      if (edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] != 
                          current_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;

                        current_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                          edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else
                  {
                    if (check_data_setpoint(edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], TIMEOUT_DF_WORK_MIN, TIMEOUT_DF_WORK_MAX) == 1)
                    {
                      if (edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] != 
                          current_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1])
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;

                        current_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                          edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1];
                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1))
                {
                  uint32_t value_after = edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1];
                  if (
                      ((value_after         & 0xffff) < (1 + TOTAL_SIGNAL_FOR_RNG_BIG      )) &&
                      (((value_after >> 16) & 0xffff) < (1 + TOTAL_SIGNAL_FOR_RANG_SMALL_A01))
                     )   
                  {
                    uint32_t value_before = current_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1];
                    if (value_after != value_before)   
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] = 
                        edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1];
                      //Формуємо запис у таблиці настройок про зміну ранжування і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(1, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMO_ELONGATION)
                  {
                    if (check_data_setpoint((edition_settings.timeout_prolongation_work_digital_registrator), TIMEOUT_DR_ELONGATION_MIN, TIMEOUT_DR_ELONGATION_MAX) == 1)
                    {
                      if (edition_settings.timeout_prolongation_work_digital_registrator != current_settings.timeout_prolongation_work_digital_registrator)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.timeout_prolongation_work_digital_registrator = edition_settings.timeout_prolongation_work_digital_registrator;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
         
                }
                else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
                {
                  if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  {
                    if (check_data_setpoint((edition_settings.prefault_number_periods*20), TIMEOUT_PREFAULT_MIN, TIMEOUT_PREFAULT_MAX) == 1)
                    {
                      if (edition_settings.prefault_number_periods != current_settings.prefault_number_periods)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.prefault_number_periods = edition_settings.prefault_number_periods;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                  else
                  {
                    if (check_data_setpoint((edition_settings.postfault_number_periods*20), TIMEOUT_POSTFAULT_MIN, TIMEOUT_POSTFAULT_MAX) == 1)
                    {
                      if (edition_settings.postfault_number_periods != current_settings.postfault_number_periods)
                      {
                        //Помічаємо, що поле структури зараз буде змінене
                        changed_settings = CHANGED_ETAP_EXECUTION;
                        
                        current_settings.postfault_number_periods = edition_settings.postfault_number_periods;

                        //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                        fix_change_settings(0, 1);
                      }
                      //Виходимо з режиму редагування
                      current_ekran.edition = 0;
                    }
                  }
                }
                else if(current_ekran.current_level == EKRAN_CONTROL_AR)
                {
                  if ((edition_settings.control_ar & ((unsigned int)(~CTR_AR_MASKA))) == 0)
                  {
                    if (edition_settings.control_ar != current_settings.control_ar)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;

                      current_settings.control_ar = edition_settings.control_ar;
                      //Формуємо запис у таблиці настройок про зміну і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
                {
                  if (check_data_setpoint(edition_settings.language, VALUE_SETTING_LANGUAGE_MIN, VALUE_SETTING_LANGUAGE_MAX) == 1)
                  {
                    if (edition_settings.language != current_settings.language)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.language = edition_settings.language;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
                {
                  if ((edition_settings.control_extra_settings_1  & ((unsigned int)(~CTR_EXTRA_SETTINGS_1_MASKA))) == 0)
                  {
                    if (edition_settings.control_extra_settings_1 != current_settings.control_extra_settings_1)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                      
                      current_settings.control_extra_settings_1 = edition_settings.control_extra_settings_1;
                      
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
                {
                  if (check_data_setpoint(edition_settings.grupa_ustavok, SETPOINT_GRUPA_USTAVOK_MIN, SETPOINT_GRUPA_USTAVOK_MAX) == 1)
                  {
                    if (edition_settings.grupa_ustavok != current_settings.grupa_ustavok)
                    {
                      //Помічаємо, що поле структури зараз буде змінене
                      changed_settings = CHANGED_ETAP_EXECUTION;
                        
                      current_settings.grupa_ustavok = edition_settings.grupa_ustavok;
                      //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                      fix_change_settings(0, 1);
                    }
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                
              }
              else if (current_ekran.edition == 3)
              {
                //Вихід у режимі редагування
                current_ekran.edition = 0;
              }
              
              if(current_ekran.edition == 2) make_ekran_ask_rewrite();
              else if(current_ekran.edition == 3)
              {
                static const unsigned char information_about_error1[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  " Вых.за диапазон",
                  " Вих.за діапазон",
                  "  Out of Limits ",
                  "Вых.за диапазон "
                };

                const unsigned char (*point_to_information_about_error)[MAX_COL_LCD] = information_about_error1;
                make_ekran_about_error(point_to_information_about_error);
              }
              else
                //Виставляємо біт обновлення екрану
                new_state_keyboard |= (1<<BIT_REWRITE);

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              if(current_ekran.edition == 0)
              {
                //Вихід у режимі спостерігання
              //Переходимо у попереднє меню
              current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
              current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              current_ekran.edition = 0;
              }
              else
              {
                //Вихід у режимі редагування без введення змін
                current_ekran.edition = 0;
              }

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(
                 (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                 (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_MTZ - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                    edition_settings.setpoint_mtz_1[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1[group], 1, COL_SETPOINT_MTZ_1_COMMA, COL_SETPOINT_MTZ_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                    edition_settings.setpoint_mtz_1_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1_n_vpered[group], 1, COL_SETPOINT_MTZ_1_N_VPERED_COMMA, COL_SETPOINT_MTZ_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                    edition_settings.setpoint_mtz_1_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1_n_nazad[group], 1, COL_SETPOINT_MTZ_1_N_NAZAD_COMMA, COL_SETPOINT_MTZ_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                    edition_settings.setpoint_mtz_1_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1_angle[group], 0, 0, COL_SETPOINT_MTZ_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_1_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1_po_napruzi[group], 1, COL_SETPOINT_MTZ_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                    edition_settings.setpoint_mtz_1_U[group] = edit_setpoint(1, edition_settings.setpoint_mtz_1_U[group], 1, COL_SETPOINT_MTZ_1_U_COMMA, COL_SETPOINT_MTZ_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2)
                    edition_settings.setpoint_mtz_2[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2[group], 1, COL_SETPOINT_MTZ_2_COMMA, COL_SETPOINT_MTZ_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                    edition_settings.setpoint_mtz_2_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2_n_vpered[group], 1, COL_SETPOINT_MTZ_2_N_VPERED_COMMA, COL_SETPOINT_MTZ_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                    edition_settings.setpoint_mtz_2_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2_n_nazad[group], 1, COL_SETPOINT_MTZ_2_N_NAZAD_COMMA, COL_SETPOINT_MTZ_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                    edition_settings.setpoint_mtz_2_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2_angle[group], 0, 0, COL_SETPOINT_MTZ_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_2_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2_po_napruzi[group], 1, COL_SETPOINT_MTZ_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                    edition_settings.setpoint_mtz_2_U[group] = edit_setpoint(1, edition_settings.setpoint_mtz_2_U[group], 1, COL_SETPOINT_MTZ_2_U_COMMA, COL_SETPOINT_MTZ_2_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3)
                    edition_settings.setpoint_mtz_3[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3[group], 1, COL_SETPOINT_MTZ_3_COMMA, COL_SETPOINT_MTZ_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                    edition_settings.setpoint_mtz_3_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3_n_vpered[group], 1, COL_SETPOINT_MTZ_3_N_VPERED_COMMA, COL_SETPOINT_MTZ_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                    edition_settings.setpoint_mtz_3_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3_n_nazad[group], 1, COL_SETPOINT_MTZ_3_N_NAZAD_COMMA, COL_SETPOINT_MTZ_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                    edition_settings.setpoint_mtz_3_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3_angle[group], 0, 0, COL_SETPOINT_MTZ_3_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_3_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3_po_napruzi[group], 1, COL_SETPOINT_MTZ_3_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                    edition_settings.setpoint_mtz_3_U[group] = edit_setpoint(1, edition_settings.setpoint_mtz_3_U[group], 1, COL_SETPOINT_MTZ_3_U_COMMA, COL_SETPOINT_MTZ_3_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4)
                    edition_settings.setpoint_mtz_4[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4[group], 1, COL_SETPOINT_MTZ_4_COMMA, COL_SETPOINT_MTZ_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                    edition_settings.setpoint_mtz_4_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4_n_vpered[group], 1, COL_SETPOINT_MTZ_4_N_VPERED_COMMA, COL_SETPOINT_MTZ_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                    edition_settings.setpoint_mtz_4_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4_n_nazad[group], 1, COL_SETPOINT_MTZ_4_N_NAZAD_COMMA, COL_SETPOINT_MTZ_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                    edition_settings.setpoint_mtz_4_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4_angle[group], 0, 0, COL_SETPOINT_MTZ_4_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_4_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4_po_napruzi[group], 1, COL_SETPOINT_MTZ_4_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_4_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                    edition_settings.setpoint_mtz_4_U[group] = edit_setpoint(1, edition_settings.setpoint_mtz_4_U[group], 1, COL_SETPOINT_MTZ_4_U_COMMA, COL_SETPOINT_MTZ_4_U_END, 10);
                }
                //Формуємо екран уставок МТЗ
                make_ekran_setpoint_mtz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_MTZ - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOMTZ1)
                    edition_settings.timeout_mtz_1[group] = edit_setpoint(1, edition_settings.timeout_mtz_1[group], 1, COL_TMO_MTZ_1_COMMA, COL_TMO_MTZ_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                    edition_settings.timeout_mtz_1_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtz_1_n_vpered[group], 1, COL_TMO_MTZ_1_N_VPERED_COMMA, COL_TMO_MTZ_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                    edition_settings.timeout_mtz_1_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtz_1_n_nazad[group], 1, COL_TMO_MTZ_1_N_NAZAD_COMMA, COL_TMO_MTZ_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                    edition_settings.timeout_mtz_1_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtz_1_po_napruzi[group], 1, COL_TMO_MTZ_1_PO_NAPRUZI_COMMA, COL_TMO_MTZ_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2)
                    edition_settings.timeout_mtz_2[group] = edit_setpoint(1, edition_settings.timeout_mtz_2[group], 1, COL_TMO_MTZ_2_COMMA, COL_TMO_MTZ_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                    edition_settings.timeout_mtz_2_pr[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_pr[group], 1, COL_TMO_MTZ_2_PR_COMMA, COL_TMO_MTZ_2_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                    edition_settings.timeout_mtz_2_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_n_vpered[group], 1, COL_TMO_MTZ_2_N_VPERED_COMMA, COL_TMO_MTZ_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                    edition_settings.timeout_mtz_2_n_vpered_pr[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_n_vpered_pr[group], 1, COL_TMO_MTZ_2_N_VPERED_PR_COMMA, COL_TMO_MTZ_2_N_VPERED_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                    edition_settings.timeout_mtz_2_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_n_nazad[group], 1, COL_TMO_MTZ_2_N_NAZAD_COMMA, COL_TMO_MTZ_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                    edition_settings.timeout_mtz_2_n_nazad_pr[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_n_nazad_pr[group], 1, COL_TMO_MTZ_2_N_NAZAD_PR_COMMA, COL_TMO_MTZ_2_N_NAZAD_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                    edition_settings.timeout_mtz_2_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_po_napruzi[group], 1, COL_TMO_MTZ_2_PO_NAPRUZI_COMMA, COL_TMO_MTZ_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                    edition_settings.timeout_mtz_2_po_napruzi_pr[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_po_napruzi_pr[group], 1, COL_TMO_MTZ_2_PO_NAPRUZI_PR_COMMA, COL_TMO_MTZ_2_PO_NAPRUZI_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                    edition_settings.timeout_mtz_2_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_mtz_2_vvid_pr[group], 1, COL_TMO_MTZ_2_VVID_PR_COMMA, COL_TMO_MTZ_2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3)
                    edition_settings.timeout_mtz_3[group] = edit_setpoint(1, edition_settings.timeout_mtz_3[group], 1, COL_TMO_MTZ_3_COMMA, COL_TMO_MTZ_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                    edition_settings.timeout_mtz_3_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtz_3_n_vpered[group], 1, COL_TMO_MTZ_3_N_VPERED_COMMA, COL_TMO_MTZ_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                    edition_settings.timeout_mtz_3_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtz_3_n_nazad[group], 1, COL_TMO_MTZ_3_N_NAZAD_COMMA, COL_TMO_MTZ_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                    edition_settings.timeout_mtz_3_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtz_3_po_napruzi[group], 1, COL_TMO_MTZ_3_PO_NAPRUZI_COMMA, COL_TMO_MTZ_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4)
                    edition_settings.timeout_mtz_4[group] = edit_setpoint(1, edition_settings.timeout_mtz_4[group], 1, COL_TMO_MTZ_4_COMMA, COL_TMO_MTZ_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                    edition_settings.timeout_mtz_4_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtz_4_n_vpered[group], 1, COL_TMO_MTZ_4_N_VPERED_COMMA, COL_TMO_MTZ_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                    edition_settings.timeout_mtz_4_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtz_4_n_nazad[group], 1, COL_TMO_MTZ_4_N_NAZAD_COMMA, COL_TMO_MTZ_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                    edition_settings.timeout_mtz_4_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtz_4_po_napruzi[group], 1, COL_TMO_MTZ_4_PO_NAPRUZI_COMMA, COL_TMO_MTZ_4_PO_NAPRUZI_END, 10);
                }
                //Формуємо екран витримок МТЗ
                make_ekran_timeout_mtz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_MTZ - 1;
                position_in_current_level_menu[EKRAN_CONTROL_MTZ] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для МТЗ
                make_ekran_control_mtz();
              }
//++++++++++++++++++#include "ekran/ekran_dz_up.ci"+++++++++++++++++++++
              //Натиснута кнопка UP
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_DZO - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                    edition_settings.pickup_dzo_Io3g_Io1g[group] = edit_setpoint(1, edition_settings.pickup_dzo_Io3g_Io1g[group], 1, 
                                                                         COL_PICKUP_DZO_K_ICE_COMMA, COL_PICKUP_DZO_K_ICE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1)
                    edition_settings.pickup_dzo1[group] = edit_setpoint(1, edition_settings.pickup_dzo1[group], 1, 
                                                                         COL_PICKUP_DZO1_COMMA, COL_PICKUP_DZO1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                    edition_settings.pickup_dzo1_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzo1_amtz[group], 1, 
                                                                         COL_PICKUP_DZO1_AMTZ_COMMA, COL_PICKUP_DZO1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                    edition_settings.pickup_dzo1_blkI[group] = edit_setpoint(1, edition_settings.pickup_dzo1_blkI[group], 1, 
                                                                         COL_PICKUP_DZO1_I_BLK_COMMA, COL_PICKUP_DZO1_I_BLK_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                    edition_settings.pickup_dzo2_angle[group] = edit_setpoint_signed(1, edition_settings.pickup_dzo2_angle[group], 
                                                                         COL_S_DZO2_ANGLE, COL_PICKUP_DZO2_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                    edition_settings.pickup_dzo2_dir[group] = edit_setpoint(1, edition_settings.pickup_dzo2_dir[group], 1, 
                                                                         COL_PICKUP_DZO2_DIR_COMMA, COL_PICKUP_DZO2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                    edition_settings.pickup_dzo2_inv[group] = edit_setpoint(1, edition_settings.pickup_dzo2_inv[group], 1, 
                                                                         COL_PICKUP_DZO2_INV_COMMA, COL_PICKUP_DZO2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                    edition_settings.pickup_dzo2_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzo2_amtz[group], 1, 
                                                                         COL_PICKUP_DZO2_AMTZ_COMMA, COL_PICKUP_DZO2_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H)
                    edition_settings.pickup_dzo3_angle_h[group] = edit_setpoint_signed(1, edition_settings.pickup_dzo3_angle_h[group], 
                                                                         COL_DZO3_S_ANGLE_H, COL_PICKUP_DZO3_ANGLE_H_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                    edition_settings.pickup_dzo3_angle_l[group] = edit_setpoint_signed(1, edition_settings.pickup_dzo3_angle_l[group], 
                                                                         COL_DZO3_S_ANGLE_L, COL_PICKUP_DZO3_ANGLE_L_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                    edition_settings.pickup_dzo3_dir[group] = edit_setpoint(1, edition_settings.pickup_dzo3_dir[group], 1, 
                                                                         COL_PICKUP_DZO3_DIR_COMMA, COL_PICKUP_DZO3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                    edition_settings.pickup_dzo3_inv[group] = edit_setpoint(1, edition_settings.pickup_dzo3_inv[group], 1, 
                                                                         COL_PICKUP_DZO3_INV_COMMA, COL_PICKUP_DZO3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                    edition_settings.pickup_dzo3_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzo3_amtz[group], 1, 
                                                                         COL_PICKUP_DZO3_AMTZ_COMMA, COL_PICKUP_DZO3_AMTZ_END, 10);


                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                    edition_settings.pickup_dzo4_Zo_dir[group] = edit_setpoint(1, edition_settings.pickup_dzo4_Zo_dir[group], 1, 
                                                                         COL_PICKUP_DZO4_Z0_DIR_COMMA, COL_PICKUP_DZO4_Z0_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                    edition_settings.pickup_dzo4_Xo_dir[group] = edit_setpoint(1, edition_settings.pickup_dzo4_Xo_dir[group], 1, 
                                                                         COL_PICKUP_DZO4_X0_DIR_COMMA, COL_PICKUP_DZO4_X0_DIR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                    edition_settings.pickup_dzo4_Zo_inv[group] = edit_setpoint(1, edition_settings.pickup_dzo4_Zo_inv[group], 1, 
                                                                         COL_PICKUP_DZO4_Z0_INV_COMMA, COL_PICKUP_DZO4_Z0_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                    edition_settings.pickup_dzo4_Xo_inv[group] = edit_setpoint(1, edition_settings.pickup_dzo4_Xo_inv[group], 1, 
                                                                         COL_PICKUP_DZO4_X0_INV_COMMA, COL_PICKUP_DZO4_X0_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                    edition_settings.pickup_dzo4_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzo4_amtz[group], 1, 
                                                                         COL_PICKUP_DZO4_AMTZ_COMMA, COL_PICKUP_DZO4_AMTZ_END, 10);
                }
                //Формуємо екран уставок ДЗ
                make_ekran_setpoint_dzo(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_DZO - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  /*if (current_ekran.index_position == INDEX_ML_TMO_DZ1)
                    edition_settings.timeout_dz1[group] = edit_setpoint(1, edition_settings.timeout_dz1[group], 1, 
                                                                         COL_TMO_DZ1_COMMA, COL_TMO_DZ1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                    edition_settings.timeout_dz1_amtz[group] = edit_setpoint(1, edition_settings.timeout_dz1_amtz[group], 1, 
                                                                         COL_TMO_DZ1_AMTZ_COMMA, COL_TMO_DZ1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                    edition_settings.timeout_dz2_dir[group] = edit_setpoint(1, edition_settings.timeout_dz2_dir[group], 1, 
                                                                         COL_TMO_DZ2_DIR_COMMA, COL_TMO_DZ2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                    edition_settings.timeout_dz2_dir_pr[group] = edit_setpoint(1, edition_settings.timeout_dz2_dir_pr[group], 1, 
                                                                         COL_TMO_DZ2_DIR_PR_COMMA, COL_TMO_DZ2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                    edition_settings.timeout_dz2_inv[group] = edit_setpoint(1, edition_settings.timeout_dz2_inv[group], 1, 
                                                                         COL_TMO_DZ2_INV_COMMA, COL_TMO_DZ2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                    edition_settings.timeout_dz2_inv_pr[group] = edit_setpoint(1, edition_settings.timeout_dz2_inv_pr[group], 1, 
                                                                         COL_TMO_DZ2_INV_PR_COMMA, COL_TMO_DZ2_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                    edition_settings.timeout_dz2_amtz[group] = edit_setpoint(1, edition_settings.timeout_dz2_amtz[group], 1, 
                                                                         COL_TMO_DZ2_AMTZ_COMMA, COL_TMO_DZ2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                    edition_settings.timeout_dz2_amtz_pr[group] = edit_setpoint(1, edition_settings.timeout_dz2_amtz_pr[group], 1, 
                                                                         COL_TMO_DZ2_AMTZ_PR_COMMA, COL_TMO_DZ2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                    edition_settings.timeout_dz2_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz2_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ2_VVID_PR_COMMA, COL_TMO_DZ2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                    edition_settings.timeout_dz2_amtz_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz2_amtz_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ2_AMTZ_VVID_PR_COMMA, COL_TMO_DZ2_AMTZ_VVID_PR_END, 10);


                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                    edition_settings.timeout_dz3_dir[group] = edit_setpoint(1, edition_settings.timeout_dz3_dir[group], 1, 
                                                                         COL_TMO_DZ3_DIR_COMMA, COL_TMO_DZ3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                    edition_settings.timeout_dz3_dir_pr[group] = edit_setpoint(1, edition_settings.timeout_dz3_dir_pr[group], 1, 
                                                                         COL_TMO_DZ3_DIR_PR_COMMA, COL_TMO_DZ3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                    edition_settings.timeout_dz3_inv[group] = edit_setpoint(1, edition_settings.timeout_dz3_inv[group], 1, 
                                                                         COL_TMO_DZ3_INV_COMMA, COL_TMO_DZ3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                    edition_settings.timeout_dz3_inv_pr[group] = edit_setpoint(1, edition_settings.timeout_dz3_inv_pr[group], 1, 
                                                                         COL_TMO_DZ3_INV_PR_COMMA, COL_TMO_DZ3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                    edition_settings.timeout_dz3_amtz[group] = edit_setpoint(1, edition_settings.timeout_dz3_amtz[group], 1, 
                                                                         COL_TMO_DZ3_AMTZ_COMMA, COL_TMO_DZ3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                    edition_settings.timeout_dz3_amtz_pr[group] = edit_setpoint(1, edition_settings.timeout_dz3_amtz_pr[group], 1, 
                                                                         COL_TMO_DZ3_AMTZ_PR_COMMA, COL_TMO_DZ3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                    edition_settings.timeout_dz3_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz3_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ3_VVID_PR_COMMA, COL_TMO_DZ3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                    edition_settings.timeout_dz3_amtz_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz3_amtz_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ3_AMTZ_VVID_PR_COMMA, COL_TMO_DZ3_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                    edition_settings.timeout_dz4_dir[group] = edit_setpoint(1, edition_settings.timeout_dz4_dir[group], 1, 
                                                                         COL_TMO_DZ4_DIR_COMMA, COL_TMO_DZ4_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                    edition_settings.timeout_dz4_dir_pr[group] = edit_setpoint(1, edition_settings.timeout_dz4_dir_pr[group], 1, 
                                                                         COL_TMO_DZ4_DIR_PR_COMMA, COL_TMO_DZ4_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                    edition_settings.timeout_dz4_inv[group] = edit_setpoint(1, edition_settings.timeout_dz4_inv[group], 1, 
                                                                         COL_TMO_DZ4_INV_COMMA, COL_TMO_DZ4_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                    edition_settings.timeout_dz4_inv_pr[group] = edit_setpoint(1, edition_settings.timeout_dz4_inv_pr[group], 1, 
                                                                         COL_TMO_DZ4_INV_PR_COMMA, COL_TMO_DZ4_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                    edition_settings.timeout_dz4_amtz[group] = edit_setpoint(1, edition_settings.timeout_dz4_amtz[group], 1, 
                                                                         COL_TMO_DZ4_AMTZ_COMMA, COL_TMO_DZ4_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                    edition_settings.timeout_dz4_amtz_pr[group] = edit_setpoint(1, edition_settings.timeout_dz4_amtz_pr[group], 1, 
                                                                         COL_TMO_DZ4_AMTZ_PR_COMMA, COL_TMO_DZ4_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                    edition_settings.timeout_dz4_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz4_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ4_VVID_PR_COMMA, COL_TMO_DZ4_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                    edition_settings.timeout_dz4_amtz_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_dz4_amtz_vvid_pr[group], 1, 
                                                                         COL_TMO_DZ4_AMTZ_VVID_PR_COMMA, COL_TMO_DZ4_AMTZ_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                    edition_settings.timeout_nkn_dz[group] = edit_setpoint(1, edition_settings.timeout_nkn_dz[group], 1, 
                                                                         COL_TMO_NKN_DZ_COMMA, COL_TMO_NKN_DZ_END, 10);*/
                    if (current_ekran.index_position == INDEX_ML_TMO_DZO1)
                    edition_settings.timeout_dzo1[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo1[group], 1, COL_TMO_DZO1_COMMA, COL_TMO_DZO1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                    edition_settings.timeout_dzo1_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo1_amtz[group], 1, COL_TMO_DZO1_AMTZ_COMMA, COL_TMO_DZO1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                    edition_settings.timeout_dzo2_dir[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_dir[group], 1, COL_TMO_DZO2_DIR_COMMA, COL_TMO_DZO2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                    edition_settings.timeout_dzo2_dir_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_dir_pr[group], 1, COL_TMO_DZO2_DIR_PR_COMMA, COL_TMO_DZO2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                    edition_settings.timeout_dzo2_inv[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_inv[group], 1, COL_TMO_DZO2_INV_COMMA, COL_TMO_DZO2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                    edition_settings.timeout_dzo2_inv_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_inv_pr[group], 1, COL_TMO_DZO2_INV_PR_COMMA, COL_TMO_DZO2_INV_PR_END , 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                    edition_settings.timeout_dzo2_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_amtz[group], 1, COL_TMO_DZO2_AMTZ_COMMA, COL_TMO_DZO2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                    edition_settings.timeout_dzo2_amtz_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_amtz_pr[group], 1, COL_TMO_DZO2_AMTZ_PR_COMMA, COL_TMO_DZO2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                    edition_settings.timeout_dzo2_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_vvid_pr[group], 1, COL_TMO_DZO2_VVID_PR_COMMA, COL_TMO_DZO2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                    edition_settings.timeout_dzo2_amtz_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo2_amtz_vvid_pr[group], 1, COL_TMO_DZO2_AMTZ_VVID_PR_COMMA, COL_TMO_DZO2_AMTZ_VVID_PR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                    edition_settings.timeout_dzo3_dir[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_dir[group], 1, COL_TMO_DZO3_DIR_COMMA, COL_TMO_DZO3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                    edition_settings.timeout_dzo3_dir_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_dir_pr[group], 1, COL_TMO_DZO3_DIR_PR_COMMA, COL_TMO_DZO3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                    edition_settings.timeout_dzo3_inv[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_inv[group], 1, COL_TMO_DZO3_INV_COMMA, COL_TMO_DZO3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                    edition_settings.timeout_dzo3_inv_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_inv_pr[group], 1, COL_TMO_DZO3_INV_PR_COMMA, COL_TMO_DZO3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                    edition_settings.timeout_dzo3_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_amtz[group], 1, COL_TMO_DZO3_AMTZ_COMMA, COL_TMO_DZO3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                    edition_settings.timeout_dzo3_amtz_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_amtz_pr[group], 1, COL_TMO_DZO3_AMTZ_PR_COMMA, COL_TMO_DZO3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                    edition_settings.timeout_dzo3_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_vvid_pr[group], 1, COL_TMO_DZO3_VVID_PR_COMMA, COL_TMO_DZO3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                    edition_settings.timeout_dzo3_amtz_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo3_amtz_vvid_pr[group], 1, COL_TMO_DZO3_AMTZ_VVID_PR_COMMA, COL_TMO_DZO3_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                    edition_settings.timeout_dzo4_dir[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo4_dir[group], 1, COL_TMO_DZO4_DIR_COMMA, COL_TMO_DZO4_DIR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                    edition_settings.timeout_dzo4_inv[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo4_inv[group], 1, COL_TMO_DZO4_INV_COMMA, COL_TMO_DZO4_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                    edition_settings.timeout_dzo4_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzo4_amtz[group], 1, COL_TMO_DZO4_AMTZ_COMMA, COL_TMO_DZO4_AMTZ_END, 10);
                 else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                    edition_settings.timeout_nkn_dzo[group] =
                      edit_setpoint(1, edition_settings.timeout_nkn_dzo[group], 1, COL_TMO_NKN_DZO_COMMA, COL_TMO_NKN_DZO_END, 10);


                }
                //Формуємо екран витримок ДЗ
                make_ekran_timeout_dzo(group);//make_ekran_timeout_dz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
              {
                //!if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_DZ - 1;
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_DZO - 1;
                position_in_current_level_menu[EKRAN_CONTROL_DZ] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ДЗ
                make_ekran_control_dzo();//make_ekran_control_dz();
              }
//------------------#include "ekran/ekran_dz_up.ci"---------------------
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_ZDZ - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOZDZ)
                    edition_settings.timeout_zdz[group] = edit_setpoint(1, edition_settings.timeout_zdz[group], 1, COL_TMO_ZDZ_COMMA, COL_TMO_ZDZ_END, 1);
                }
                //Формуємо екран витримок ЗДЗ
                make_ekran_timeout_zdz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
              {
                current_ekran.index_position--;
                
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_ZDZ - 1;
                while(
                      (
                       (
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ1_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ2_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ3_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ4_BIT)
                       )   
                       &&
                       ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                      )
                      ||  
                      (
                       (
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN1_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN2_BIT)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                      )
                     )
                {
                  current_ekran.index_position--;
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_ZDZ - 1;
                }

                position_in_current_level_menu[EKRAN_CONTROL_ZDZ] = current_ekran.index_position;
                
                //Формуємо екран управлінської інформації для ЗДЗ
                make_ekran_control_zdz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_MTZO - 1;//MAX_ROW_FOR_SETPOINT_ZZ - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа

                  //if (current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                  //  edition_settings.setpoint_zz_3I0[group] = edit_setpoint(1, edition_settings.setpoint_zz_3I0[group], 1, COL_SETPOINT_ZZ1_3I0_COMMA, COL_SETPOINT_ZZ1_3I0_END, 1);
                  //else if (current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                  //  edition_settings.setpoint_zz_3U0[group] = edit_setpoint(1, edition_settings.setpoint_zz_3U0[group], 1, COL_SETPOINT_ZZ1_3U0_COMMA, COL_SETPOINT_ZZ1_3U0_END, 10);
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZO1)
                    edition_settings.setpoint_mtzo_1[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1[group], 1, COL_SETPOINT_MTZO_1_COMMA, COL_SETPOINT_MTZO_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                    edition_settings.setpoint_mtzo_1_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1_n_vpered[group], 1, COL_SETPOINT_MTZO_1_N_VPERED_COMMA, COL_SETPOINT_MTZO_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                    edition_settings.setpoint_mtzo_1_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1_n_nazad[group], 1, COL_SETPOINT_MTZO_1_N_NAZAD_COMMA, COL_SETPOINT_MTZO_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                    edition_settings.setpoint_mtzo_1_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1_angle[group], 0, 0, COL_SETPOINT_MTZO_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_1_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1_po_napruzi[group], 1, COL_SETPOINT_MTZO_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                    edition_settings.setpoint_mtzo_1_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_1_U[group], 1, COL_SETPOINT_MTZO_1_U_COMMA, COL_SETPOINT_MTZO_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2)
                    edition_settings.setpoint_mtzo_2[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2[group], 1, COL_SETPOINT_MTZO_2_COMMA, COL_SETPOINT_MTZO_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                    edition_settings.setpoint_mtzo_2_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2_n_vpered[group], 1, COL_SETPOINT_MTZO_2_N_VPERED_COMMA, COL_SETPOINT_MTZO_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                    edition_settings.setpoint_mtzo_2_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2_n_nazad[group], 1, COL_SETPOINT_MTZO_2_N_NAZAD_COMMA, COL_SETPOINT_MTZO_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                    edition_settings.setpoint_mtzo_2_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2_angle[group], 0, 0, COL_SETPOINT_MTZO_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_2_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2_po_napruzi[group], 1, COL_SETPOINT_MTZO_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                    edition_settings.setpoint_mtzo_2_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_2_U[group], 1, COL_SETPOINT_MTZO_2_U_COMMA, COL_SETPOINT_MTZO_2_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3)
                    edition_settings.setpoint_mtzo_3[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3[group], 1, COL_SETPOINT_MTZO_3_COMMA, COL_SETPOINT_MTZO_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                    edition_settings.setpoint_mtzo_3_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3_n_vpered[group], 1, COL_SETPOINT_MTZO_3_N_VPERED_COMMA, COL_SETPOINT_MTZO_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                    edition_settings.setpoint_mtzo_3_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3_n_nazad[group], 1, COL_SETPOINT_MTZO_3_N_NAZAD_COMMA, COL_SETPOINT_MTZO_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                    edition_settings.setpoint_mtzo_3_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3_angle[group], 0, 0, COL_SETPOINT_MTZO_3_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_3_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3_po_napruzi[group], 1, COL_SETPOINT_MTZO_3_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                    edition_settings.setpoint_mtzo_3_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_3_U[group], 1, COL_SETPOINT_MTZO_3_U_COMMA, COL_SETPOINT_MTZO_3_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4)
                    edition_settings.setpoint_mtzo_4[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4[group], 1, COL_SETPOINT_MTZO_4_COMMA, COL_SETPOINT_MTZO_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                    edition_settings.setpoint_mtzo_4_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4_n_vpered[group], 1, COL_SETPOINT_MTZO_4_N_VPERED_COMMA, COL_SETPOINT_MTZO_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                    edition_settings.setpoint_mtzo_4_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4_n_nazad[group], 1, COL_SETPOINT_MTZO_4_N_NAZAD_COMMA, COL_SETPOINT_MTZO_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                    edition_settings.setpoint_mtzo_4_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4_angle[group], 0, 0, COL_SETPOINT_MTZO_4_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_4_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4_po_napruzi[group], 1, COL_SETPOINT_MTZO_4_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_4_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                    edition_settings.setpoint_mtzo_4_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzo_4_U[group], 1, COL_SETPOINT_MTZO_4_U_COMMA, COL_SETPOINT_MTZO_4_U_END, 10);
                
                }
                //Формуємо екран уставок ЗЗ
                make_ekran_setpoint_mtzo(group);//make_ekran_setpoint_zz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_MTZO - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;

                }
                else
                {
                   //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOMTZO1)
                    edition_settings.timeout_mtzo_1[group] = edit_setpoint(1, edition_settings.timeout_mtzo_1[group], 1, COL_TMO_MTZO_1_COMMA, COL_TMO_MTZO_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                    edition_settings.timeout_mtzo_1_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzo_1_n_vpered[group], 1, COL_TMO_MTZO_1_N_VPERED_COMMA, COL_TMO_MTZO_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                    edition_settings.timeout_mtzo_1_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzo_1_n_nazad[group], 1, COL_TMO_MTZO_1_N_NAZAD_COMMA, COL_TMO_MTZO_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_1_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzo_1_po_napruzi[group], 1, COL_TMO_MTZO_1_PO_NAPRUZI_COMMA, COL_TMO_MTZO_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2)
                    edition_settings.timeout_mtzo_2[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2[group], 1, COL_TMO_MTZO_2_COMMA, COL_TMO_MTZO_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                    edition_settings.timeout_mtzo_2_pr[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_pr[group], 1, COL_TMO_MTZO_2_PR_COMMA, COL_TMO_MTZO_2_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                    edition_settings.timeout_mtzo_2_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_n_vpered[group], 1, COL_TMO_MTZO_2_N_VPERED_COMMA, COL_TMO_MTZO_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                    edition_settings.timeout_mtzo_2_n_vpered_pr[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_n_vpered_pr[group], 1, COL_TMO_MTZO_2_N_VPERED_PR_COMMA, COL_TMO_MTZO_2_N_VPERED_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                    edition_settings.timeout_mtzo_2_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_n_nazad[group], 1, COL_TMO_MTZO_2_N_NAZAD_COMMA, COL_TMO_MTZO_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                    edition_settings.timeout_mtzo_2_n_nazad_pr[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_n_nazad_pr[group], 1, COL_TMO_MTZO_2_N_NAZAD_PR_COMMA, COL_TMO_MTZO_2_N_NAZAD_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_2_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_po_napruzi[group], 1, COL_TMO_MTZO_2_PO_NAPRUZI_COMMA, COL_TMO_MTZO_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                    edition_settings.timeout_mtzo_2_po_napruzi_pr[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_po_napruzi_pr[group], 1, COL_TMO_MTZO_2_PO_NAPRUZI_PR_COMMA, COL_TMO_MTZO_2_PO_NAPRUZI_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                    edition_settings.timeout_mtzo_2_vvid_pr[group] = edit_setpoint(1, edition_settings.timeout_mtzo_2_vvid_pr[group], 1, COL_TMO_MTZO_2_VVID_PR_COMMA, COL_TMO_MTZO_2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3)
                    edition_settings.timeout_mtzo_3[group] = edit_setpoint(1, edition_settings.timeout_mtzo_3[group], 1, COL_TMO_MTZO_3_COMMA, COL_TMO_MTZO_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                    edition_settings.timeout_mtzo_3_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzo_3_n_vpered[group], 1, COL_TMO_MTZO_3_N_VPERED_COMMA, COL_TMO_MTZO_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                    edition_settings.timeout_mtzo_3_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzo_3_n_nazad[group], 1, COL_TMO_MTZO_3_N_NAZAD_COMMA, COL_TMO_MTZO_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_3_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzo_3_po_napruzi[group], 1, COL_TMO_MTZO_3_PO_NAPRUZI_COMMA, COL_TMO_MTZO_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4)
                    edition_settings.timeout_mtzo_4[group] = edit_setpoint(1, edition_settings.timeout_mtzo_4[group], 1, COL_TMO_MTZO_4_COMMA, COL_TMO_MTZO_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                    edition_settings.timeout_mtzo_4_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzo_4_n_vpered[group], 1, COL_TMO_MTZO_4_N_VPERED_COMMA, COL_TMO_MTZO_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                    edition_settings.timeout_mtzo_4_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzo_4_n_nazad[group], 1, COL_TMO_MTZO_4_N_NAZAD_COMMA, COL_TMO_MTZO_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_4_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzo_4_po_napruzi[group], 1, COL_TMO_MTZO_4_PO_NAPRUZI_COMMA, COL_TMO_MTZO_4_PO_NAPRUZI_END, 10);
                 
                }
                //Формуємо екран витримок ЗЗ
                make_ekran_timeout_mtzo(group);//make_ekran_timeout_zz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
              {
               if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_MTZO - 1;
                
                position_in_current_level_menu[EKRAN_CONTROL_ZZ] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ЗЗ
                 make_ekran_control_mtzo();//.make_ekran_control_zz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_TZNP - 1;
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_MTZR - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  /*/Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                    edition_settings.setpoint_tznp_1_3I0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_1_3I0_vpered[group], 1, COL_SETPOINT_TZNP1_3I0_VPERED_COMMA, COL_SETPOINT_TZNP1_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                    edition_settings.setpoint_tznp_1_3U0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_1_3U0_vpered[group], 1, COL_SETPOINT_TZNP1_3U0_VPERED_COMMA, COL_SETPOINT_TZNP1_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                    edition_settings.setpoint_tznp_1_3I0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_1_3I0_nazad[group], 1, COL_SETPOINT_TZNP1_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP1_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                    edition_settings.setpoint_tznp_1_3U0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_1_3U0_nazad[group], 1, COL_SETPOINT_TZNP1_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP1_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                    edition_settings.setpoint_tznp_1_angle[group] = edit_setpoint(1, edition_settings.setpoint_tznp_1_angle[group], 0, 0, COL_SETPOINT_TZNP1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                    edition_settings.setpoint_tznp_2_3I0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_2_3I0_vpered[group], 1, COL_SETPOINT_TZNP2_3I0_VPERED_COMMA, COL_SETPOINT_TZNP2_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                    edition_settings.setpoint_tznp_2_3U0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_2_3U0_vpered[group], 1, COL_SETPOINT_TZNP2_3U0_VPERED_COMMA, COL_SETPOINT_TZNP2_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                    edition_settings.setpoint_tznp_2_3I0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_2_3I0_nazad[group], 1, COL_SETPOINT_TZNP2_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP2_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                    edition_settings.setpoint_tznp_2_3U0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_2_3U0_nazad[group], 1, COL_SETPOINT_TZNP2_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP2_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                    edition_settings.setpoint_tznp_2_angle[group] = edit_setpoint(1, edition_settings.setpoint_tznp_2_angle[group], 0, 0, COL_SETPOINT_TZNP2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                    edition_settings.setpoint_tznp_3_3I0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_3_3I0_vpered[group], 1, COL_SETPOINT_TZNP3_3I0_VPERED_COMMA, COL_SETPOINT_TZNP3_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                    edition_settings.setpoint_tznp_3_3U0_vpered[group] = edit_setpoint(1, edition_settings.setpoint_tznp_3_3U0_vpered[group], 1, COL_SETPOINT_TZNP3_3U0_VPERED_COMMA, COL_SETPOINT_TZNP3_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                    edition_settings.setpoint_tznp_3_3I0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_3_3I0_nazad[group], 1, COL_SETPOINT_TZNP3_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP3_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                    edition_settings.setpoint_tznp_3_3U0_nazad[group] = edit_setpoint(1, edition_settings.setpoint_tznp_3_3U0_nazad[group], 1, COL_SETPOINT_TZNP3_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP3_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                    edition_settings.setpoint_tznp_3_angle[group] = edit_setpoint(1, edition_settings.setpoint_tznp_3_angle[group], 0, 0, COL_SETPOINT_TZNP3_ANGLE_END, 1);
                */
                //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                    edition_settings.setpoint_mtzr_1[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1[group], 1, COL_SETPOINT_MTZR_1_COMMA, COL_SETPOINT_MTZR_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                    edition_settings.setpoint_mtzr_1_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1_n_vpered[group], 1, COL_SETPOINT_MTZR_1_N_VPERED_COMMA, COL_SETPOINT_MTZR_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                    edition_settings.setpoint_mtzr_1_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1_n_nazad[group], 1, COL_SETPOINT_MTZR_1_N_NAZAD_COMMA, COL_SETPOINT_MTZR_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                    edition_settings.setpoint_mtzr_1_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1_angle[group], 0, 0, COL_SETPOINT_MTZR_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                    edition_settings.setpoint_mtzr_1_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1_po_napruzi[group], 1, COL_SETPOINT_MTZR_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZR_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                    edition_settings.setpoint_mtzr_1_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_1_U[group], 1, COL_SETPOINT_MTZR_1_U_COMMA, COL_SETPOINT_MTZR_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2)
                    edition_settings.setpoint_mtzr_2[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2[group], 1, COL_SETPOINT_MTZR_2_COMMA, COL_SETPOINT_MTZR_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                    edition_settings.setpoint_mtzr_2_n_vpered[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2_n_vpered[group], 1, COL_SETPOINT_MTZR_2_N_VPERED_COMMA, COL_SETPOINT_MTZR_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                    edition_settings.setpoint_mtzr_2_n_nazad[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2_n_nazad[group], 1, COL_SETPOINT_MTZR_2_N_NAZAD_COMMA, COL_SETPOINT_MTZR_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                    edition_settings.setpoint_mtzr_2_angle[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2_angle[group], 0, 0, COL_SETPOINT_MTZR_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                    edition_settings.setpoint_mtzr_2_po_napruzi[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2_po_napruzi[group], 1, COL_SETPOINT_MTZR_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZR_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                    edition_settings.setpoint_mtzr_2_U[group] = edit_setpoint(1, edition_settings.setpoint_mtzr_2_U[group], 1, COL_SETPOINT_MTZR_2_U_COMMA, COL_SETPOINT_MTZR_2_U_END, 10);
                
                }
                //Формуємо екран уставок ТЗНП
                make_ekran_setpoint_mtzr(group);//make_ekran_setpoint_tznp(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_TZNP - 1;
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_MTZR - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //if (current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                  //  edition_settings.timeout_tznp_1_vpered[group] = edit_setpoint(1, edition_settings.timeout_tznp_1_vpered[group], 1, COL_TMO_TZNP1_VPERED_COMMA, COL_TMO_TZNP1_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                  //  edition_settings.timeout_tznp_1_nazad[group] = edit_setpoint(1, edition_settings.timeout_tznp_1_nazad[group], 1, COL_TMO_TZNP1_NAZAD_COMMA, COL_TMO_TZNP1_NAZAD_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                  //  edition_settings.timeout_tznp_2_vpered[group] = edit_setpoint(1, edition_settings.timeout_tznp_2_vpered[group], 1, COL_TMO_TZNP2_VPERED_COMMA, COL_TMO_TZNP2_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                  //  edition_settings.timeout_tznp_2_nazad[group] = edit_setpoint(1, edition_settings.timeout_tznp_2_nazad[group], 1, COL_TMO_TZNP2_NAZAD_COMMA, COL_TMO_TZNP2_NAZAD_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                  //  edition_settings.timeout_tznp_3_vpered[group] = edit_setpoint(1, edition_settings.timeout_tznp_3_vpered[group], 1, COL_TMO_TZNP3_VPERED_COMMA, COL_TMO_TZNP3_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                  //  edition_settings.timeout_tznp_3_nazad[group] = edit_setpoint(1, edition_settings.timeout_tznp_3_nazad[group], 1, COL_TMO_TZNP3_NAZAD_COMMA, COL_TMO_TZNP3_NAZAD_END, 10);
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOMTZR1)
                    edition_settings.timeout_mtzr_1[group] = edit_setpoint(1, edition_settings.timeout_mtzr_1[group], 1, COL_TMO_MTZR_1_COMMA, COL_TMO_MTZR_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                    edition_settings.timeout_mtzr_1_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzr_1_n_vpered[group], 1, COL_TMO_MTZR_1_N_VPERED_COMMA, COL_TMO_MTZR_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                    edition_settings.timeout_mtzr_1_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzr_1_n_nazad[group], 1, COL_TMO_MTZR_1_N_NAZAD_COMMA, COL_TMO_MTZR_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                    edition_settings.timeout_mtzr_1_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzr_1_po_napruzi[group], 1, COL_TMO_MTZR_1_PO_NAPRUZI_COMMA, COL_TMO_MTZR_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2)
                    edition_settings.timeout_mtzr_2[group] = edit_setpoint(1, edition_settings.timeout_mtzr_2[group], 1, COL_TMO_MTZR_2_COMMA, COL_TMO_MTZR_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                    edition_settings.timeout_mtzr_2_n_vpered[group] = edit_setpoint(1, edition_settings.timeout_mtzr_2_n_vpered[group], 1, COL_TMO_MTZR_2_N_VPERED_COMMA, COL_TMO_MTZR_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                    edition_settings.timeout_mtzr_2_n_nazad[group] = edit_setpoint(1, edition_settings.timeout_mtzr_2_n_nazad[group], 1, COL_TMO_MTZR_2_N_NAZAD_COMMA, COL_TMO_MTZR_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                    edition_settings.timeout_mtzr_2_po_napruzi[group] = edit_setpoint(1, edition_settings.timeout_mtzr_2_po_napruzi[group], 1, COL_TMO_MTZR_2_PO_NAPRUZI_COMMA, COL_TMO_MTZR_2_PO_NAPRUZI_END, 10);
                
                }
                //Формуємо екран витримок ТЗНП
                make_ekran_timeout_mtzr(group);//make_ekran_timeout_tznp(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
              {
                //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_TZNP - 1;
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_MTZR - 1;
                position_in_current_level_menu[EKRAN_CONTROL_TZNP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ТЗНП
                make_ekran_control_mtzr();//.make_ekran_control_tznp();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_APV - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOAPV1)
                    edition_settings.timeout_apv_1[group] = edit_setpoint(1, edition_settings.timeout_apv_1[group], 1, COL_TMO_APV_1_COMMA, COL_TMO_APV_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV2)
                    edition_settings.timeout_apv_2[group] = edit_setpoint(1, edition_settings.timeout_apv_2[group], 1, COL_TMO_APV_2_COMMA, COL_TMO_APV_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV3)
                    edition_settings.timeout_apv_3[group] = edit_setpoint(1, edition_settings.timeout_apv_3[group], 1, COL_TMO_APV_3_COMMA, COL_TMO_APV_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV4)
                    edition_settings.timeout_apv_4[group] = edit_setpoint(1, edition_settings.timeout_apv_4[group], 1, COL_TMO_APV_4_COMMA, COL_TMO_APV_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                    edition_settings.timeout_apv_block_vid_apv1[group] = edit_setpoint(1, edition_settings.timeout_apv_block_vid_apv1[group], 1, COL_TMO_APV_BLOCK_VID_APV1_COMMA, COL_TMO_APV_BLOCK_VID_APV1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                    edition_settings.timeout_apv_block_vid_apv2[group] = edit_setpoint(1, edition_settings.timeout_apv_block_vid_apv2[group], 1, COL_TMO_APV_BLOCK_VID_APV2_COMMA, COL_TMO_APV_BLOCK_VID_APV2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                    edition_settings.timeout_apv_block_vid_apv3[group] = edit_setpoint(1, edition_settings.timeout_apv_block_vid_apv3[group], 1, COL_TMO_APV_BLOCK_VID_APV3_COMMA, COL_TMO_APV_BLOCK_VID_APV3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                    edition_settings.timeout_apv_block_vid_apv4[group] = edit_setpoint(1, edition_settings.timeout_apv_block_vid_apv4[group], 1, COL_TMO_APV_BLOCK_VID_APV4_COMMA, COL_TMO_APV_BLOCK_VID_APV4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                    edition_settings.timeout_apv_block_vid_VV[group] = edit_setpoint(1, edition_settings.timeout_apv_block_vid_VV[group], 1, COL_TMO_APV_BLOCK_VID_VV_COMMA, COL_TMO_APV_BLOCK_VID_VV_END, 10);
                }
                //Формуємо екран витримок АПВ
                make_ekran_timeout_apv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_APV)
              {
                current_ekran.index_position--;
                
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_APV - 1;
                while(
                      (
                       (  
                        (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_DZ1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_AMTDZ4) 
                       )   
                      &&
                      ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                      ) 
                      ||
                      (
                       (  
                        (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_MTZ1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_MTZ4)
                       )   
                      &&
                      ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                      ) 
                      //!||
                      //!(
                      //! (  
                      //!  (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_TZNP1) &&
                      //!  (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_TZNP3)
                      //! )   
                      //!&&
                      //!((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0)
                      //!) 
                      ||  
                      (
                       (current_ekran.index_position == INDEX_ML_CTRAPV_BLK_CTRL_PRVV2)
                       &&
                       ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0)
                      )
                    )
                {
                  current_ekran.index_position--;
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_APV - 1;
                }

                position_in_current_level_menu[EKRAN_CONTROL_APV] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для АПВ
                make_ekran_control_apv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_ACHR_CHAPV - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                    edition_settings.setpoint_achr_chapv_uf[group] = edit_setpoint(1, edition_settings.setpoint_achr_chapv_uf[group], 1, COL_SETPOINT_ACHR_CHAPV_UF_COMMA, COL_SETPOINT_ACHR_CHAPV_UF_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                    edition_settings.setpoint_achr1_f_rab[group] = edit_setpoint(1, edition_settings.setpoint_achr1_f_rab[group], 1, COL_SETPOINT_ACHR1_F_RAB_COMMA, COL_SETPOINT_ACHR1_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                    edition_settings.setpoint_chapv1_f_rab[group] = edit_setpoint(1, edition_settings.setpoint_chapv1_f_rab[group], 1, COL_SETPOINT_CHAPV1_F_RAB_COMMA, COL_SETPOINT_CHAPV1_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                    edition_settings.setpoint_achr2_f_rab[group] = edit_setpoint(1, edition_settings.setpoint_achr2_f_rab[group], 1, COL_SETPOINT_ACHR2_F_RAB_COMMA, COL_SETPOINT_ACHR2_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                    edition_settings.setpoint_chapv2_f_rab[group] = edit_setpoint(1, edition_settings.setpoint_chapv2_f_rab[group], 1, COL_SETPOINT_CHAPV2_F_RAB_COMMA, COL_SETPOINT_CHAPV2_F_RAB_END, 10);
                }
                //Формуємо екран уставок АЧР-ЧАПВ
                make_ekran_setpoint_achr_chapv(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_ACHR_CHAPV - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOACHR1)
                    edition_settings.timeout_achr_1[group] = edit_setpoint(1, edition_settings.timeout_achr_1[group], 1, COL_TMO_ACHR1_COMMA, COL_TMO_ACHR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                    edition_settings.timeout_chapv_1[group] = edit_setpoint(1, edition_settings.timeout_chapv_1[group], 1, COL_TMO_CHAPV1_COMMA, COL_TMO_CHAPV1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOACHR2)
                    edition_settings.timeout_achr_2[group] = edit_setpoint(1, edition_settings.timeout_achr_2[group], 1, COL_TMO_ACHR2_COMMA, COL_TMO_ACHR2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                    edition_settings.timeout_chapv_2[group] = edit_setpoint(1, edition_settings.timeout_chapv_2[group], 1, COL_TMO_CHAPV2_COMMA, COL_TMO_CHAPV2_END, 10);
                }
                //Формуємо екран витримок АЧР-ЧАПВ
                make_ekran_timeout_achr_chapv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_ACHR_CHAPV - 1;
                position_in_current_level_menu[EKRAN_CONTROL_ACHR_CHAPV] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для АЧР-ЧАПВ
                make_ekran_control_achr_chapv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_UROV - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.setpoint_urov[group] = edit_setpoint(1, edition_settings.setpoint_urov[group], 1, COL_SETPOINT_UROV_COMMA, COL_SETPOINT_UROV_END, 10);
                }
                //Формуємо екран уставок УРОВ
                make_ekran_setpoint_urov(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_UROV - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUROV1)
                    edition_settings.timeout_urov_1[group] = edit_setpoint(1, edition_settings.timeout_urov_1[group], 1, COL_TMO_UROV_1_COMMA, COL_TMO_UROV_1_END, 10);
                  else
                    edition_settings.timeout_urov_2[group] = edit_setpoint(1, edition_settings.timeout_urov_2[group], 1, COL_TMO_UROV_2_COMMA, COL_TMO_UROV_2_END, 10);
                }
                //Формуємо екран витримок УРОВ
                make_ekran_timeout_urov(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
              {
                current_ekran.index_position--;
                
                if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_UROV - 1;
                while(
                    (
                     (  
                      (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_DZ1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_AMTDZ4) 
                     )   
                    &&
                    ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                    ) 
                    ||
                      (
                       (  
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ2) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ3) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ4)
                       )   
                       &&
                       //!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                       ((current_settings.configuration & (1<<MCZO_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (  
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ZDZ)
                       )   
                       &&
                       ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0)
                      )
                      ||
                      (
                       (
                        (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_UP1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_UP1 + NUMBER_UP - 1)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0)
                      )
                    )
                {
                  current_ekran.index_position--;
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_UROV - 1;
                }

                position_in_current_level_menu[EKRAN_CONTROL_UROV] = current_ekran.index_position;

                //Формуємо екран управлінської інформації для УРОВ
                make_ekran_control_urov();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_ZOP - 1;
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_DZR - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //edition_settings.setpoint_zop[group] = edit_setpoint(1, edition_settings.setpoint_zop[group], 1, COL_SETPOINT_ZOP_COMMA, COL_SETPOINT_ZOP_END, 1);
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                    edition_settings.pickup_dzr_Io3g_Io1g[group] = edit_setpoint(1, edition_settings.pickup_dzr_Io3g_Io1g[group], 1, 
                                                                         COL_PICKUP_DZR_K_ICE_COMMA, COL_PICKUP_DZR_K_ICE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1)
                    edition_settings.pickup_dzr1[group] = edit_setpoint(1, edition_settings.pickup_dzr1[group], 1, 
                                                                         COL_PICKUP_DZR1_COMMA, COL_PICKUP_DZR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                    edition_settings.pickup_dzr1_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzr1_amtz[group], 1, 
                                                                         COL_PICKUP_DZR1_AMTZ_COMMA, COL_PICKUP_DZR1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                    edition_settings.pickup_dzr1_blkI[group] = edit_setpoint(1, edition_settings.pickup_dzr1_blkI[group], 1, 
                                                                         COL_PICKUP_DZR1_I_BLK_COMMA, COL_PICKUP_DZR1_I_BLK_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                    edition_settings.pickup_dzr2_angle[group] = edit_setpoint_signed(1, edition_settings.pickup_dzr2_angle[group], 
                                                                         COL_S_DZR2_ANGLE, COL_PICKUP_DZR2_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                    edition_settings.pickup_dzr2_dir[group] = edit_setpoint(1, edition_settings.pickup_dzr2_dir[group], 1, 
                                                                         COL_PICKUP_DZR2_DIR_COMMA, COL_PICKUP_DZR2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                    edition_settings.pickup_dzr2_inv[group] = edit_setpoint(1, edition_settings.pickup_dzr2_inv[group], 1, 
                                                                         COL_PICKUP_DZR2_INV_COMMA, COL_PICKUP_DZR2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                    edition_settings.pickup_dzr2_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzr2_amtz[group], 1, 
                                                                         COL_PICKUP_DZR2_AMTZ_COMMA, COL_PICKUP_DZR2_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H)
                    edition_settings.pickup_dzr3_angle_h[group] = edit_setpoint_signed(1, edition_settings.pickup_dzr3_angle_h[group], 
                                                                         COL_DZR3_S_ANGLE_H, COL_PICKUP_DZR3_ANGLE_H_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                    edition_settings.pickup_dzr3_angle_l[group] = edit_setpoint_signed(1, edition_settings.pickup_dzr3_angle_l[group], 
                                                                         COL_DZR3_S_ANGLE_L, COL_PICKUP_DZR3_ANGLE_L_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                    edition_settings.pickup_dzr3_dir[group] = edit_setpoint(1, edition_settings.pickup_dzr3_dir[group], 1, 
                                                                         COL_PICKUP_DZR3_DIR_COMMA, COL_PICKUP_DZR3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                    edition_settings.pickup_dzr3_inv[group] = edit_setpoint(1, edition_settings.pickup_dzr3_inv[group], 1, 
                                                                         COL_PICKUP_DZR3_INV_COMMA, COL_PICKUP_DZR3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                    edition_settings.pickup_dzr3_amtz[group] = edit_setpoint(1, edition_settings.pickup_dzr3_amtz[group], 1, 
                                                                         COL_PICKUP_DZR3_AMTZ_COMMA, COL_PICKUP_DZR3_AMTZ_END, 10);

                }
                //Формуємо екран уставок ЗТОП
                make_ekran_setpoint_dzr(group);//make_ekran_setpoint_zop(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_ZOP - 1;
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_DZR - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //edition_settings.timeout_zop[group] = edit_setpoint(1, edition_settings.timeout_zop[group], 1, COL_TMO_ZOP_COMMA, COL_TMO_ZOP_END, 10);
                  if (current_ekran.index_position == INDEX_ML_TMO_DZR1)
                    edition_settings.timeout_dzr1[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr1[group], 1, COL_TMO_DZR1_COMMA, COL_TMO_DZR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                    edition_settings.timeout_dzr1_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr1_amtz[group], 1, COL_TMO_DZR1_AMTZ_COMMA, COL_TMO_DZR1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                    edition_settings.timeout_dzr2_dir[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_dir[group], 1, COL_TMO_DZR2_DIR_COMMA, COL_TMO_DZR2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                    edition_settings.timeout_dzr2_dir_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_dir_pr[group], 1, COL_TMO_DZR2_DIR_PR_COMMA, COL_TMO_DZR2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                    edition_settings.timeout_dzr2_inv[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_inv[group], 1, COL_TMO_DZR2_INV_COMMA, COL_TMO_DZR2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                    edition_settings.timeout_dzr2_inv_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_inv_pr[group], 1, COL_TMO_DZR2_INV_PR_COMMA, COL_TMO_DZR2_INV_PR_END , 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                    edition_settings.timeout_dzr2_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_amtz[group], 1, COL_TMO_DZR2_AMTZ_COMMA, COL_TMO_DZR2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                    edition_settings.timeout_dzr2_amtz_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_amtz_pr[group], 1, COL_TMO_DZR2_AMTZ_PR_COMMA, COL_TMO_DZR2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                    edition_settings.timeout_dzr2_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_vvid_pr[group], 1, COL_TMO_DZR2_VVID_PR_COMMA, COL_TMO_DZR2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                    edition_settings.timeout_dzr2_amtz_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr2_amtz_vvid_pr[group], 1, COL_TMO_DZR2_AMTZ_VVID_PR_COMMA, COL_TMO_DZR2_AMTZ_VVID_PR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                    edition_settings.timeout_dzr3_dir[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_dir[group], 1, COL_TMO_DZR3_DIR_COMMA, COL_TMO_DZR3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                    edition_settings.timeout_dzr3_dir_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_dir_pr[group], 1, COL_TMO_DZR3_DIR_PR_COMMA, COL_TMO_DZR3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                    edition_settings.timeout_dzr3_inv[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_inv[group], 1, COL_TMO_DZR3_INV_COMMA, COL_TMO_DZR3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                    edition_settings.timeout_dzr3_inv_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_inv_pr[group], 1, COL_TMO_DZR3_INV_PR_COMMA, COL_TMO_DZR3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                    edition_settings.timeout_dzr3_amtz[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_amtz[group], 1, COL_TMO_DZR3_AMTZ_COMMA, COL_TMO_DZR3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                    edition_settings.timeout_dzr3_amtz_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_amtz_pr[group], 1, COL_TMO_DZR3_AMTZ_PR_COMMA, COL_TMO_DZR3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                    edition_settings.timeout_dzr3_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_vvid_pr[group], 1, COL_TMO_DZR3_VVID_PR_COMMA, COL_TMO_DZR3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                    edition_settings.timeout_dzr3_amtz_vvid_pr[group] =
                      edit_setpoint(1, edition_settings.timeout_dzr3_amtz_vvid_pr[group], 1, COL_TMO_DZR3_AMTZ_VVID_PR_COMMA, COL_TMO_DZR3_AMTZ_VVID_PR_END, 10);
                }
                //Формуємо екран витримок ЗОП(КОФ)
                make_ekran_timeout_dzr(group);//make_ekran_timeout_zop(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
              {
                //if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_ZOP - 1;
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_DZR - 1;
                position_in_current_level_menu[EKRAN_CONTROL_ZOP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ЗОП(КОФ)
                make_ekran_control_dzr();//make_ekran_control_zop();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_UMIN - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPUMIN1)
                    edition_settings.setpoint_Umin1[group] = edit_setpoint(1, edition_settings.setpoint_Umin1[group], 1, COL_SETPOINT_UMIN1_COMMA, COL_SETPOINT_UMIN1_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                    edition_settings.setpoint_Umin1_Iblk[group] = edit_setpoint(1, edition_settings.setpoint_Umin1_Iblk[group], 1, COL_SETPOINT_UMIN1_IBLK_COMMA, COL_SETPOINT_UMIN1_IBLK_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2)
                    edition_settings.setpoint_Umin2[group] = edit_setpoint(1, edition_settings.setpoint_Umin2[group], 1, COL_SETPOINT_UMIN2_COMMA, COL_SETPOINT_UMIN2_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                    edition_settings.setpoint_Umin2_Iblk[group] = edit_setpoint(1, edition_settings.setpoint_Umin2_Iblk[group], 1, COL_SETPOINT_UMIN2_IBLK_COMMA, COL_SETPOINT_UMIN2_IBLK_END, 10);
                }
                //Формуємо екран уставок Umin
                make_ekran_setpoint_Umin(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_UMIN - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUMIN1)
                    edition_settings.timeout_Umin1[group] = edit_setpoint(1, edition_settings.timeout_Umin1[group], 1, COL_TMO_UMIN1_COMMA, COL_TMO_UMIN1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUMIN2)
                    edition_settings.timeout_Umin2[group] = edit_setpoint(1, edition_settings.timeout_Umin2[group], 1, COL_TMO_UMIN2_COMMA, COL_TMO_UMIN2_END, 10);
                }
                //Формуємо екран витримок Umin
                make_ekran_timeout_Umin(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_UMIN - 1;
                position_in_current_level_menu[EKRAN_CONTROL_UMIN] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для Umin
                make_ekran_control_Umin();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_UMAX - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPUMAX1)
                    edition_settings.setpoint_Umax1[group] = edit_setpoint(1, edition_settings.setpoint_Umax1[group], 1, COL_SETPOINT_UMAX1_COMMA, COL_SETPOINT_UMAX1_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMAX2)
                    edition_settings.setpoint_Umax2[group] = edit_setpoint(1, edition_settings.setpoint_Umax2[group], 1, COL_SETPOINT_UMAX2_COMMA, COL_SETPOINT_UMAX2_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                    edition_settings.setpoint_kp_Umax[group] = edit_setpoint(1, edition_settings.setpoint_kp_Umax[group], 1, COL_SETPOINT_KP_UMAX_COMMA, COL_SETPOINT_KP_UMAX_END, 1);
                }
                //Формуємо екран уставок Umax
                make_ekran_setpoint_Umax(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_UMAX - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUMAX1)
                    edition_settings.timeout_Umax1[group] = edit_setpoint(1, edition_settings.timeout_Umax1[group], 1, COL_TMO_UMAX1_COMMA, COL_TMO_UMAX1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUMAX2)
                    edition_settings.timeout_Umax2[group] = edit_setpoint(1, edition_settings.timeout_Umax2[group], 1, COL_TMO_UMAX2_COMMA, COL_TMO_UMAX2_END, 10);
                }
                //Формуємо екран витримок Umax
                make_ekran_timeout_Umax(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_UMAX - 1;
                position_in_current_level_menu[EKRAN_CONTROL_UMAX] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для Umax
                make_ekran_control_Umax();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_UP*MAX_ROW_FOR_SETPOINT_UP - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                  
                  if (_n_index == INDEX_ML_STP_UP)
                  {
                    uint32_t comma = 0, end = 0, min_step = 0;
                    int32_t sign_before = 1, sign_after = 1;
                    switch (current_settings.ctrl_UP_input[_n_UP])
                    {
                    case UP_CTRL_Ia_Ib_Ic:
                    case UP_CTRL_Ia:
                    case UP_CTRL_Ib:
                    case UP_CTRL_Ic:
                    case UP_CTRL_I1:
                    case UP_CTRL_I2:
                    case UP_CTRL_3I0_r:
                      {
                        comma = COL_SETPOINT_UP_I_COMMA;
                        end = COL_SETPOINT_UP_I_END;
                        min_step = 10;
                        break;
                      }
                    case UP_CTRL_3I0:
                    case UP_CTRL_3I0_others:
                      {
                        comma = COL_SETPOINT_UP_3I0_COMMA;
                        end = COL_SETPOINT_UP_3I0_END;
                        min_step = 1;
                        break;
                      }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                      {
                        comma = COL_SETPOINT_UP_U_COMMA;
                        end = COL_SETPOINT_UP_U_END;
                        min_step = 100;
                        break;
                      }
                    case UP_CTRL_P:
                    case UP_CTRL_Q:
                      {
                        if (edition_settings.setpoint_UP[_n_UP][0][group] < 0) sign_before = -1;
                        if (current_ekran.position_cursor_x == (COL_SETPOINT_UP_PQ_BEGIN - 1))
                        {
                          sign_after = -sign_before;
                        }
                        else
                        {
                          sign_after = sign_before;
                          comma = COL_SETPOINT_UP_PQ_COMMA;
                          end = COL_SETPOINT_UP_PQ_END;
                          min_step = 1;
                        }
                        break;
                      }
                    case UP_CTRL_S:
                      {
                        comma = COL_SETPOINT_UP_S_COMMA;
                        end = COL_SETPOINT_UP_S_END;
                        min_step = 1;
                        break;
                      }
                    default:
                      {
                        //Теоретично цього ніколи не мало б бути
                        total_error_sw_fixed();
                      }
                    }
                    
                    if (sign_before == sign_after)
                      edition_settings.setpoint_UP[_n_UP][0][group] = sign_after*edit_setpoint(1, abs(edition_settings.setpoint_UP[_n_UP][0][group]), 1, comma, end, min_step);
                    else
                      edition_settings.setpoint_UP[_n_UP][0][group] = sign_after*abs(edition_settings.setpoint_UP[_n_UP][0][group]);
                  }
                  else if (_n_index == INDEX_ML_STP_UP_KP)
                    edition_settings.setpoint_UP_KP[_n_UP][0][group] = edit_setpoint(1, edition_settings.setpoint_UP_KP[_n_UP][0][group], 1, COL_SETPOINT_UP_KP_COMMA, COL_SETPOINT_UP_KP_END, 1);
                }
                //Формуємо екран уставок УЗ
                make_ekran_setpoint_UP_A01(group);//!make_ekran_setpoint_UP(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_UP*MAX_ROW_FOR_TIMEOUT_UP - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_TIMEOUT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;

                  if (_n_index == INDEX_ML_TMOUP)
                    edition_settings.timeout_UP[_n_UP][0][group] = edit_setpoint(1, edition_settings.timeout_UP[_n_UP][0][group], 1, COL_TMO_UP_COMMA, COL_TMO_UP_END, 10);
                }
                //Формуємо екран витримок УЗ
                make_ekran_timeout_UP(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UP)
              {
                current_ekran.index_position--;
                //!if(current_ekran.index_position < 0) current_ekran.index_position = (NUMBER_UP*MAX_ROW_FOR_CONTROL_UP) - 1;
				//!
                //!__SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                //!uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
                //!while (
                //!       ((current_ekran.index_position % (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)) == CTR_UP_OR_AND_BIT) &&
                //!       (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
                //!       (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
                //!       (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
                //!      )
                //!{
                //!  current_ekran.index_position--;
                //!  if(current_ekran.index_position < 0) current_ekran.index_position = (NUMBER_UP*MAX_ROW_FOR_CONTROL_UP) - 1;
                //!
                //!  ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
                //!}
                if(current_ekran.index_position < 0) current_ekran.index_position = (NUMBER_UP*MAX_ROW_FOR_CONTROL_A01_UP) - 1;

                __SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
                while (
                       ((current_ekran.index_position % (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)) == (_CTR_A01_UP_NEXT_BIT+3)) &&
                       (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
                       (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
                       (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
                      )
                {
                  current_ekran.index_position--;
                  if(current_ekran.index_position < 0) current_ekran.index_position = (NUMBER_UP*MAX_ROW_FOR_CONTROL_A01_UP) - 1;
                
                  ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
                }
              
                position_in_current_level_menu[EKRAN_CONTROL_UP] = current_ekran.index_position;
              
                //Формуємо екран управлінської інформації для УЗ
                make_ekran_control_UP_A01();//!make_ekran_control_UP();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TRANSFORMATOR_INFO_SETPOINT - 1;
                  position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_SETPOINT] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_T_BP)
                    edition_settings.Tbp = edit_setpoint(1, edition_settings.Tbp, 0, 0, COL_T_BP_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_T_MN)
                    edition_settings.Tmn = edit_setpoint(1, edition_settings.Tmn, 0, 0, COL_T_MN_END, 1);
                  else
                    edition_settings.TVoltage = edit_setpoint(1, edition_settings.TVoltage, 0, 0, COL_TN_END, 1);
                }
                //Формуємо екран інфтрмації по трансформаторах
                make_ekran_transformator();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TRANSFORMATOR_INFO_CONTROL - 1;
                position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_CONTROL] = current_ekran.index_position;
                //Формуємо екран відображення налаштувань меню "Трансформатор"
                //!make_ekran_transformator_control();
              }
              else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_SETPOINT_SWITCH - 1;
                  position_in_current_level_menu[EKRAN_SETPOINT_SWITCH] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPInom)
                    edition_settings.setpoint_Inom = edit_setpoint(1, edition_settings.setpoint_Inom, 0, 0, COL_SETPOINT_Inom_END, 1);
                  if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                    edition_settings.setpoint_r_kom_st_Inom = edit_setpoint(1, edition_settings.setpoint_r_kom_st_Inom, 0, 0, COL_SETPOINT_RKS_Inom_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                    edition_settings.setpoint_Inom_vymk = edit_setpoint(1, edition_settings.setpoint_Inom_vymk, 1, COL_SETPOINT_Inom_vymk_COMMA, COL_SETPOINT_Inom_vymk_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                    edition_settings.setpoint_r_kom_st_Inom_vymk = edit_setpoint(1, edition_settings.setpoint_r_kom_st_Inom_vymk, 0, 0, COL_SETPOINT_RKS_Inom_vymk_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                    edition_settings.setpoint_pochatkovyj_resurs = edit_setpoint(1, edition_settings.setpoint_pochatkovyj_resurs, 0, 0, COL_SETPOINT_POCHATKOVYJ_RESURS_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                    edition_settings.setpoint_krytychnyj_resurs = edit_setpoint(1, edition_settings.setpoint_krytychnyj_resurs, 0, 0, COL_SETPOINT_KRYTYCHNYJ_RESURS_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                    edition_settings.setpoint_pochatkova_k_vymk = edit_setpoint(1, edition_settings.setpoint_pochatkova_k_vymk, 0, 0, COL_SETPOINT_POCHATKOVA_K_VYMK_END, 1);
                }
                //Формуємо екран уставок виключателя
                make_ekran_setpoint_switch();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_SWITCH - 1;
                  position_in_current_level_menu[EKRAN_TIMEOUT_SWITCH] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                    edition_settings.timeout_swch_on = edit_setpoint(1, edition_settings.timeout_swch_on, 1, COL_TMO_SWCH_ON_COMMA, COL_TMO_SWCH_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                    edition_settings.timeout_swch_off = edit_setpoint(1, edition_settings.timeout_swch_off, 1, COL_TMO_SWCH_OFF_COMMA, COL_TMO_SWCH_OFF_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                    edition_settings.timeout_swch_udl_blk_on = edit_setpoint(1, edition_settings.timeout_swch_udl_blk_on, 1, COL_TMO_SWCH_UDL_BLK_ON_COMMA, COL_TMO_SWCH_UDL_BLK_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                    edition_settings.timeout_pryvoda_VV = edit_setpoint(1, edition_settings.timeout_pryvoda_VV, 1, COL_TMO_PRYVODA_VV_COMMA, COL_TMO_PRYVODA_VV_END, 10);
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_SWITCH - 1;
                position_in_current_level_menu[EKRAN_CONTROL_SWITCH] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для вимикача
                make_ekran_control_switch();
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                uint32_t on_off = current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H;
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_SWITCH - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                    edition_settings.timeout_swch_on_[on_off] = edit_setpoint(1, edition_settings.timeout_swch_on_[on_off], 1, COL_TMO_SWCH_ON_COMMA, COL_TMO_SWCH_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                    edition_settings.timeout_swch_off_[on_off] = edit_setpoint(1, edition_settings.timeout_swch_off_[on_off], 1, COL_TMO_SWCH_OFF_COMMA, COL_TMO_SWCH_OFF_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                    edition_settings.timeout_swch_udl_blk_on_[on_off] = edit_setpoint(1, edition_settings.timeout_swch_udl_blk_on_[on_off], 1, COL_TMO_SWCH_UDL_BLK_ON_COMMA, COL_TMO_SWCH_UDL_BLK_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                    edition_settings.timeout_pryvoda_VV_[on_off] = edit_setpoint(1, edition_settings.timeout_pryvoda_VV_[on_off], 1, COL_TMO_PRYVODA_VV_COMMA, COL_TMO_PRYVODA_VV_END, 10);
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch_(on_off);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_CONTROL_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_SWITCH - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для вимикача
                make_ekran_control_switch_(current_ekran.current_level - EKRAN_CONTROL_SWITCH_H);
              }
              else if(
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                     )
              {
                int forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
                if (current_ekran.edition == 0) 
                {
                  int lines = current_settings.lines[forward_backward];
                  if(--current_ekran.index_position < 0) current_ekran.index_position = (1 + 2*lines) - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else 
                {
                  if (current_ekran.index_position == INDEX_ML_LINES)
                  {
                    edition_settings.lines[forward_backward] = edit_setpoint(1, edition_settings.lines[forward_backward], 0, 0, COL_SETPOINT_LINES_END, 1);
                  }
                  else
                  {
                    int _tmp = current_ekran.index_position - 1;
                    int dilanka = _tmp >> 1;
                    if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                    {
                      edition_settings.dovgyna[forward_backward][dilanka] = edit_setpoint(1, edition_settings.dovgyna[forward_backward][dilanka], 1, COL_SETPOINT_DOVGYNA_COMMA, COL_SETPOINT_DOVGYNA_END, 1);
                    }
                    else
                    {
                      edition_settings.opir[forward_backward][dilanka] = edit_setpoint(1, edition_settings.opir[forward_backward][dilanka], 1, COL_SETPOINT_OPIR_COMMA, COL_SETPOINT_OPIR_END, 1);
                    }
                  }
                }
              
                //Формуємо екран уставок для ВМП
                make_ekran_setpoint_VMP(forward_backward);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_VMP - 1;
                position_in_current_level_menu[EKRAN_CONTROL_VMP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ВМП
                make_ekran_control_VMP();
              }
              else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_INPUTS - 1;
                  position_in_current_level_menu[EKRAN_DOPUSK_DV_UVV] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.dopusk_dv[current_ekran.index_position] = 
                    edit_setpoint(1, edition_settings.dopusk_dv[current_ekran.index_position], 0, 0, COL_DOPUSK_DV_END, 1);
                }
                //Формуємо екран інфтрмації по допусках ДВ
                make_ekran_dopusk_dv();
              }
              else if((current_ekran.current_level == EKRAN_TYPE_INPUT_UVV) || (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_INPUTS - 1;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для УВВ
                if (current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                  make_ekran_type_input_uvv(0);
                else
                  make_ekran_type_input_uvv(1);
              }
              else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_SIMPLE_OUTPUTS - 1;
                position_in_current_level_menu[EKRAN_TYPE_OUTPUT_UVV] = current_ekran.index_position;
                //Формуємо екран типу виходу
                make_ekran_type_output_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_LEDS - 1;
                position_in_current_level_menu[EKRAN_TYPE_LED_UVV] = current_ekran.index_position;
                //Формуємо екран типу світлоіндикатора
                make_ekran_type_led_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = NUMBER_DEFINED_BUTTONS - 1;
                position_in_current_level_menu[EKRAN_TYPE_BUTTON_UVV] = current_ekran.index_position;
                //Формуємо екран типу ФК
                make_ekran_type_button_uvv();
              }
              else if(current_ekran.current_level == EKRAN_ADDRESS)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_ADDRESS - 1;
                  position_in_current_level_menu[EKRAN_ADDRESS] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.address = edit_setpoint(1, edition_settings.address, 0, 0, COL_ADDRESS_END, 1);
                }
                //Формуємо екран інфтрмації по комунікаційній адресі
                make_ekran_address();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_SPEED_INTERFACE - 1;
                  position_in_current_level_menu[EKRAN_VIEW_SPEED_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.speed_RS485--;
                  if (edition_settings.speed_RS485 < VALUE_SPEED_INTERFACE_MIN)
                    edition_settings.speed_RS485 = VALUE_SPEED_INTERFACE_MAX;
                }
                //Формуємо екран інформації по швидкості обміну
                make_ekran_speed_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_PARE_INTERFACE - 1;
                  position_in_current_level_menu[EKRAN_VIEW_PARE_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.pare_bit_RS485--;
                  if (edition_settings.pare_bit_RS485 < VALUE_PARE_INTERFACE_MIN)
                    edition_settings.pare_bit_RS485 = VALUE_PARE_INTERFACE_MAX;
                }
                //Формуємо екран інформації по контролю парності
                make_ekran_pare_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_STOP_BITS_INTERFACE - 1;
                  position_in_current_level_menu[EKRAN_VIEW_STOP_BITS_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.number_stop_bit_RS485--;
                  if (edition_settings.number_stop_bit_RS485 < VALUE_STOP_BITS_INTERFACE_MIN)
                    edition_settings.number_stop_bit_RS485 = VALUE_STOP_BITS_INTERFACE_MAX;
                }
                //Формуємо екран інформації по кількості стопових біт
                make_ekran_stopbits_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_TIMEOUT_INTERFACE - 1;
                  position_in_current_level_menu[EKRAN_VIEW_TIMEOUT_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.time_out_1_RS485 = edit_setpoint(1, edition_settings.time_out_1_RS485, 1, COL_TIMEOUT_INTERFACE_COMMA, COL_TIMEOUT_INTERFACE_END, 1);
                }
                //Формуємо екран інформації по time-out наступного символу
                make_ekran_timeout_interface();
              }
              else if(current_ekran.current_level == EKRAN_TIME_ZONE)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEZONE_SETTINGS - 1;
                position_in_current_level_menu[EKRAN_TIME_ZONE] = current_ekran.index_position;
                //Формуємо екран
                make_ekran_timezone_dst();
              }
              else if(current_ekran.current_level == EKRAN_DST_RULE)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_DST_RULE - 1;
                position_in_current_level_menu[EKRAN_DST_RULE] = current_ekran.index_position;
              
                __SETTINGS *p_settings = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                uint32_t rule = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? p_settings->dst_on_rule : p_settings->dst_off_rule;
                //Формуємо екран
                make_ekran_dst_rule(rule);
              }
              else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_GENERAL_PICKUPS_EL - 1;
                  position_in_current_level_menu[EKRAN_GENERAL_PICKUPS_EL] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                  {
                    edition_settings.number_iteration_el = edit_setpoint(1, edition_settings.number_iteration_el, 0, 0, COL_NUMBER_INERATION_END, 1);
                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                  {
//                    edition_settings.number_defined_df = edit_setpoint(1, edition_settings.number_defined_df, 0, 0, COL_NUMBER_DEFINED_FUNCTIONS_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                  {
//                    edition_settings.number_defined_dt = edit_setpoint(1, edition_settings.number_defined_dt, 0, 0, COL_NUMBER_DEFINED_TRIGGERS_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                  {
//                    edition_settings.number_defined_and = edit_setpoint(1, edition_settings.number_defined_and, 0, 0, COL_NUMBER_DEFINED_AND_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                  {
//                    edition_settings.number_defined_or = edit_setpoint(1, edition_settings.number_defined_or, 0, 0, COL_NUMBER_DEFINED_OR_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                  {
//                    edition_settings.number_defined_xor = edit_setpoint(1, edition_settings.number_defined_xor, 0, 0, COL_NUMBER_DEFINED_XOR_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                  {
//                    edition_settings.number_defined_not = edit_setpoint(1, edition_settings.number_defined_not, 0, 0, COL_NUMBER_DEFINED_NOT_END, 1);
//                  }
                }
                //Формуємо екран відображення загальних витримок для розширеної логіки
                make_ekran_general_pickups_el();
              }
              else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TYPE_DF - 1;
                position_in_current_level_menu[EKRAN_LIST_TYPE_DF] = current_ekran.index_position;
                //Формуємо екран відображення типу опреділювальної функції
                make_ekran_type_df();
              }
              else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_TIMEOUT_DF - 1;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                    edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      edit_setpoint(1, edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], 1, COL_TMO_DF_PAUSE_COMMA, COL_TMO_DF_PAUSE_END, 10);
                  else
                    edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      edit_setpoint(1, edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], 1, COL_TMO_DF_WORK_COMMA, COL_TMO_DF_WORK_END, 10);
                }
                //Формуємо екран таймерів опреділюваних функцій
                make_ekran_timeout_df(current_ekran.current_level - EKRAN_TIMEOUT_DF1);
              }
              else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_LIST_SOURCE_TF - 1;
                //Формуємо екран
                make_ekran_list_source_tf();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_DIGITAL_REGISTRATOR - 1;
                  position_in_current_level_menu[EKRAN_TIMEOUT_DIGITAL_REGISTRATOR] = current_ekran.index_position;
                }
                else
                {
                  ////Редагування числа
                  //if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  //{
                  //  unsigned int temp_setpoint = edition_settings.prefault_number_periods*20;
                  //  do
                  //  {
                  //    //Величину витримки збільшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                  //    temp_setpoint = edit_setpoint(1, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                  //  }
                  //  while ((temp_setpoint % 20) != 0);
                  //  edition_settings.prefault_number_periods = temp_setpoint / 20;
                  //}
                  //else
                  //{
                    //unsigned int temp_setpoint = edition_settings.postfault_number_periods*20;
                    //unsigned int temp_setpoint = edition_settings.timeout_prolongation_work_digital_registrator;
                    //do
                    //{
                    //  //Величину витримки збільшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                    //  temp_setpoint = edit_setpoint(1, temp_setpoint, 1, COL_TMO_ELONGATION_COMMA, COL_TMO_ELONGATION_END, 10);
                    //}
                    //while ((temp_setpoint % 20) != 0);
                    //edition_settings.postfault_number_periods = temp_setpoint / 20;
                  //}
                  edition_settings.timeout_prolongation_work_digital_registrator = 
                      edit_setpoint(1, edition_settings.timeout_prolongation_work_digital_registrator, 1, COL_TMO_ELONGATION_COMMA, COL_TMO_ELONGATION_END, 10);
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_digital_registrator();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_TIMEOUT_ANALOG_REGISTRATOR - 1;
                  position_in_current_level_menu[EKRAN_TIMEOUT_ANALOG_REGISTRATOR] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  {
                    unsigned int temp_setpoint = edition_settings.prefault_number_periods*20;
                    do
                    {
                      //Величину витримки збільшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                      temp_setpoint = edit_setpoint(1, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                    }
                    while ((temp_setpoint % 20) != 0);
                    edition_settings.prefault_number_periods = temp_setpoint / 20;
                  }
                  else
                  {
                    unsigned int temp_setpoint = edition_settings.postfault_number_periods*20;
                    do
                    {
                      //Величину витримки збільшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                      temp_setpoint = edit_setpoint(1, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                    }
                    while ((temp_setpoint % 20) != 0);
                    edition_settings.postfault_number_periods = temp_setpoint / 20;
                  }
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_analog_registrator();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_AR)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CONTROL_AR - 1;
                position_in_current_level_menu[EKRAN_CONTROL_AR] = current_ekran.index_position;
                //Формуємо екран відображення
                make_ekran_control_ar();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_SETTING_LANGUAGE - 1;
                  position_in_current_level_menu[EKRAN_VIEW_SETTING_LANGUAGE] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.language--;
                  if (edition_settings.language < VALUE_SETTING_LANGUAGE_MIN)
                    edition_settings.language = VALUE_SETTING_LANGUAGE_MAX;
                }
                //Формуємо екран інформації по мові меню
                make_ekran_setting_language();
              }
              else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
              {
                if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_CHOSE_EXTRA_SETTINGS - 1;
                position_in_current_level_menu[EKRAN_CHOSE_EXTRA_SETTINGS] = current_ekran.index_position;
                //Формуємо екран відображення додаткових налаштувань
                make_ekran_chose_extra_settings();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
              {
                if(current_ekran.edition == 0)
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIEW_GRUPA_USTAVOK - 1;
                  position_in_current_level_menu[EKRAN_VIEW_GRUPA_USTAVOK] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.grupa_ustavok--;
                  if (edition_settings.grupa_ustavok < SETPOINT_GRUPA_USTAVOK_MIN)
                    edition_settings.grupa_ustavok = SETPOINT_GRUPA_USTAVOK_MAX;
                }
                //Формуємо екран інформації по групах уставок
                make_ekran_grupa_ustavok();
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(
                 (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                 (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_MTZ) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZ1)
                    edition_settings.setpoint_mtz_1[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1[group], 1, COL_SETPOINT_MTZ_1_COMMA, COL_SETPOINT_MTZ_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                    edition_settings.setpoint_mtz_1_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1_n_vpered[group], 1, COL_SETPOINT_MTZ_1_N_VPERED_COMMA, COL_SETPOINT_MTZ_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                    edition_settings.setpoint_mtz_1_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1_n_nazad[group], 1, COL_SETPOINT_MTZ_1_N_NAZAD_COMMA, COL_SETPOINT_MTZ_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                    edition_settings.setpoint_mtz_1_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1_angle[group], 0, 0, COL_SETPOINT_MTZ_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_1_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1_po_napruzi[group], 1, COL_SETPOINT_MTZ_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                    edition_settings.setpoint_mtz_1_U[group] = edit_setpoint(0, edition_settings.setpoint_mtz_1_U[group], 1, COL_SETPOINT_MTZ_1_U_COMMA, COL_SETPOINT_MTZ_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2)
                    edition_settings.setpoint_mtz_2[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2[group], 1, COL_SETPOINT_MTZ_2_COMMA, COL_SETPOINT_MTZ_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                    edition_settings.setpoint_mtz_2_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2_n_vpered[group], 1, COL_SETPOINT_MTZ_2_N_VPERED_COMMA, COL_SETPOINT_MTZ_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                    edition_settings.setpoint_mtz_2_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2_n_nazad[group], 1, COL_SETPOINT_MTZ_2_N_NAZAD_COMMA, COL_SETPOINT_MTZ_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                    edition_settings.setpoint_mtz_2_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2_angle[group], 0, 0, COL_SETPOINT_MTZ_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_2_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2_po_napruzi[group], 1, COL_SETPOINT_MTZ_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                    edition_settings.setpoint_mtz_2_U[group] = edit_setpoint(0, edition_settings.setpoint_mtz_2_U[group], 1, COL_SETPOINT_MTZ_2_U_COMMA, COL_SETPOINT_MTZ_2_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3)
                    edition_settings.setpoint_mtz_3[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3[group], 1, COL_SETPOINT_MTZ_3_COMMA, COL_SETPOINT_MTZ_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                    edition_settings.setpoint_mtz_3_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3_n_vpered[group], 1, COL_SETPOINT_MTZ_3_N_VPERED_COMMA, COL_SETPOINT_MTZ_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                    edition_settings.setpoint_mtz_3_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3_n_nazad[group], 1, COL_SETPOINT_MTZ_3_N_NAZAD_COMMA, COL_SETPOINT_MTZ_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                    edition_settings.setpoint_mtz_3_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3_angle[group], 0, 0, COL_SETPOINT_MTZ_3_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_3_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3_po_napruzi[group], 1, COL_SETPOINT_MTZ_3_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                    edition_settings.setpoint_mtz_3_U[group] = edit_setpoint(0, edition_settings.setpoint_mtz_3_U[group], 1, COL_SETPOINT_MTZ_3_U_COMMA, COL_SETPOINT_MTZ_3_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4)
                    edition_settings.setpoint_mtz_4[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4[group], 1, COL_SETPOINT_MTZ_4_COMMA, COL_SETPOINT_MTZ_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                    edition_settings.setpoint_mtz_4_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4_n_vpered[group], 1, COL_SETPOINT_MTZ_4_N_VPERED_COMMA, COL_SETPOINT_MTZ_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                    edition_settings.setpoint_mtz_4_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4_n_nazad[group], 1, COL_SETPOINT_MTZ_4_N_NAZAD_COMMA, COL_SETPOINT_MTZ_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                    edition_settings.setpoint_mtz_4_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4_angle[group], 0, 0, COL_SETPOINT_MTZ_4_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                    edition_settings.setpoint_mtz_4_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4_po_napruzi[group], 1, COL_SETPOINT_MTZ_4_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZ_4_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                    edition_settings.setpoint_mtz_4_U[group] = edit_setpoint(0, edition_settings.setpoint_mtz_4_U[group], 1, COL_SETPOINT_MTZ_4_U_COMMA, COL_SETPOINT_MTZ_4_U_END, 10);
                }
                //Формуємо екран уставок МТЗ
                make_ekran_setpoint_mtz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_MTZ) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOMTZ1)
                    edition_settings.timeout_mtz_1[group] = edit_setpoint(0, edition_settings.timeout_mtz_1[group], 1, COL_TMO_MTZ_1_COMMA, COL_TMO_MTZ_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                    edition_settings.timeout_mtz_1_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtz_1_n_vpered[group], 1, COL_TMO_MTZ_1_N_VPERED_COMMA, COL_TMO_MTZ_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                    edition_settings.timeout_mtz_1_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtz_1_n_nazad[group], 1, COL_TMO_MTZ_1_N_NAZAD_COMMA, COL_TMO_MTZ_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                    edition_settings.timeout_mtz_1_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtz_1_po_napruzi[group], 1, COL_TMO_MTZ_1_PO_NAPRUZI_COMMA, COL_TMO_MTZ_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2)
                    edition_settings.timeout_mtz_2[group] = edit_setpoint(0, edition_settings.timeout_mtz_2[group], 1, COL_TMO_MTZ_2_COMMA, COL_TMO_MTZ_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                    edition_settings.timeout_mtz_2_pr[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_pr[group], 1, COL_TMO_MTZ_2_PR_COMMA, COL_TMO_MTZ_2_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                    edition_settings.timeout_mtz_2_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_n_vpered[group], 1, COL_TMO_MTZ_2_N_VPERED_COMMA, COL_TMO_MTZ_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                    edition_settings.timeout_mtz_2_n_vpered_pr[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_n_vpered_pr[group], 1, COL_TMO_MTZ_2_N_VPERED_PR_COMMA, COL_TMO_MTZ_2_N_VPERED_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                    edition_settings.timeout_mtz_2_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_n_nazad[group], 1, COL_TMO_MTZ_2_N_NAZAD_COMMA, COL_TMO_MTZ_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                    edition_settings.timeout_mtz_2_n_nazad_pr[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_n_nazad_pr[group], 1, COL_TMO_MTZ_2_N_NAZAD_PR_COMMA, COL_TMO_MTZ_2_N_NAZAD_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                    edition_settings.timeout_mtz_2_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_po_napruzi[group], 1, COL_TMO_MTZ_2_PO_NAPRUZI_COMMA, COL_TMO_MTZ_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                    edition_settings.timeout_mtz_2_po_napruzi_pr[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_po_napruzi_pr[group], 1, COL_TMO_MTZ_2_PO_NAPRUZI_PR_COMMA, COL_TMO_MTZ_2_PO_NAPRUZI_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                    edition_settings.timeout_mtz_2_vvid_pr[group] = edit_setpoint(0, edition_settings.timeout_mtz_2_vvid_pr[group], 1, COL_TMO_MTZ_2_VVID_PR_COMMA, COL_TMO_MTZ_2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3)
                    edition_settings.timeout_mtz_3[group] = edit_setpoint(0, edition_settings.timeout_mtz_3[group], 1, COL_TMO_MTZ_3_COMMA, COL_TMO_MTZ_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                    edition_settings.timeout_mtz_3_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtz_3_n_vpered[group], 1, COL_TMO_MTZ_3_N_VPERED_COMMA, COL_TMO_MTZ_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                    edition_settings.timeout_mtz_3_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtz_3_n_nazad[group], 1, COL_TMO_MTZ_3_N_NAZAD_COMMA, COL_TMO_MTZ_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                    edition_settings.timeout_mtz_3_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtz_3_po_napruzi[group], 1, COL_TMO_MTZ_3_PO_NAPRUZI_COMMA, COL_TMO_MTZ_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4)
                    edition_settings.timeout_mtz_4[group] = edit_setpoint(0, edition_settings.timeout_mtz_4[group], 1, COL_TMO_MTZ_4_COMMA, COL_TMO_MTZ_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                    edition_settings.timeout_mtz_4_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtz_4_n_vpered[group], 1, COL_TMO_MTZ_4_N_VPERED_COMMA, COL_TMO_MTZ_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                    edition_settings.timeout_mtz_4_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtz_4_n_nazad[group], 1, COL_TMO_MTZ_4_N_NAZAD_COMMA, COL_TMO_MTZ_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                    edition_settings.timeout_mtz_4_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtz_4_po_napruzi[group], 1, COL_TMO_MTZ_4_PO_NAPRUZI_COMMA, COL_TMO_MTZ_4_PO_NAPRUZI_END, 10);
                }
                //Формуємо екран витримок МТЗ
                make_ekran_timeout_mtz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZ) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_MTZ] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для МТЗ
                make_ekran_control_mtz();
              }
//++++++++++++++++++#include "ekran/ekran_dz_down.ci"++++++++++++++++++++
              //Натиснута кнопка DOWN
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_DZO) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                    edition_settings.pickup_dzo_Io3g_Io1g[group] = edit_setpoint(0, edition_settings.pickup_dzo_Io3g_Io1g[group], 1, 
                                                                         COL_PICKUP_DZO_K_ICE_COMMA, COL_PICKUP_DZO_K_ICE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1)
                    edition_settings.pickup_dzo1[group] = edit_setpoint(0, edition_settings.pickup_dzo1[group], 1, 
                                                                         COL_PICKUP_DZO1_COMMA, COL_PICKUP_DZO1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                    edition_settings.pickup_dzo1_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzo1_amtz[group], 1, 
                                                                         COL_PICKUP_DZO1_AMTZ_COMMA, COL_PICKUP_DZO1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                    edition_settings.pickup_dzo1_blkI[group] = edit_setpoint(0, edition_settings.pickup_dzo1_blkI[group], 1, 
                                                                         COL_PICKUP_DZO1_I_BLK_COMMA, COL_PICKUP_DZO1_I_BLK_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                    edition_settings.pickup_dzo2_angle[group] = edit_setpoint_signed(0, edition_settings.pickup_dzo2_angle[group], 
                                                                         COL_S_DZO2_ANGLE, COL_PICKUP_DZO2_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                    edition_settings.pickup_dzo2_dir[group] = edit_setpoint(0, edition_settings.pickup_dzo2_dir[group], 1, 
                                                                         COL_PICKUP_DZO2_DIR_COMMA, COL_PICKUP_DZO2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                    edition_settings.pickup_dzo2_inv[group] = edit_setpoint(0, edition_settings.pickup_dzo2_inv[group], 1, 
                                                                         COL_PICKUP_DZO2_INV_COMMA, COL_PICKUP_DZO2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                    edition_settings.pickup_dzo2_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzo2_amtz[group], 1, 
                                                                         COL_PICKUP_DZO2_AMTZ_COMMA, COL_PICKUP_DZO2_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H)
                    edition_settings.pickup_dzo3_angle_h[group] = edit_setpoint_signed(0, edition_settings.pickup_dzo3_angle_h[group], 
                                                                         COL_DZO3_S_ANGLE_H, COL_PICKUP_DZO3_ANGLE_H_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                    edition_settings.pickup_dzo3_angle_l[group] = edit_setpoint_signed(0, edition_settings.pickup_dzo3_angle_l[group], 
                                                                         COL_DZO3_S_ANGLE_L, COL_PICKUP_DZO3_ANGLE_L_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                    edition_settings.pickup_dzo3_dir[group] = edit_setpoint(0, edition_settings.pickup_dzo3_dir[group], 1, 
                                                                         COL_PICKUP_DZO3_DIR_COMMA, COL_PICKUP_DZO3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                    edition_settings.pickup_dzo3_inv[group] = edit_setpoint(0, edition_settings.pickup_dzo3_inv[group], 1, 
                                                                         COL_PICKUP_DZO3_INV_COMMA, COL_PICKUP_DZO3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                    edition_settings.pickup_dzo3_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzo3_amtz[group], 1, 
                                                                         COL_PICKUP_DZO3_AMTZ_COMMA, COL_PICKUP_DZO3_AMTZ_END, 10);


                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                    edition_settings.pickup_dzo4_Zo_dir[group] = edit_setpoint(0, edition_settings.pickup_dzo4_Zo_dir[group], 1, 
                                                                         COL_PICKUP_DZO4_Z0_DIR_COMMA, COL_PICKUP_DZO4_Z0_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                    edition_settings.pickup_dzo4_Xo_dir[group] = edit_setpoint(0, edition_settings.pickup_dzo4_Xo_dir[group], 1, 
                                                                         COL_PICKUP_DZO4_X0_DIR_COMMA, COL_PICKUP_DZO4_X0_DIR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                    edition_settings.pickup_dzo4_Zo_inv[group] = edit_setpoint(0, edition_settings.pickup_dzo4_Zo_inv[group], 1, 
                                                                         COL_PICKUP_DZO4_Z0_INV_COMMA, COL_PICKUP_DZO4_Z0_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                    edition_settings.pickup_dzo4_Xo_inv[group] = edit_setpoint(0, edition_settings.pickup_dzo4_Xo_inv[group], 1, 
                                                                         COL_PICKUP_DZO4_X0_INV_COMMA, COL_PICKUP_DZO4_X0_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                    edition_settings.pickup_dzo4_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzo4_amtz[group], 1, 
                                                                      COL_PICKUP_DZO4_AMTZ_COMMA, COL_PICKUP_DZO4_AMTZ_END, 10);
/* if (current_ekran.index_position == INDEX_ML_STP_K_DZ)
                    edition_settings.pickup_dz_k[group] =
                      edit_setpoint(0, edition_settings.pickup_dz_k[group], 1, COL_PICKUP_DZ_K_COMMA, COL_PICKUP_DZ_K_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1)
                    edition_settings.pickup_dz1[group] =
                      edit_setpoint(0, edition_settings.pickup_dz1[group], 1, COL_PICKUP_DZ1_COMMA, COL_PICKUP_DZ1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ1_AMTZ)
                    edition_settings.pickup_dz1_amtz[group] =
                      edit_setpoint(0, edition_settings.pickup_dz1_amtz[group], 1, COL_PICKUP_DZ1_AMTZ_COMMA, COL_PICKUP_DZ1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_ANGLE)
                    edition_settings.pickup_dz2_angle[group] = edit_setpoint_signed(0, edition_settings.pickup_dz2_angle[group], 
                                                                         COL_SDZ2_ANGLE, COL_PICKUP_DZ2_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_DIR)
                    edition_settings.pickup_dz2_dir[group] =
                      edit_setpoint(0, edition_settings.pickup_dz2_dir[group], 1, COL_PICKUP_DZ2_DIR_COMMA, COL_PICKUP_DZ2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_INV)
                    edition_settings.pickup_dz2_inv[group] =
                      edit_setpoint(0, edition_settings.pickup_dz2_inv[group], 1, COL_PICKUP_DZ2_INV_COMMA, COL_PICKUP_DZ2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ2_AMTZ)
                    edition_settings.pickup_dz2_amtz[group] =
                      edit_setpoint(0, edition_settings.pickup_dz2_amtz[group], 1, COL_PICKUP_DZ2_AMTZ_COMMA, COL_PICKUP_DZ2_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_ANGLE)
                    edition_settings.pickup_dz3_angle[group] = edit_setpoint_signed(0, edition_settings.pickup_dz3_angle[group], 
                                                                         COL_SDZ3_ANGLE, COL_PICKUP_DZ3_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_DIR)
                    edition_settings.pickup_dz3_dir[group] =
                      edit_setpoint(0, edition_settings.pickup_dz3_dir[group], 1, COL_PICKUP_DZ3_DIR_COMMA, COL_PICKUP_DZ3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_INV)
                    edition_settings.pickup_dz3_inv[group] =
                      edit_setpoint(0, edition_settings.pickup_dz3_inv[group], 1, COL_PICKUP_DZ3_INV_COMMA, COL_PICKUP_DZ3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ3_AMTZ)
                    edition_settings.pickup_dz3_amtz[group] =
                      edit_setpoint(0, edition_settings.pickup_dz3_amtz[group], 1, COL_PICKUP_DZ3_AMTZ_COMMA, COL_PICKUP_DZ3_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_ANGLE)
                    edition_settings.pickup_dz4_angle[group] = edit_setpoint_signed(0, edition_settings.pickup_dz4_angle[group], 
                                                                         COL_SDZ4_ANGLE, COL_PICKUP_DZ4_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_DIR)
                    edition_settings.pickup_dz4_dir[group] =
                      edit_setpoint(0, edition_settings.pickup_dz4_dir[group], 1, COL_PICKUP_DZ4_DIR_COMMA, COL_PICKUP_DZ4_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_INV)
                    edition_settings.pickup_dz4_inv[group] =
                      edit_setpoint(0, edition_settings.pickup_dz4_inv[group], 1, COL_PICKUP_DZ4_INV_COMMA, COL_PICKUP_DZ4_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZ4_AMTZ)
                    edition_settings.pickup_dz4_amtz[group] =
                      edit_setpoint(0, edition_settings.pickup_dz4_amtz[group], 1, COL_PICKUP_DZ4_AMTZ_COMMA, COL_PICKUP_DZ4_AMTZ_END, 10);
*/
                }
                //Формуємо екран уставок ДЗ
                make_ekran_setpoint_dzo(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_DZO) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  /*if (current_ekran.index_position == INDEX_ML_TMO_DZ1)
                    edition_settings.timeout_dz1[group] =
                      edit_setpoint(0, edition_settings.timeout_dz1[group], 1, COL_TMO_DZ1_COMMA, COL_TMO_DZ1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                    edition_settings.timeout_dz1_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dz1_amtz[group], 1, COL_TMO_DZ1_AMTZ_COMMA, COL_TMO_DZ1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                    edition_settings.timeout_dz2_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_dir[group], 1, COL_TMO_DZ2_DIR_COMMA, COL_TMO_DZ2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                    edition_settings.timeout_dz2_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_dir_pr[group], 1, COL_TMO_DZ2_DIR_PR_COMMA, COL_TMO_DZ2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                    edition_settings.timeout_dz2_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_inv[group], 1, COL_TMO_DZ2_INV_COMMA, COL_TMO_DZ2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                    edition_settings.timeout_dz2_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_inv_pr[group], 1, COL_TMO_DZ2_INV_PR_COMMA, COL_TMO_DZ2_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                    edition_settings.timeout_dz2_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_amtz[group], 1, COL_TMO_DZ2_AMTZ_COMMA, COL_TMO_DZ2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                    edition_settings.timeout_dz2_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_amtz_pr[group], 1, COL_TMO_DZ2_AMTZ_PR_COMMA, COL_TMO_DZ2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                    edition_settings.timeout_dz2_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_vvid_pr[group], 1, COL_TMO_DZ2_VVID_PR_COMMA, COL_TMO_DZ2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                    edition_settings.timeout_dz2_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz2_amtz_vvid_pr[group], 1, COL_TMO_DZ2_AMTZ_VVID_PR_COMMA, COL_TMO_DZ2_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                    edition_settings.timeout_dz3_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_dir[group], 1, COL_TMO_DZ3_DIR_COMMA, COL_TMO_DZ3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                    edition_settings.timeout_dz3_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_dir_pr[group], 1, COL_TMO_DZ3_DIR_PR_COMMA, COL_TMO_DZ3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                    edition_settings.timeout_dz3_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_inv[group], 1, COL_TMO_DZ3_INV_COMMA, COL_TMO_DZ3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                    edition_settings.timeout_dz3_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_inv_pr[group], 1, COL_TMO_DZ3_INV_PR_COMMA, COL_TMO_DZ3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                    edition_settings.timeout_dz3_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_amtz[group], 1, COL_TMO_DZ3_AMTZ_COMMA, COL_TMO_DZ3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                    edition_settings.timeout_dz3_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_amtz_pr[group], 1, COL_TMO_DZ3_AMTZ_PR_COMMA, COL_TMO_DZ3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                    edition_settings.timeout_dz3_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_vvid_pr[group], 1, COL_TMO_DZ3_VVID_PR_COMMA, COL_TMO_DZ3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                    edition_settings.timeout_dz3_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz3_amtz_vvid_pr[group], 1, COL_TMO_DZ3_AMTZ_VVID_PR_COMMA, COL_TMO_DZ3_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                    edition_settings.timeout_dz4_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_dir[group], 1, COL_TMO_DZ4_DIR_COMMA, COL_TMO_DZ4_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                    edition_settings.timeout_dz4_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_dir_pr[group], 1, COL_TMO_DZ4_DIR_PR_COMMA, COL_TMO_DZ4_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                    edition_settings.timeout_dz4_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_inv[group], 1, COL_TMO_DZ4_INV_COMMA, COL_TMO_DZ4_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                    edition_settings.timeout_dz4_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_inv_pr[group], 1, COL_TMO_DZ3_INV_PR_COMMA, COL_TMO_DZ4_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                    edition_settings.timeout_dz4_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_amtz[group], 1, COL_TMO_DZ4_AMTZ_COMMA, COL_TMO_DZ4_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                    edition_settings.timeout_dz4_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_amtz_pr[group], 1, COL_TMO_DZ4_AMTZ_PR_COMMA, COL_TMO_DZ4_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                    edition_settings.timeout_dz4_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_vvid_pr[group], 1, COL_TMO_DZ4_VVID_PR_COMMA, COL_TMO_DZ4_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                    edition_settings.timeout_dz4_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dz4_amtz_vvid_pr[group], 1, COL_TMO_DZ4_AMTZ_VVID_PR_COMMA, COL_TMO_DZ4_AMTZ_VVID_PR_END, 10);
*/
/*
  INDEX_ML_TMO_DZ3_DIR,
  INDEX_ML_TMO_DZ3_DIR_PR,
  INDEX_ML_TMO_DZ3_INV,
  INDEX_ML_TMO_DZ3_INV_PR,
  INDEX_ML_TMO_DZ3_AMTZ,
  INDEX_ML_TMO_DZ3_AMTZ_PR,
  INDEX_ML_TMO_DZ3_VVID_PR,
  INDEX_ML_TMO_DZ3_AMTZ_VVID_PR,
  
  INDEX_ML_TMO_DZ4_DIR,
  INDEX_ML_TMO_DZ4_DIR_PR,
  INDEX_ML_TMO_DZ4_INV,
  INDEX_ML_TMO_DZ4_INV_PR,
  INDEX_ML_TMO_DZ4_AMTZ,
  INDEX_ML_TMO_DZ4_AMTZ_PR,
  INDEX_ML_TMO_DZ4_VVID_PR,
  INDEX_ML_TMO_DZ4_AMTZ_VVID_PR,


#define COL_TMO_DZ3_DIR_BEGIN                4
#define COL_TMO_DZ3_DIR_COMMA                6
#define COL_TMO_DZ3_DIR_END                  8

#define COL_TMO_DZ3_DIR_PR_BEGIN             4
#define COL_TMO_DZ3_DIR_PR_COMMA             6
#define COL_TMO_DZ3_DIR_PR_END               8

#define COL_TMO_DZ3_INV_BEGIN                4
#define COL_TMO_DZ3_INV_COMMA                6
#define COL_TMO_DZ3_INV_END                  8

#define COL_TMO_DZ3_INV_PR_BEGIN             4
#define COL_TMO_DZ3_INV_PR_COMMA             6
#define COL_TMO_DZ3_INV_PR_END               8

#define COL_TMO_DZ3_AMTZ_BEGIN               4
#define COL_TMO_DZ3_AMTZ_COMMA               6
#define COL_TMO_DZ3_AMTZ_END                 8

#define COL_TMO_DZ3_AMTZ_PR_BEGIN            4
#define COL_TMO_DZ3_AMTZ_PR_COMMA            6
#define COL_TMO_DZ3_AMTZ_PR_END              8

#define COL_TMO_DZ3_VVID_PR_BEGIN            4
#define COL_TMO_DZ3_VVID_PR_COMMA            6
#define COL_TMO_DZ3_VVID_PR_END              8

#define COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN       4
#define COL_TMO_DZ3_AMTZ_VVID_PR_COMMA       6
#define COL_TMO_DZ3_AMTZ_VVID_PR_END         8

#define COL_TMO_DZ4_DIR_BEGIN                4
#define COL_TMO_DZ4_DIR_COMMA                6
#define COL_TMO_DZ4_DIR_END                  8

#define COL_TMO_DZ4_DIR_PR_BEGIN             4
#define COL_TMO_DZ4_DIR_PR_COMMA             6
#define COL_TMO_DZ4_DIR_PR_END               8

#define COL_TMO_DZ4_INV_BEGIN                4
#define COL_TMO_DZ4_INV_COMMA                6
#define COL_TMO_DZ4_INV_END                  8

#define COL_TMO_DZ4_INV_PR_BEGIN             4
#define COL_TMO_DZ4_INV_PR_COMMA             6
#define COL_TMO_DZ4_INV_PR_END               8

#define COL_TMO_DZ4_AMTZ_BEGIN               4
#define COL_TMO_DZ4_AMTZ_COMMA               6
#define COL_TMO_DZ4_AMTZ_END                 8

#define COL_TMO_DZ4_AMTZ_PR_BEGIN            4
#define COL_TMO_DZ4_AMTZ_PR_COMMA            6
#define COL_TMO_DZ4_AMTZ_PR_END              8

#define COL_TMO_DZ4_VVID_PR_BEGIN            4
#define COL_TMO_DZ4_VVID_PR_COMMA            6
#define COL_TMO_DZ4_VVID_PR_END              8

#define COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN       4
#define COL_TMO_DZ4_AMTZ_VVID_PR_COMMA       6
#define COL_TMO_DZ4_AMTZ_VVID_PR_END         8
*/
                //  else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                //    edition_settings.timeout_nkn_dz[group] =
                //      edit_setpoint(0, edition_settings.timeout_nkn_dz[group], 1, COL_TMO_NKN_DZ_COMMA, COL_TMO_NKN_DZ_END, 10);
                
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMO_DZO1)
                    edition_settings.timeout_dzo1[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo1[group], 1, COL_TMO_DZO1_COMMA, COL_TMO_DZO1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                    edition_settings.timeout_dzo1_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo1_amtz[group], 1, COL_TMO_DZO1_AMTZ_COMMA, COL_TMO_DZO1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                    edition_settings.timeout_dzo2_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_dir[group], 1, COL_TMO_DZO2_DIR_COMMA, COL_TMO_DZO2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                    edition_settings.timeout_dzo2_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_dir_pr[group], 1, COL_TMO_DZO2_DIR_PR_COMMA, COL_TMO_DZO2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                    edition_settings.timeout_dzo2_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_inv[group], 1, COL_TMO_DZO2_INV_COMMA, COL_TMO_DZO2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                    edition_settings.timeout_dzo2_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_inv_pr[group], 1, COL_TMO_DZO2_INV_PR_COMMA, COL_TMO_DZO2_INV_PR_END , 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                    edition_settings.timeout_dzo2_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_amtz[group], 1, COL_TMO_DZO2_AMTZ_COMMA, COL_TMO_DZO2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                    edition_settings.timeout_dzo2_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_amtz_pr[group], 1, COL_TMO_DZO2_AMTZ_PR_COMMA, COL_TMO_DZO2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                    edition_settings.timeout_dzo2_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_vvid_pr[group], 1, COL_TMO_DZO2_VVID_PR_COMMA, COL_TMO_DZO2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                    edition_settings.timeout_dzo2_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo2_amtz_vvid_pr[group], 1, COL_TMO_DZO2_AMTZ_VVID_PR_COMMA, COL_TMO_DZO2_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                    edition_settings.timeout_dzo3_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_dir[group], 1, COL_TMO_DZO3_DIR_COMMA, COL_TMO_DZO3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                    edition_settings.timeout_dzo3_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_dir_pr[group], 1, COL_TMO_DZO3_DIR_PR_COMMA, COL_TMO_DZO3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                    edition_settings.timeout_dzo3_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_inv[group], 1, COL_TMO_DZO3_INV_COMMA, COL_TMO_DZO3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                    edition_settings.timeout_dzo3_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_inv_pr[group], 1, COL_TMO_DZO3_INV_PR_COMMA, COL_TMO_DZO3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                    edition_settings.timeout_dzo3_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_amtz[group], 1, COL_TMO_DZO3_AMTZ_COMMA, COL_TMO_DZO3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                    edition_settings.timeout_dzo3_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_amtz_pr[group], 1, COL_TMO_DZO3_AMTZ_PR_COMMA, COL_TMO_DZO3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                    edition_settings.timeout_dzo3_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_vvid_pr[group], 1, COL_TMO_DZO3_VVID_PR_COMMA, COL_TMO_DZO3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                    edition_settings.timeout_dzo3_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo3_amtz_vvid_pr[group], 1, COL_TMO_DZO3_AMTZ_VVID_PR_COMMA, COL_TMO_DZO3_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                    edition_settings.timeout_dzo4_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo4_dir[group], 1, COL_TMO_DZO4_DIR_COMMA, COL_TMO_DZO4_DIR_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                    edition_settings.timeout_dzo4_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo4_inv[group], 1, COL_TMO_DZO4_INV_COMMA, COL_TMO_DZO4_INV_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                    edition_settings.timeout_dzo4_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzo4_amtz[group], 1, COL_TMO_DZO4_AMTZ_COMMA, COL_TMO_DZO4_AMTZ_END, 10);
                 else if (current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                    edition_settings.timeout_nkn_dzo[group] =
                      edit_setpoint(0, edition_settings.timeout_nkn_dzo[group], 1, COL_TMO_NKN_DZO_COMMA, COL_TMO_NKN_DZO_END, 10);

                }
                //Формуємо екран витримок ДЗ
                make_ekran_timeout_dzo(group);//make_ekran_timeout_dz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
              {
                //!if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZ) current_ekran.index_position = 0;
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZO) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_DZ] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ДЗ
                make_ekran_control_dzo();//make_ekran_control_dz();//1
              }
//------------------#include "ekran/ekran_dz_down.ci"--------------------
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ZDZ) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOZDZ)
                    edition_settings.timeout_zdz[group] = edit_setpoint(0, edition_settings.timeout_zdz[group], 1, COL_TMO_ZDZ_COMMA, COL_TMO_ZDZ_END, 1);
                }
                //Формуємо екран витримок ЗДЗ
                make_ekran_timeout_zdz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
              {
                current_ekran.index_position++;
                
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZDZ) current_ekran.index_position = 0;
                while(
                      (
                       (
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ1_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ2_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ3_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ4_BIT)
                       )   
                       &&
                       ((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                      )
                      ||  
                      (
                       (
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN1_BIT) ||
                        (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN2_BIT)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                      )
                     )
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZDZ) current_ekran.index_position = 0;
                }

                position_in_current_level_menu[EKRAN_CONTROL_ZDZ] = current_ekran.index_position;
                
                //Формуємо екран управлінської інформації для ЗДЗ
                make_ekran_control_zdz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  //if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ZZ) current_ekran.index_position = 0;
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_MTZO) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                
                
                }
                else
                {
                  //Редагування числа

                  //if (current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                  //  edition_settings.setpoint_zz_3I0[group] = edit_setpoint(0, edition_settings.setpoint_zz_3I0[group], 1, COL_SETPOINT_ZZ1_3I0_COMMA, COL_SETPOINT_ZZ1_3I0_END, 1);
                  //else if (current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                  //edition_settings.setpoint_zz_3U0[group] = edit_setpoint(0, edition_settings.setpoint_zz_3U0[group], 1, COL_SETPOINT_ZZ1_3U0_COMMA, COL_SETPOINT_ZZ1_3U0_END, 10);
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZO1)
                    edition_settings.setpoint_mtzo_1[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1[group], 1, COL_SETPOINT_MTZO_1_COMMA, COL_SETPOINT_MTZO_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                    edition_settings.setpoint_mtzo_1_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1_n_vpered[group], 1, COL_SETPOINT_MTZO_1_N_VPERED_COMMA, COL_SETPOINT_MTZO_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                    edition_settings.setpoint_mtzo_1_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1_n_nazad[group], 1, COL_SETPOINT_MTZO_1_N_NAZAD_COMMA, COL_SETPOINT_MTZO_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                    edition_settings.setpoint_mtzo_1_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1_angle[group], 0, 0, COL_SETPOINT_MTZO_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_1_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1_po_napruzi[group], 1, COL_SETPOINT_MTZO_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                    edition_settings.setpoint_mtzo_1_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_1_U[group], 1, COL_SETPOINT_MTZO_1_U_COMMA, COL_SETPOINT_MTZO_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2)
                    edition_settings.setpoint_mtzo_2[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2[group], 1, COL_SETPOINT_MTZO_2_COMMA, COL_SETPOINT_MTZO_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                    edition_settings.setpoint_mtzo_2_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2_n_vpered[group], 1, COL_SETPOINT_MTZO_2_N_VPERED_COMMA, COL_SETPOINT_MTZO_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                    edition_settings.setpoint_mtzo_2_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2_n_nazad[group], 1, COL_SETPOINT_MTZO_2_N_NAZAD_COMMA, COL_SETPOINT_MTZO_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                    edition_settings.setpoint_mtzo_2_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2_angle[group], 0, 0, COL_SETPOINT_MTZO_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_2_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2_po_napruzi[group], 1, COL_SETPOINT_MTZO_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                    edition_settings.setpoint_mtzo_2_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_2_U[group], 1, COL_SETPOINT_MTZO_2_U_COMMA, COL_SETPOINT_MTZO_2_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3)
                    edition_settings.setpoint_mtzo_3[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3[group], 1, COL_SETPOINT_MTZO_3_COMMA, COL_SETPOINT_MTZO_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                    edition_settings.setpoint_mtzo_3_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3_n_vpered[group], 1, COL_SETPOINT_MTZO_3_N_VPERED_COMMA, COL_SETPOINT_MTZO_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                    edition_settings.setpoint_mtzo_3_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3_n_nazad[group], 1, COL_SETPOINT_MTZO_3_N_NAZAD_COMMA, COL_SETPOINT_MTZO_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                    edition_settings.setpoint_mtzo_3_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3_angle[group], 0, 0, COL_SETPOINT_MTZO_3_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_3_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3_po_napruzi[group], 1, COL_SETPOINT_MTZO_3_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                    edition_settings.setpoint_mtzo_3_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_3_U[group], 1, COL_SETPOINT_MTZO_3_U_COMMA, COL_SETPOINT_MTZO_3_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4)
                    edition_settings.setpoint_mtzo_4[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4[group], 1, COL_SETPOINT_MTZO_4_COMMA, COL_SETPOINT_MTZO_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                    edition_settings.setpoint_mtzo_4_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4_n_vpered[group], 1, COL_SETPOINT_MTZO_4_N_VPERED_COMMA, COL_SETPOINT_MTZO_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                    edition_settings.setpoint_mtzo_4_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4_n_nazad[group], 1, COL_SETPOINT_MTZO_4_N_NAZAD_COMMA, COL_SETPOINT_MTZO_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                    edition_settings.setpoint_mtzo_4_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4_angle[group], 0, 0, COL_SETPOINT_MTZO_4_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                    edition_settings.setpoint_mtzo_4_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4_po_napruzi[group], 1, COL_SETPOINT_MTZO_4_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZO_4_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                    edition_settings.setpoint_mtzo_4_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzo_4_U[group], 1, COL_SETPOINT_MTZO_4_U_COMMA, COL_SETPOINT_MTZO_4_U_END, 10);
                
                }
                //Формуємо екран уставок ЗЗ
                make_ekran_setpoint_mtzo(group); //make_ekran_setpoint_zz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_MTZO) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                  
                  
                  
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOMTZO1)
                    edition_settings.timeout_mtzo_1[group] = edit_setpoint(0, edition_settings.timeout_mtzo_1[group], 1, COL_TMO_MTZO_1_COMMA, COL_TMO_MTZO_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                    edition_settings.timeout_mtzo_1_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzo_1_n_vpered[group], 1, COL_TMO_MTZO_1_N_VPERED_COMMA, COL_TMO_MTZO_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                    edition_settings.timeout_mtzo_1_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzo_1_n_nazad[group], 1, COL_TMO_MTZO_1_N_NAZAD_COMMA, COL_TMO_MTZO_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_1_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzo_1_po_napruzi[group], 1, COL_TMO_MTZO_1_PO_NAPRUZI_COMMA, COL_TMO_MTZO_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2)
                    edition_settings.timeout_mtzo_2[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2[group], 1, COL_TMO_MTZO_2_COMMA, COL_TMO_MTZO_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                    edition_settings.timeout_mtzo_2_pr[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_pr[group], 1, COL_TMO_MTZO_2_PR_COMMA, COL_TMO_MTZO_2_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                    edition_settings.timeout_mtzo_2_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_n_vpered[group], 1, COL_TMO_MTZO_2_N_VPERED_COMMA, COL_TMO_MTZO_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                    edition_settings.timeout_mtzo_2_n_vpered_pr[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_n_vpered_pr[group], 1, COL_TMO_MTZO_2_N_VPERED_PR_COMMA, COL_TMO_MTZO_2_N_VPERED_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                    edition_settings.timeout_mtzo_2_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_n_nazad[group], 1, COL_TMO_MTZO_2_N_NAZAD_COMMA, COL_TMO_MTZO_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                    edition_settings.timeout_mtzo_2_n_nazad_pr[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_n_nazad_pr[group], 1, COL_TMO_MTZO_2_N_NAZAD_PR_COMMA, COL_TMO_MTZO_2_N_NAZAD_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_2_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_po_napruzi[group], 1, COL_TMO_MTZO_2_PO_NAPRUZI_COMMA, COL_TMO_MTZO_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                    edition_settings.timeout_mtzo_2_po_napruzi_pr[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_po_napruzi_pr[group], 1, COL_TMO_MTZO_2_PO_NAPRUZI_PR_COMMA, COL_TMO_MTZO_2_PO_NAPRUZI_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                    edition_settings.timeout_mtzo_2_vvid_pr[group] = edit_setpoint(0, edition_settings.timeout_mtzo_2_vvid_pr[group], 1, COL_TMO_MTZO_2_VVID_PR_COMMA, COL_TMO_MTZO_2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3)
                    edition_settings.timeout_mtzo_3[group] = edit_setpoint(0, edition_settings.timeout_mtzo_3[group], 1, COL_TMO_MTZO_3_COMMA, COL_TMO_MTZO_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                    edition_settings.timeout_mtzo_3_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzo_3_n_vpered[group], 1, COL_TMO_MTZO_3_N_VPERED_COMMA, COL_TMO_MTZO_3_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                    edition_settings.timeout_mtzo_3_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzo_3_n_nazad[group], 1, COL_TMO_MTZO_3_N_NAZAD_COMMA, COL_TMO_MTZO_3_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_3_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzo_3_po_napruzi[group], 1, COL_TMO_MTZO_3_PO_NAPRUZI_COMMA, COL_TMO_MTZO_3_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4)
                    edition_settings.timeout_mtzo_4[group] = edit_setpoint(0, edition_settings.timeout_mtzo_4[group], 1, COL_TMO_MTZO_4_COMMA, COL_TMO_MTZO_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                    edition_settings.timeout_mtzo_4_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzo_4_n_vpered[group], 1, COL_TMO_MTZO_4_N_VPERED_COMMA, COL_TMO_MTZO_4_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                    edition_settings.timeout_mtzo_4_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzo_4_n_nazad[group], 1, COL_TMO_MTZO_4_N_NAZAD_COMMA, COL_TMO_MTZO_4_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                    edition_settings.timeout_mtzo_4_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzo_4_po_napruzi[group], 1, COL_TMO_MTZO_4_PO_NAPRUZI_COMMA, COL_TMO_MTZO_4_PO_NAPRUZI_END, 10);
                  
                    
                    
                }
                //Формуємо екран витримок ЗЗ
                make_ekran_timeout_mtzo(group);//make_ekran_timeout_zz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZO) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_ZZ] = current_ekran.index_position;
                
                //Формуємо екран управлінської інформації для ЗЗ
                make_ekran_control_mtzo();//.make_ekran_control_zz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  //if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_TZNP) current_ekran.index_position = 0;
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_MTZR) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  /*
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                    edition_settings.setpoint_tznp_1_3I0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_1_3I0_vpered[group], 1, COL_SETPOINT_TZNP1_3I0_VPERED_COMMA, COL_SETPOINT_TZNP1_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                    edition_settings.setpoint_tznp_1_3U0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_1_3U0_vpered[group], 1, COL_SETPOINT_TZNP1_3U0_VPERED_COMMA, COL_SETPOINT_TZNP1_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                    edition_settings.setpoint_tznp_1_3I0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_1_3I0_nazad[group], 1, COL_SETPOINT_TZNP1_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP1_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                    edition_settings.setpoint_tznp_1_3U0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_1_3U0_nazad[group], 1, COL_SETPOINT_TZNP1_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP1_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                    edition_settings.setpoint_tznp_1_angle[group] = edit_setpoint(0, edition_settings.setpoint_tznp_1_angle[group], 0, 0, COL_SETPOINT_TZNP1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                    edition_settings.setpoint_tznp_2_3I0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_2_3I0_vpered[group], 1, COL_SETPOINT_TZNP2_3I0_VPERED_COMMA, COL_SETPOINT_TZNP2_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                    edition_settings.setpoint_tznp_2_3U0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_2_3U0_vpered[group], 1, COL_SETPOINT_TZNP2_3U0_VPERED_COMMA, COL_SETPOINT_TZNP2_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                    edition_settings.setpoint_tznp_2_3I0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_2_3I0_nazad[group], 1, COL_SETPOINT_TZNP2_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP2_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                    edition_settings.setpoint_tznp_2_3U0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_2_3U0_nazad[group], 1, COL_SETPOINT_TZNP2_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP2_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                    edition_settings.setpoint_tznp_2_angle[group] = edit_setpoint(0, edition_settings.setpoint_tznp_2_angle[group], 0, 0, COL_SETPOINT_TZNP2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                    edition_settings.setpoint_tznp_3_3I0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_3_3I0_vpered[group], 1, COL_SETPOINT_TZNP3_3I0_VPERED_COMMA, COL_SETPOINT_TZNP3_3I0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                    edition_settings.setpoint_tznp_3_3U0_vpered[group] = edit_setpoint(0, edition_settings.setpoint_tznp_3_3U0_vpered[group], 1, COL_SETPOINT_TZNP3_3U0_VPERED_COMMA, COL_SETPOINT_TZNP3_3U0_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                    edition_settings.setpoint_tznp_3_3I0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_3_3I0_nazad[group], 1, COL_SETPOINT_TZNP3_3I0_NAZAD_COMMA, COL_SETPOINT_TZNP3_3I0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                    edition_settings.setpoint_tznp_3_3U0_nazad[group] = edit_setpoint(0, edition_settings.setpoint_tznp_3_3U0_nazad[group], 1, COL_SETPOINT_TZNP3_3U0_NAZAD_COMMA, COL_SETPOINT_TZNP3_3U0_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                    edition_settings.setpoint_tznp_3_angle[group] = edit_setpoint(0, edition_settings.setpoint_tznp_3_angle[group], 0, 0, COL_SETPOINT_TZNP3_ANGLE_END, 1);
                }*/
                //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPMTZR1)
                    edition_settings.setpoint_mtzr_1[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1[group], 1, COL_SETPOINT_MTZR_1_COMMA, COL_SETPOINT_MTZR_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                    edition_settings.setpoint_mtzr_1_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1_n_vpered[group], 1, COL_SETPOINT_MTZR_1_N_VPERED_COMMA, COL_SETPOINT_MTZR_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                    edition_settings.setpoint_mtzr_1_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1_n_nazad[group], 1, COL_SETPOINT_MTZR_1_N_NAZAD_COMMA, COL_SETPOINT_MTZR_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                    edition_settings.setpoint_mtzr_1_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1_angle[group], 0, 0, COL_SETPOINT_MTZR_1_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                    edition_settings.setpoint_mtzr_1_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1_po_napruzi[group], 1, COL_SETPOINT_MTZR_1_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZR_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                    edition_settings.setpoint_mtzr_1_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_1_U[group], 1, COL_SETPOINT_MTZR_1_U_COMMA, COL_SETPOINT_MTZR_1_U_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2)
                    edition_settings.setpoint_mtzr_2[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2[group], 1, COL_SETPOINT_MTZR_2_COMMA, COL_SETPOINT_MTZR_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                    edition_settings.setpoint_mtzr_2_n_vpered[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2_n_vpered[group], 1, COL_SETPOINT_MTZR_2_N_VPERED_COMMA, COL_SETPOINT_MTZR_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                    edition_settings.setpoint_mtzr_2_n_nazad[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2_n_nazad[group], 1, COL_SETPOINT_MTZR_2_N_NAZAD_COMMA, COL_SETPOINT_MTZR_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                    edition_settings.setpoint_mtzr_2_angle[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2_angle[group], 0, 0, COL_SETPOINT_MTZR_2_ANGLE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                    edition_settings.setpoint_mtzr_2_po_napruzi[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2_po_napruzi[group], 1, COL_SETPOINT_MTZR_2_PO_NAPRUZI_COMMA, COL_SETPOINT_MTZR_2_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                    edition_settings.setpoint_mtzr_2_U[group] = edit_setpoint(0, edition_settings.setpoint_mtzr_2_U[group], 1, COL_SETPOINT_MTZR_2_U_COMMA, COL_SETPOINT_MTZR_2_U_END, 10);
                }
                //Формуємо екран уставок ТЗНП
                make_ekran_setpoint_mtzr(group);//make_ekran_setpoint_tznp(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  //if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_TZNP) current_ekran.index_position = 0;
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_MTZR) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //if (current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                  //  edition_settings.timeout_tznp_1_vpered[group] = edit_setpoint(0, edition_settings.timeout_tznp_1_vpered[group], 1, COL_TMO_TZNP1_VPERED_COMMA, COL_TMO_TZNP1_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                  //  edition_settings.timeout_tznp_1_nazad[group] = edit_setpoint(0, edition_settings.timeout_tznp_1_nazad[group], 1, COL_TMO_TZNP1_NAZAD_COMMA, COL_TMO_TZNP1_NAZAD_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                  //  edition_settings.timeout_tznp_2_vpered[group] = edit_setpoint(0, edition_settings.timeout_tznp_2_vpered[group], 1, COL_TMO_TZNP2_VPERED_COMMA, COL_TMO_TZNP2_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                  //  edition_settings.timeout_tznp_2_nazad[group] = edit_setpoint(0, edition_settings.timeout_tznp_2_nazad[group], 1, COL_TMO_TZNP2_NAZAD_COMMA, COL_TMO_TZNP2_NAZAD_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                  //  edition_settings.timeout_tznp_3_vpered[group] = edit_setpoint(0, edition_settings.timeout_tznp_3_vpered[group], 1, COL_TMO_TZNP3_VPERED_COMMA, COL_TMO_TZNP3_VPERED_END, 10);
                  //else if (current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                  //  edition_settings.timeout_tznp_3_nazad[group] = edit_setpoint(0, edition_settings.timeout_tznp_3_nazad[group], 1, COL_TMO_TZNP3_NAZAD_COMMA, COL_TMO_TZNP3_NAZAD_END, 10);
                  
                  if (current_ekran.index_position == INDEX_ML_TMOMTZR1)
                    edition_settings.timeout_mtzr_1[group] = edit_setpoint(0, edition_settings.timeout_mtzr_1[group], 1, COL_TMO_MTZR_1_COMMA, COL_TMO_MTZR_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                    edition_settings.timeout_mtzr_1_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzr_1_n_vpered[group], 1, COL_TMO_MTZR_1_N_VPERED_COMMA, COL_TMO_MTZR_1_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                    edition_settings.timeout_mtzr_1_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzr_1_n_nazad[group], 1, COL_TMO_MTZR_1_N_NAZAD_COMMA, COL_TMO_MTZR_1_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                    edition_settings.timeout_mtzr_1_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzr_1_po_napruzi[group], 1, COL_TMO_MTZR_1_PO_NAPRUZI_COMMA, COL_TMO_MTZR_1_PO_NAPRUZI_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2)
                    edition_settings.timeout_mtzr_2[group] = edit_setpoint(0, edition_settings.timeout_mtzr_2[group], 1, COL_TMO_MTZR_2_COMMA, COL_TMO_MTZR_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                    edition_settings.timeout_mtzr_2_n_vpered[group] = edit_setpoint(0, edition_settings.timeout_mtzr_2_n_vpered[group], 1, COL_TMO_MTZR_2_N_VPERED_COMMA, COL_TMO_MTZR_2_N_VPERED_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                    edition_settings.timeout_mtzr_2_n_nazad[group] = edit_setpoint(0, edition_settings.timeout_mtzr_2_n_nazad[group], 1, COL_TMO_MTZR_2_N_NAZAD_COMMA, COL_TMO_MTZR_2_N_NAZAD_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                    edition_settings.timeout_mtzr_2_po_napruzi[group] = edit_setpoint(0, edition_settings.timeout_mtzr_2_po_napruzi[group], 1, COL_TMO_MTZR_2_PO_NAPRUZI_COMMA, COL_TMO_MTZR_2_PO_NAPRUZI_END, 10);
                 }
                //Формуємо екран витримок ТЗНП
                make_ekran_timeout_mtzr(group);//make_ekran_timeout_tznp(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
              {
                //if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_TZNP) current_ekran.index_position = 0;
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_MTZR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_TZNP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ТЗНП
                make_ekran_control_mtzr();//.make_ekran_control_tznp();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_APV) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOAPV1)
                    edition_settings.timeout_apv_1[group] = edit_setpoint(0, edition_settings.timeout_apv_1[group], 1, COL_TMO_APV_1_COMMA, COL_TMO_APV_1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV2)
                    edition_settings.timeout_apv_2[group] = edit_setpoint(0, edition_settings.timeout_apv_2[group], 1, COL_TMO_APV_2_COMMA, COL_TMO_APV_2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV3)
                    edition_settings.timeout_apv_3[group] = edit_setpoint(0, edition_settings.timeout_apv_3[group], 1, COL_TMO_APV_3_COMMA, COL_TMO_APV_3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV4)
                    edition_settings.timeout_apv_4[group] = edit_setpoint(0, edition_settings.timeout_apv_4[group], 1, COL_TMO_APV_4_COMMA, COL_TMO_APV_4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                    edition_settings.timeout_apv_block_vid_apv1[group] = edit_setpoint(0, edition_settings.timeout_apv_block_vid_apv1[group], 1, COL_TMO_APV_BLOCK_VID_APV1_COMMA, COL_TMO_APV_BLOCK_VID_APV1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                    edition_settings.timeout_apv_block_vid_apv2[group] = edit_setpoint(0, edition_settings.timeout_apv_block_vid_apv2[group], 1, COL_TMO_APV_BLOCK_VID_APV2_COMMA, COL_TMO_APV_BLOCK_VID_APV2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                    edition_settings.timeout_apv_block_vid_apv3[group] = edit_setpoint(0, edition_settings.timeout_apv_block_vid_apv3[group], 1, COL_TMO_APV_BLOCK_VID_APV3_COMMA, COL_TMO_APV_BLOCK_VID_APV3_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                    edition_settings.timeout_apv_block_vid_apv4[group] = edit_setpoint(0, edition_settings.timeout_apv_block_vid_apv4[group], 1, COL_TMO_APV_BLOCK_VID_APV4_COMMA, COL_TMO_APV_BLOCK_VID_APV4_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                    edition_settings.timeout_apv_block_vid_VV[group] = edit_setpoint(0, edition_settings.timeout_apv_block_vid_VV[group], 1, COL_TMO_APV_BLOCK_VID_VV_COMMA, COL_TMO_APV_BLOCK_VID_VV_END, 10);
                }
                //Формуємо екран витримок АПВ
                make_ekran_timeout_apv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_APV)
              {
                current_ekran.index_position++;
                
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_APV) current_ekran.index_position = 0;
                while(
                      (
                       (  
                        (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_DZ1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_AMTDZ4) 
                       )   
                      &&
                      ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                      ) 
                      ||
                      (
                       (  
                        (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_MTZ1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_MTZ4)
                       )   
                      &&
                      //!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                      ((current_settings.configuration & (1<<MCZO_BIT_CONFIGURATION)) == 0)
                      ) 
                      //!||
                      //!(
                      //! (  
                      //!  (current_ekran.index_position >= INDEX_ML_CTRAPV_STARTED_FROM_TZNP1) &&
                      //!  (current_ekran.index_position <= INDEX_ML_CTRAPV_STARTED_FROM_TZNP3)
                      //! )   
                      //!&&
                      //!((current_settings.configuration & (1<<TZNP_BIT_CONFIGURATION)) == 0)
                      //!) 
                      ||  
                      (
                       (current_ekran.index_position == INDEX_ML_CTRAPV_BLK_CTRL_PRVV2)
                       &&
                       ((current_settings.configuration & (1<<UROV_BIT_CONFIGURATION)) == 0)
                      )
                    )
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_APV) current_ekran.index_position = 0;
                }

                position_in_current_level_menu[EKRAN_CONTROL_APV] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для АПВ
                make_ekran_control_apv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ACHR_CHAPV) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                    edition_settings.setpoint_achr_chapv_uf[group] = edit_setpoint(0, edition_settings.setpoint_achr_chapv_uf[group], 1, COL_SETPOINT_ACHR_CHAPV_UF_COMMA, COL_SETPOINT_ACHR_CHAPV_UF_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                    edition_settings.setpoint_achr1_f_rab[group] = edit_setpoint(0, edition_settings.setpoint_achr1_f_rab[group], 1, COL_SETPOINT_ACHR1_F_RAB_COMMA, COL_SETPOINT_ACHR1_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                    edition_settings.setpoint_chapv1_f_rab[group] = edit_setpoint(0, edition_settings.setpoint_chapv1_f_rab[group], 1, COL_SETPOINT_CHAPV1_F_RAB_COMMA, COL_SETPOINT_CHAPV1_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                    edition_settings.setpoint_achr2_f_rab[group] = edit_setpoint(0, edition_settings.setpoint_achr2_f_rab[group], 1, COL_SETPOINT_ACHR2_F_RAB_COMMA, COL_SETPOINT_ACHR2_F_RAB_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                    edition_settings.setpoint_chapv2_f_rab[group] = edit_setpoint(0, edition_settings.setpoint_chapv2_f_rab[group], 1, COL_SETPOINT_CHAPV2_F_RAB_COMMA, COL_SETPOINT_CHAPV2_F_RAB_END, 10);
                }
                //Формуємо екран уставок АЧР-ЧАПВ
                make_ekran_setpoint_achr_chapv(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ACHR_CHAPV) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOACHR1)
                    edition_settings.timeout_achr_1[group] = edit_setpoint(0, edition_settings.timeout_achr_1[group], 1, COL_TMO_ACHR1_COMMA, COL_TMO_ACHR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                    edition_settings.timeout_chapv_1[group] = edit_setpoint(0, edition_settings.timeout_chapv_1[group], 1, COL_TMO_CHAPV1_COMMA, COL_TMO_CHAPV1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOACHR2)
                    edition_settings.timeout_achr_2[group] = edit_setpoint(0, edition_settings.timeout_achr_2[group], 1, COL_TMO_ACHR2_COMMA, COL_TMO_ACHR2_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                    edition_settings.timeout_chapv_2[group] = edit_setpoint(0, edition_settings.timeout_chapv_2[group], 1, COL_TMO_CHAPV2_COMMA, COL_TMO_CHAPV2_END, 10);
                }
                //Формуємо екран витримок АЧР-ЧАПВ
                make_ekran_timeout_achr_chapv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ACHR_CHAPV) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_ACHR_CHAPV] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для АЧР-ЧАПВ
                make_ekran_control_achr_chapv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UROV) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.setpoint_urov[group] = edit_setpoint(0, edition_settings.setpoint_urov[group], 1, COL_SETPOINT_UROV_COMMA, COL_SETPOINT_UROV_END, 10);
                }
                //Формуємо екран уставок УРОВ
                make_ekran_setpoint_urov(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UROV) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUROV1)
                    edition_settings.timeout_urov_1[group] = edit_setpoint(0, edition_settings.timeout_urov_1[group], 1, COL_TMO_UROV_1_COMMA, COL_TMO_UROV_1_END, 10);
                  else
                    edition_settings.timeout_urov_2[group] = edit_setpoint(0, edition_settings.timeout_urov_2[group], 1, COL_TMO_UROV_2_COMMA, COL_TMO_UROV_2_END, 10);
                }
                //Формуємо екран витримок УРОВ
                make_ekran_timeout_urov(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
              {
                current_ekran.index_position++;
                
                if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UROV) current_ekran.index_position = 0;
                while(
                    (
                     (  
                      (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_DZ1) &&
                      (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_AMTDZ4) 
                     )   
                    &&
                    ((current_settings.configuration & (1<<DZ_BIT_CONFIGURATION)) == 0)
                    ) 
                    ||
                      (
                       (  
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ2) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ3) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_MTZ4)
                       )   
                       &&
                       //!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0)
                       ((current_settings.configuration & (1<<MCZO_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (  
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ZDZ)
                       )   
                       &&
                       ((current_settings.configuration & (1<<ZDZ_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMIN2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_UMAX2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UMAX_BIT_CONFIGURATION)) == 0)
                      )  
                      ||
                      (
                       (
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR1) ||
                        (current_ekran.index_position == INDEX_ML_CTRUROV_STARTED_FROM_ACHR2)
                       )   
                       &&
                       ((current_settings.configuration & (1<<ACHR_CHAPV_BIT_CONFIGURATION)) == 0)
                      )
                      ||
                      (
                       (
                        (current_ekran.index_position >= INDEX_ML_CTRUROV_STARTED_FROM_UP1) &&
                        (current_ekran.index_position <= INDEX_ML_CTRUROV_STARTED_FROM_UP1 + NUMBER_UP - 1)
                       )   
                       &&
                       ((current_settings.configuration & (1<<UP_BIT_CONFIGURATION)) == 0)
                      )
                     )
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UROV) current_ekran.index_position = 0;
                }

                position_in_current_level_menu[EKRAN_CONTROL_UROV] = current_ekran.index_position;

                //Формуємо екран управлінської інформації для УРОВ
                make_ekran_control_urov();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  //if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_ZOP) current_ekran.index_position = 0;
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_DZR) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //edition_settings.setpoint_zop[group] = edit_setpoint(0, edition_settings.setpoint_zop[group], 1, COL_SETPOINT_ZOP_COMMA, COL_SETPOINT_ZOP_END, 1);
                  if (current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                    edition_settings.pickup_dzr_Io3g_Io1g[group] = edit_setpoint(0, edition_settings.pickup_dzr_Io3g_Io1g[group], 1, 
                                                                         COL_PICKUP_DZR_K_ICE_COMMA, COL_PICKUP_DZR_K_ICE_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1)
                    edition_settings.pickup_dzr1[group] = edit_setpoint(0, edition_settings.pickup_dzr1[group], 1, 
                                                                         COL_PICKUP_DZR1_COMMA, COL_PICKUP_DZR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                    edition_settings.pickup_dzr1_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzr1_amtz[group], 1, 
                                                                         COL_PICKUP_DZR1_AMTZ_COMMA, COL_PICKUP_DZR1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                    edition_settings.pickup_dzr1_blkI[group] = edit_setpoint(0, edition_settings.pickup_dzr1_blkI[group], 1, 
                                                                         COL_PICKUP_DZR1_I_BLK_COMMA, COL_PICKUP_DZR1_I_BLK_END, 10);
                  
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                    edition_settings.pickup_dzr2_angle[group] = edit_setpoint_signed(0, edition_settings.pickup_dzr2_angle[group], 
                                                                         COL_S_DZR2_ANGLE, COL_PICKUP_DZR2_ANGLE_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                    edition_settings.pickup_dzr2_dir[group] = edit_setpoint(0, edition_settings.pickup_dzr2_dir[group], 1, 
                                                                         COL_PICKUP_DZR2_DIR_COMMA, COL_PICKUP_DZR2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                    edition_settings.pickup_dzr2_inv[group] = edit_setpoint(0, edition_settings.pickup_dzr2_inv[group], 1, 
                                                                         COL_PICKUP_DZR2_INV_COMMA, COL_PICKUP_DZR2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                    edition_settings.pickup_dzr2_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzr2_amtz[group], 1, 
                                                                         COL_PICKUP_DZR2_AMTZ_COMMA, COL_PICKUP_DZR2_AMTZ_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H)
                    edition_settings.pickup_dzr3_angle_h[group] = edit_setpoint_signed(0, edition_settings.pickup_dzr3_angle_h[group], 
                                                                         COL_DZR3_S_ANGLE_H, COL_PICKUP_DZR3_ANGLE_H_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                    edition_settings.pickup_dzr3_angle_l[group] = edit_setpoint_signed(0, edition_settings.pickup_dzr3_angle_l[group], 
                                                                         COL_DZR3_S_ANGLE_L, COL_PICKUP_DZR3_ANGLE_L_END);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                    edition_settings.pickup_dzr3_dir[group] = edit_setpoint(0, edition_settings.pickup_dzr3_dir[group], 1, 
                                                                         COL_PICKUP_DZR3_DIR_COMMA, COL_PICKUP_DZR3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                    edition_settings.pickup_dzr3_inv[group] = edit_setpoint(0, edition_settings.pickup_dzr3_inv[group], 1, 
                                                                         COL_PICKUP_DZR3_INV_COMMA, COL_PICKUP_DZR3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                    edition_settings.pickup_dzr3_amtz[group] = edit_setpoint(0, edition_settings.pickup_dzr3_amtz[group], 1, 
                                                                         COL_PICKUP_DZR3_AMTZ_COMMA, COL_PICKUP_DZR3_AMTZ_END, 10);

                }
                //Формуємо екран уставок ЗТОП
                make_ekran_setpoint_dzr(group);//make_ekran_setpoint_zop(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  //if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ZOP) current_ekran.index_position = 0;
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_DZR) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  //edition_settings.timeout_zop[group] = edit_setpoint(0, edition_settings.timeout_zop[group], 1, COL_TMO_ZOP_COMMA, COL_TMO_ZOP_END, 10);
                  if (current_ekran.index_position == INDEX_ML_TMO_DZR1)
                    edition_settings.timeout_dzr1[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr1[group], 1, COL_TMO_DZR1_COMMA, COL_TMO_DZR1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                    edition_settings.timeout_dzr1_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr1_amtz[group], 1, COL_TMO_DZR1_AMTZ_COMMA, COL_TMO_DZR1_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                    edition_settings.timeout_dzr2_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_dir[group], 1, COL_TMO_DZR2_DIR_COMMA, COL_TMO_DZR2_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                    edition_settings.timeout_dzr2_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_dir_pr[group], 1, COL_TMO_DZR2_DIR_PR_COMMA, COL_TMO_DZR2_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                    edition_settings.timeout_dzr2_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_inv[group], 1, COL_TMO_DZR2_INV_COMMA, COL_TMO_DZR2_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                    edition_settings.timeout_dzr2_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_inv_pr[group], 1, COL_TMO_DZR2_INV_PR_COMMA, COL_TMO_DZR2_INV_PR_END , 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                    edition_settings.timeout_dzr2_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_amtz[group], 1, COL_TMO_DZR2_AMTZ_COMMA, COL_TMO_DZR2_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                    edition_settings.timeout_dzr2_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_amtz_pr[group], 1, COL_TMO_DZR2_AMTZ_PR_COMMA, COL_TMO_DZR2_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                    edition_settings.timeout_dzr2_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_vvid_pr[group], 1, COL_TMO_DZR2_VVID_PR_COMMA, COL_TMO_DZR2_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                    edition_settings.timeout_dzr2_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr2_amtz_vvid_pr[group], 1, COL_TMO_DZR2_AMTZ_VVID_PR_COMMA, COL_TMO_DZR2_AMTZ_VVID_PR_END, 10);

                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                    edition_settings.timeout_dzr3_dir[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_dir[group], 1, COL_TMO_DZR3_DIR_COMMA, COL_TMO_DZR3_DIR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                    edition_settings.timeout_dzr3_dir_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_dir_pr[group], 1, COL_TMO_DZR3_DIR_PR_COMMA, COL_TMO_DZR3_DIR_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                    edition_settings.timeout_dzr3_inv[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_inv[group], 1, COL_TMO_DZR3_INV_COMMA, COL_TMO_DZR3_INV_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                    edition_settings.timeout_dzr3_inv_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_inv_pr[group], 1, COL_TMO_DZR3_INV_PR_COMMA, COL_TMO_DZR3_INV_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                    edition_settings.timeout_dzr3_amtz[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_amtz[group], 1, COL_TMO_DZR3_AMTZ_COMMA, COL_TMO_DZR3_AMTZ_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                    edition_settings.timeout_dzr3_amtz_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_amtz_pr[group], 1, COL_TMO_DZR3_AMTZ_PR_COMMA, COL_TMO_DZR3_AMTZ_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                    edition_settings.timeout_dzr3_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_vvid_pr[group], 1, COL_TMO_DZR3_VVID_PR_COMMA, COL_TMO_DZR3_VVID_PR_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                    edition_settings.timeout_dzr3_amtz_vvid_pr[group] =
                      edit_setpoint(0, edition_settings.timeout_dzr3_amtz_vvid_pr[group], 1, COL_TMO_DZR3_AMTZ_VVID_PR_COMMA, COL_TMO_DZR3_AMTZ_VVID_PR_END, 10);

                }
                //Формуємо екран витримок ЗОП(КОФ)
                make_ekran_timeout_dzr(group);//make_ekran_timeout_zop
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
              {
                //if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_ZOP) current_ekran.index_position = 0;
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_DZR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_ZOP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ЗОП(КОФ)
                make_ekran_control_dzr();//make_ekran_control_zop();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UMIN) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPUMIN1)
                    edition_settings.setpoint_Umin1[group] = edit_setpoint(0, edition_settings.setpoint_Umin1[group], 1, COL_SETPOINT_UMIN1_COMMA, COL_SETPOINT_UMIN1_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                    edition_settings.setpoint_Umin1_Iblk[group] = edit_setpoint(0, edition_settings.setpoint_Umin1_Iblk[group], 1, COL_SETPOINT_UMIN1_IBLK_COMMA, COL_SETPOINT_UMIN1_IBLK_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2)
                    edition_settings.setpoint_Umin2[group] = edit_setpoint(0, edition_settings.setpoint_Umin2[group], 1, COL_SETPOINT_UMIN2_COMMA, COL_SETPOINT_UMIN2_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                    edition_settings.setpoint_Umin2_Iblk[group] = edit_setpoint(0, edition_settings.setpoint_Umin2_Iblk[group], 1, COL_SETPOINT_UMIN2_IBLK_COMMA, COL_SETPOINT_UMIN2_IBLK_END, 10);
                }
                //Формуємо екран уставок Umin
                make_ekran_setpoint_Umin(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UMIN) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUMIN1)
                    edition_settings.timeout_Umin1[group] = edit_setpoint(0, edition_settings.timeout_Umin1[group], 1, COL_TMO_UMIN1_COMMA, COL_TMO_UMIN1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUMIN2)
                    edition_settings.timeout_Umin2[group] = edit_setpoint(0, edition_settings.timeout_Umin2[group], 1, COL_TMO_UMIN2_COMMA, COL_TMO_UMIN2_END, 10);
                }
                //Формуємо екран витримок Umin
                make_ekran_timeout_Umin(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UMIN) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_UMIN] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для Umin
                make_ekran_control_Umin();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_UMAX) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPUMAX1)
                    edition_settings.setpoint_Umax1[group] = edit_setpoint(0, edition_settings.setpoint_Umax1[group], 1, COL_SETPOINT_UMAX1_COMMA, COL_SETPOINT_UMAX1_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STPUMAX2)
                    edition_settings.setpoint_Umax2[group] = edit_setpoint(0, edition_settings.setpoint_Umax2[group], 1, COL_SETPOINT_UMAX2_COMMA, COL_SETPOINT_UMAX2_END, 100);
                  else if (current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                    edition_settings.setpoint_kp_Umax[group] = edit_setpoint(0, edition_settings.setpoint_kp_Umax[group], 1, COL_SETPOINT_KP_UMAX_COMMA, COL_SETPOINT_KP_UMAX_END, 1);
                }
                //Формуємо екран уставок Umax
                make_ekran_setpoint_Umax(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_UMAX) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOUMAX1)
                    edition_settings.timeout_Umax1[group] = edit_setpoint(0, edition_settings.timeout_Umax1[group], 1, COL_TMO_UMAX1_COMMA, COL_TMO_UMAX1_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUMAX2)
                    edition_settings.timeout_Umax2[group] = edit_setpoint(0, edition_settings.timeout_Umax2[group], 1, COL_TMO_UMAX2_COMMA, COL_TMO_UMAX2_END, 10);
                }
                //Формуємо екран витримок Umax
                make_ekran_timeout_Umax(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_UMAX) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_UMAX] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для Umax
                make_ekran_control_Umax();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_SETPOINT_UP)) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                  
                  if (_n_index == INDEX_ML_STP_UP)
                  {
                    uint32_t comma = 0, end = 0, min_step = 0;
                    int32_t sign_before = 1, sign_after = 1;
                    switch (current_settings.ctrl_UP_input[_n_UP])
                    {
                    case UP_CTRL_Ia_Ib_Ic:
                    case UP_CTRL_Ia:
                    case UP_CTRL_Ib:
                    case UP_CTRL_Ic:
                    case UP_CTRL_I1:
                    case UP_CTRL_I2:
                    case UP_CTRL_3I0_r:
                      {
                        comma = COL_SETPOINT_UP_I_COMMA;
                        end = COL_SETPOINT_UP_I_END;
                        min_step = 10;
                        break;
                      }
                    case UP_CTRL_3I0:
                    case UP_CTRL_3I0_others:
                      {
                        comma = COL_SETPOINT_UP_3I0_COMMA;
                        end = COL_SETPOINT_UP_3I0_END;
                        min_step = 1;
                        break;
                      }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                      {
                        comma = COL_SETPOINT_UP_U_COMMA;
                        end = COL_SETPOINT_UP_U_END;
                        min_step = 100;
                        break;
                      }
                    case UP_CTRL_P:
                    case UP_CTRL_Q:
                      {
                        if (edition_settings.setpoint_UP[_n_UP][0][group] < 0) sign_before = -1;
                        if (current_ekran.position_cursor_x == (COL_SETPOINT_UP_PQ_BEGIN - 1))
                        {
                          sign_after = -sign_before;
                        }
                        else
                        {
                          sign_after = sign_before;
                          comma = COL_SETPOINT_UP_PQ_COMMA;
                          end = COL_SETPOINT_UP_PQ_END;
                          min_step = 1;
                        }
                        break;
                      }
                    case UP_CTRL_S:
                      {
                        comma = COL_SETPOINT_UP_S_COMMA;
                        end = COL_SETPOINT_UP_S_END;
                        min_step = 1;
                        break;
                      }
                    default:
                      {
                        //Теоретично цього ніколи не мало б бути
                        total_error_sw_fixed();
                      }
                    }
                    
                    if (sign_before == sign_after)
                      edition_settings.setpoint_UP[_n_UP][0][group] = sign_after*edit_setpoint(0, abs(edition_settings.setpoint_UP[_n_UP][0][group]), 1, comma, end, min_step);
                    else
                      edition_settings.setpoint_UP[_n_UP][0][group] = sign_after*abs(edition_settings.setpoint_UP[_n_UP][0][group]);
                  }
                  else if (_n_index == INDEX_ML_STP_UP_KP)
                    edition_settings.setpoint_UP_KP[_n_UP][0][group] = edit_setpoint(0, edition_settings.setpoint_UP_KP[_n_UP][0][group], 1, COL_SETPOINT_UP_KP_COMMA, COL_SETPOINT_UP_KP_END, 1);
                }
                //Формуємо екран уставок УЗ
                make_ekran_setpoint_UP_A01(group);//!make_ekran_setpoint_UP(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                     )   
              {
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);

                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_TIMEOUT_UP)) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_TIMEOUT_UP;
                  uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;

                  if (_n_index == INDEX_ML_TMOUP)
                    edition_settings.timeout_UP[_n_UP][0][group] = edit_setpoint(0, edition_settings.timeout_UP[_n_UP][0][group], 1, COL_TMO_UP_COMMA, COL_TMO_UP_END, 10);
                }
                //Формуємо екран витримок УЗ
                make_ekran_timeout_UP(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UP)
              {
                current_ekran.index_position++;
                //!if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_UP)) current_ekran.index_position = 0;
				//!
                //!__SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                //!uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
                //!while (
                //!       ((current_ekran.index_position % (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)) == CTR_UP_OR_AND_BIT) &&
                //!       (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
                //!       (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
                //!       (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
                //!      )
                //!{
                //!  current_ekran.index_position++;
                //!  if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_UP)) current_ekran.index_position = 0;
                //!
                //!  ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I)];
                //!}
              
                //!position_in_current_level_menu[EKRAN_CONTROL_UP] = current_ekran.index_position;
              
                if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_A01_UP)) current_ekran.index_position = 0;

                __SETTINGS *point = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                uint32_t ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
                while (
                       ((current_ekran.index_position % (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)) == (CTR_UP_OR_AND_BIT+3)) &&
                       (ctrl_UP_input != UP_CTRL_Ia_Ib_Ic) &&
                       (ctrl_UP_input != UP_CTRL_Ua_Ub_Uc) &&
                       (ctrl_UP_input != UP_CTRL_Uab_Ubc_Uca)
                      )
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= (NUMBER_UP*MAX_ROW_FOR_CONTROL_A01_UP)) current_ekran.index_position = 0;
                
                  ctrl_UP_input = point->ctrl_UP_input[current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I)];
                }
              
                position_in_current_level_menu[EKRAN_CONTROL_UP] = current_ekran.index_position;
              
                //Формуємо екран управлінської інформації для УЗ
                make_ekran_control_UP_A01();//!make_ekran_control_UP();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TRANSFORMATOR_INFO_SETPOINT) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_SETPOINT] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_T_BP)
                    edition_settings.Tbp = edit_setpoint(0, edition_settings.Tbp, 0, 0, COL_T_BP_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_T_MN)
                    edition_settings.Tmn = edit_setpoint(0, edition_settings.Tmn, 0, 0, COL_T_MN_END, 1);
                  else
                    edition_settings.TVoltage = edit_setpoint(0, edition_settings.TVoltage, 0, 0, COL_TN_END, 1);
                }
                //Формуємо екран інфтрмації по трансформаторах
                make_ekran_transformator();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_TRANSFORMATOR_INFO_CONTROL) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TRANSFORMATOR_INFO_CONTROL] = current_ekran.index_position;
                //Формуємо екран відображення налаштувань меню "Трансформатор"
                //!make_ekran_transformator_control();
              }
              else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_SETPOINT_SWITCH) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_SETPOINT_SWITCH] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_STPInom)
                    edition_settings.setpoint_Inom = edit_setpoint(0, edition_settings.setpoint_Inom, 0, 0, COL_SETPOINT_Inom_END, 1);
                  if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                    edition_settings.setpoint_r_kom_st_Inom = edit_setpoint(0, edition_settings.setpoint_r_kom_st_Inom, 0, 0, COL_SETPOINT_RKS_Inom_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                    edition_settings.setpoint_Inom_vymk = edit_setpoint(0, edition_settings.setpoint_Inom_vymk, 1, COL_SETPOINT_Inom_vymk_COMMA, COL_SETPOINT_Inom_vymk_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                    edition_settings.setpoint_r_kom_st_Inom_vymk = edit_setpoint(0, edition_settings.setpoint_r_kom_st_Inom_vymk, 0, 0, COL_SETPOINT_RKS_Inom_vymk_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                    edition_settings.setpoint_pochatkovyj_resurs = edit_setpoint(0, edition_settings.setpoint_pochatkovyj_resurs, 0, 0, COL_SETPOINT_POCHATKOVYJ_RESURS_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                    edition_settings.setpoint_krytychnyj_resurs = edit_setpoint(0, edition_settings.setpoint_krytychnyj_resurs, 0, 0, COL_SETPOINT_KRYTYCHNYJ_RESURS_END, 1);
                  else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                    edition_settings.setpoint_pochatkova_k_vymk = edit_setpoint(0, edition_settings.setpoint_pochatkova_k_vymk, 0, 0, COL_SETPOINT_POCHATKOVA_K_VYMK_END, 1);
                }
                //Формуємо екран уставок виключателя
                make_ekran_setpoint_switch();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_SWITCH) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_TIMEOUT_SWITCH] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                    edition_settings.timeout_swch_on = edit_setpoint(0, edition_settings.timeout_swch_on, 1, COL_TMO_SWCH_ON_COMMA, COL_TMO_SWCH_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                    edition_settings.timeout_swch_off = edit_setpoint(0, edition_settings.timeout_swch_off, 1, COL_TMO_SWCH_OFF_COMMA, COL_TMO_SWCH_OFF_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                    edition_settings.timeout_swch_udl_blk_on = edit_setpoint(0, edition_settings.timeout_swch_udl_blk_on, 1, COL_TMO_SWCH_UDL_BLK_ON_COMMA, COL_TMO_SWCH_UDL_BLK_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                    edition_settings.timeout_pryvoda_VV = edit_setpoint(0, edition_settings.timeout_pryvoda_VV, 1, COL_TMO_PRYVODA_VV_COMMA, COL_TMO_PRYVODA_VV_END, 10);
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_SWITCH) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_SWITCH] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для вимикача
                make_ekran_control_switch();
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                uint32_t on_off = current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H;
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_SWITCH) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOON)
                    edition_settings.timeout_swch_on_[on_off] = edit_setpoint(0, edition_settings.timeout_swch_on_[on_off], 1, COL_TMO_SWCH_ON_COMMA, COL_TMO_SWCH_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                    edition_settings.timeout_swch_off_[on_off] = edit_setpoint(0, edition_settings.timeout_swch_off_[on_off], 1, COL_TMO_SWCH_OFF_COMMA, COL_TMO_SWCH_OFF_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                    edition_settings.timeout_swch_udl_blk_on_[on_off] = edit_setpoint(0, edition_settings.timeout_swch_udl_blk_on_[on_off], 1, COL_TMO_SWCH_UDL_BLK_ON_COMMA, COL_TMO_SWCH_UDL_BLK_ON_END, 10);
                  else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                    edition_settings.timeout_pryvoda_VV_[on_off] = edit_setpoint(0, edition_settings.timeout_pryvoda_VV_[on_off], 1, COL_TMO_PRYVODA_VV_COMMA, COL_TMO_PRYVODA_VV_END, 10);
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch_(on_off);
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_SWITCH) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для вимикача
                make_ekran_control_switch_(current_ekran.current_level - EKRAN_CONTROL_SWITCH_H);
              }
              else if(
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                     )
              {
                int forward_backward = current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD;
                if (current_ekran.edition == 0) 
                {
                  int lines = current_settings.lines[forward_backward];
                  if(++current_ekran.index_position >= (1 + 2*lines)) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else 
                {
                  if (current_ekran.index_position == INDEX_ML_LINES)
                  {
                    edition_settings.lines[forward_backward] = edit_setpoint(0, edition_settings.lines[forward_backward], 0, 0, COL_SETPOINT_LINES_END, 1);
                  }
                  else
                  {
                    int _tmp = current_ekran.index_position - 1;
                    int dilanka = _tmp >> 1;
                    if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                    {
                      edition_settings.dovgyna[forward_backward][dilanka] = edit_setpoint(0, edition_settings.dovgyna[forward_backward][dilanka], 1, COL_SETPOINT_DOVGYNA_COMMA, COL_SETPOINT_DOVGYNA_END, 1);
                    }
                    else
                    {
                      edition_settings.opir[forward_backward][dilanka] = edit_setpoint(0, edition_settings.opir[forward_backward][dilanka], 1, COL_SETPOINT_OPIR_COMMA, COL_SETPOINT_OPIR_END, 1);
                    }
                  }
                }
                //Формуємо екран уставок для ВМП
                make_ekran_setpoint_VMP(forward_backward);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_VMP) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_VMP] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для ВМП
                make_ekran_control_VMP();
              }
              else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_DOPUSK_DV_UVV] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.dopusk_dv[current_ekran.index_position] = 
                    edit_setpoint(0, edition_settings.dopusk_dv[current_ekran.index_position], 0, 0, COL_DOPUSK_DV_END, 1);
                }
                //Формуємо екран інфтрмації по допусках ДВ
                make_ekran_dopusk_dv();
              }
              else if((current_ekran.current_level == EKRAN_TYPE_INPUT_UVV) || (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV))
              {
                if(++current_ekran.index_position >= NUMBER_INPUTS) current_ekran.index_position = 0;
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                //Формуємо екран управлінської інформації для УВВ
                if (current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                  make_ekran_type_input_uvv(0);
                else
                  make_ekran_type_input_uvv(1);
              }
              else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
              {
                if(++current_ekran.index_position >= NUMBER_SIMPLE_OUTPUTS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TYPE_OUTPUT_UVV] = current_ekran.index_position;
                //Формуємо екран типу виходів
                make_ekran_type_output_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_LED_UVV)
              {
                if(++current_ekran.index_position >= NUMBER_LEDS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TYPE_LED_UVV] = current_ekran.index_position;
                //Формуємо екран типу світлоіндикаторів
                make_ekran_type_led_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
              {
                if(++current_ekran.index_position >= NUMBER_DEFINED_BUTTONS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TYPE_BUTTON_UVV] = current_ekran.index_position;
                //Формуємо екран типу ФК
                make_ekran_type_button_uvv();
              }
              else if(current_ekran.current_level == EKRAN_ADDRESS)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_ADDRESS) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_ADDRESS] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.address = edit_setpoint(0, edition_settings.address, 0, 0, COL_ADDRESS_END, 1);
                }
                //Формуємо екран інфтрмації по комунікаційній адресі
                make_ekran_address();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_SPEED_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_SPEED_INTERFACE) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_SPEED_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.speed_RS485++;
                  if (edition_settings.speed_RS485 > VALUE_SPEED_INTERFACE_MAX)
                    edition_settings.speed_RS485 = VALUE_SPEED_INTERFACE_MIN;
                }
                //Формуємо екран інформації по швидкості обміну
                make_ekran_speed_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_PARE_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_PARE_INTERFACE) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_PARE_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.pare_bit_RS485++;
                  if (edition_settings.pare_bit_RS485 > VALUE_PARE_INTERFACE_MAX)
                    edition_settings.pare_bit_RS485 = VALUE_PARE_INTERFACE_MIN;
                }
                //Формуємо екран інформації по контролю парності
                make_ekran_pare_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_STOP_BITS_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_STOP_BITS_INTERFACE) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_STOP_BITS_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.number_stop_bit_RS485++;
                  if (edition_settings.number_stop_bit_RS485 > VALUE_STOP_BITS_INTERFACE_MAX)
                    edition_settings.number_stop_bit_RS485 = VALUE_STOP_BITS_INTERFACE_MIN;
                }
                //Формуємо екран інформації по кількості стопових біт
                make_ekran_stopbits_interface();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_TIMEOUT_INTERFACE) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_TIMEOUT_RS485] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.time_out_1_RS485 = edit_setpoint(0, edition_settings.time_out_1_RS485, 1, COL_TIMEOUT_INTERFACE_COMMA, COL_TIMEOUT_INTERFACE_END, 1);
                }
                //Формуємо екран інформації по time-out наступного символу
                make_ekran_timeout_interface();
              }
              else if(current_ekran.current_level == EKRAN_TIME_ZONE)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEZONE_SETTINGS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_TIME_ZONE] = current_ekran.index_position;
                //Формуємо екран
                make_ekran_timezone_dst();
              }
              else if(current_ekran.current_level == EKRAN_DST_RULE)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_DST_RULE) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_DST_RULE] = current_ekran.index_position;
              
                __SETTINGS *p_settings = (current_ekran.edition == 0) ? &current_settings : &edition_settings;
                uint32_t rule = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? p_settings->dst_on_rule : p_settings->dst_off_rule;
                //Формуємо екран
                make_ekran_dst_rule(rule);
              }
              else if (current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_GENERAL_PICKUPS_EL) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_GENERAL_PICKUPS_EL] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                  {
                    edition_settings.number_iteration_el = edit_setpoint(0, edition_settings.number_iteration_el, 0, 0, COL_NUMBER_INERATION_END, 1);
                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                  {
//                    edition_settings.number_defined_df = edit_setpoint(0, edition_settings.number_defined_df, 0, 0, COL_NUMBER_DEFINED_FUNCTIONS_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                  {
//                    edition_settings.number_defined_dt = edit_setpoint(0, edition_settings.number_defined_dt, 0, 0, COL_NUMBER_DEFINED_TRIGGERS_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                  {
//                    edition_settings.number_defined_and = edit_setpoint(0, edition_settings.number_defined_and, 0, 0, COL_NUMBER_DEFINED_AND_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                  {
//                    edition_settings.number_defined_or = edit_setpoint(0, edition_settings.number_defined_or, 0, 0, COL_NUMBER_DEFINED_OR_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                  {
//                    edition_settings.number_defined_xor = edit_setpoint(0, edition_settings.number_defined_xor, 0, 0, COL_NUMBER_DEFINED_XOR_END, 1);
//                  }
//                  else if (current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                  {
//                    edition_settings.number_defined_not = edit_setpoint(0, edition_settings.number_defined_not, 0, 0, COL_NUMBER_DEFINED_NOT_END, 1);
//                  }
                }
                //Формуємо екран відображення загальних витримок для розширеної логіки
                make_ekran_general_pickups_el();
              }
              else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_TYPE_DF) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_LIST_TYPE_DF] = current_ekran.index_position;
                //Формуємо екран відображення типу опреділювальної функції
                make_ekran_type_df();
              }
              else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_TIMEOUT_DF) current_ekran.index_position = 0;
                  position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                    edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      edit_setpoint(0, edition_settings.timeout_pause_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], 1, COL_TMO_DF_PAUSE_COMMA, COL_TMO_DF_PAUSE_END, 10);
                  else
                    edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1] = 
                      edit_setpoint(0, edition_settings.timeout_work_df[current_ekran.current_level - EKRAN_TIMEOUT_DF1], 1, COL_TMO_DF_WORK_COMMA, COL_TMO_DF_WORK_END, 10);
                }
                //Формуємо екран таймерів опреділюваних функцій
                make_ekran_timeout_df(current_ekran.current_level - EKRAN_TIMEOUT_DF1);
              }
              else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
              {
                if(++current_ekran.index_position >= MAX_ROW_LIST_SOURCE_TF) current_ekran.index_position = 0;
                //Формуємо екран
                make_ekran_list_source_tf();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_DIGITAL_REGISTRATOR) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_TIMEOUT_DIGITAL_REGISTRATOR] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  
                  //{
                  //  unsigned int temp_setpoint = edition_settings.postfault_number_periods*20;
                  //  do
                  //  {
                  //    //Величину витримки зменшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                  //    temp_setpoint = edit_setpoint(0, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                  //  }
                  //  while ((temp_setpoint % 20) != 0);
                  //  edition_settings.postfault_number_periods = temp_setpoint / 20;
                  //}
				  edition_settings.timeout_prolongation_work_digital_registrator = 
                      edit_setpoint(0, edition_settings.timeout_prolongation_work_digital_registrator, 1, COL_TMO_ELONGATION_COMMA, COL_TMO_ELONGATION_END, 10);
                    
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_digital_registrator();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_TIMEOUT_ANALOG_REGISTRATOR) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_TIMEOUT_ANALOG_REGISTRATOR] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  if (current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                  {
                    unsigned int temp_setpoint = edition_settings.prefault_number_periods*20;
                    do
                    {
                      //Величину витримки зменшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                      temp_setpoint = edit_setpoint(0, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                    }
                    while ((temp_setpoint % 20) != 0);
                    edition_settings.prefault_number_periods = temp_setpoint / 20;
                  }
                  else
                  {
                    unsigned int temp_setpoint = edition_settings.postfault_number_periods*20;
                    do
                    {
                      //Величину витримки зменшуємо почергого на 10 мс (ф-ція edit_setpoint збільшує/зменшує з крогом кратних 1, 10 і т.д.), щоб отримати крок 20 мс
                      temp_setpoint = edit_setpoint(0, temp_setpoint, 1, COL_TMO_PREFAULT_COMMA, COL_TMO_PREFAULT_END, 10);
                    }
                    while ((temp_setpoint % 20) != 0);
                    edition_settings.postfault_number_periods = temp_setpoint / 20;
                  }
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_analog_registrator();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_AR)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CONTROL_AR) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CONTROL_AR] = current_ekran.index_position;
                //Формуємо екран відображення
                make_ekran_control_ar();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_SETTING_LANGUAGE) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_SETTING_LANGUAGE] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.language++;
                  if (edition_settings.language > VALUE_SETTING_LANGUAGE_MAX)
                    edition_settings.language = VALUE_SETTING_LANGUAGE_MIN;
                }
                //Формуємо екран інформації по мові меню
                make_ekran_setting_language();
              }
              else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
              {
                if(++current_ekran.index_position >= MAX_ROW_FOR_CHOSE_EXTRA_SETTINGS) current_ekran.index_position = 0;
                position_in_current_level_menu[EKRAN_CHOSE_EXTRA_SETTINGS] = current_ekran.index_position;
                //Формуємо екран відображення додаткових налаштувань
                make_ekran_chose_extra_settings();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_GRUPA_USTAVOK)
              {
                if(current_ekran.edition == 0)
                {
                  if(++current_ekran.index_position >= MAX_ROW_FOR_VIEW_GRUPA_USTAVOK) current_ekran.index_position = 0;
                  position_in_current_level_menu[EKRAN_VIEW_GRUPA_USTAVOK] = current_ekran.index_position;
                }
                else
                {
                  //Редагування числа
                  edition_settings.grupa_ustavok++;
                  if (edition_settings.grupa_ustavok > SETPOINT_GRUPA_USTAVOK_MAX)
                    edition_settings.grupa_ustavok = SETPOINT_GRUPA_USTAVOK_MIN;
                }
                //Формуємо екран інформації по групах уставок
                make_ekran_grupa_ustavok();
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_RIGHT))
            {
              current_ekran.position_cursor_x++;
              //Перевіряємо, чи ми не вийшли за межі виділені для значення даної уставки, або позицію коми
              if(
                 (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                 (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                )   
              {
                if(current_ekran.index_position == INDEX_ML_STPMTZ1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_U_BEGIN;
                }

                //Формуємо екран уставок МТЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                make_ekran_setpoint_mtz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                     )  
              {
                if(current_ekran.index_position == INDEX_ML_TMOMTZ1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_VPERED_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_VPERED_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_VPERED_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_NAZAD_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_NAZAD_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_NAZAD_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PO_NAPRUZI_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PO_NAPRUZI_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PO_NAPRUZI_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_PO_NAPRUZI_BEGIN;
                }
                
                //Формуємо екран витримок МТЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                make_ekran_timeout_mtz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
              {
                if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_TYPE)
                {
                  if (++edition_settings.type_mtz1 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtz1 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_TYPE)
                {
                  if (++edition_settings.type_mtz2 > TYPE_MTZ_DEPENDENT_RTV_I) edition_settings.type_mtz2 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_TYPE)
                {
                  if (++edition_settings.type_mtz3 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtz3 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_TYPE)
                {
                  if (++edition_settings.type_mtz4 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtz4 = TYPE_MTZ_SIMPLE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZ_1             ) maska = CTR_MTZ_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_VPERED      ) maska = CTR_MTZ_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_NAZAD       ) maska = CTR_MTZ_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2             ) maska = CTR_MTZ_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_VPERED      ) maska = CTR_MTZ_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_NAZAD       ) maska = CTR_MTZ_2_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_PRYSKORENNJA) maska = CTR_MTZ_2_PRYSKORENNJA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_PRYSKORENA  ) maska = CTR_MTZ_2_PRYSKORENA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3             ) maska = CTR_MTZ_3;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_VPERED      ) maska = CTR_MTZ_3_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_NAZAD       ) maska = CTR_MTZ_3_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4             ) maska = CTR_MTZ_4;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_VPERED      ) maska = CTR_MTZ_4_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_NAZAD       ) maska = CTR_MTZ_4_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_NESPR_KIL_NAPR) maska = CTR_MTZ_NESPR_KIL_NAPR;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtz ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗ
                 make_ekran_control_mtz();
              }
//++++++++++++++++#include "ekran/ekran_dz_right.ci"++++++++++++++++++++
              //Натиснута кнопка RIGHT
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO_K_ICE_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO_K_ICE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO_K_ICE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO_K_ICE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_I_BLK_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_I_BLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_I_BLK_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_I_BLK_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZO2_ANGLE_END) current_ekran.position_cursor_x=COL_S_DZO2_ANGLE;
                  else if(current_ekran.position_cursor_x==(COL_S_DZO2_ANGLE+1)) current_ekran.position_cursor_x=COL_PICKUP_DZO2_ANGLE_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_S_DZO2_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_AMTZ_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZO3_ANGLE_H_END) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZO3_ANGLE_L;
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_L;
                  }
                  else if(current_ekran.position_cursor_x == (COL_DZO3_S_ANGLE_H + 1)) current_ekran.position_cursor_x=COL_PICKUP_DZO3_ANGLE_H_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_H) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_ANGLE_H_END))
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_H;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZO3_ANGLE_L_END) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZO3_ANGLE_H;
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_H;
                  }
                  else if(current_ekran.position_cursor_x == (COL_DZO3_S_ANGLE_L + 1)) current_ekran.position_cursor_x=COL_PICKUP_DZO3_ANGLE_L_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_L) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_ANGLE_L_END))
                    current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_L;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_Z0_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_Z0_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_Z0_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_X0_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_X0_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x >COL_PICKUP_DZO4_X0_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_X0_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_Z0_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_Z0_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_Z0_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_X0_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_X0_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_X0_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_AMTZ_BEGIN;
                }
                //Формуємо екран уставок ДЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                make_ekran_setpoint_dzo(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                     )  
              {
                /*if(current_ekran.index_position == INDEX_ML_TMO_DZ1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_VVID_PR_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN;
                }*/

/*
  INDEX_ML_TMO_DZ3_DIR,
  INDEX_ML_TMO_DZ3_DIR_PR,
  INDEX_ML_TMO_DZ3_INV,
  INDEX_ML_TMO_DZ3_INV_PR,
  INDEX_ML_TMO_DZ3_AMTZ,
  INDEX_ML_TMO_DZ3_AMTZ_PR,
  INDEX_ML_TMO_DZ3_VVID_PR,
  INDEX_ML_TMO_DZ3_AMTZ_VVID_PR,

#define COL_TMO_DZ3_DIR_BEGIN                4
#define COL_TMO_DZ3_DIR_COMMA                6
#define COL_TMO_DZ3_DIR_END                  8

#define COL_TMO_DZ3_DIR_PR_BEGIN             5
#define COL_TMO_DZ3_DIR_PR_COMMA             6
#define COL_TMO_DZ3_DIR_PR_END               8

#define COL_TMO_DZ3_INV_BEGIN                4
#define COL_TMO_DZ3_INV_COMMA                6
#define COL_TMO_DZ3_INV_END                  8

#define COL_TMO_DZ3_INV_PR_BEGIN             5
#define COL_TMO_DZ3_INV_PR_COMMA             6
#define COL_TMO_DZ3_INV_PR_END               8

#define COL_TMO_DZ3_AMTZ_BEGIN               4
#define COL_TMO_DZ3_AMTZ_COMMA               6
#define COL_TMO_DZ3_AMTZ_END                 8

#define COL_TMO_DZ3_AMTZ_PR_BEGIN            5
#define COL_TMO_DZ3_AMTZ_PR_COMMA            6
#define COL_TMO_DZ3_AMTZ_PR_END              8

#define COL_TMO_DZ3_VVID_PR_BEGIN            5
#define COL_TMO_DZ3_VVID_PR_COMMA            6
#define COL_TMO_DZ3_VVID_PR_END              8

#define COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN       5
#define COL_TMO_DZ3_AMTZ_VVID_PR_COMMA       6
#define COL_TMO_DZ3_AMTZ_VVID_PR_END         8
*/
                //else if(current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_NKN_DZ_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_TMO_NKN_DZ_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_NKN_DZ_END))
                //    current_ekran.position_cursor_x = COL_TMO_NKN_DZ_BEGIN;
                //}
                   if(current_ekran.index_position == INDEX_ML_TMO_DZO1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_VVID_PR_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_VVID_PR_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_NKN_DZO_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_NKN_DZO_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_NKN_DZO_END))
                    current_ekran.position_cursor_x = COL_TMO_NKN_DZO_BEGIN;
                }
                
                //Формуємо екран витримок ДЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                make_ekran_timeout_dzo(group);//make_ekran_timeout_dz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
              {
                  unsigned int maska = 1<<current_ekran.index_position;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_dzo ^= maska;

                //Формуємо екран управлінської інформації для ДЗ
                 make_ekran_control_dzo();//make_ekran_control_dz();
              }
//----------------#include "ekran/ekran_dz_right.ci"--------------------
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOZDZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ZDZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_ZDZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ZDZ_END))
                    current_ekran.position_cursor_x = COL_TMO_ZDZ_BEGIN;
                }
                //Формуємо екран витримок ЗДЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
                make_ekran_timeout_zdz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
              {
                if (current_ekran.index_position == CTR_ZDZ_CTRL_TYPE)
                {
                  do
                  {
                    if (++edition_settings.ctrl_zdz_type >= _ZDZ_CTRL_NUMBER) edition_settings.ctrl_zdz_type = _ZDZ_CTRL_MIN;
                  }
                  while(
                        (
                         ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0) &&//!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0) &&
                         (
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I      ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_OR_U ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_AND_U)
                         )   
                        )
                        ||  
                        (
                         ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0) &&
                         (
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_U      ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_OR_U ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_AND_U)
                         )   
                        )
                        //!||  
                        //!(
                        //! ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0) &&
                        //! (
                        //!  (edition_settings.ctrl_zdz_type == ZDZ_CTRL_3I0)
                        //! )   
                        //!)
                       ); 
                }
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                else if (current_ekran.index_position == CTR_ZDZ_PORIG)
                {
                  if (++edition_settings.zdz_ovd_porig >= ZDZ_CTRL_PORIG_N) edition_settings.zdz_ovd_porig = 0;
                }
#endif
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if (current_ekran.index_position == CTR_ZDZ_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_STATE_BIT);
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                  else if (current_ekran.index_position == CTR_ZDZ_OVD1_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD1_STATE_BIT);
                  else if (current_ekran.index_position == CTR_ZDZ_OVD2_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD2_STATE_BIT);
                  else if (current_ekran.index_position == CTR_ZDZ_OVD3_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD3_STATE_BIT);
#endif
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ1_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ1_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ2_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ2_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ3_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ3_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ4_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ4_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN1_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_UMIN1_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN2_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_UMIN2_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_zdz ^= maska;
                }

                //Формуємо екран управлінської інформації для ЗДЗ
                make_ekran_control_zdz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                     )   
              {
                //if(current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                //{
                //  if (current_ekran.position_cursor_x == COL_SETPOINT_ZZ1_3I0_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_SETPOINT_ZZ1_3I0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_SETPOINT_ZZ1_3I0_END))
                //    current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3I0_BEGIN;
                //}
                //else if(current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                //{
                //  if (current_ekran.position_cursor_x == COL_SETPOINT_ZZ1_3U0_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_SETPOINT_ZZ1_3U0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_SETPOINT_ZZ1_3U0_END))
                //    current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3U0_BEGIN;
                //}
                if(current_ekran.index_position == INDEX_ML_STPMTZO1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_U_BEGIN;
                }
                //Формуємо екран уставок ЗЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                make_ekran_setpoint_mtzo(group);//make_ekran_setpoint_zz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                     )   
              {
                //if(current_ekran.index_position == INDEX_ML_TMOZZ1_3I0)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_3I0_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_3I0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_3I0_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_3I0_BEGIN;
                //}
                //else if (current_ekran.index_position == INDEX_ML_TMOZZ1_3U0)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_3U0_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_3U0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_3U0_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_3U0_BEGIN;
                //}
                //else if(current_ekran.index_position == INDEX_ML_TMOZZ1_NZZ)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_NZZ_COMMA )current_ekran.position_cursor_x++;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_NZZ_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_NZZ_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_NZZ_BEGIN;
                //}
                 if(current_ekran.index_position == INDEX_ML_TMOMTZO1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_VPERED_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_VPERED_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_VPERED_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_NAZAD_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_NAZAD_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_NAZAD_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PO_NAPRUZI_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PO_NAPRUZI_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PO_NAPRUZI_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_PO_NAPRUZI_BEGIN;
                }
                //Формуємо екран витримок ЗЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                make_ekran_timeout_mtzo(group);//make_ekran_timeout_zz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
              {
                if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_TYPE)
                {
                  if (++edition_settings.type_mtzo1 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtzo1 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_TYPE)
                {
                  if (++edition_settings.type_mtzo2 > TYPE_MTZ_DEPENDENT_RTV_I) edition_settings.type_mtzo2 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_TYPE)
                {
                  if (++edition_settings.type_mtzo3 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtzo3 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_TYPE)
                {
                  if (++edition_settings.type_mtzo4 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtzo4 = TYPE_MTZ_SIMPLE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZO_1             ) maska = CTR_MTZO_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_VPERED      ) maska = CTR_MTZO_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_NAZAD       ) maska = CTR_MTZO_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2             ) maska = CTR_MTZO_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_VPERED      ) maska = CTR_MTZO_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_NAZAD       ) maska = CTR_MTZO_2_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_PRYSKORENNJA) maska = CTR_MTZO_2_PRYSKORENNJA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_PRYSKORENA  ) maska = CTR_MTZO_2_PRYSKORENA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3             ) maska = CTR_MTZO_3;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_VPERED      ) maska = CTR_MTZO_3_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_NAZAD       ) maska = CTR_MTZO_3_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4             ) maska = CTR_MTZO_4;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_VPERED      ) maska = CTR_MTZO_4_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_NAZAD       ) maska = CTR_MTZO_4_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_NESPR_KIL_NAPR) maska = CTR_MTZO_NESPR_KIL_NAPR;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtzo ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗO
                 make_ekran_control_mtzo();
                
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                     )   
              {
                /*if(current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3I0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3U0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3I0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3U0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3I0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3U0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3I0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3U0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3I0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3U0_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3I0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3U0_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_ANGLE_BEGIN;
                }*/
                if(current_ekran.index_position == INDEX_ML_STPMTZR1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_U_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_NAZAD_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_ANGLE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_PO_NAPRUZI_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_U_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_U_BEGIN;
                }
                //Формуємо екран уставок ТЗНП
                int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                make_ekran_setpoint_mtzr(group);//make_ekran_setpoint_tznp(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                     )  
              {
                /*if(current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP1_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP1_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP1_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP1_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP1_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP1_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP2_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP2_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP2_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP2_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP2_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP2_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP3_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP3_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP3_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP3_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP3_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP3_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_NAZAD_BEGIN;
                }*/
                if(current_ekran.index_position == INDEX_ML_TMOMTZR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_PO_NAPRUZI_BEGIN;
                }
                
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_N_VPERED_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_VPERED_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_N_NAZAD_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_NAZAD_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_PO_NAPRUZI_BEGIN;
                }
                //Формуємо екран витримок ТЗНП
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
                make_ekran_timeout_mtzr(group);//make_ekran_timeout_tznp(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
              {
                //unsigned int maska = 0;

                ////Виділяємо, який біт треба міняти
                //if (current_ekran.index_position == INDEX_ML_CTR_TZNP1) maska = CTR_TZNP1;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP1_VPERED) maska = CTR_TZNP1_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP1_NAZAD) maska = CTR_TZNP1_NAZAD;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2) maska = CTR_TZNP2;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2_VPERED) maska = CTR_TZNP2_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2_NAZAD) maska = CTR_TZNP2_NAZAD;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3) maska = CTR_TZNP3;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3_VPERED) maska = CTR_TZNP3_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3_NAZAD) maska = CTR_TZNP3_NAZAD;
                //
                ////Міняємо на протилежний відповідний біт для вибраної позиції
                //edition_settings.control_tznp ^= maska;

                //Формуємо екран управлінської інформації для ТЗНП
                 //make_ekran_control_tznp();
                 if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_TYPE)
                {
                  if (++edition_settings.type_mtzr1 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtzr1 = TYPE_MTZ_SIMPLE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_TYPE)
                {
                  if (++edition_settings.type_mtzr2 > TYPE_MTZ_VOLTAGE) edition_settings.type_mtzr2 = TYPE_MTZ_SIMPLE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZR_1             ) maska = CTR_MTZR_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_VPERED      ) maska = CTR_MTZR_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_NAZAD       ) maska = CTR_MTZR_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2             ) maska = CTR_MTZR_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_VPERED      ) maska = CTR_MTZR_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_NAZAD       ) maska = CTR_MTZR_2_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_NESPR_KIL_NAPR) maska = CTR_MTZR_NESPR_KIL_NAPR;
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtzr ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗ
                 make_ekran_control_mtzr();
                 
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOAPV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_1_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_2_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_3_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_3_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_4_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_4_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV1_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV1_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV2_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV2_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV3_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV3_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV3_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV4_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV4_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV4_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_VV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_VV_BEGIN;
                }
                //Формуємо екран витримок АПВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
                make_ekran_timeout_apv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_APV)
              {
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_apv ^= MASKA_FOR_BIT(current_ekran.index_position);

                //Формуємо екран управлінської інформації для АПВ
                 make_ekran_control_apv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR_CHAPV_UF_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR_CHAPV_UF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR_CHAPV_UF_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR_CHAPV_UF_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR1_F_RAB_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR1_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR1_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR1_F_RAB_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_CHAPV1_F_RAB_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_CHAPV1_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_CHAPV1_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV1_F_RAB_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR2_F_RAB_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR2_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR2_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR2_F_RAB_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_CHAPV2_F_RAB_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_CHAPV2_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_CHAPV2_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV2_F_RAB_BEGIN;
                }

                //Формуємо екран уставок АЧР-ЧАПВ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                make_ekran_setpoint_achr_chapv(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                     )  
              {
                if(current_ekran.index_position == INDEX_ML_TMOACHR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ACHR1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_ACHR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ACHR1_END))
                    current_ekran.position_cursor_x = COL_TMO_ACHR1_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_CHAPV1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_CHAPV1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_CHAPV1_END))
                    current_ekran.position_cursor_x = COL_TMO_CHAPV1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOACHR2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ACHR2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_ACHR2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ACHR2_END))
                    current_ekran.position_cursor_x = COL_TMO_ACHR2_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_CHAPV2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_CHAPV2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_CHAPV2_END))
                    current_ekran.position_cursor_x = COL_TMO_CHAPV2_BEGIN;
                }

                //Формуємо екран витримок АЧР-ЧАПВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
                make_ekran_timeout_achr_chapv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_CHAPV_VID_DV) maska = CTR_CHAPV_VID_DV;
                else if (current_ekran.index_position == INDEX_CTR_ACHR1       ) maska = CTR_ACHR1;
                else if (current_ekran.index_position == INDEX_CTR_CHAPV1      ) maska = CTR_CHAPV1;
                else if (current_ekran.index_position == INDEX_CTR_ACHR2       ) maska = CTR_ACHR2;
                else if (current_ekran.index_position == INDEX_CTR_CHAPV2      ) maska = CTR_CHAPV2;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_achr_chapv ^= maska;

                //Формуємо екран управлінської інформації для АЧР-ЧАПВ
                 make_ekran_control_achr_chapv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                     )   
              {
                if (current_ekran.position_cursor_x == COL_SETPOINT_UROV_COMMA )current_ekran.position_cursor_x++;
                if ((current_ekran.position_cursor_x < COL_SETPOINT_UROV_BEGIN) ||
                    (current_ekran.position_cursor_x > COL_SETPOINT_UROV_END))
                  current_ekran.position_cursor_x = COL_SETPOINT_UROV_BEGIN;

                //Формуємо екран уставок УРОВ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
                make_ekran_setpoint_urov(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOUROV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UROV_1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UROV_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UROV_1_END))
                    current_ekran.position_cursor_x = COL_TMO_UROV_1_BEGIN;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UROV_2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UROV_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UROV_2_END))
                    current_ekran.position_cursor_x = COL_TMO_UROV_2_BEGIN;
                }

                //Формуємо екран витримок УРОВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
                make_ekran_timeout_urov(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
              {
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_urov ^= MASKA64_FOR_BIT(current_ekran.index_position);

                //Формуємо екран управлінської інформації для УРОВ
                 make_ekran_control_urov();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                     )   
              {
                //if (current_ekran.position_cursor_x == COL_SETPOINT_ZOP_COMMA )current_ekran.position_cursor_x++;
                //if ((current_ekran.position_cursor_x < COL_SETPOINT_ZOP_BEGIN) ||
                //    (current_ekran.position_cursor_x > COL_SETPOINT_ZOP_END))
                //  current_ekran.position_cursor_x = COL_SETPOINT_ZOP_BEGIN;
                if(current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR_K_ICE_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR_K_ICE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR_K_ICE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR_K_ICE_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_I_BLK_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_I_BLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_I_BLK_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_I_BLK_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZR2_ANGLE_END) current_ekran.position_cursor_x=COL_S_DZR2_ANGLE;
                  else if(current_ekran.position_cursor_x==(COL_S_DZR2_ANGLE+1)) current_ekran.position_cursor_x=COL_PICKUP_DZR2_ANGLE_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_S_DZR2_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_AMTZ_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZR3_ANGLE_H_END) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZR3_ANGLE_L;
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_L;
                  }
                  else if(current_ekran.position_cursor_x == (COL_DZR3_S_ANGLE_H + 1)) current_ekran.position_cursor_x=COL_PICKUP_DZR3_ANGLE_H_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_H) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_ANGLE_H_END))
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_H;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZR3_ANGLE_L_END) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZR3_ANGLE_H;
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_H;
                  }
                  else if(current_ekran.position_cursor_x == (COL_DZR3_S_ANGLE_L + 1)) current_ekran.position_cursor_x=COL_PICKUP_DZR3_ANGLE_L_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_L) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_ANGLE_L_END))
                    current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_L;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_AMTZ_BEGIN;
                }
                
                //Формуємо екран уставок ЗТОП
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
                make_ekran_setpoint_dzr(group);//make_ekran_setpoint_zop(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                     )   
              {
                //if (current_ekran.position_cursor_x == COL_TMO_ZOP_COMMA )current_ekran.position_cursor_x++;
                //if ((current_ekran.position_cursor_x < COL_TMO_ZOP_BEGIN) ||
                //    (current_ekran.position_cursor_x > COL_TMO_ZOP_END))
                //  current_ekran.position_cursor_x = COL_TMO_ZOP_BEGIN;
                if(current_ekran.index_position == INDEX_ML_TMO_DZR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_VVID_PR_BEGIN;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_VVID_PR_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_VVID_PR_BEGIN;
                }

                //Формуємо екран витримок ЗОП(КОФ)
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
                make_ekran_timeout_dzr(group);//make_ekran_timeout_zop(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
              {
                //unsigned int maska;
          
                //Виділяємо, який біт треба міняти
                //maska = CTR_ZOP_STATE;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                //edition_settings.control_zop ^= maska;
                unsigned int maska = 1<<current_ekran.index_position;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_dzr ^= maska;

                
                //Формуємо екран управлінської інформації для ЗТОП
                 //make_ekran_control_zop();
                 make_ekran_control_dzr();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPUMIN1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN1_IBLK_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN1_IBLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN1_IBLK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_IBLK_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN2_IBLK_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN2_IBLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN2_IBLK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_IBLK_BEGIN;
                }

                //Формуємо екран уставок Umin
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                make_ekran_setpoint_Umin(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                     )  
              {
                if(current_ekran.index_position == INDEX_ML_TMOUMIN1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMIN1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMIN1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMIN1_END))
                    current_ekran.position_cursor_x = COL_TMO_UMIN1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUMIN2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMIN2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMIN2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMIN2_END))
                    current_ekran.position_cursor_x = COL_TMO_UMIN2_BEGIN;
                }

                //Формуємо екран витримок Umin
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                make_ekran_timeout_Umin(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_UMIN1          ) maska = CTR_UMIN1;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMIN1_OR_AND) maska = CTR_PO_UMIN1_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMIN1_UBLK     ) maska = CTR_UMIN1_UBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN1_IBLK     ) maska = CTR_UMIN1_IBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2          ) maska = CTR_UMIN2;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMIN2_OR_AND) maska = CTR_PO_UMIN2_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2_UBLK     ) maska = CTR_UMIN2_UBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2_IBLK     ) maska = CTR_UMIN2_IBLK;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_Umin ^= maska;

                //Формуємо екран управлінської інформації для Umin
                 make_ekran_control_Umin();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPUMAX1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMAX1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMAX1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMAX1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMAX2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMAX2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMAX2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMAX2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX2_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_KP_UMAX_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_KP_UMAX_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_KP_UMAX_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_KP_UMAX_BEGIN;
                }

                //Формуємо екран уставок Umax
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                make_ekran_setpoint_Umax(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                     )  
              {
                if(current_ekran.index_position == INDEX_ML_TMOUMAX1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMAX1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMAX1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMAX1_END))
                    current_ekran.position_cursor_x = COL_TMO_UMAX1_BEGIN;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUMAX2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMAX2_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMAX2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMAX2_END))
                    current_ekran.position_cursor_x = COL_TMO_UMAX2_BEGIN;
                }

                //Формуємо екран витримок Umax
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                make_ekran_timeout_Umax(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_UMAX1          ) maska = CTR_UMAX1;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMAX1_OR_AND) maska = CTR_PO_UMAX1_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMAX2          ) maska = CTR_UMAX2;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMAX2_OR_AND) maska = CTR_PO_UMAX2_OR_AND;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_Umax ^= maska;

                //Формуємо екран управлінської інформації для Umax
                 make_ekran_control_Umax();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                     )   
              {
                uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                
                if(_n_index == INDEX_ML_STP_UP)
                {
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  int32_t begin = 0, comma = 0, end = 0;
                  switch (current_settings.ctrl_UP_input[_n_UP])
                  {
                  case UP_CTRL_Ia_Ib_Ic:
                  case UP_CTRL_Ia:
                  case UP_CTRL_Ib:
                  case UP_CTRL_Ic:
                  case UP_CTRL_I1:
                  case UP_CTRL_I2:
                  case UP_CTRL_3I0_r:
                    {
                      begin = COL_SETPOINT_UP_I_BEGIN;
                      comma = COL_SETPOINT_UP_I_COMMA;
                      end = COL_SETPOINT_UP_I_END;
                      break;
                    }
                  case UP_CTRL_3I0:
                  case UP_CTRL_3I0_others:
                    {
                      begin = COL_SETPOINT_UP_3I0_BEGIN;
                      comma = COL_SETPOINT_UP_3I0_COMMA;
                      end = COL_SETPOINT_UP_3I0_END;
                      break;
                    }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                    {
                      begin = COL_SETPOINT_UP_U_BEGIN;
                      comma = COL_SETPOINT_UP_U_COMMA;
                      end = COL_SETPOINT_UP_U_END;
                      break;
                    }
                  case UP_CTRL_P:
                  case UP_CTRL_Q:
                    {
                      begin = COL_SETPOINT_UP_PQ_BEGIN - 1;
                      comma = COL_SETPOINT_UP_PQ_COMMA;
                      end = COL_SETPOINT_UP_PQ_END;
                      break;
                    }
                  case UP_CTRL_S:
                    {
                      begin = COL_SETPOINT_UP_S_BEGIN;
                      comma = COL_SETPOINT_UP_S_COMMA;
                      end = COL_SETPOINT_UP_S_END;
                      break;
                    }
                  default:
                    {
                      //Теоретично цього ніколи не мало б бути
                      total_error_sw_fixed();
                    }
                  }
                    
                  if (current_ekran.position_cursor_x == comma )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < begin) ||
                      (current_ekran.position_cursor_x > end))
                    current_ekran.position_cursor_x = begin;
                }
                else if(_n_index == INDEX_ML_STP_UP_KP)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UP_KP_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UP_KP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UP_KP_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UP_KP_BEGIN;
                }

                //Формуємо екран уставок УЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                make_ekran_setpoint_UP_A01(group);//!make_ekran_setpoint_UP(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                     )  
              {
                uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;

                if(_n_index == INDEX_ML_TMOUP)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UP_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_UP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UP_END))
                    current_ekran.position_cursor_x = COL_TMO_UP_BEGIN;
                }

                //Формуємо екран витримок УЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
                make_ekran_timeout_UP(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UP)
              {
                //!uint32_t n_UP = current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I);
                //!uint32_t n_index = current_ekran.index_position % (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I);
                //!if (n_index == CTR_UP_CTRL_INPUT)
                //!{
                //!  uint32_t ctrl_maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_STATE_BIT     - (_CTR_UP_PART_II - _CTR_UP_PART_I)) |
                //!                        MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_OR_AND_BIT    - (_CTR_UP_PART_II - _CTR_UP_PART_I)) |
                //!                        MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_MORE_LESS_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));  
                //!  edition_settings.control_UP &= (uint32_t)(~ctrl_maska);
                //!  
                //!  if (++edition_settings.ctrl_UP_input[n_UP] >= _UP_CTRL_NUMBER) edition_settings.ctrl_UP_input[n_UP] = _UP_CTRL_MIN;
                //!}
                //!else
                //!{
                //!  unsigned int maska = 0;
				//!
                //!  //Виділяємо, який біт треба міняти
                //!  if (n_index == CTR_UP_STATE_BIT) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_STATE_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!  else if (n_index == CTR_UP_OR_AND_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_OR_AND_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!  else if (n_index == CTR_UP_MORE_LESS_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_MORE_LESS_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!
                //!  //Міняємо на протилежний відповідний біт для вибраної позиції
                //!  edition_settings.control_UP ^= maska;
                //!}

                uint32_t n_UP = current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I);
                uint32_t n_index = current_ekran.index_position % (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I);
                if (n_index == CTR_UP_CTRL_INPUT)
                {
                  uint32_t ctrl_maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_STATE_BIT     - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I)) |
                                     //!MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_UP_OR_AND_BIT    - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I)) |
                                        MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_MORE_LESS_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));  
                  edition_settings.control_UP &= (uint32_t)(~ctrl_maska);
                  
                  if (++edition_settings.ctrl_UP_input[n_UP] >= _UP_CTRL_A01_NUMBER) edition_settings.ctrl_UP_input[n_UP] = _UP_CTRL_A01_MIN;//!_UP_CTRL_MIN;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if (n_index == CTR_A01_UP_STATE_BIT) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_STATE_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                  //!else if (n_index == CTR_UP_OR_AND_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_UP_OR_AND_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                  else if (n_index == CTR_A01_UP_MORE_LESS_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_MORE_LESS_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_UP ^= maska;
                }


                //Формуємо екран управлінської інформації для УЗ
                make_ekran_control_UP_A01();//!make_ekran_control_UP();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
              {
                if(current_ekran.index_position == INDEX_ML_T_BP)
                {
                  if ((current_ekran.position_cursor_x < COL_T_BP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_T_BP_END))
                    current_ekran.position_cursor_x = COL_T_BP_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_T_MN)
                {
                  if ((current_ekran.position_cursor_x <  COL_T_MN_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_T_MN_END))
                    current_ekran.position_cursor_x =  COL_T_MN_BEGIN;
                }
                else
                {
                  if ((current_ekran.position_cursor_x < COL_TN_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TN_END))
                    current_ekran.position_cursor_x = COL_TN_BEGIN;
                }
                //Формуємо екран відображення інформації по трансформаторах
                make_ekran_transformator();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
              {
                //Виділяємо, який біт треба міняти
                unsigned int maska = (1 << current_ekran.index_position);
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_transformator ^= maska;

                //Формуємо екран відображення налаштувань меню "Трансформатор"
                //!make_ekran_transformator_control();
              }
              else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
              {
                if(current_ekran.index_position == INDEX_ML_STPInom)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_Inom_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_Inom_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_Inom_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_RKS_Inom_BEGIN) ||
                      (current_ekran.position_cursor_x > (COL_SETPOINT_RKS_Inom_END - 1)))
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_Inom_vymk_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_Inom_vymk_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_Inom_vymk_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_Inom_vymk_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_RKS_Inom_vymk_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_RKS_Inom_vymk_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_vymk_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_POCHATKOVYJ_RESURS_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_POCHATKOVYJ_RESURS_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVYJ_RESURS_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_KRYTYCHNYJ_RESURS_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_KRYTYCHNYJ_RESURS_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_KRYTYCHNYJ_RESURS_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_POCHATKOVA_K_VYMK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_POCHATKOVA_K_VYMK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVA_K_VYMK_BEGIN;
                }
                //Формуємо екран уставок виключателя
                make_ekran_setpoint_switch();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
              {
                if(current_ekran.index_position == INDEX_ML_TMOON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_ON_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_OFF_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_OFF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_OFF_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_UDL_BLK_ON_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_UDL_BLK_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_UDL_BLK_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PRYVODA_VV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_PRYVODA_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PRYVODA_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_BEGIN;
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_ML_CTRPRYVOD_VV) maska = CTR_PRYVOD_VV;
                else if (current_ekran.index_position == INDEX_ML_CTRRESURS_VV) maska = CTR_RESURS_VV;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_switch ^= maska;

                //Формуємо екран управлінської інформації длявимикача
                 make_ekran_control_switch();
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_ON_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOOFF)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_OFF_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_OFF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_OFF_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_UDL_BLK_ON_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_UDL_BLK_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_UDL_BLK_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_BEGIN;
                }
                else if (current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PRYVODA_VV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_PRYVODA_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PRYVODA_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_BEGIN;
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch_(current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H);
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if (current_ekran.index_position == INDEX_ML_CTRPRYVOD_VV) maska = CTR_PRYVOD_VV;
                
                uint32_t on_off = current_ekran.current_level - EKRAN_CONTROL_SWITCH_H;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_switch_[on_off] ^= maska;

                //Формуємо екран управлінської інформації длявимикача
                 make_ekran_control_switch_(on_off);
              }
              else if(
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                     )   
              {
                if (current_ekran.index_position == INDEX_ML_LINES)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_LINES_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_LINES_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_LINES_BEGIN;
                }
                else
                {
                  int _tmp = current_ekran.index_position - 1;
                  if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                  {
                    if (current_ekran.position_cursor_x == COL_SETPOINT_DOVGYNA_COMMA )current_ekran.position_cursor_x++;
                    if ((current_ekran.position_cursor_x < COL_SETPOINT_DOVGYNA_BEGIN) ||
                        (current_ekran.position_cursor_x > COL_SETPOINT_DOVGYNA_END))
                      current_ekran.position_cursor_x = COL_SETPOINT_DOVGYNA_BEGIN;
                  }
                  else
                  {
                    if (current_ekran.position_cursor_x == COL_SETPOINT_OPIR_COMMA )current_ekran.position_cursor_x++;
                    if ((current_ekran.position_cursor_x < COL_SETPOINT_OPIR_BEGIN) ||
                        (current_ekran.position_cursor_x > COL_SETPOINT_OPIR_END))
                      current_ekran.position_cursor_x = COL_SETPOINT_OPIR_BEGIN;
                  }
                }

                //Формуємо екран уставок для ВМП
                make_ekran_setpoint_VMP(current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
              {
                unsigned int maska;
                
                //Виділяємо, який біт треба міняти
                maska = CTR_VMP_STATE;

                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_vmp ^= maska;

                //Формуємо екран управлінської інформації для ВМП
                make_ekran_control_VMP();
              }
              else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
              {
                if (
                    (current_ekran.position_cursor_x < COL_DOPUSK_DV_BEGIN )
                    ||
                    (current_ekran.position_cursor_x > COL_DOPUSK_DV_END   )
                    ||  
                    (
                     (current_ekran.position_cursor_x == COL_DOPUSK_DV_END) &&
                     ((current_settings.type_of_input_signal & (1 << current_ekran.index_position)) != 0)
                    )
                   )
                  current_ekran.position_cursor_x = COL_DOPUSK_DV_BEGIN;

                //Формуємо екран інфтрмації по допусках ДВ
                make_ekran_dopusk_dv();
              }
              else if((current_ekran.current_level == EKRAN_TYPE_INPUT_UVV ) || (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV) ||
                      (current_ekran.current_level == EKRAN_TYPE_LED_UVV   ))
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції і формуємо екран управлінської інформації для УВВ
                if (current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                {
                  edition_settings.type_of_input ^= value;
                  make_ekran_type_input_uvv(0);
                }
                else if (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV)
                {
                  edition_settings.type_of_input_signal ^= value;
                  make_ekran_type_input_uvv(1);
                }
                else 
                {
                  edition_settings.type_of_led ^= value;
                  make_ekran_type_led_uvv();
                }
              }
              else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
              {
                unsigned int maska = (1 << current_ekran.index_position);
                
                int value = ((edition_settings.type_of_output & maska) != 0);
                if (value == true) value += ((edition_settings.type_of_output_modif & maska) != 0); //тільки у випадку, коли вихід сигнальний
                if ((++value) >= 3) value = 0;
                
                if (value == 0)
                {
                  edition_settings.type_of_output       &= (unsigned int)(~maska);
                  edition_settings.type_of_output_modif &= (unsigned int)(~maska);
                }
                else
                {
                  edition_settings.type_of_output |= maska;
                  if (value == 1) edition_settings.type_of_output_modif &= (unsigned int)(~maska);
                  else edition_settings.type_of_output_modif |= maska;
                }

                make_ekran_type_output_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
              {
                edition_settings.buttons_mode ^= (1 << current_ekran.index_position);
                make_ekran_type_button_uvv();
              }
              else if(current_ekran.current_level == EKRAN_ADDRESS)
              {
                if ((current_ekran.position_cursor_x < COL_ADDRESS_BEGIN) ||
                    (current_ekran.position_cursor_x > COL_ADDRESS_END))
                  current_ekran.position_cursor_x = COL_ADDRESS_BEGIN;
                //Формуємо екран інфтрмації по комунікаційній адресі
                make_ekran_address();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
              {
                if (current_ekran.position_cursor_x == COL_TIMEOUT_INTERFACE_COMMA )current_ekran.position_cursor_x++;
                if ((current_ekran.position_cursor_x < COL_TIMEOUT_INTERFACE_BEGIN) ||
                    (current_ekran.position_cursor_x > COL_TIMEOUT_INTERFACE_END))
                  current_ekran.position_cursor_x = COL_TIMEOUT_INTERFACE_BEGIN;
                //Формуємо екран інформації по time-out наступного символу
                make_ekran_timeout_interface();
              }
              else if(current_ekran.current_level == EKRAN_TIME_ZONE)
              {
                if (current_ekran.index_position == INDEX_ML_TIME_ZONE)
                {
                  if (++edition_settings.time_zone > TIME_ZONE_MAX) edition_settings.time_zone = TIME_ZONE_MIN;
                }
                else if (current_ekran.index_position == INDEX_ML_DST)
                {
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.dst ^= MASKA_FOR_BIT(N_BIT_TZ_DST);
                }

                //Формуємо екран
                make_ekran_timezone_dst();
              }
              else if(current_ekran.current_level == EKRAN_DST_RULE)
              {
                uint32_t *p_rule_target = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? &edition_settings.dst_on_rule : &edition_settings.dst_off_rule;
                unsigned int pos = 0, shift = 0;
                unsigned int min = 0, max = 0;

                if (current_ekran.index_position == INDEX_ML_DST_MM)
                {
                  pos = POS_MM;
                  shift = SHIFT_MM;
                  
                  min = DST_RULE_MM_MIN;
                  max = DST_RULE_MM_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_DOW)
                {
                  pos = POS_DOW;
                  shift = SHIFT_DOW;
                  
                  min = DST_RULE_DOW_MIN;
                  max = DST_RULE_DOW_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_WR)
                {
                  pos = POS_WR;
                  shift = SHIFT_WR;
                  
                  min = DST_RULE_DR_MIN;
                  max = DST_RULE_DR_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_HH)
                {
                  pos = POS_HH;
                  shift = SHIFT_HH;
                  
                  min = DST_RULE_HH_MIN;
                  max = DST_RULE_HH_MAX;
                }
                else
                {
                  //Теоретично цього ніколи не мало б бути
                  total_error_sw_fixed();
                }
                
                uint32_t value = (*p_rule_target >> pos) & ((1 << shift) - 1);
                if (++value > max) value = min;
                
                uint32_t bit_maska = ((1u << (pos + shift)) - 1) - ((1u << pos) - 1);
                *p_rule_target &= ~bit_maska;
                *p_rule_target |= value << pos;

                //Формуємо екран
                make_ekran_dst_rule(*p_rule_target);
              }
              else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
              {
                if(current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                {
                  if ((current_ekran.position_cursor_x < COL_NUMBER_INERATION_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_NUMBER_INERATION_END))
                    current_ekran.position_cursor_x = COL_NUMBER_INERATION_BEGIN;
                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_FUNCTIONS_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_FUNCTIONS_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_FUNCTIONS_BEGIN;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_TRIGGERS_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_TRIGGERS_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_TRIGGERS_BEGIN;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_AND_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_AND_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_AND_BEGIN;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_OR_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_OR_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_OR_BEGIN;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_XOR_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_XOR_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_XOR_BEGIN;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_NOT_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_NOT_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_NOT_BEGIN;
//                }
                
                //Формуємо екран відображення загальних витримок для розширеної логіки
                make_ekran_general_pickups_el();
              }
              else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.type_df ^= value;

                //Формуємо екран відображення типу опреділювальної функції
                make_ekran_type_df();
              }
              else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
              {
                if(current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DF_PAUSE_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DF_PAUSE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DF_PAUSE_END))
                    current_ekran.position_cursor_x = COL_TMO_DF_PAUSE_BEGIN;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DF_WORK_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DF_WORK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DF_WORK_END))
                    current_ekran.position_cursor_x = COL_TMO_DF_WORK_BEGIN;
                }
                //Формуємо екран таймерів опреділюваних функцій
                make_ekran_timeout_df(current_ekran.current_level - EKRAN_TIMEOUT_DF1);
              }
              else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
              {
                int32_t index_position = current_ekran.index_position;
                uint32_t value = (edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] >> (16*index_position)) & 0xffff;
                  
                if (++value >= max_value_for_tf[1 + TOTAL_NUMBER_PROTECTION - 1][index_position]) value = 0;
                for (size_t i = 0; i < TOTAL_NUMBER_PROTECTION; i++)
                {
                  if (
                      ((current_settings.configuration & (1 << i)) == 0) &&
                      (value >= max_value_for_tf[1 + i - 1][index_position]) &&
                      (value <= max_value_for_tf[1 + i    ][index_position])
                     ) 
                  {
                    value = (i < (TOTAL_NUMBER_PROTECTION - 1)) ? max_value_for_tf[1 + i][index_position] : 0;
                  }
                }
                edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] &= (uint32_t)(~(0xffff << (16*index_position)));
                edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] |= ((value & 0xffff) << (16*index_position));

                //Формуємо екран
                make_ekran_list_source_tf();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
              {

                if(current_ekran.index_position == INDEX_ML_TMO_ELONGATION)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ELONGATION_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_ELONGATION_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ELONGATION_END))
                    current_ekran.position_cursor_x = COL_TMO_ELONGATION_BEGIN;
                }

                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_digital_registrator();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
              {
                if(current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PREFAULT_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_PREFAULT_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PREFAULT_END))
                    current_ekran.position_cursor_x = COL_TMO_PREFAULT_BEGIN;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_POSTFAULT_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_POSTFAULT_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_POSTFAULT_END))
                    current_ekran.position_cursor_x = COL_TMO_POSTFAULT_BEGIN;
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_analog_registrator();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_AR)
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_ar ^= value;

                //Формуємо екран відображення
                make_ekran_control_ar();
              }
              else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
              {
                //Виділяємо, який біт треба міняти
                unsigned int maska = (1 << current_ekran.index_position);
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_extra_settings_1 ^= maska;

                //Формуємо екран відображення додаткових налаштувань
                make_ekran_chose_extra_settings();
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_LEFT))
            {
              current_ekran.position_cursor_x--;
              //Перевіряємо, чи ми не вийшли за межі виділені для значення даної уставки, або позицію коми
              if(
                 (current_ekran.current_level >= EKRAN_SETPOINT_MTZ_GROUP1) &&
                 (current_ekran.current_level <= EKRAN_SETPOINT_MTZ_GROUP4)
                )   
              {
                if(current_ekran.index_position == INDEX_ML_STPMTZ1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_1_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_1_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_2_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_2_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ3_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_3_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_3_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_3_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_3_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZ4_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZ_4_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZ_4_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZ_4_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZ_4_U_END;
                }

                //Формуємо екран уставок МТЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_MTZ_GROUP1);
                make_ekran_setpoint_mtz(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_MTZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_MTZ_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOMTZ1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_1_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_VPERED_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_VPERED_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_VPERED_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_VPERED_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_VPERED_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_N_NAZAD_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_N_NAZAD_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_N_NAZAD_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_N_NAZAD_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_N_NAZAD_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_PO_NAPRUZI_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_PO_NAPRUZI_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_PO_NAPRUZI_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_PO_NAPRUZI_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_PO_NAPRUZI_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_2_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_2_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_3_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZ4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZ_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZ_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZ_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZ_4_PO_NAPRUZI_END;
                }
                
                //Формуємо екран витримок МТЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_MTZ_GROUP1);
                make_ekran_timeout_mtz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_MTZ)
              {
                if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_TYPE)
                {
                  if (--edition_settings.type_mtz1 < 0) edition_settings.type_mtz1 = TYPE_MTZ_VOLTAGE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_TYPE)
                {
                  if (--edition_settings.type_mtz2 < 0) edition_settings.type_mtz2 = TYPE_MTZ_DEPENDENT_RTV_I;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_TYPE)
                {
                  if (--edition_settings.type_mtz3 < 0) edition_settings.type_mtz3 = TYPE_MTZ_VOLTAGE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_TYPE)
                {
                  if (--edition_settings.type_mtz4 < 0) edition_settings.type_mtz4 = TYPE_MTZ_VOLTAGE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZ_1             ) maska = CTR_MTZ_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_VPERED      ) maska = CTR_MTZ_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_1_NAZAD       ) maska = CTR_MTZ_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2             ) maska = CTR_MTZ_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_VPERED      ) maska = CTR_MTZ_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_NAZAD       ) maska = CTR_MTZ_2_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_PRYSKORENNJA) maska = CTR_MTZ_2_PRYSKORENNJA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_2_PRYSKORENA  ) maska = CTR_MTZ_2_PRYSKORENA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3             ) maska = CTR_MTZ_3;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_VPERED      ) maska = CTR_MTZ_3_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_3_NAZAD       ) maska = CTR_MTZ_3_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4             ) maska = CTR_MTZ_4;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_VPERED      ) maska = CTR_MTZ_4_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_4_NAZAD       ) maska = CTR_MTZ_4_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZ_NESPR_KIL_NAPR) maska = CTR_MTZ_NESPR_KIL_NAPR;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtz ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗ
                 make_ekran_control_mtz();
              }
//++++++++++++++++#include "ekran/ekran_dz_left.ci"++++++++++++++++++++++
              //Натиснута кнопка LEFT
               else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_DZ_GROUP4)
                     )   
              {
               /* if(current_ekran.index_position == INDEX_ML_STP_K_DZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ_K_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ_K_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ_K_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ_K_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ1)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ1_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ1_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ2_ANGLE)
                {
                  if(current_ekran.position_cursor_x<COL_SDZ2_ANGLE) current_ekran.position_cursor_x=COL_PICKUP_DZ2_ANGLE_END;
                  else if(current_ekran.position_cursor_x<COL_PICKUP_DZ2_ANGLE_BEGIN) current_ekran.position_cursor_x=COL_SDZ2_ANGLE;
                  else if ((current_ekran.position_cursor_x < COL_SDZ2_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ2_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ2_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ2_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ2_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ2_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ2_AMTZ_END;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZ3_ANGLE)
                {
                  if(current_ekran.position_cursor_x<COL_SDZ3_ANGLE) current_ekran.position_cursor_x=COL_PICKUP_DZ3_ANGLE_END;
                  else if(current_ekran.position_cursor_x<COL_PICKUP_DZ3_ANGLE_BEGIN) current_ekran.position_cursor_x=COL_SDZ3_ANGLE;
                  else if ((current_ekran.position_cursor_x < COL_SDZ3_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ3_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ3_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ3_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ3_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ3_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ3_AMTZ_END;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZ4_ANGLE)
                {
                  if(current_ekran.position_cursor_x<COL_SDZ4_ANGLE) current_ekran.position_cursor_x=COL_PICKUP_DZ4_ANGLE_END;
                  else if(current_ekran.position_cursor_x<COL_PICKUP_DZ4_ANGLE_BEGIN) current_ekran.position_cursor_x=COL_SDZ4_ANGLE;
                  else if ((current_ekran.position_cursor_x < COL_SDZ4_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ4_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ4_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ4_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ4_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ4_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ4_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ4_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ4_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ4_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZ4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZ4_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZ4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZ4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_AMTZ_END;
                }*/
                 if(current_ekran.index_position == INDEX_ML_STP_K_ICE_DZO)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO_K_ICE_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO_K_ICE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO_K_ICE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO_K_ICE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO1_I_BLK)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO1_I_BLK_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO1_I_BLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO1_I_BLK_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO1_I_BLK_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_ANGLE)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZO2_ANGLE_END) current_ekran.position_cursor_x=COL_S_DZO2_ANGLE;
                  else if(current_ekran.position_cursor_x==(COL_S_DZO2_ANGLE+1)) current_ekran.position_cursor_x=COL_PICKUP_DZO2_ANGLE_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_S_DZO2_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO2_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO2_AMTZ_END;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_H)
                {
                  if(current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_H) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZO3_ANGLE_L;
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_ANGLE_L_END;
                  }
                  else if(current_ekran.position_cursor_x == (COL_PICKUP_DZO3_ANGLE_H_BEGIN - 1)) current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_H;
                  else if ((current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_H) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_ANGLE_H_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_ANGLE_H_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_ANGLE_L)
                {
                  if(current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_L)
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZO3_ANGLE_H;
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_ANGLE_H_END;
                  }
                  else if(current_ekran.position_cursor_x == (COL_PICKUP_DZO3_ANGLE_L_BEGIN - 1)) current_ekran.position_cursor_x = COL_DZO3_S_ANGLE_L;
                  else if ((current_ekran.position_cursor_x < COL_DZO3_S_ANGLE_L) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_ANGLE_L_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_ANGLE_L_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO3_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO3_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_Z0_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_Z0_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_Z0_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_X0_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_X0_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_X0_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x >COL_PICKUP_DZO4_X0_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_X0_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_Z0_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_Z0_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_Z0_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_Z0_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_Z0_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_X0_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_X0_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_X0_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_X0_INV_BEGIN))
                    current_ekran.position_cursor_x = COL_PICKUP_DZ4_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZO4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZO4_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZO4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZO4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZO4_AMTZ_END;
                }
                //Формуємо екран уставок ДЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_DZ_GROUP1);
                make_ekran_setpoint_dzo(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_DZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_DZ_GROUP4)
                     )   
              {
                /*if(current_ekran.index_position == INDEX_ML_TMO_DZ1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ1_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_DIR_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_INV_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ2_AMTZ_VVID_PR_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_DIR_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_INV_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ3_AMTZ_VVID_PR_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_DIR_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_INV_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZ4_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZ4_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZ4_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZ4_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ4_AMTZ_VVID_PR_END;
                }*/



                //else if(current_ekran.index_position == INDEX_ML_TMO_NKN_DZ)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_NKN_DZ_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_TMO_NKN_DZ_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_NKN_DZ_END))
                //    current_ekran.position_cursor_x = COL_TMO_NKN_DZ_END;
                //}
                   if(current_ekran.index_position == INDEX_ML_TMO_DZO1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO2_AMTZ_VVID_PR_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO3_AMTZ_VVID_PR_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZO4_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZO4_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZO4_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZO4_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZO4_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_NKN_DZO)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_NKN_DZO_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_NKN_DZO_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_NKN_DZO_END))
                    current_ekran.position_cursor_x = COL_TMO_NKN_DZO_END;
                }
                
                //Формуємо екран витримок ДЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_DZ_GROUP1);
                make_ekran_timeout_dzo(group);//make_ekran_timeout_dz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_DZ)
              {
                  unsigned int maska = 1<<current_ekran.index_position;

                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_dzo ^= maska;

                //Формуємо екран управлінської інформації для ДЗ
                 make_ekran_control_dzo();//make_ekran_control_dz();
              }
//----------------#include "ekran/ekran_dz_left.ci"----------------------
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZDZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZDZ_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOZDZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ZDZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_ZDZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ZDZ_END))
                    current_ekran.position_cursor_x = COL_TMO_ZDZ_END;
                }
                //Формуємо екран витримок ЗДЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZDZ_GROUP1);
                make_ekran_timeout_zdz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZDZ)
              {
                if (current_ekran.index_position == CTR_ZDZ_CTRL_TYPE)
                {
                  do
                  {
                    if (--edition_settings.ctrl_zdz_type < 0) edition_settings.ctrl_zdz_type = _ZDZ_CTRL_NUMBER - 1;
                  }
                  while(
                        (
                         ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0) &&//!((current_settings.configuration & (1<<MTZ1_BIT_CONFIGURATION)) == 0) &&
                         (
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I      ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_OR_U ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_AND_U)
                         )   
                        )
                        ||  
                        (
                         ((current_settings.configuration & (1<<UMIN_BIT_CONFIGURATION)) == 0) &&
                         (
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_U      ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_OR_U ) ||
                          (edition_settings.ctrl_zdz_type == ZDZ_CTRL_I_AND_U)
                         )   
                        )
                        //!||  
                        //!(
                        //! ((current_settings.configuration & (1<<ZZ_BIT_CONFIGURATION)) == 0) &&
                        //! (
                        //!  (edition_settings.ctrl_zdz_type == ZDZ_CTRL_3I0)
                        //! )   
                        //!)
						
						
                       ); 
                }
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                else if (current_ekran.index_position == CTR_ZDZ_PORIG)
                {
                  if (--edition_settings.zdz_ovd_porig < 0) edition_settings.zdz_ovd_porig = (ZDZ_CTRL_PORIG_N - 1);
                }
#endif
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if (current_ekran.index_position == CTR_ZDZ_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_STATE_BIT);
#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )   
                  else if (current_ekran.index_position == CTR_ZDZ_OVD1_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD1_STATE_BIT);
                  else if (current_ekran.index_position == CTR_ZDZ_OVD2_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD2_STATE_BIT);
                  else if (current_ekran.index_position == CTR_ZDZ_OVD3_STATE_BIT) maska = MASKA_FOR_BIT(CTR_ZDZ_OVD3_STATE_BIT);
#endif
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ1_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ1_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ2_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ2_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ3_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ3_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_MTZ4_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_MTZ4_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN1_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_UMIN1_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                  else if (current_ekran.index_position == CTR_ZDZ_STARTED_FROM_UMIN2_BIT ) maska = MASKA_FOR_BIT(CTR_ZDZ_STARTED_FROM_UMIN2_BIT - (_CTR_ZDZ_PART_III - _CTR_ZDZ_PART_II));
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_zdz ^= maska;
                }

                 //Формуємо екран управлінської інформації для ЗДЗ
                 make_ekran_control_zdz();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZZ_GROUP4)
                     )   
              {
                //if(current_ekran.index_position == INDEX_ML_STPZZ1_3I0)
                //{
                //  if (current_ekran.position_cursor_x == COL_SETPOINT_ZZ1_3I0_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_SETPOINT_ZZ1_3I0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_SETPOINT_ZZ1_3I0_END))
                //    current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3I0_END;
                //}
                //else if(current_ekran.index_position == INDEX_ML_STPZZ1_3U0)
                //{
                //  if (current_ekran.position_cursor_x == COL_SETPOINT_ZZ1_3U0_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_SETPOINT_ZZ1_3U0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_SETPOINT_ZZ1_3U0_END))
                //    current_ekran.position_cursor_x = COL_SETPOINT_ZZ1_3U0_END;
                //}
                ////Формуємо екран уставок ЗЗ
                //int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                //make_ekran_setpoint_zz(group);
                if(current_ekran.index_position == INDEX_ML_STPMTZO1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_1_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_1_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_2_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_2_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO3_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_3_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_3_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_3_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_3_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZO4_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZO_4_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZO_4_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZO_4_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZO_4_U_END;
                }
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZZ_GROUP1);
                make_ekran_setpoint_mtzo(group);//make_ekran_setpoint_zz(group);

                
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZZ_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZZ_GROUP4)
                     )   
              {
                //if(current_ekran.index_position == INDEX_ML_TMOZZ1_3I0)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_3I0_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_3I0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_3I0_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_3I0_END;
                //}
                //else if(current_ekran.index_position == INDEX_ML_TMOZZ1_3U0)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_3U0_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_3U0_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_3U0_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_3U0_END;
                //}
                //else if(current_ekran.index_position == INDEX_ML_TMOZZ1_NZZ)
                //{
                //  if (current_ekran.position_cursor_x == COL_TMO_ZZ1_NZZ_COMMA )current_ekran.position_cursor_x--;
                //  if ((current_ekran.position_cursor_x < COL_TMO_ZZ1_NZZ_BEGIN) ||
                //      (current_ekran.position_cursor_x > COL_TMO_ZZ1_NZZ_END))
                //    current_ekran.position_cursor_x = COL_TMO_ZZ1_NZZ_END;
                //}
                ////Формуємо екран витримок ЗЗ
                //int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                //make_ekran_timeout_zz(group);
                if(current_ekran.index_position == INDEX_ML_TMOMTZO1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_1_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_VPERED_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_VPERED_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_VPERED_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_VPERED_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_VPERED_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_N_NAZAD_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_N_NAZAD_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_N_NAZAD_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_N_NAZAD_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_N_NAZAD_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_PO_NAPRUZI_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_PO_NAPRUZI_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_PO_NAPRUZI_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_PO_NAPRUZI_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_PO_NAPRUZI_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_2_VVID_PR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_2_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO3_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_3_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_3_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_3_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_3_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZO4_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZO_4_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZO_4_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZO_4_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZO_4_PO_NAPRUZI_END;
                }
                
                //Формуємо екран витримок МТЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZZ_GROUP1);
                make_ekran_timeout_mtzo(group);//make_ekran_timeout_zz(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZZ)
              {
                if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_TYPE)
                {
                  if (--edition_settings.type_mtzo1 < 0) edition_settings.type_mtzo1 = TYPE_MTZ_VOLTAGE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_TYPE)
                {
                  if (--edition_settings.type_mtzo2 < 0) edition_settings.type_mtzo2 = TYPE_MTZ_DEPENDENT_RTV_I;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_TYPE)
                {
                  if (--edition_settings.type_mtzo3 < 0) edition_settings.type_mtzo3 = TYPE_MTZ_VOLTAGE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_TYPE)
                {
                  if (--edition_settings.type_mtzo4 < 0) edition_settings.type_mtzo4 = TYPE_MTZ_VOLTAGE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZO_1             ) maska = CTR_MTZO_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_VPERED      ) maska = CTR_MTZO_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_1_NAZAD       ) maska = CTR_MTZO_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2             ) maska = CTR_MTZO_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_VPERED      ) maska = CTR_MTZO_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_NAZAD       ) maska = CTR_MTZO_2_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_PRYSKORENNJA) maska = CTR_MTZO_2_PRYSKORENNJA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_2_PRYSKORENA  ) maska = CTR_MTZO_2_PRYSKORENA;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3             ) maska = CTR_MTZO_3;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_VPERED      ) maska = CTR_MTZO_3_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_3_NAZAD       ) maska = CTR_MTZO_3_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4             ) maska = CTR_MTZO_4;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_VPERED      ) maska = CTR_MTZO_4_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_4_NAZAD       ) maska = CTR_MTZO_4_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZO_NESPR_KIL_NAPR) maska = CTR_MTZO_NESPR_KIL_NAPR;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtzo ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗO
                 make_ekran_control_mtzo();
                 
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_TZNP_GROUP4)
                     )   
              {
                /*if(current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3I0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3U0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3I0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3I0_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP1_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP1_3U0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_3U0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_3U0_NAZAD_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP1_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3I0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3U0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3I0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3I0_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP2_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP2_3U0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_3U0_NAZAD_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3I0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3I0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3I0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3U0_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3U0_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3I0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3I0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3I0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3I0_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3I0_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPTZNP3_3U0_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_TZNP3_3U0_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_3U0_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_3U0_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_3U0_NAZAD_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPTZNP3_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_TZNP3_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_TZNP3_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_TZNP3_ANGLE_END;
                }*/
                if(current_ekran.index_position == INDEX_ML_STPMTZR1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR1_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_1_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_1_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_1_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_1_U_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_ANGLE)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_ANGLE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_PO_NAPRUZI_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPMTZR2_U)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_MTZR_2_U_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_MTZR_2_U_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_MTZR_2_U_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_MTZR_2_U_END;
                }
                
                
                //Формуємо екран уставок ТЗНП
                int group = (current_ekran.current_level - EKRAN_SETPOINT_TZNP_GROUP1);
                make_ekran_setpoint_mtzr(group);//make_ekran_setpoint_tznp(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_TZNP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_TZNP_GROUP4)
                     )  
              {
                /*if(current_ekran.index_position == INDEX_ML_TMOTZNP1_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP1_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP1_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP1_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP1_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP1_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP1_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP1_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP1_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP2_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP2_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP2_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP2_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP2_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP2_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP2_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP2_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP2_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP3_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP3_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP3_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP3_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOTZNP3_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_TZNP3_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_TZNP3_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_TZNP3_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_TZNP3_NAZAD_END;
                }*/
                if(current_ekran.index_position == INDEX_ML_TMOMTZR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR1_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_1_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_1_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_1_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_1_PO_NAPRUZI_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_N_VPERED)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_N_VPERED_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_N_VPERED_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_N_VPERED_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_VPERED_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_N_NAZAD)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_N_NAZAD_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_N_NAZAD_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_N_NAZAD_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_N_NAZAD_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOMTZR2_PO_NAPRUZI)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_MTZR_2_PO_NAPRUZI_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_MTZR_2_PO_NAPRUZI_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_MTZR_2_PO_NAPRUZI_END))
                    current_ekran.position_cursor_x = COL_TMO_MTZR_2_PO_NAPRUZI_END;
                }
                //Формуємо екран витримок ТЗНП
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_TZNP_GROUP1);
                make_ekran_timeout_mtzr(group);//make_ekran_timeout_tznp(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_TZNP)
              {
                //unsigned int maska = 0;
                ////Виділяємо, який біт треба міняти
                //if (current_ekran.index_position == INDEX_ML_CTR_TZNP1) maska = CTR_TZNP1;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP1_VPERED) maska = CTR_TZNP1_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP1_NAZAD) maska = CTR_TZNP1_NAZAD;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2) maska = CTR_TZNP2;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2_VPERED) maska = CTR_TZNP2_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP2_NAZAD) maska = CTR_TZNP2_NAZAD;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3) maska = CTR_TZNP3;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3_VPERED) maska = CTR_TZNP3_VPERED;
                //else if (current_ekran.index_position == INDEX_ML_CTR_TZNP3_NAZAD) maska = CTR_TZNP3_NAZAD;
                //
                ////Міняємо на протилежний відповідний біт для вибраної позиції
                //edition_settings.control_tznp ^= maska;

                //Формуємо екран управлінської інформації для ТЗНП
                 //make_ekran_control_tznp();
                if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_TYPE)
                {
                  if (--edition_settings.type_mtzr1 < 0) edition_settings.type_mtzr1 = TYPE_MTZ_VOLTAGE;
                }
                else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_TYPE)
                {
                  if (--edition_settings.type_mtzr2 < 0) edition_settings.type_mtzr2 = TYPE_MTZ_VOLTAGE;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if      (current_ekran.index_position == INDEX_ML_CTRMTZR_1             ) maska = CTR_MTZR_1;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_VPERED      ) maska = CTR_MTZR_1_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_1_NAZAD       ) maska = CTR_MTZR_1_NAZAD;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2             ) maska = CTR_MTZR_2;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_VPERED      ) maska = CTR_MTZR_2_VPERED;
                  else if (current_ekran.index_position == INDEX_ML_CTRMTZR_2_NAZAD       ) maska = CTR_MTZR_2_NAZAD;


                   else if (current_ekran.index_position == INDEX_ML_CTRMTZR_NESPR_KIL_NAPR) maska = CTR_MTZR_NESPR_KIL_NAPR;
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_mtzr ^= maska;
                }

                //Формуємо екран управлінської інформації для МТЗ
                 make_ekran_control_mtzr();
                
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_APV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_APV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOAPV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_1_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_2_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_3_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_4_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV1_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV2_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV3)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV3_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV3_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV3_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV3_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_APV4)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_APV4_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_APV4_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_APV4_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_APV4_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOAPV_BLOCK_VID_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_APV_BLOCK_VID_VV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_APV_BLOCK_VID_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_APV_BLOCK_VID_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_APV_BLOCK_VID_VV_END;
                }
                //Формуємо екран витримок АПВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_APV_GROUP1);
                make_ekran_timeout_apv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_APV)
              {
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_apv ^= MASKA_FOR_BIT(current_ekran.index_position);

                //Формуємо екран управлінської інформації для АПВ
                 make_ekran_control_apv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ACHR_CHAPV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPACHR_CHAPV_UF)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR_CHAPV_UF_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR_CHAPV_UF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR_CHAPV_UF_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR_CHAPV_UF_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPACHR1_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR1_F_RAB_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR1_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR1_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR1_F_RAB_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPCHAPV1_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_CHAPV1_F_RAB_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_CHAPV1_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_CHAPV1_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV1_F_RAB_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPACHR2_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_ACHR2_F_RAB_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_ACHR2_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_ACHR2_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_ACHR2_F_RAB_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPCHAPV2_F_RAB)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_CHAPV2_F_RAB_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_CHAPV2_F_RAB_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_CHAPV2_F_RAB_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_CHAPV2_F_RAB_END;
                }

                //Формуємо екран уставок АЧР-ЧАПВ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ACHR_CHAPV_GROUP1);
                make_ekran_setpoint_achr_chapv(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ACHR_CHAPV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOACHR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ACHR1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_ACHR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ACHR1_END))
                    current_ekran.position_cursor_x = COL_TMO_ACHR1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOCHAPV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_CHAPV1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_CHAPV1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_CHAPV1_END))
                    current_ekran.position_cursor_x = COL_TMO_CHAPV1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOACHR2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ACHR2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_ACHR2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ACHR2_END))
                    current_ekran.position_cursor_x = COL_TMO_ACHR2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOCHAPV2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_CHAPV2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_CHAPV2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_CHAPV2_END))
                    current_ekran.position_cursor_x = COL_TMO_CHAPV2_END;
                }

                //Формуємо екран витримок АЧР-ЧАПВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ACHR_CHAPV_GROUP1);
                make_ekran_timeout_achr_chapv(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ACHR_CHAPV)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_CHAPV_VID_DV) maska = CTR_CHAPV_VID_DV;
                else if (current_ekran.index_position == INDEX_CTR_ACHR1       ) maska = CTR_ACHR1;
                else if (current_ekran.index_position == INDEX_CTR_CHAPV1      ) maska = CTR_CHAPV1;
                else if (current_ekran.index_position == INDEX_CTR_ACHR2       ) maska = CTR_ACHR2;
                else if (current_ekran.index_position == INDEX_CTR_CHAPV2      ) maska = CTR_CHAPV2;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_achr_chapv ^= maska;

                //Формуємо екран управлінської інформації для АЧР-ЧАПВ
                 make_ekran_control_achr_chapv();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UROV_GROUP4)
                     )   
              {
                if (current_ekran.position_cursor_x == COL_SETPOINT_UROV_COMMA )current_ekran.position_cursor_x--;
                if ((current_ekran.position_cursor_x < COL_SETPOINT_UROV_BEGIN) ||
                    (current_ekran.position_cursor_x > COL_SETPOINT_UROV_END))
                  current_ekran.position_cursor_x = COL_SETPOINT_UROV_END;

                //Формуємо екран уставок УРОВ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UROV_GROUP1);
                make_ekran_setpoint_urov(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UROV_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UROV_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOUROV1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UROV_1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UROV_1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UROV_1_END))
                    current_ekran.position_cursor_x = COL_TMO_UROV_1_END;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UROV_2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UROV_2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UROV_2_END))
                    current_ekran.position_cursor_x = COL_TMO_UROV_2_END;
                }

                //Формуємо екран витримок УРОВ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UROV_GROUP1);
                 make_ekran_timeout_urov(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UROV)
              {
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_urov ^= MASKA64_FOR_BIT(current_ekran.index_position);

                //Формуємо екран управлінської інформації для УРОВ
                 make_ekran_control_urov();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_ZOP_GROUP4)
                     )   
              {
                //if (current_ekran.position_cursor_x == COL_SETPOINT_ZOP_COMMA )current_ekran.position_cursor_x--;
                //if ((current_ekran.position_cursor_x < COL_SETPOINT_ZOP_BEGIN) ||
                //    (current_ekran.position_cursor_x > COL_SETPOINT_ZOP_END))
                //  current_ekran.position_cursor_x = COL_SETPOINT_ZOP_END;
                if(current_ekran.index_position == INDEX_ML_STP_K_ICE_DZR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR_K_ICE_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR_K_ICE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR_K_ICE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR_K_ICE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR1_I_BLK)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR1_I_BLK_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR1_I_BLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR1_I_BLK_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR1_I_BLK_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_ANGLE)
                {
                  if(current_ekran.position_cursor_x>COL_PICKUP_DZR2_ANGLE_END) current_ekran.position_cursor_x=COL_S_DZR2_ANGLE;
                  else if(current_ekran.position_cursor_x==(COL_S_DZR2_ANGLE+1)) current_ekran.position_cursor_x=COL_PICKUP_DZR2_ANGLE_BEGIN;
                  else if ((current_ekran.position_cursor_x < COL_S_DZR2_ANGLE) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_ANGLE_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_ANGLE_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR2_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR2_AMTZ_END;
                }

                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_H)
                {
                  if(current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_H) 
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZR3_ANGLE_L;
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_ANGLE_L_END;
                  }
                  else if(current_ekran.position_cursor_x == (COL_PICKUP_DZR3_ANGLE_H_BEGIN - 1)) current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_H;
                  else if ((current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_H) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_ANGLE_H_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_ANGLE_H_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_ANGLE_L)
                {
                  if(current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_L)
                  {
                    current_ekran.index_position = INDEX_ML_STP_DZR3_ANGLE_H;
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_ANGLE_H_END;
                  }
                  else if(current_ekran.position_cursor_x == (COL_PICKUP_DZR3_ANGLE_L_BEGIN - 1)) current_ekran.position_cursor_x = COL_DZR3_S_ANGLE_L;
                  else if ((current_ekran.position_cursor_x < COL_DZR3_S_ANGLE_L) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_ANGLE_L_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_ANGLE_L_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_DIR_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_DIR_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_INV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_INV_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_DZR3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_PICKUP_DZR3_AMTZ_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_PICKUP_DZR3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_PICKUP_DZR3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_PICKUP_DZR3_AMTZ_END;
                }
                
                //Формуємо екран уставок ЗОП(КОФ)
                int group = (current_ekran.current_level - EKRAN_SETPOINT_ZOP_GROUP1);
                make_ekran_setpoint_dzr(group);//make_ekran_setpoint_zop(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_ZOP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_ZOP_GROUP4)
                     )   
              {
                //if (current_ekran.position_cursor_x == COL_TMO_ZOP_COMMA )current_ekran.position_cursor_x--;
                //if ((current_ekran.position_cursor_x < COL_TMO_ZOP_BEGIN) ||
                //    (current_ekran.position_cursor_x > COL_TMO_ZOP_END))
                //  current_ekran.position_cursor_x = COL_TMO_ZOP_END;
                if(current_ekran.index_position == INDEX_ML_TMO_DZR1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR1_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR1_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR1_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR1_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR1_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR1_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZ1_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR2_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR2_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR2_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR2_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR2_AMTZ_VVID_PR_END;
                }

                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_DIR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_DIR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_DIR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_DIR_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_DIR_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_DIR_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_DIR_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_DIR_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_INV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_INV_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_INV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_INV_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_INV_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_INV_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_INV_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_INV_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_INV_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_VVID_PR_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMO_DZR3_AMTZ_VVID_PR)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DZR3_AMTZ_VVID_PR_COMMA )current_ekran.position_cursor_x++;
                  if ((current_ekran.position_cursor_x < COL_TMO_DZR3_AMTZ_VVID_PR_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DZR3_AMTZ_VVID_PR_END))
                    current_ekran.position_cursor_x = COL_TMO_DZR3_AMTZ_VVID_PR_END;
                }

                //Формуємо екран витримок ЗОП(КОФ)
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_ZOP_GROUP1);
                make_ekran_timeout_dzr(group);//make_ekran_timeout_zop(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_ZOP)
              {
                //unsigned int maska;
                //Виділяємо, який біт треба міняти
                //maska = CTR_ZOP_STATE;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                //edition_settings.control_zop ^= maska;
                unsigned int maska = 1<<current_ekran.index_position;
                edition_settings.control_dzr ^= maska;
                //Формуємо екран управлінської інформації для ЗТОП
                 make_ekran_control_dzr();//make_ekran_control_zop();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMIN_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPUMIN1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN1_IBLK)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN1_IBLK_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN1_IBLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN1_IBLK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN1_IBLK_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMIN2_IBLK)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMIN2_IBLK_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMIN2_IBLK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMIN2_IBLK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMIN2_IBLK_END;
                }

                //Формуємо екран уставок Umin
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMIN_GROUP1);
                make_ekran_setpoint_Umin(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMIN_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMIN_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOUMIN1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMIN1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMIN1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMIN1_END))
                    current_ekran.position_cursor_x = COL_TMO_UMIN1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUMIN2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMIN2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMIN2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMIN2_END))
                    current_ekran.position_cursor_x = COL_TMO_UMIN2_END;
                }

                //Формуємо екран витримок Umin
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMIN_GROUP1);
                make_ekran_timeout_Umin(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMIN)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_UMIN1          ) maska = CTR_UMIN1;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMIN1_OR_AND) maska = CTR_PO_UMIN1_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMIN1_UBLK     ) maska = CTR_UMIN1_UBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN1_IBLK     ) maska = CTR_UMIN1_IBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2          ) maska = CTR_UMIN2;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMIN2_OR_AND) maska = CTR_PO_UMIN2_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2_UBLK     ) maska = CTR_UMIN2_UBLK;
                else if (current_ekran.index_position == INDEX_CTR_UMIN2_IBLK     ) maska = CTR_UMIN2_IBLK;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_Umin ^= maska;

                //Формуємо екран управлінської інформації для Umin
                 make_ekran_control_Umin();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UMAX_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_STPUMAX1)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMAX1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMAX1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMAX1_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STPUMAX2)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UMAX2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UMAX2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UMAX2_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UMAX2_END;
                }
                else if(current_ekran.index_position == INDEX_ML_STP_KP_UMAX)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_KP_UMAX_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_KP_UMAX_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_KP_UMAX_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_KP_UMAX_END;
                }

                //Формуємо екран уставок Umax
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UMAX_GROUP1);
                make_ekran_setpoint_Umax(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UMAX_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UMAX_GROUP4)
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOUMAX1)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMAX1_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMAX1_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMAX1_END))
                    current_ekran.position_cursor_x = COL_TMO_UMAX1_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUMAX2)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UMAX2_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UMAX2_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UMAX2_END))
                    current_ekran.position_cursor_x = COL_TMO_UMAX2_END;
                }

                //Формуємо екран витримок Umax
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UMAX_GROUP1);
                make_ekran_timeout_Umax(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UMAX)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_CTR_UMAX1          ) maska = CTR_UMAX1;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMAX1_OR_AND) maska = CTR_PO_UMAX1_OR_AND;
                else if (current_ekran.index_position == INDEX_CTR_UMAX2          ) maska = CTR_UMAX2;
                //else if (current_ekran.index_position == INDEX_CTR_PO_UMAX2_OR_AND) maska = CTR_PO_UMAX2_OR_AND;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_Umax ^= maska;

                //Формуємо екран управлінської інформації для Umax
                 make_ekran_control_Umax();
              }
              else if(
                      (current_ekran.current_level >= EKRAN_SETPOINT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_SETPOINT_UP_GROUP4)
                     )   
              {
                uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_SETPOINT_UP;
                
                if(_n_index == INDEX_ML_STP_UP)
                {
                  uint32_t _n_UP = current_ekran.index_position / MAX_ROW_FOR_SETPOINT_UP;
                  int32_t begin = 0, comma = 0, end = 0;
                  switch (current_settings.ctrl_UP_input[_n_UP])
                  {
                  case UP_CTRL_Ia_Ib_Ic:
                  case UP_CTRL_Ia:
                  case UP_CTRL_Ib:
                  case UP_CTRL_Ic:
                  case UP_CTRL_I1:
                  case UP_CTRL_I2:
                  case UP_CTRL_3I0_r:
                    {
                      begin = COL_SETPOINT_UP_I_BEGIN;
                      comma = COL_SETPOINT_UP_I_COMMA;
                      end = COL_SETPOINT_UP_I_END;
                      break;
                    }
                  case UP_CTRL_3I0:
                  case UP_CTRL_3I0_others:
                    {
                      begin = COL_SETPOINT_UP_3I0_BEGIN;
                      comma = COL_SETPOINT_UP_3I0_COMMA;
                      end = COL_SETPOINT_UP_3I0_END;
                      break;
                    }
                    case UP_CTRL_Ua_Ub_Uc:
                    case UP_CTRL_Uab_Ubc_Uca:
                    case UP_CTRL_Ua:
                    case UP_CTRL_Uab:
                    case UP_CTRL_Ub:
                    case UP_CTRL_Ubc:
                    case UP_CTRL_Uc:
                    case UP_CTRL_Uca:
                    case UP_CTRL_U1:
                    case UP_CTRL_U2:
                    case UP_CTRL_3U0:
                    {
                      begin = COL_SETPOINT_UP_U_BEGIN;
                      comma = COL_SETPOINT_UP_U_COMMA;
                      end = COL_SETPOINT_UP_U_END;
                      break;
                    }
                  case UP_CTRL_P:
                  case UP_CTRL_Q:
                    {
                      begin = COL_SETPOINT_UP_PQ_BEGIN - 1;
                      comma = COL_SETPOINT_UP_PQ_COMMA;
                      end = COL_SETPOINT_UP_PQ_END;
                      break;
                    }
                  case UP_CTRL_S:
                    {
                      begin = COL_SETPOINT_UP_S_BEGIN;
                      comma = COL_SETPOINT_UP_S_COMMA;
                      end = COL_SETPOINT_UP_S_END;
                      break;
                    }
                  default:
                    {
                      //Теоретично цього ніколи не мало б бути
                      total_error_sw_fixed();
                    }
                  }
                    
                  if (current_ekran.position_cursor_x == comma )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < begin) ||
                      (current_ekran.position_cursor_x > end))
                    current_ekran.position_cursor_x = end;
                }
                else if(_n_index == INDEX_ML_STP_UP_KP)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_UP_KP_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_UP_KP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_UP_KP_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_UP_KP_END;
                }

                //Формуємо екран уставок УЗ
                int group = (current_ekran.current_level - EKRAN_SETPOINT_UP_GROUP1);
                make_ekran_setpoint_UP_A01(group);//!make_ekran_setpoint_UP(group);
              }
              else if(
                      (current_ekran.current_level >= EKRAN_TIMEOUT_UP_GROUP1) &&
                      (current_ekran.current_level <= EKRAN_TIMEOUT_UP_GROUP4)
                     )  
              {
                uint32_t _n_index = current_ekran.index_position % MAX_ROW_FOR_TIMEOUT_UP;

                if(_n_index == INDEX_ML_TMOUP)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_UP_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_UP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_UP_END))
                    current_ekran.position_cursor_x = COL_TMO_UP_END;
                }

                //Формуємо екран витримок УЗ
                int group = (current_ekran.current_level - EKRAN_TIMEOUT_UP_GROUP1);
                make_ekran_timeout_UP(group);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_UP)
              {
                //!uint32_t n_UP = current_ekran.index_position / (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I);
                //!uint32_t n_index = current_ekran.index_position % (_CTR_UP_NEXT_BIT - _CTR_UP_PART_I);
                //!if (n_index == CTR_UP_CTRL_INPUT)
                //!{
                //!  uint32_t ctrl_maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_STATE_BIT     - (_CTR_UP_PART_II - _CTR_UP_PART_I)) |
                //!                        MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_OR_AND_BIT    - (_CTR_UP_PART_II - _CTR_UP_PART_I)) |
                //!                        MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_MORE_LESS_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));  
                //!  edition_settings.control_UP &= (uint32_t)(~ctrl_maska);
                //!  
                //!  if (--edition_settings.ctrl_UP_input[n_UP] < 0) edition_settings.ctrl_UP_input[n_UP] = _UP_CTRL_NUMBER - 1;
                //!}
                //!else
                //!{
                //!  unsigned int maska = 0;
				//!
                //!  //Виділяємо, який біт треба міняти
                //!  if (n_index == CTR_UP_STATE_BIT) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_STATE_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!  else if (n_index == CTR_UP_OR_AND_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_OR_AND_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!  else if (n_index == CTR_UP_MORE_LESS_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_UP_NEXT_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I) - _CTR_UP_PART_I) + CTR_UP_MORE_LESS_BIT - (_CTR_UP_PART_II - _CTR_UP_PART_I));
                //!
                //!  //Міняємо на протилежний відповідний біт для вибраної позиції
                //!  edition_settings.control_UP ^= maska;
                //!}
                uint32_t n_UP = current_ekran.index_position / (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I);
                uint32_t n_index = current_ekran.index_position % (_CTR_A01_UP_NEXT_BIT - _CTR_A01_UP_PART_I);
                if (n_index == CTR_UP_CTRL_INPUT)
                {
                  uint32_t ctrl_maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_STATE_BIT     - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I)) |
                                        //!MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_UP_OR_AND_BIT    - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I)) |
                                        MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_MORE_LESS_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));  
                  edition_settings.control_UP &= (uint32_t)(~ctrl_maska);
                  
                  if (--edition_settings.ctrl_UP_input[n_UP] < 0) edition_settings.ctrl_UP_input[n_UP] = _UP_CTRL_A01_NUMBER - 1;
                }
                else
                {
                  unsigned int maska = 0;
          
                  //Виділяємо, який біт треба міняти
                  if (n_index == CTR_A01_UP_STATE_BIT) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_STATE_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                  //!else if (n_index == CTR_UP_OR_AND_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_UP_OR_AND_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                  else if (n_index == CTR_A01_UP_MORE_LESS_BIT ) maska = MASKA_FOR_BIT(n_UP*(_CTR_A01_UP_NEXT_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I) - _CTR_A01_UP_PART_I) + CTR_A01_UP_MORE_LESS_BIT - (_CTR_A01_UP_PART_II - _CTR_A01_UP_PART_I));
                
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.control_UP ^= maska;
                }

                //Формуємо екран управлінської інформації для УЗ
                make_ekran_control_UP_A01();//!make_ekran_control_UP();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_SETPOINT)
              {
                if(current_ekran.index_position == INDEX_ML_T_BP)
                {
                  if ((current_ekran.position_cursor_x < COL_T_BP_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_T_BP_END))
                    current_ekran.position_cursor_x = COL_T_BP_END;
                }
                else if(current_ekran.index_position == INDEX_ML_T_MN)
                {
                  if ((current_ekran.position_cursor_x < COL_T_MN_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_T_MN_END))
                    current_ekran.position_cursor_x = COL_T_MN_END;
                }
                else
                {
                  if ((current_ekran.position_cursor_x < COL_TN_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TN_END))
                    current_ekran.position_cursor_x = COL_TN_END;
                }
                //Формуємо екран відображення інформації по трансформаторах
                make_ekran_transformator();
              }
              else if(current_ekran.current_level == EKRAN_TRANSFORMATOR_INFO_CONTROL)
              {
                //Виділяємо, який біт треба міняти
                unsigned int maska = (1 << current_ekran.index_position);
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_transformator ^= maska;

                //Формуємо екран відображення налаштувань меню "Трансформатор"
                //!make_ekran_transformator_control();
              }
              else if(current_ekran.current_level == EKRAN_SETPOINT_SWITCH)
              {
                if(current_ekran.index_position == INDEX_ML_STPInom)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_Inom_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_Inom_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_Inom_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_RKS_Inom_BEGIN) ||
                      (current_ekran.position_cursor_x > (COL_SETPOINT_RKS_Inom_END - 1)))
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_END - 1;
                }
                else if (current_ekran.index_position == INDEX_ML_STPMInom_vymk)
                {
                  if (current_ekran.position_cursor_x == COL_SETPOINT_Inom_vymk_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_Inom_vymk_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_Inom_vymk_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_Inom_vymk_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPRKS_Inom_vymk)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_RKS_Inom_vymk_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_RKS_Inom_vymk_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_RKS_Inom_vymk_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVYJ_RESURS)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_POCHATKOVYJ_RESURS_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_POCHATKOVYJ_RESURS_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVYJ_RESURS_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPKRYTYCHNYJ_RESURS)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_KRYTYCHNYJ_RESURS_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_KRYTYCHNYJ_RESURS_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_KRYTYCHNYJ_RESURS_END;
                }
                else if (current_ekran.index_position == INDEX_ML_STPPOCHATKOVA_K_VYMK)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_POCHATKOVA_K_VYMK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_POCHATKOVA_K_VYMK_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_POCHATKOVA_K_VYMK_END;
                }
                //Формуємо екран уставок виключателя
                make_ekran_setpoint_switch();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_SWITCH)
              {
                if(current_ekran.index_position == INDEX_ML_TMOON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_ON_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOOFF)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_OFF_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_OFF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_OFF_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_UDL_BLK_ON_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_UDL_BLK_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_UDL_BLK_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PRYVODA_VV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_PRYVODA_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PRYVODA_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_END;
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_SWITCH)
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if      (current_ekran.index_position == INDEX_ML_CTRPRYVOD_VV) maska = CTR_PRYVOD_VV;
                else if (current_ekran.index_position == INDEX_ML_CTRRESURS_VV) maska = CTR_RESURS_VV;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_switch ^= maska;

                //Формуємо екран управлінської інформації для вимикача
                 make_ekran_control_switch();
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_TIMEOUT_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_TIMEOUT_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                if(current_ekran.index_position == INDEX_ML_TMOON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_ON_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_ON_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOOFF)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_OFF_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_OFF_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_OFF_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_OFF_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOUDL_BLK_ON)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_SWCH_UDL_BLK_ON_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_SWCH_UDL_BLK_ON_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_SWCH_UDL_BLK_ON_END))
                    current_ekran.position_cursor_x = COL_TMO_SWCH_UDL_BLK_ON_END;
                }
                else if(current_ekran.index_position == INDEX_ML_TMOPRYVODA_VV)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PRYVODA_VV_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_PRYVODA_VV_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PRYVODA_VV_END))
                    current_ekran.position_cursor_x = COL_TMO_PRYVODA_VV_END;
                }
                //Формуємо екран витримок виключателя
                make_ekran_timeout_switch_(current_ekran.current_level - EKRAN_TIMEOUT_SWITCH_H);
              }
              else if(
                      (current_ekran.current_level >=  EKRAN_CONTROL_SWITCH_H) &&
                      (current_ekran.current_level <  (EKRAN_CONTROL_SWITCH_H + NUMBER_OFF_ON))
                     )   
              {
                unsigned int maska = 0;
          
                //Виділяємо, який біт треба міняти
                if (current_ekran.index_position == INDEX_ML_CTRPRYVOD_VV) maska = CTR_PRYVOD_VV;
                
                uint32_t on_off = current_ekran.current_level - EKRAN_CONTROL_SWITCH_H;
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_switch_[on_off] ^= maska;

                //Формуємо екран управлінської інформації для вимикача
                 make_ekran_control_switch_(on_off);
              }
              else if(
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_FORWARD) ||
                      (current_ekran.current_level == EKRAN_SETPOINT_VMP_BACKWARD)
                     )   
              {
                if (current_ekran.index_position == INDEX_ML_LINES)
                {
                  if ((current_ekran.position_cursor_x < COL_SETPOINT_LINES_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_SETPOINT_LINES_END))
                    current_ekran.position_cursor_x = COL_SETPOINT_LINES_END;
                }
                else
                {
                  int _tmp = current_ekran.index_position - 1;
                  if ((_tmp & 0x1)  == (INDEX_ML_DOVGYNA - 1))
                  {
                    if (current_ekran.position_cursor_x == COL_SETPOINT_DOVGYNA_COMMA )current_ekran.position_cursor_x--;
                    if ((current_ekran.position_cursor_x < COL_SETPOINT_DOVGYNA_BEGIN) ||
                        (current_ekran.position_cursor_x > COL_SETPOINT_DOVGYNA_END))
                      current_ekran.position_cursor_x = COL_SETPOINT_DOVGYNA_END;
                  }
                  else
                  {
                    if (current_ekran.position_cursor_x == COL_SETPOINT_OPIR_COMMA )current_ekran.position_cursor_x--;
                    if ((current_ekran.position_cursor_x < COL_SETPOINT_OPIR_BEGIN) ||
                        (current_ekran.position_cursor_x > COL_SETPOINT_OPIR_END))
                      current_ekran.position_cursor_x = COL_SETPOINT_OPIR_END;
                  }
                }

                //Формуємо екран уставок для ВМП
                make_ekran_setpoint_VMP(current_ekran.current_level - EKRAN_SETPOINT_VMP_FORWARD);
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_VMP)
              {
                unsigned int maska;
                
                //Виділяємо, який біт треба міняти
                maska = CTR_VMP_STATE;

                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_vmp ^= maska;

                //Формуємо екран управлінської інформації для ВМП
                make_ekran_control_VMP();
              }
              else if(current_ekran.current_level == EKRAN_DOPUSK_DV_UVV)
              {
                if (
                    (current_ekran.position_cursor_x < COL_DOPUSK_DV_BEGIN )
                    ||
                    (current_ekran.position_cursor_x > COL_DOPUSK_DV_END   )
                    ||  
                    (
                     (current_ekran.position_cursor_x == COL_DOPUSK_DV_END) &&
                     ((current_settings.type_of_input_signal & (1 << current_ekran.index_position)) != 0)
                    )
                   )
                {
                  if ((current_settings.type_of_input_signal & (1 << current_ekran.index_position)) != 0)
                    current_ekran.position_cursor_x = (COL_DOPUSK_DV_END - 1);
                  else 
                    current_ekran.position_cursor_x = COL_DOPUSK_DV_END;
                }
                
                //Формуємо екран інфтрмації по допусках ДВ
                make_ekran_dopusk_dv();
              }
              else if((current_ekran.current_level == EKRAN_TYPE_INPUT_UVV ) || (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV) ||
                      (current_ekran.current_level == EKRAN_TYPE_LED_UVV   ))
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції і формуємо екран управлінської інформації для УВВ
                if (current_ekran.current_level == EKRAN_TYPE_INPUT_UVV)
                {
                  edition_settings.type_of_input ^= value;
                  make_ekran_type_input_uvv(0);
                }
                else if (current_ekran.current_level == EKRAN_TYPE_INPUT_SIGNAL_UVV)
                {
                  edition_settings.type_of_input_signal ^= value;
                  make_ekran_type_input_uvv(1);
                }
                else
                {
                  edition_settings.type_of_led ^= value;
                  make_ekran_type_led_uvv();
                }
              }
              else if(current_ekran.current_level == EKRAN_TYPE_OUTPUT_UVV)
              {
                unsigned int maska = (1 << current_ekran.index_position);
                
                int value = ((edition_settings.type_of_output & maska) != 0);
                if (value == true) value += ((edition_settings.type_of_output_modif & maska) != 0); //тільки у випадку, коли вихід сигнальний
                if ((--value) < 0) value = 2;
                
                if (value == 0)
                {
                  edition_settings.type_of_output       &= (unsigned int)(~maska);
                  edition_settings.type_of_output_modif &= (unsigned int)(~maska);
                }
                else
                {
                  edition_settings.type_of_output |= maska;
                  if (value == 1) edition_settings.type_of_output_modif &= (unsigned int)(~maska);
                  else edition_settings.type_of_output_modif |= maska;
                }

                make_ekran_type_output_uvv();
              }
              else if(current_ekran.current_level == EKRAN_TYPE_BUTTON_UVV)
              {
                edition_settings.buttons_mode ^= (1 << current_ekran.index_position);
                make_ekran_type_button_uvv();
              }
              else if(current_ekran.current_level == EKRAN_ADDRESS)
              {
                  if ((current_ekran.position_cursor_x < COL_ADDRESS_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_ADDRESS_END))
                    current_ekran.position_cursor_x = COL_ADDRESS_END;
                  //Формуємо екран інфтрмації по комунікаційній адресі
                  make_ekran_address();
              }
              else if(current_ekran.current_level == EKRAN_VIEW_TIMEOUT_RS485)
              {
                if (current_ekran.position_cursor_x == COL_TIMEOUT_INTERFACE_COMMA )current_ekran.position_cursor_x--;
                if ((current_ekran.position_cursor_x < COL_TIMEOUT_INTERFACE_BEGIN) ||
                    (current_ekran.position_cursor_x > COL_TIMEOUT_INTERFACE_END))
                  current_ekran.position_cursor_x = COL_TIMEOUT_INTERFACE_END;
                //Формуємо екран інформації по time-out наступного символу
                make_ekran_timeout_interface();
              }
              else if(current_ekran.current_level == EKRAN_TIME_ZONE)
              {
                if (current_ekran.index_position == INDEX_ML_TIME_ZONE)
                {
                  if (--edition_settings.time_zone < TIME_ZONE_MIN) edition_settings.time_zone = TIME_ZONE_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST)
                {
                  //Міняємо на протилежний відповідний біт для вибраної позиції
                  edition_settings.dst ^= MASKA_FOR_BIT(N_BIT_TZ_DST);
                }

                //Формуємо екран
                make_ekran_timezone_dst();
              }
              else if(current_ekran.current_level == EKRAN_DST_RULE)
              {
                uint32_t *p_rule_target = (position_in_current_level_menu[previous_level_in_current_level_menu[EKRAN_DST_RULE]] == INDEX_ML_CHDT_DST_ON) ? &edition_settings.dst_on_rule : &edition_settings.dst_off_rule;
                unsigned int pos = 0, shift = 0;
                unsigned int min = 0, max = 0;

                if (current_ekran.index_position == INDEX_ML_DST_MM)
                {
                  pos = POS_MM;
                  shift = SHIFT_MM;
                  
                  min = DST_RULE_MM_MIN;
                  max = DST_RULE_MM_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_DOW)
                {
                  pos = POS_DOW;
                  shift = SHIFT_DOW;
                  
                  min = DST_RULE_DOW_MIN;
                  max = DST_RULE_DOW_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_WR)
                {
                  pos = POS_WR;
                  shift = SHIFT_WR;
                  
                  min = DST_RULE_DR_MIN;
                  max = DST_RULE_DR_MAX;
                }
                else if (current_ekran.index_position == INDEX_ML_DST_HH)
                {
                  pos = POS_HH;
                  shift = SHIFT_HH;
                  
                  min = DST_RULE_HH_MIN;
                  max = DST_RULE_HH_MAX;
                }
                else
                {
                  //Теоретично цього ніколи не мало б бути
                  total_error_sw_fixed();
                }
                
                int32_t value = (*p_rule_target >> pos) & ((1 << shift) - 1);
                if (--value < (int)min) value = max;
                
                uint32_t bit_maska = ((1u << (pos + shift)) - 1) - ((1u << pos) - 1);
                *p_rule_target &= ~bit_maska;
                *p_rule_target |= value << pos;

                //Формуємо екран
                make_ekran_dst_rule(*p_rule_target);
              }
              else if(current_ekran.current_level == EKRAN_GENERAL_PICKUPS_EL)
              {
                if(current_ekran.index_position == INDEX_ML_NUMBER_INERATION)
                {
                  if ((current_ekran.position_cursor_x < COL_NUMBER_INERATION_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_NUMBER_INERATION_END))
                    current_ekran.position_cursor_x = COL_NUMBER_INERATION_END;
                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_FUNCTIONS)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_FUNCTIONS_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_FUNCTIONS_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_FUNCTIONS_END;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_TRIGGERS)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_TRIGGERS_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_TRIGGERS_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_TRIGGERS_END;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_AND)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_AND_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_AND_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_AND_END;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_OR)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_OR_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_OR_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_OR_END;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_XOR)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_XOR_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_XOR_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_XOR_END;
//                }
//                else if(current_ekran.index_position == INDEX_ML_NUMBER_DEFINED_NOT)
//                {
//                  if ((current_ekran.position_cursor_x < COL_NUMBER_DEFINED_NOT_BEGIN) ||
//                      (current_ekran.position_cursor_x > COL_NUMBER_DEFINED_NOT_END))
//                    current_ekran.position_cursor_x = COL_NUMBER_DEFINED_NOT_END;
//                }
                
                //Формуємо екран відображення загальних витримок для розширеної логіки
                make_ekran_general_pickups_el();
              }
              else if(current_ekran.current_level == EKRAN_LIST_TYPE_DF)
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.type_df ^= value;

                //Формуємо екран відображення типу опреділювальної функції
                make_ekran_type_df();
              }
              else if((current_ekran.current_level >= EKRAN_TIMEOUT_DF1) && (current_ekran.current_level <= EKRAN_TIMEOUT_DF16))
              {
                if(current_ekran.index_position == INDEX_ML_TMO_DF_PAUSE)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DF_PAUSE_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DF_PAUSE_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DF_PAUSE_END))
                    current_ekran.position_cursor_x = COL_TMO_DF_PAUSE_END;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_DF_WORK_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_DF_WORK_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_DF_WORK_END))
                    current_ekran.position_cursor_x = COL_TMO_DF_WORK_END;
                }
                //Формуємо екран таймерів опреділюваних функцій
                make_ekran_timeout_df(current_ekran.current_level - EKRAN_TIMEOUT_DF1);
              }
              else if((current_ekran.current_level >= EKRAN_LIST_SOURCE_TF1) && (current_ekran.current_level <= (EKRAN_LIST_SOURCE_TF1 + NUMBER_TRANSFER_FUNCTIONS - 1)))
              {
                int32_t index_position = current_ekran.index_position;
                int32_t value = (edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] >> (16*index_position)) & 0xffff;
                  
                if (--value < 0) value = max_value_for_tf[1 + TOTAL_NUMBER_PROTECTION - 1][index_position] - 1;
                for (intptr_t i = (TOTAL_NUMBER_PROTECTION - 1); i >= 0; i--)
                {
                  if (
                      ((current_settings.configuration & (1 << i)) == 0) &&
                      ((uint32_t)value >= max_value_for_tf[1 + i - 1][index_position]) &&
                      ((uint32_t)value <= max_value_for_tf[1 + i    ][index_position])
                     ) 
                  {
                    value = max_value_for_tf[1 + i - 1][index_position] - 1;
                  }
                }
                edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] &= (uint32_t)(~(0xffff << (16*index_position)));
                edition_settings.ranguvannja_tf[current_ekran.current_level - EKRAN_LIST_SOURCE_TF1] |= ((value & 0xffff) << (16*index_position));

                //Формуємо екран
                make_ekran_list_source_tf();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_DIGITAL_REGISTRATOR)
              {
                if(current_ekran.index_position == INDEX_ML_TMO_ELONGATION)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_ELONGATION_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_ELONGATION_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_ELONGATION_END))
                    current_ekran.position_cursor_x = COL_TMO_ELONGATION_END;
                }

                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_digital_registrator();
              }
              else if(current_ekran.current_level == EKRAN_TIMEOUT_ANALOG_REGISTRATOR)
              {
                if(current_ekran.index_position == INDEX_ML_TMOPREFAULT)
                {
                  if (current_ekran.position_cursor_x == COL_TMO_PREFAULT_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_PREFAULT_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_PREFAULT_END))
                    current_ekran.position_cursor_x = COL_TMO_PREFAULT_END;
                }
                else
                {
                  if (current_ekran.position_cursor_x == COL_TMO_POSTFAULT_COMMA )current_ekran.position_cursor_x--;
                  if ((current_ekran.position_cursor_x < COL_TMO_POSTFAULT_BEGIN) ||
                      (current_ekran.position_cursor_x > COL_TMO_POSTFAULT_END))
                    current_ekran.position_cursor_x = COL_TMO_POSTFAULT_END;
                }
                //Формуємо екран витримок аналогового реєстратора
                make_ekran_timeout_analog_registrator();
              }
              else if(current_ekran.current_level == EKRAN_CONTROL_AR)
              {
                unsigned int value = (1 << current_ekran.index_position);
          
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_ar ^= value;

                //Формуємо екран відображення
                make_ekran_control_ar();
              }
              else if(current_ekran.current_level == EKRAN_CHOSE_EXTRA_SETTINGS)
              {
                //Виділяємо, який біт треба міняти
                unsigned int maska = (1 << current_ekran.index_position);
                
                //Міняємо на протилежний відповідний біт для вибраної позиції
                edition_settings.control_extra_settings_1 ^= maska;

                //Формуємо екран відображення додаткових налаштувань
                make_ekran_chose_extra_settings();
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 

/******************************************************************************************************************************************/      
    case EKRAN_RESURS:
    case EKRAN_REPROGRAM:
      {
        //Очищаємо всі біти краім упралінських
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        if (current_ekran.current_level == EKRAN_RESURS) maska_keyboard_bits |= (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);

        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагувати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if(current_ekran.edition == 0)
            {
              if (current_ekran.current_level == EKRAN_RESURS)
              {
                if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_RESURS) current_ekran.index_position = 0;
                current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
                position_in_current_level_menu[EKRAN_RESURS] = current_ekran.index_position;
                //Формуємо екран відображення лічильників ресурсу
                make_ekran_resurs();
              }
              else
              {
                //Теоретично цього ніколи не мало б бути
                total_error_sw_fixed();
              }
            }
            else if ((current_ekran.edition == 1) || (current_ekran.edition == 2))
            {
              current_ekran.cursor_on = 0;
              current_ekran.cursor_blinking_on = 0;
              if (current_ekran.current_level == EKRAN_RESURS)
              {
                unsigned char information_about_reset_counter[1][MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  " Очистить ресурс",
                  " Очистити ресурс",
                  " Reset Res Coun ",
                  " Очистить ресурс"
                };
              
                make_ekran_about_activation_command(0, information_about_reset_counter);
              }
              else if (current_ekran.current_level == EKRAN_REPROGRAM)
              {
                unsigned char information_about_reprogram[1][MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  "Режим перепрогр.",
                  "Режим перепрогр.",
                  " Reprogram Mode ",
                  "Режим перепрогр."
                };
              
                make_ekran_about_activation_command(0, information_about_reprogram);
              }

              //Переходимо в режим введення значень у дію
              current_ekran.edition = 2;
            }

            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              if(current_ekran.edition == 0)
              {
                int temp_current_level = current_ekran.current_level;
                
                //Переходимо на меню запиту паролю скидання ресурсу вимикача
                current_ekran.current_level = EKRAN_LEVEL_PASSWORD_HARD;
                previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              else if (current_ekran.edition == 2)
              {
                if(current_ekran.current_level == EKRAN_RESURS)
                {
                  restart_counter = 0xff; /*Сигнал про очищення ресурсу лічильників з системи зазистів*/
                }
                else if (current_ekran.current_level == EKRAN_REPROGRAM)
                {
                  //Подаємо команду на перехід у режим перепрограмування
                  _SET_STATE(reprogram_device, REPROGRAM_COMMAND);
                  
                  //Переходимо у попереднє меню
                  current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }

                //Виходимо з режиму редагування
                current_ekran.edition = 0;
              }
              
              //Виставляємо біт обновлення екрану
              new_state_keyboard |= (1<<BIT_REWRITE);

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              if (
                  (current_ekran.edition == 0) || 
                  (current_ekran.current_level == EKRAN_REPROGRAM)
                 )   
              {
                //Вихід у режимі спостерігання
                //Переходимо у попереднє меню
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                current_ekran.edition = 0;
              }
              else
              {
                if (current_ekran.current_level == EKRAN_RESURS)
                {
                  //Вихід у режимі редагування без введення змін
                  current_ekran.edition = 0;
                }
                else
                {
                  //Теоретично цього ніколи не мало б бути
                  total_error_sw_fixed();
                }
              }

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(current_ekran.edition == 0)
              {
                if(current_ekran.current_level == EKRAN_RESURS)
                {
                  current_ekran.index_position -= (MAX_ROW_LCD >> 1);
                  if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_EKRAN_RESURS - 1;
                  current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
                  position_in_current_level_menu[EKRAN_RESURS] = current_ekran.index_position;
                  //Формуємо екран відображення лічильників ресурсу
                  make_ekran_resurs();
                }
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(current_ekran.edition == 0)
              {
                if(current_ekran.current_level == EKRAN_RESURS)
                {
                  current_ekran.index_position += (MAX_ROW_LCD >> 1);
                  if(current_ekran.index_position >= MAX_ROW_FOR_EKRAN_RESURS) current_ekran.index_position =  0;
                  current_ekran.index_position = (current_ekran.index_position >> (POWER_MAX_ROW_LCD - 1)) << (POWER_MAX_ROW_LCD - 1);
                  position_in_current_level_menu[EKRAN_RESURS] = current_ekran.index_position;
                  //Формуємо екран відображення лічильників ресурсу
                  make_ekran_resurs();
                }
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 

/******************************************************************************************************************************************/      
    case EKRAN_REPROGRAM_ACTIVE:
    case EKRAN_UNSUPPORT_REPROGRAM:
      {
        //Очищаємо всі біти краім упралінських
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER) | (1<<BIT_REWRITE);

        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагувати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            static uint8_t const name_string1[MAX_NAMBER_LANGUAGE][2][MAX_COL_LCD] = 
            {
              {"Режим перепрогр.", "Режим не поддерж"},
              {"Режим перепрогр.", "Режим не підтрим"},
              {" Reprogram Mode ", "Unsupported Mode"},
              {"Режим перепрогр.", "Режим не поддерж"}
            };
            
            static uint8_t const name_string2[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
            {
              "  Выйти: Enter  ",
              "  Вийти: Enter  ",
              "   Exit: Enter  ",
              "  Выйти: Enter  "
            };
            
            int index_language = index_language_in_array(current_settings.language);
            uint8_t const * const pArray[2] = 
            {
              name_string1[index_language][current_ekran.current_level == EKRAN_UNSUPPORT_REPROGRAM],
              name_string2[index_language]
            };
            for (size_t i = 0; i < MAX_ROW_LCD; ++i)
            {
              //Наступні рядки треба перевірити, чи їх требе відображати у текучій коффігурації
              if (i < 2)
              {
                for (size_t j = 0; j < MAX_COL_LCD; ++j) working_ekran[i][j] = pArray[i][j];
              } 
              else
                for (size_t j = 0; j < MAX_COL_LCD; ++j) working_ekran[i][j] = ' ';
            }

            current_ekran.cursor_on = 0;
            current_ekran.cursor_blinking_on = 0;
            current_ekran.position_cursor_x = 0;
            current_ekran.position_cursor_y = 0;
            //Обновити повністю весь екран
            current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;

            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              //Подаємо команду на перехід у режим перепрограмування
              if (current_ekran.current_level == EKRAN_REPROGRAM_ACTIVE) _SET_STATE(reprogram_device, STAFF_COMMAND);
              else _CLEAR_STATE(reprogram_device, UNSUPPORT_REPROGRAM);
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 
      
/******************************************************************************************************************************************/      
    case EKRAN_RANGUVANNJA_INPUT_1:
    case EKRAN_RANGUVANNJA_INPUT_2:
    case EKRAN_RANGUVANNJA_INPUT_3:
    case EKRAN_RANGUVANNJA_INPUT_4:
    case EKRAN_RANGUVANNJA_INPUT_5:
    case EKRAN_RANGUVANNJA_INPUT_6:
    case EKRAN_RANGUVANNJA_INPUT_7:
    case EKRAN_RANGUVANNJA_INPUT_8:

#if (                                   \
     (MODYFIKACIA_VERSII_PZ == 0) ||    \
     (MODYFIKACIA_VERSII_PZ == 1) ||    \
     (MODYFIKACIA_VERSII_PZ == 3)       \
    )

    case EKRAN_RANGUVANNJA_INPUT_9:
    case EKRAN_RANGUVANNJA_INPUT_10:
    case EKRAN_RANGUVANNJA_INPUT_11:
    case EKRAN_RANGUVANNJA_INPUT_12:
    case EKRAN_RANGUVANNJA_INPUT_13:
    case EKRAN_RANGUVANNJA_INPUT_14:
    case EKRAN_RANGUVANNJA_INPUT_15:
    case EKRAN_RANGUVANNJA_INPUT_16:
    case EKRAN_RANGUVANNJA_OUTPUT_10:
    case EKRAN_RANGUVANNJA_OUTPUT_11:
    case EKRAN_RANGUVANNJA_OUTPUT_12:
    case EKRAN_RANGUVANNJA_OUTPUT_13:
    case EKRAN_RANGUVANNJA_OUTPUT_14:
    case EKRAN_RANGUVANNJA_OUTPUT_15:
    case EKRAN_RANGUVANNJA_OUTPUT_16:

#if (MODYFIKACIA_VERSII_PZ == 0)

    case EKRAN_RANGUVANNJA_INPUT_17:
    case EKRAN_RANGUVANNJA_INPUT_18:
    case EKRAN_RANGUVANNJA_INPUT_19:
    case EKRAN_RANGUVANNJA_INPUT_20:

#endif

#endif

    case EKRAN_RANGUVANNJA_OUTPUT_1:
    case EKRAN_RANGUVANNJA_OUTPUT_2:
    case EKRAN_RANGUVANNJA_OUTPUT_3:
    case EKRAN_RANGUVANNJA_OUTPUT_4:
    case EKRAN_RANGUVANNJA_OUTPUT_5:
    case EKRAN_RANGUVANNJA_OUTPUT_6:
    case EKRAN_RANGUVANNJA_OUTPUT_7:
    case EKRAN_RANGUVANNJA_OUTPUT_8:
    case EKRAN_RANGUVANNJA_OUTPUT_9:
    case EKRAN_RANGUVANNJA_LED_1:
    case EKRAN_RANGUVANNJA_LED_2:
    case EKRAN_RANGUVANNJA_LED_3:
    case EKRAN_RANGUVANNJA_LED_4:
    case EKRAN_RANGUVANNJA_LED_5:
    case EKRAN_RANGUVANNJA_LED_6:
    case EKRAN_RANGUVANNJA_LED_7:
    case EKRAN_RANGUVANNJA_LED_8:
    case EKRAN_RANGUVANNJA_LED_9:
    case EKRAN_RANGUVANNJA_LED_10:
    case EKRAN_RANGUVANNJA_LED_11:
    case EKRAN_RANGUVANNJA_LED_12:
    case EKRAN_RANGUVANNJA_LED_13:
    case EKRAN_RANGUVANNJA_LED_14:
    case EKRAN_RANGUVANNJA_LED_15:
    case EKRAN_RANGUVANNJA_LED_16:
    case EKRAN_RANGUVANNJA_LED_17:
    case EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR:
    case EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR:
    case EKRAN_RANGUVANNJA_OFF_CB:
    case EKRAN_RANGUVANNJA_ON_CB:
    case EKRAN_RANGUVANNJA_OFF_CB_H:
    case EKRAN_RANGUVANNJA_OFF_CB_L:
    case EKRAN_RANGUVANNJA_ON_CB_H:
    case EKRAN_RANGUVANNJA_ON_CB_L:
    case EKRAN_RANGUVANNJA_DF1_PLUS:
    case EKRAN_RANGUVANNJA_DF1_MINUS:
    case EKRAN_RANGUVANNJA_DF1_BLK:
    case EKRAN_RANGUVANNJA_DF2_PLUS:
    case EKRAN_RANGUVANNJA_DF2_MINUS:
    case EKRAN_RANGUVANNJA_DF2_BLK:
    case EKRAN_RANGUVANNJA_DF3_PLUS:
    case EKRAN_RANGUVANNJA_DF3_MINUS:
    case EKRAN_RANGUVANNJA_DF3_BLK:
    case EKRAN_RANGUVANNJA_DF4_PLUS:
    case EKRAN_RANGUVANNJA_DF4_MINUS:
    case EKRAN_RANGUVANNJA_DF4_BLK:
    case EKRAN_RANGUVANNJA_DF5_PLUS:
    case EKRAN_RANGUVANNJA_DF5_MINUS:
    case EKRAN_RANGUVANNJA_DF5_BLK:
    case EKRAN_RANGUVANNJA_DF6_PLUS:
    case EKRAN_RANGUVANNJA_DF6_MINUS:
    case EKRAN_RANGUVANNJA_DF6_BLK:
    case EKRAN_RANGUVANNJA_DF7_PLUS:
    case EKRAN_RANGUVANNJA_DF7_MINUS:
    case EKRAN_RANGUVANNJA_DF7_BLK:
    case EKRAN_RANGUVANNJA_DF8_PLUS:
    case EKRAN_RANGUVANNJA_DF8_MINUS:
    case EKRAN_RANGUVANNJA_DF8_BLK:
    case EKRAN_RANGUVANNJA_DF9_PLUS:
    case EKRAN_RANGUVANNJA_DF9_MINUS:
    case EKRAN_RANGUVANNJA_DF9_BLK:
    case EKRAN_RANGUVANNJA_DF10_PLUS:
    case EKRAN_RANGUVANNJA_DF10_MINUS:
    case EKRAN_RANGUVANNJA_DF10_BLK:
    case EKRAN_RANGUVANNJA_DF11_PLUS:
    case EKRAN_RANGUVANNJA_DF11_MINUS:
    case EKRAN_RANGUVANNJA_DF11_BLK:
    case EKRAN_RANGUVANNJA_DF12_PLUS:
    case EKRAN_RANGUVANNJA_DF12_MINUS:
    case EKRAN_RANGUVANNJA_DF12_BLK:
    case EKRAN_RANGUVANNJA_DF13_PLUS:
    case EKRAN_RANGUVANNJA_DF13_MINUS:
    case EKRAN_RANGUVANNJA_DF13_BLK:
    case EKRAN_RANGUVANNJA_DF14_PLUS:
    case EKRAN_RANGUVANNJA_DF14_MINUS:
    case EKRAN_RANGUVANNJA_DF14_BLK:
    case EKRAN_RANGUVANNJA_DF15_PLUS:
    case EKRAN_RANGUVANNJA_DF15_MINUS:
    case EKRAN_RANGUVANNJA_DF15_BLK:
    case EKRAN_RANGUVANNJA_DF16_PLUS:
    case EKRAN_RANGUVANNJA_DF16_MINUS:
    case EKRAN_RANGUVANNJA_DF16_BLK:
    case EKRAN_RANGUVANNJA_SET_DT1_PLUS:
    case EKRAN_RANGUVANNJA_SET_DT1_MINUS:
    case EKRAN_RANGUVANNJA_RESET_DT1_PLUS:
    case EKRAN_RANGUVANNJA_RESET_DT1_MINUS:
    case EKRAN_RANGUVANNJA_SET_DT2_PLUS:
    case EKRAN_RANGUVANNJA_SET_DT2_MINUS:
    case EKRAN_RANGUVANNJA_RESET_DT2_PLUS:
    case EKRAN_RANGUVANNJA_RESET_DT2_MINUS:
    case EKRAN_RANGUVANNJA_SET_DT3_PLUS:
    case EKRAN_RANGUVANNJA_SET_DT3_MINUS:
    case EKRAN_RANGUVANNJA_RESET_DT3_PLUS:
    case EKRAN_RANGUVANNJA_RESET_DT3_MINUS:
    case EKRAN_RANGUVANNJA_SET_DT4_PLUS:
    case EKRAN_RANGUVANNJA_SET_DT4_MINUS:
    case EKRAN_RANGUVANNJA_RESET_DT4_PLUS:
    case EKRAN_RANGUVANNJA_RESET_DT4_MINUS:
    case EKRAN_RANGUVANNJA_D_AND1:
    case EKRAN_RANGUVANNJA_D_AND2:
    case EKRAN_RANGUVANNJA_D_AND3:
    case EKRAN_RANGUVANNJA_D_AND4:
    case EKRAN_RANGUVANNJA_D_AND5:
    case EKRAN_RANGUVANNJA_D_AND6:
    case EKRAN_RANGUVANNJA_D_AND7:
    case EKRAN_RANGUVANNJA_D_AND8:
    case EKRAN_RANGUVANNJA_D_OR1:
    case EKRAN_RANGUVANNJA_D_OR2:
    case EKRAN_RANGUVANNJA_D_OR3:
    case EKRAN_RANGUVANNJA_D_OR4:
    case EKRAN_RANGUVANNJA_D_OR5:
    case EKRAN_RANGUVANNJA_D_OR6:
    case EKRAN_RANGUVANNJA_D_OR7:
    case EKRAN_RANGUVANNJA_D_OR8:
    case EKRAN_RANGUVANNJA_D_XOR1:
    case EKRAN_RANGUVANNJA_D_XOR2:
    case EKRAN_RANGUVANNJA_D_XOR3:
    case EKRAN_RANGUVANNJA_D_XOR4:
    case EKRAN_RANGUVANNJA_D_XOR5:
    case EKRAN_RANGUVANNJA_D_XOR6:
    case EKRAN_RANGUVANNJA_D_XOR7:
    case EKRAN_RANGUVANNJA_D_XOR8:
    case EKRAN_RANGUVANNJA_D_NOT1:
    case EKRAN_RANGUVANNJA_D_NOT2:
    case EKRAN_RANGUVANNJA_D_NOT3:
    case EKRAN_RANGUVANNJA_D_NOT4:
    case EKRAN_RANGUVANNJA_D_NOT5:
    case EKRAN_RANGUVANNJA_D_NOT6:
    case EKRAN_RANGUVANNJA_D_NOT7:
    case EKRAN_RANGUVANNJA_D_NOT8:
    case EKRAN_RANGUVANNJA_D_NOT9:
    case EKRAN_RANGUVANNJA_D_NOT10:
    case EKRAN_RANGUVANNJA_D_NOT11:
    case EKRAN_RANGUVANNJA_D_NOT12:
    case EKRAN_RANGUVANNJA_D_NOT13:
    case EKRAN_RANGUVANNJA_D_NOT14:
    case EKRAN_RANGUVANNJA_D_NOT15:
    case EKRAN_RANGUVANNJA_D_NOT16:
    case EKRAN_RANGUVANNJA_BUTTON_1:
    case EKRAN_RANGUVANNJA_BUTTON_2:
    case EKRAN_RANGUVANNJA_BUTTON_3:
    case EKRAN_RANGUVANNJA_BUTTON_4:
    case EKRAN_RANGUVANNJA_BUTTON_5:
    case EKRAN_RANGUVANNJA_BUTTON_6:
      {
        //Очищаємо всі біти краім упралінських
        unsigned int maska_keyboard_bits = (1<<BIT_KEY_ENTER)| (1<<BIT_KEY_ESC)|(1<<BIT_REWRITE);
        
        if (current_ekran.edition == 1)
          maska_keyboard_bits |= (1<<BIT_KEY_RIGHT) | (1<<BIT_KEY_LEFT) | (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        else if (current_ekran.edition == 0)
          maska_keyboard_bits |= (1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN);
        
        new_state_keyboard &= maska_keyboard_bits;
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if(
               ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6)) ||
               ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1 ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
              )   
            {
              int max_row_ranguvannja = 0;
              
              if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_BUTTON;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_INPUT;
            else total_error_sw_fixed();  

              if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
              if(current_ekran.edition == 0)
              {
                unsigned int temp_state[N_SMALL];
                unsigned int not_null = false;
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                {
                  for (size_t i = 0; i < N_SMALL; ++i) 
                  {
                    temp_state[i] = current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                {
                  for (size_t i = 0; i < N_SMALL; ++i) 
                  {
                    temp_state[i] = current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                
                if (not_null == false) current_ekran.index_position = 0;
                else
                {
                  // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                  // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                  while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) == 0)
                  {
                    current_ekran.index_position++;
                    if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                  }
                }
              }
              else
              {
                unsigned int found_new_index = 0;
//                int add_filter[0 + 1] = 
//                {
//                  -1 /*признак завершення масиву*/
//                };
                
                //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                while (found_new_index == 0)
                {
                    check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                     /*add_filter,*/
                                                                     /*el_filter,*/
                                                                     1,
                                                                     TOTAL_GENERAL_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_DZO_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_MTZ_STUB_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_ZDZ_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_MCZO_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_MCZR_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_APV_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_ACHR_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_UROV_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_DZR_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_UMIN_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_UMAX_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_UP_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_VMP_SIGNAL_FOR_RANG_SMALL,
                                                                     TOTAL_EL_SIGNAL_FOR_RANG_SMALL
                                                                    );
                  
                    //Перевіряємо режим рооботи функціональної кнопки (якщо іде редагування ФК)
                    if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                    {
                      uint32_t mode = (current_settings.buttons_mode >> (current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1)) & 0x1;
                      if (_CHECK_SET_BIT(buttons_mode[mode], current_ekran.index_position) == 0)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    
                    //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                    if(current_ekran.index_position >= max_row_ranguvannja)
                    {
                      found_new_index = 0;
                      current_ekran.index_position = 0;
                    }
                }
              }
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран відображення зранжованих функцій
              if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_BUTTON);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_INPUT); //!   BOOK MARK1 ---/
            }
            else if(
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST        )) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1   ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17             )) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR                                                                 ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR                                                                ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB                                                                             ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB                                                                              ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H                                                                           ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L                                                                           ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H                                                                            ) ||
                    ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L                                                                            ) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK           )) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS)) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8         )) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1       ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8          )) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8         )) ||
                    ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16        ))
                   )
            {
              int max_row_ranguvannja = 0;
              
              if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OUTPUT;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_LED;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ANALOG_REGISTRATOR;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DIGITAL_REGISTRATOR;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OFF_CB;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ON_CB;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                max_row_ranguvannja = TOTAL_SIGNAL_FOR_RNG_BIG;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                max_row_ranguvannja = TOTAL_SIGNAL_FOR_RNG_BIG;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                max_row_ranguvannja = TOTAL_SIGNAL_FOR_RNG_BIG;
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                max_row_ranguvannja = TOTAL_SIGNAL_FOR_RNG_BIG;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DF;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DT;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_AND;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_OR;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_XOR;
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_NOT;
              else total_error_sw_fixed();
                
              if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
              if(current_ekran.edition == 0)
              {
                unsigned int temp_state[N_BIG];
                unsigned int not_null = false;
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ )
                  {
                    temp_state[i] = current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_analog_registrator[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_digital_registrator[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_off_cb[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_on_cb[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_off_cb_oh[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_off_cb_rl[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_on__cb_oh[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_on__cb_rl[i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 3;
                  unsigned int index_of_df = index_in_ekran_list / 3;
    
                  if(type_source == 0)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++ ) 
                    {
                      temp_state[i] = current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df+i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if(type_source == 1)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++ ) 
                    {
                      temp_state[i] = current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df+i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else
                  {
                    for (unsigned int i = 0; i < N_BIG; i++ ) 
                    {
                      temp_state[i] = current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df+i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 2;
                  unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                  unsigned int index_of_dt = index_in_ekran_list / 4;
    
                  if (type_of_action == INDEX_ML_SET_DT)
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++ ) 
                      {
                        temp_state[i] = current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt+i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++ )
                      {
                        temp_state[i] = current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt+i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                  }
                  else
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++ ) 
                      {
                        temp_state[i] = current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt+i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++ ) 
                      {
                        temp_state[i] = current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt+i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                  }                    
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ ) 
                  {
                    temp_state[i] = current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                {
                  for (unsigned int i = 0; i < N_BIG; i++ )
                  {
                    temp_state[i] = current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1)+i];
                    not_null |= (temp_state[i] != 0);
                  }
                }

                if (not_null == false) current_ekran.index_position = 0;
                else
                {
                  // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                  // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                  while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) ==0)
                  {
                    current_ekran.index_position++;
                    if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                  }
                }
              }
              else
              {
                unsigned int found_new_index = 0;
//                int add_filter[3 + 1] = 
//                {
//                  RANG_PO_NZZ,
//                  RANG_NZZ,
//                  RANG_SECTOR_NZZ,
//                  -1 /*признак завершення масиву*/
//                };
                
                //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                while (found_new_index == 0)
                {
                  check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                     /*add_filter,*/
                                                                     /*el_filter,*/
                                                                     1,
                                                                     TOTAL_GENERAL_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_DZO_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_MTZ_STUB_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_ZDZ_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_MCZO_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_MCZR_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_APV_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_ACHR_CHAPV_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_UROV_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_DZR_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_UMIN_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_UMAX_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_UP_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_VMP_SIGNAL_FOR_RNG_BIG,
                                                                     TOTAL_EL_SIGNAL_FOR_RNG_BIG
                                                                    );
                  
                  //Перевіряємо, чи ми не  на індексі функцій із списку загальних, яку треба викинути для даного типу ранжування
                  if (
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR ) ||   
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB             ) ||   
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB              ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H           ) ||   
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H            ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L           ) ||   
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L            )                         
                     )   
                  {
                    unsigned int index_deleted_function = 0;

                    if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                      index_deleted_function = RNG_BIG_WORK_A_REJESTRATOR;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                      index_deleted_function = RNG_BIG_WORK_D_REJESTRATOR;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                      index_deleted_function = RNG_BIG_WORK_BO_VVO;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                      index_deleted_function = RNG_BIG_WORK_BV_VVO;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                      index_deleted_function = RNG_BIG_WORK_BO_VVO;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                      index_deleted_function = RNG_BIG_WORK_BV_VVO;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                      index_deleted_function = RNG_BIG_WORK_BO_VVR;
                    else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                      index_deleted_function = RNG_BIG_WORK_BV_VVR;
                    else total_error_sw_fixed();
                    
                    if(index_deleted_function == current_ekran.index_position)
                    {
                      found_new_index = 0;
                      current_ekran.index_position++;
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                    unsigned int index_of_df = index_in_ekran_list / 3;

                    for (unsigned int i = 0; i < 2; i++)
                    {
                      unsigned int index_deleted_function;
                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      if (i == 0)
                      {
                        //!@if(index_of_df == 0)
                        //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_IN : RANG_DF1_OUT;
                        //!@else if(index_of_df == 1)
                        //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_IN : RANG_DF2_OUT;
                        //!@else if(index_of_df == 2)
                        //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_IN : RANG_DF3_OUT;
                        //!@else if(index_of_df == 3)
                        //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_IN : RANG_DF4_OUT;
                        //!@else if(index_of_df == 4)
                        //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_IN : RANG_DF5_OUT;
                        //!@else if(index_of_df == 5)
                        //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_IN : RANG_DF6_OUT;
                        //!@else if(index_of_df == 6)
                        //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_IN : RANG_DF7_OUT;
                        //!@else if(index_of_df == 7)
                        //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_IN : RANG_DF8_OUT;
                        //!@else if(index_of_df == 8)
                        //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_IN : RANG_DF9_OUT;
                        //!@else if(index_of_df == 9)
                        //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_IN : RANG_DF10_OUT;
                        //!@else if(index_of_df == 10)
                        //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_IN : RANG_DF11_OUT;
                        //!@else if(index_of_df == 11)
                        //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_IN : RANG_DF12_OUT;
                        //!@else if(index_of_df == 12)
                        //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_IN : RANG_DF13_OUT;
                        //!@else if(index_of_df == 13)
                        //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_IN : RANG_DF14_OUT;
                        //!@else if(index_of_df == 14)
                        //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_IN : RANG_DF15_OUT;
                        //!@else 
                        //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_IN : RANG_DF16_OUT;
                      if(index_of_df == 0)
                          index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_IN : RNG_BIG_DF1_OUT;
                        else if(index_of_df == 1)
                          index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_IN : RNG_BIG_DF2_OUT;
                        else if(index_of_df == 2)
                          index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_IN : RNG_BIG_DF3_OUT;
                        else if(index_of_df == 3)
                          index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_IN : RNG_BIG_DF4_OUT;
                        else if(index_of_df == 4)
                          index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_IN : RNG_BIG_DF5_OUT;
                        else if(index_of_df == 5)
                          index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_IN : RNG_BIG_DF6_OUT;
                        else if(index_of_df == 6)
                          index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_IN : RNG_BIG_DF7_OUT;
                        else if(index_of_df == 7)
                          index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_IN : RNG_BIG_DF8_OUT;
                        else if(index_of_df == 8)
                          index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_IN : RNG_BIG_DF9_OUT;
                        else if(index_of_df == 9)
                          index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_IN : RNG_BIG_DF10_OUT;
                        else if(index_of_df == 10)
                          index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_IN : RNG_BIG_DF11_OUT;
                        else if(index_of_df == 11)
                          index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_IN : RNG_BIG_DF12_OUT;
                        else if(index_of_df == 12)
                          index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_IN : RNG_BIG_DF13_OUT;
                        else if(index_of_df == 13)
                          index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_IN : RNG_BIG_DF14_OUT;
                        else if(index_of_df == 14)
                          index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_IN : RNG_BIG_DF15_OUT;
                        else 
                          index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_IN : RNG_BIG_DF16_OUT;
                      }
                      else
                      {
                        //!@if(index_of_df == 0)
                        //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_OUT : RANG_DF1_IN;
                        //!@else if(index_of_df == 1)
                        //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_OUT : RANG_DF2_IN;
                        //!@else if(index_of_df == 2)
                        //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_OUT : RANG_DF3_IN;
                        //!@else if(index_of_df == 3)
                        //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_OUT : RANG_DF4_IN;
                        //!@else if(index_of_df == 4)
                        //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_OUT : RANG_DF5_IN;
                        //!@else if(index_of_df == 5)
                        //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_OUT : RANG_DF6_IN;
                        //!@else if(index_of_df == 6)
                        //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_OUT : RANG_DF7_IN;
                        //!@else if(index_of_df == 7)
                        //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_OUT : RANG_DF8_IN;
                        //!@else if(index_of_df == 8)
                        //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_OUT : RANG_DF9_IN;
                        //!@else if(index_of_df == 9)
                        //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_OUT : RANG_DF10_IN;
                        //!@else if(index_of_df == 10)
                        //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_OUT : RANG_DF11_IN;
                        //!@else if(index_of_df == 11)
                        //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_OUT : RANG_DF12_IN;
                        //!@else if(index_of_df == 12)
                        //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_OUT : RANG_DF13_IN;
                        //!@else if(index_of_df == 13)
                        //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_OUT : RANG_DF14_IN;
                        //!@else if(index_of_df == 14)
                        //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_OUT : RANG_DF15_IN;
                        //!@else
                        //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_OUT : RANG_DF16_IN;
                      if(index_of_df == 0)
                          index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_OUT : RNG_BIG_DF1_IN;
                        else if(index_of_df == 1)
                          index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_OUT : RNG_BIG_DF2_IN;
                        else if(index_of_df == 2)
                          index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_OUT : RNG_BIG_DF3_IN;
                        else if(index_of_df == 3)
                          index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_OUT : RNG_BIG_DF4_IN;
                        else if(index_of_df == 4)
                          index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_OUT : RNG_BIG_DF5_IN;
                        else if(index_of_df == 5)
                          index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_OUT : RNG_BIG_DF6_IN;
                        else if(index_of_df == 6)
                          index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_OUT : RNG_BIG_DF7_IN;
                        else if(index_of_df == 7)
                          index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_OUT : RNG_BIG_DF8_IN;
                        else if(index_of_df == 8)
                          index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_OUT : RNG_BIG_DF9_IN;
                        else if(index_of_df == 9)
                          index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_OUT : RNG_BIG_DF10_IN;
                        else if(index_of_df == 10)
                          index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_OUT : RNG_BIG_DF11_IN;
                        else if(index_of_df == 11)
                          index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_OUT : RNG_BIG_DF12_IN;
                        else if(index_of_df == 12)
                          index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_OUT : RNG_BIG_DF13_IN;
                        else if(index_of_df == 13)
                          index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_OUT : RNG_BIG_DF14_IN;
                        else if(index_of_df == 14)
                          index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_OUT : RNG_BIG_DF15_IN;
                        else
                          index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_OUT : RNG_BIG_DF16_IN;
                      }
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                    unsigned int index_of_dt = index_in_ekran_list / 4;

                    for (unsigned int i = 0; i < 3; i++)
                    {
                      unsigned int index_deleted_function = 0;
                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      if (i == 0)
                      {
                      if(index_of_dt == 0)
                          index_deleted_function = RNG_BIG_DT1_SET;
                        else if(index_of_dt == 1)
                          index_deleted_function = RNG_BIG_DT2_SET;
                        else if(index_of_dt == 2)
                          index_deleted_function = RNG_BIG_DT3_SET;
                        else if(index_of_dt == 3)
                          index_deleted_function = RNG_BIG_DT4_SET;
                        else total_error_sw_fixed();
                      }
                      else if (i == 1)
                      {
                        if(index_of_dt == 0)
                          index_deleted_function = RNG_BIG_DT1_RESET;
                        else if(index_of_dt == 1)
                          index_deleted_function = RNG_BIG_DT2_RESET;
                        else if(index_of_dt == 2)
                          index_deleted_function = RNG_BIG_DT3_RESET;
                        else if(index_of_dt == 3)
                          index_deleted_function = RNG_BIG_DT4_RESET;
                        else total_error_sw_fixed();
                      }
                      else
                      {
                        //!@if(index_of_dt == 0)
                        //!@  index_deleted_function = RANG_DT1_OUT;
                        //!@else if(index_of_dt == 1)
                        //!@  index_deleted_function = RANG_DT2_OUT;
                        //!@else if(index_of_dt == 2)
                        //!@  index_deleted_function = RANG_DT3_OUT;
                        //!@else if(index_of_dt == 3)
                        //!@  index_deleted_function = RANG_DT4_OUT;
                        if(index_of_dt == 0)
                          index_deleted_function = RNG_BIG_DT1_OUT;
                        else if(index_of_dt == 1)
                          index_deleted_function = RNG_BIG_DT2_OUT;
                        else if(index_of_dt == 2)
                          index_deleted_function = RNG_BIG_DT3_OUT;
                        else if(index_of_dt == 3)
                          index_deleted_function = RNG_BIG_DT4_OUT;
                      }
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  {
                    unsigned int index_of_d_and = current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1;

                    //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                    //!@unsigned int index_deleted_function = @RANG_D_AND1 + index_of_d_and;
                    unsigned int index_deleted_function = RNG_BIG_D_AND1 + index_of_d_and;
                    
                    if(index_deleted_function == current_ekran.index_position)
                    {
                      found_new_index = 0;
                      current_ekran.index_position++;
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  {
                    unsigned int index_of_d_or = current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1;

                    //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                    //!@unsigned int index_deleted_function = @RANG_D_OR1 + index_of_d_or;
                    unsigned int index_deleted_function = RNG_BIG_D_OR1 + index_of_d_or;
                    
                    if(index_deleted_function == current_ekran.index_position)
                    {
                      found_new_index = 0;
                      current_ekran.index_position++;
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  {
                    unsigned int index_of_d_xor = current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1;

                    //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                    //!@unsigned int index_deleted_function = @RANG_D_XOR1 + index_of_d_xor;
                    unsigned int index_deleted_function = RNG_BIG_D_XOR1 + index_of_d_xor;
                    
                    if(index_deleted_function == current_ekran.index_position)
                    {
                      found_new_index = 0;
                      current_ekran.index_position++;
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  {
                    unsigned int index_of_d_not = current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1;

                    //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                    //!@unsigned int index_deleted_function = @RANG_D_NOT1 + index_of_d_not;
                    unsigned int index_deleted_function = RNG_BIG_D_NOT1 + index_of_d_not;
                    
                    if(index_deleted_function == current_ekran.index_position)
                    {
                      found_new_index = 0;
                      current_ekran.index_position++;
                    }
                  }

                  //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                  if(current_ekran.index_position >= max_row_ranguvannja)
                  {
                    found_new_index = 0;
                    current_ekran.index_position = 0;
                  }
                }
              }
              position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
              //Формуємо екран відображення зранжованих функцій
              if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OUTPUT);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_LED);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_A_REG);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_REG);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_H);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_H);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_L);
              else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_L);
              
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DF);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DT);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_AND);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_OR);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_XOR);
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_NOT);
            }
            
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Натиснута кнопка ENTER
              if(current_ekran.edition == 0)
              {
                //Копіюємо ранжування у структуру для редагування
                if((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                {
                  for (unsigned int i = 0; i < N_SMALL; i++)
                  {
                    edition_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i] =
                      current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                {
                  for (unsigned int i = 0; i < N_SMALL; i++)
                  {
                    edition_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i] =
                      current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i] =
                      current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i] =
                      current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_analog_registrator[i] = current_settings.ranguvannja_analog_registrator[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_digital_registrator[i] = current_settings.ranguvannja_digital_registrator[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_off_cb[i] = current_settings.ranguvannja_off_cb[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_on__cb_oh[i] = current_settings.ranguvannja_on__cb_oh[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_off_cb_oh[i] = current_settings.ranguvannja_off_cb_oh[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_on__cb_oh[i] = current_settings.ranguvannja_on__cb_oh[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_off_cb_rl[i] = current_settings.ranguvannja_off_cb_rl[i];
                  }
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_on__cb_rl[i] = current_settings.ranguvannja_on__cb_rl[i];
                  }
                }
                
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 3;
                  unsigned int index_of_df = index_in_ekran_list / 3;
    
                  if(type_source == 0)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      edition_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i] = current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i];
                    }
                  }
                  else if(type_source == 1)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      edition_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i] = current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i];
                    }
                  }
                  else
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      edition_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i] = current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i];
                    }
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 2;
                  unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                  unsigned int index_of_dt = index_in_ekran_list / 4;
    
                  if (type_of_action == INDEX_ML_SET_DT)
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        edition_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i] = current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i];
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        edition_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i] = current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i];
                      }
                    }
                  }
                  else
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        edition_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i] = current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i];
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        edition_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i] = current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i];
                      }
                    }
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i] =
                      current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i] =
                      current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i] =
                      current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i];
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                {
                  for (unsigned int i = 0; i < N_BIG; i++)
                  {
                    edition_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i] =
                      current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i];
                  }
                }
                  
                //Підготовка до режиму редагування - включаємо мигаючий курсор
                int temp_current_level = current_ekran.current_level;
                current_ekran.cursor_on = 1;
                current_ekran.cursor_blinking_on = 1;
                if (current_settings.password1 != 0)
                {
                  //Переходимо на меню запиту паролю
                  current_ekran.current_level = EKRAN_LEVEL_PASSWORD;
                  previous_level_in_current_level_menu[current_ekran.current_level] = temp_current_level;
                  current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
                }
                else
                {
                  //Переходимо у режим редагування
                  current_ekran.edition = 1;
                }
              }
              else if (current_ekran.edition == 1)
              {
                //Перевіряємо чи якісь зміни відбулися
                unsigned int not_equal = false;
                if((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                {
                  for (size_t i = 0; i < N_SMALL; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i] != current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                {
                  for (size_t i = 0; i < N_SMALL; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i] != current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i] != current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i] != current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_analog_registrator[i] != current_settings.ranguvannja_analog_registrator[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_digital_registrator[i] != current_settings.ranguvannja_digital_registrator[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_off_cb[i] != current_settings.ranguvannja_off_cb[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_on_cb[i] != current_settings.ranguvannja_on_cb[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                {
                   for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_off_cb_oh[i] != current_settings.ranguvannja_off_cb_oh[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_on__cb_oh[i] != current_settings.ranguvannja_on__cb_oh[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                {
                   for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_off_cb_rl[i] != current_settings.ranguvannja_off_cb_rl[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                {
                   for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_on__cb_rl[i] != current_settings.ranguvannja_on__cb_rl[i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                    
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 3;
                  unsigned int index_of_df = index_in_ekran_list / 3;
    
                  if(type_source == 0)
                  {
                    for (size_t i = 0; i < N_BIG; ++i)
                    {
                      not_equal |= (edition_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i] != current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i]);
                    }
                    if (not_equal == false) current_ekran.edition = 0;
                    else current_ekran.edition = 2;
                  }
                  else if(type_source == 1)
                  {
                    for (size_t i = 0; i < N_BIG; ++i)
                    {
                      not_equal |= (edition_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i] != current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i]);
                    }
                    if (not_equal == false) current_ekran.edition = 0;
                    else current_ekran.edition = 2;
                  }
                  else
                  {
                    for (size_t i = 0; i < N_BIG; ++i)
                    {
                      not_equal |= (edition_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i] != current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i]);
                    }
                    if (not_equal == false) current_ekran.edition = 0;
                    else current_ekran.edition = 2;
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 2;
                  unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                  unsigned int index_of_dt = index_in_ekran_list / 4;
    
                  if (type_of_action == INDEX_ML_SET_DT)
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (size_t i = 0; i < N_BIG; ++i)
                      {
                        not_equal |= (edition_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i] != current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i]);
                      }
                      if (not_equal == false) current_ekran.edition = 0;
                      else current_ekran.edition = 2;
                    }
                    else
                    {
                      for (size_t i = 0; i < N_BIG; ++i)
                      {
                        not_equal |= (edition_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i] != current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i]);
                      }
                      if (not_equal == false) current_ekran.edition = 0;
                      else current_ekran.edition = 2;
                    }
                  }
                  else
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    {
                      for (size_t i = 0; i < N_BIG; ++i)
                      {
                        not_equal |= (edition_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i] != current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i]);
                      }
                      if (not_equal == false) current_ekran.edition = 0;
                      else current_ekran.edition = 2;
                    }
                    else
                    {
                      for (size_t i = 0; i < N_BIG; ++i)
                      {
                        not_equal |= (edition_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i] != current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i]);
                      }
                      if (not_equal == false) current_ekran.edition = 0;
                      else current_ekran.edition = 2;
                    }
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i] != current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i] != current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i] != current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                {
                  for (size_t i = 0; i < N_BIG; ++i)
                  {
                    not_equal |= (edition_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i] != current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i]);
                  }
                  if (not_equal == false) current_ekran.edition = 0;
                  else current_ekran.edition = 2;
                }

                current_ekran.cursor_on = 0;
                current_ekran.cursor_blinking_on = 0;
              }
              else if (current_ekran.edition == 2)
              {
                //Попередньо виставляємо повідомлення, що дані не достовірні
                current_ekran.edition = 3;
                //Обновляємо значення
                if((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                {
                  unsigned int* point = edition_settings.ranguvannja_inputs;
                  if (count_number_set_bit(
                                           (point + N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1)),
                                           TOTAL_SIGNAL_FOR_RANG_SMALL_A01
                                          ) <= MAX_FUNCTIONS_IN_INPUT)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i] = 
                      edition_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                {
                  unsigned int* point = edition_settings.ranguvannja_buttons;
                  if (count_number_set_bit(
                                           (point + N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1)),
                                           TOTAL_SIGNAL_FOR_RANG_SMALL_A01
                                          ) <= MAX_FUNCTIONS_IN_DB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i] = 
                      edition_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i];
                    }
                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                {
                  unsigned int* point = edition_settings.ranguvannja_outputs;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_OUTPUT)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i] = 
                      edition_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                {
                  unsigned int* point = edition_settings.ranguvannja_leds;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_LED)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i] = 
                      edition_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                {
                  unsigned int* point = edition_settings.ranguvannja_analog_registrator;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_AREG)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_analog_registrator[i] = edition_settings.ranguvannja_analog_registrator[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                {
                  unsigned int* point = edition_settings.ranguvannja_digital_registrator;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_DREG)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_digital_registrator[i] = edition_settings.ranguvannja_digital_registrator[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                {
                  unsigned int* point = edition_settings.ranguvannja_off_cb;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_OFF_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_off_cb[i] = edition_settings.ranguvannja_off_cb[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                {
                  unsigned int* point = edition_settings.ranguvannja_on_cb;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_ON_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_on_cb[i] = edition_settings.ranguvannja_on_cb[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                {
                  unsigned int* point = edition_settings.ranguvannja_off_cb_oh;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_OFF_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_off_cb_oh[i] = edition_settings.ranguvannja_off_cb_oh[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                {
                  unsigned int* point = edition_settings.ranguvannja_on__cb_oh;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_ON_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_on__cb_oh[i] = edition_settings.ranguvannja_on__cb_oh[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                {
                  unsigned int* point = edition_settings.ranguvannja_off_cb_rl;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_OFF_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_off_cb_rl[i] = edition_settings.ranguvannja_off_cb_rl[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                {
                  unsigned int* point = edition_settings.ranguvannja_on__cb_rl;
                  if (count_number_set_bit(
                                           point,
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_ON_CB)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_on__cb_rl[i] = edition_settings.ranguvannja_on__cb_rl[i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 3;
                  unsigned int index_of_df = index_in_ekran_list / 3;
    
                  unsigned int* point;
                  
                  if(type_source == 0)
                    point = edition_settings.ranguvannja_df_source_plus;
                  else if(type_source == 1)
                    point = edition_settings.ranguvannja_df_source_minus;
                  else 
                    point = edition_settings.ranguvannja_df_source_blk;

                  if (count_number_set_bit(
                                           (point + N_BIG*index_of_df),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_DF)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    if(type_source == 0)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i] = edition_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i];
                      }
                    }
                    else if(type_source == 1)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i] = edition_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i];
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i] = edition_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i];
                      }
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                {
                  unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                  unsigned int type_source = index_in_ekran_list % 2;
                  unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                  unsigned int index_of_dt = index_in_ekran_list / 4;
    
                  unsigned int* point;
                  
                  if (type_of_action == INDEX_ML_SET_DT)
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      point = edition_settings.ranguvannja_set_dt_source_plus;
                    else
                      point = edition_settings.ranguvannja_set_dt_source_minus;
                  }
                  else
                  {
                    if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      point = edition_settings.ranguvannja_reset_dt_source_plus;
                    else
                      point = edition_settings.ranguvannja_reset_dt_source_minus;
                  }

                  if (count_number_set_bit(
                                           (point + N_BIG*index_of_dt),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_DT)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    if (type_of_action == INDEX_ML_SET_DT)
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i] = edition_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i];
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i] = edition_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i];
                        }
                      }
                    }
                    else
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i] = edition_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i];
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i] = edition_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i];
                        }
                      }
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                {
                  unsigned int* point = edition_settings.ranguvannja_d_and;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_D_AND)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i] = 
                      edition_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                {
                  unsigned int* point = edition_settings.ranguvannja_d_or;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_D_OR)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i] = 
                      edition_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                {
                  unsigned int* point = edition_settings.ranguvannja_d_xor;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_D_XOR)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i] = 
                      edition_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
                else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                {
                  unsigned int* point = edition_settings.ranguvannja_d_not;
                  if (count_number_set_bit(
                                           (point + N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1)),
                                           TOTAL_SIGNAL_FOR_RNG_BIG
                                          ) <= MAX_FUNCTIONS_IN_D_NOT)
                  {
                    //Помічаємо, що поле структури зараз буде змінене
                    changed_settings = CHANGED_ETAP_EXECUTION;

                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i] = 
                      edition_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i];
                    }

                    //Формуємо запис у таблиці настройок про зміну конфігурації і ініціюємо запис у EEPROM нових настройок
                    fix_change_settings(1, 1);
                    //Виходимо з режиму редагування
                    current_ekran.edition = 0;
                  }
                }
              }
              else if (current_ekran.edition == 3)
              {
                //Вихід у режимі редагування
                current_ekran.edition = 0;
              }
              
              if(current_ekran.edition == 2) make_ekran_ask_rewrite();
              else if(current_ekran.edition == 3)
              {
                static const unsigned char information_about_error[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
                {
                  "Прев.макс.кол.ф.",
                  "Переб.макс.кіл.ф",
                  " Max.n.of F.Exc.",
                  "Прев.макс.кол.ф."
                };
                make_ekran_about_error(information_about_error);
              }
              else
                //Виставляємо біт обновлення екрану
                new_state_keyboard |= (1<<BIT_REWRITE);

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
            {
              if(current_ekran.edition == 0)
              {
                //Вихід у режимі спостерігання
                //Переходимо у попереднє меню
                current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
                current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
              }
              //Інекше переходдимо у режим спостерігання
              current_ekran.edition = 0;

              //Виставляємо команду на обновлекння нового екрану
              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(
                 ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6)) ||
                 ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1 ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                )
              {
                int max_row_ranguvannja = 0;
                
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_BUTTON;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_INPUT;
                else total_error_sw_fixed();

                if(current_ekran.edition == 0)
                {
                  unsigned int temp_state[N_SMALL];
                  unsigned int not_null = false;

                  if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  {
                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  {
                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }

                  if (not_null == false)  current_ekran.index_position = 0;
                  else
                  {
                    if(--current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                    // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                    // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                    while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) == 0)
                    {
                      current_ekran.index_position--;
                      if(current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                    }
                  }
                }
                else
                {
                  //Редагування
                  unsigned int found_new_index = 0;
//                  int add_filter[0 + 1] = 
//                  {
//                    -1 /*признак завершення масиву*/
//                  };
                
                  //Переміщаємося на наступну функцію
                  if(--current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                  //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                  while (found_new_index == 0)
                  {
                    check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                       /*add_filter,*/
                                                                       /*el_filter,*/
                                                                       0,
                                                                       TOTAL_GENERAL_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_DZO_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MTZ_STUB_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_ZDZ_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MCZO_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MCZR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_APV_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_ACHR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UROV_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_DZR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UMIN_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UMAX_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UP_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_VMP_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_EL_SIGNAL_FOR_RANG_SMALL
                                                                      );

                    //Перевіряємо режим рооботи функціональної кнопки (якщо іде редагування ФК)
                    if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                    {
                      uint32_t mode = (current_settings.buttons_mode >> (current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1)) & 0x1;
                      if (_CHECK_SET_BIT(buttons_mode[mode], current_ekran.index_position) == 0)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    
                    //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                    if(current_ekran.index_position < 0)
                    {
                      found_new_index = 0;
                      current_ekran.index_position = max_row_ranguvannja - 1;
                    }
                  }
                }
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                
                //Формуємо екран відображення зранжованих функцій
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_BUTTON);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_INPUT);
              }
              else if(
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST          )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1   ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17             )) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR                                                                 ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR                                                                ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB                                                                             ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB                                                                              ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H                                                                           ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H                                                                            ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L                                                                           ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L                                                                            ) ||
                      
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK           )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS)) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8         )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1       ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8          )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8         )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16        ))
                     )
              {
                int max_row_ranguvannja = 0;
                
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OUTPUT;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_LED;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ANALOG_REGISTRATOR;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DIGITAL_REGISTRATOR;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OFF_CB;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ON_CB;
                else if ((current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H) || (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OFF_CB;
                else if ((current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H) || (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ON_CB;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DF;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DT;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_AND;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_OR;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_XOR;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_NOT;
                else total_error_sw_fixed();

                if(current_ekran.edition == 0)
                {
                  unsigned int temp_state[N_BIG];
                  unsigned int not_null = false;

                  
                  if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_analog_registrator[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_digital_registrator[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on_cb[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb_oh[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on__cb_oh[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb_rl[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on__cb_rl[i];
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                    unsigned int type_source = index_in_ekran_list % 3;
                    unsigned int index_of_df = index_in_ekran_list / 3;
    
                    if(type_source == 0)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else if(type_source == 1)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                    unsigned int type_source = index_in_ekran_list % 2;
                    unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                    unsigned int index_of_dt = index_in_ekran_list / 4;
    
                    if (type_of_action == INDEX_ML_SET_DT)
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                    }
                    else
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  
                  if (not_null == false) current_ekran.index_position = 0;
                  else
                  {
                    if(--current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                    // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                    // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                    while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) == 0)
                    {
                      current_ekran.index_position--;
                      if(current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                    }
                  }
                }
                else
                {
                  //Редагування
                  unsigned int found_new_index = 0;
//                  int add_filter[3 + 1] = 
//                  {
//                    RANG_PO_NZZ,
//                    RANG_NZZ,
//                    RANG_SECTOR_NZZ,
//                    -1 /*признак завершення масиву*/
//                  };
                  
                  //Переміщаємося на наступну функцію
                  if(--current_ekran.index_position < 0) current_ekran.index_position = max_row_ranguvannja - 1;
                  //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                  while (found_new_index == 0)
                  {
                    check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                       /*add_filter,*/
                                                                       /*el_filter,*/
                                                                       0,
                                                                       TOTAL_GENERAL_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_DZO_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MTZ_STUB_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_ZDZ_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MCZO_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MCZR_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_APV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_ACHR_CHAPV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UROV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_DZR_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UMIN_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UMAX_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UP_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_VMP_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_EL_SIGNAL_FOR_RNG_BIG
                                                                      );
                    //Перевіряємо, чи ми не  на індексі функцій із списку загальних, яку треба викинути для даного типу ранжування
                    if (
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR) ||
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB             ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB              ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H           ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H            ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L           ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L            )  
                                       
                       )   
                    {
                      unsigned int index_deleted_function = 0;
                      
                      if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                        index_deleted_function = RNG_BIG_WORK_A_REJESTRATOR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                        index_deleted_function = RNG_BIG_WORK_D_REJESTRATOR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                        index_deleted_function = RNG_BIG_WORK_BO_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                        index_deleted_function = RNG_BIG_WORK_BV_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                        index_deleted_function = RNG_BIG_WORK_BO_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                        index_deleted_function = RNG_BIG_WORK_BV_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                        index_deleted_function = RNG_BIG_WORK_BO_VVR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                        index_deleted_function = RNG_BIG_WORK_BV_VVR;
                      else total_error_sw_fixed();
                    
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK))
                    {
                      unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                      unsigned int index_of_df = index_in_ekran_list / 3;

                      for (unsigned int i = 0; i < 2; i++)
                      {
                        unsigned int index_deleted_function;
                        //Першою перевіряємо функцію з більшим номером, щоб за одну операцію циклу можна було переміститися на функцію, яку можна ранжувати
                        if (i == 0)
                        {
                          //!@if(index_of_df == 0)
                          //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_OUT : RANG_DF1_IN;
                          //!@else if(index_of_df == 1)
                          //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_OUT : RANG_DF2_IN;
                          //!@else if(index_of_df == 2)
                          //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_OUT : RANG_DF3_IN;
                          //!@else if(index_of_df == 3)
                          //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_OUT : RANG_DF4_IN;
                          //!@else if(index_of_df == 4)
                          //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_OUT : RANG_DF5_IN;
                          //!@else if(index_of_df == 5)
                          //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_OUT : RANG_DF6_IN;
                          //!@else if(index_of_df == 6)
                          //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_OUT : RANG_DF7_IN;
                          //!@else if(index_of_df == 7)
                          //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_OUT : RANG_DF8_IN;
                          //!@else if(index_of_df == 8)
                          //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_OUT : RANG_DF9_IN;
                          //!@else if(index_of_df == 9)
                          //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_OUT : RANG_DF10_IN;
                          //!@else if(index_of_df == 10)
                          //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_OUT : RANG_DF11_IN;
                          //!@else if(index_of_df == 11)
                          //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_OUT : RANG_DF12_IN;
                          //!@else if(index_of_df == 12)
                          //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_OUT : RANG_DF13_IN;
                          //!@else if(index_of_df == 13)
                          //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_OUT : RANG_DF14_IN;
                          //!@else if(index_of_df == 14)
                          //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_OUT : RANG_DF15_IN;
                          //!@else
                          //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_OUT : RANG_DF16_IN;
                        if(index_of_df == 0)
                            index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_OUT : RNG_BIG_DF1_IN;
                          else if(index_of_df == 1)
                            index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_OUT : RNG_BIG_DF2_IN;
                          else if(index_of_df == 2)
                            index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_OUT : RNG_BIG_DF3_IN;
                          else if(index_of_df == 3)
                            index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_OUT : RNG_BIG_DF4_IN;
                          else if(index_of_df == 4)
                            index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_OUT : RNG_BIG_DF5_IN;
                          else if(index_of_df == 5)
                            index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_OUT : RNG_BIG_DF6_IN;
                          else if(index_of_df == 6)
                            index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_OUT : RNG_BIG_DF7_IN;
                          else if(index_of_df == 7)
                            index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_OUT : RNG_BIG_DF8_IN;
                          else if(index_of_df == 8)
                            index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_OUT : RNG_BIG_DF9_IN;
                          else if(index_of_df == 9)
                            index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_OUT : RNG_BIG_DF10_IN;
                          else if(index_of_df == 10)
                            index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_OUT : RNG_BIG_DF11_IN;
                          else if(index_of_df == 11)
                            index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_OUT : RNG_BIG_DF12_IN;
                          else if(index_of_df == 12)
                            index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_OUT : RNG_BIG_DF13_IN;
                          else if(index_of_df == 13)
                            index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_OUT : RNG_BIG_DF14_IN;
                          else if(index_of_df == 14)
                            index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_OUT : RNG_BIG_DF15_IN;
                          else
                            index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_OUT : RNG_BIG_DF16_IN;
                        }
                        else
                        {
                          //!@if(index_of_df == 0)
                          //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_IN : RANG_DF1_OUT;
                          //!@else if(index_of_df == 1)
                          //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_IN : RANG_DF2_OUT;
                          //!@else if(index_of_df == 2)
                          //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_IN : RANG_DF3_OUT;
                          //!@else if(index_of_df == 3)
                          //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_IN : RANG_DF4_OUT;
                          //!@else if(index_of_df == 4)
                          //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_IN : RANG_DF5_OUT;
                          //!@else if(index_of_df == 5)
                          //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_IN : RANG_DF6_OUT;
                          //!@else if(index_of_df == 6)
                          //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_IN : RANG_DF7_OUT;
                          //!@else if(index_of_df == 7)
                          //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_IN : RANG_DF8_OUT;
                          //!@else if(index_of_df == 8)
                          //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_IN : RANG_DF9_OUT;
                          //!@else if(index_of_df == 9)
                          //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_IN : RANG_DF10_OUT;
                          //!@else if(index_of_df == 10)
                          //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_IN : RANG_DF11_OUT;
                          //!@else if(index_of_df == 11)
                          //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_IN : RANG_DF12_OUT;
                          //!@else if(index_of_df == 12)
                          //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_IN : RANG_DF13_OUT;
                          //!@else if(index_of_df == 13)
                          //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_IN : RANG_DF14_OUT;
                          //!@else if(index_of_df == 14)
                          //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_IN : RANG_DF15_OUT;
                          //!@else 
                          //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_IN : RANG_DF16_OUT;
                        if(index_of_df == 0)
                            index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_IN : RNG_BIG_DF1_OUT;
                          else if(index_of_df == 1)
                            index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_IN : RNG_BIG_DF2_OUT;
                          else if(index_of_df == 2)
                            index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_IN : RNG_BIG_DF3_OUT;
                          else if(index_of_df == 3)
                            index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_IN : RNG_BIG_DF4_OUT;
                          else if(index_of_df == 4)
                            index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_IN : RNG_BIG_DF5_OUT;
                          else if(index_of_df == 5)
                            index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_IN : RNG_BIG_DF6_OUT;
                          else if(index_of_df == 6)
                            index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_IN : RNG_BIG_DF7_OUT;
                          else if(index_of_df == 7)
                            index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_IN : RNG_BIG_DF8_OUT;
                          else if(index_of_df == 8)
                            index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_IN : RNG_BIG_DF9_OUT;
                          else if(index_of_df == 9)
                            index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_IN : RNG_BIG_DF10_OUT;
                          else if(index_of_df == 10)
                            index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_IN : RNG_BIG_DF11_OUT;
                          else if(index_of_df == 11)
                            index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_IN : RNG_BIG_DF12_OUT;
                          else if(index_of_df == 12)
                            index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_IN : RNG_BIG_DF13_OUT;
                          else if(index_of_df == 13)
                            index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_IN : RNG_BIG_DF14_OUT;
                          else if(index_of_df == 14)
                            index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_IN : RNG_BIG_DF15_OUT;
                          else 
                            index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_IN : RNG_BIG_DF16_OUT;
                        }
                    
                        if(index_deleted_function == current_ekran.index_position)
                        {
                          found_new_index = 0;
                          current_ekran.index_position--;
                        }
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                    {
                      unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                      unsigned int index_of_dt = index_in_ekran_list / 4;

                      for (unsigned int i = 0; i < 3; i++)
                      {
                        unsigned int index_deleted_function = 0;
                        //Першою перевіряємо функцію з більшим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                        if (i == 0)
                        {
                          if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_OUT;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_OUT;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_OUT;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_OUT;
                          else total_error_sw_fixed();
                        }
                        else if (i == 1)
                        {
                        if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_RESET;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_RESET;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_RESET;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_RESET;
                          else total_error_sw_fixed();
                        }
                        else
                        {
                        if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_SET;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_SET;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_SET;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_SET;
                          else total_error_sw_fixed();
                        }
                    
                        if(index_deleted_function == current_ekran.index_position)
                        {
                          found_new_index = 0;
                          current_ekran.index_position--;
                        }
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                    {
                      unsigned int index_of_d_and = current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_AND1 + index_of_d_and;
                      unsigned int index_deleted_function = RNG_BIG_D_AND1 + index_of_d_and;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                    {
                      unsigned int index_of_d_or = current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_OR1 + index_of_d_or;
                      unsigned int index_deleted_function = RNG_BIG_D_OR1 + index_of_d_or;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                    {
                      unsigned int index_of_d_xor = current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_XOR1 + index_of_d_xor;
                      unsigned int index_deleted_function = RNG_BIG_D_XOR1 + index_of_d_xor;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                    {
                      unsigned int index_of_d_not = current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_NOT1 + index_of_d_not;
                      unsigned int index_deleted_function = RNG_BIG_D_NOT1 + index_of_d_not;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position--;
                      }
                    }
                    
                    //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                    if(current_ekran.index_position < 0)
                    {
                      found_new_index = 0;
                      current_ekran.index_position = max_row_ranguvannja - 1;
                    }
                  }
                }
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                
                //Формуємо екран відображення зранжованих функцій
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OUTPUT);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_LED);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_A_REG);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_REG);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_H);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_H);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_L);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_L);
                
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DF);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DT);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_AND);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_OR);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_XOR);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_NOT);
              }
              
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(
                 ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6)) ||
                 ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1 ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                )   
              {
                int max_row_ranguvannja = 0;
                
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_BUTTON;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_INPUT;
                else total_error_sw_fixed();

                if(current_ekran.edition == 0)
                {
                  unsigned int temp_state[N_SMALL];
                  unsigned int not_null = false;
                  if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  {
                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  {
                    for (unsigned int i = 0; i < N_SMALL; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }

                  if (not_null == false) current_ekran.index_position = 0;
                  else
                  {
                    if(++current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                    // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                    // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                    while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) ==0)
                    {
                      current_ekran.index_position++;
                      if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                    }
                  }
                }
                else
                {
                  //Редагування
                  unsigned int found_new_index = 0;
//                  int add_filter[0 + 1] = 
//                  {
//                    -1 /*признак завершення масиву*/
//                  };
                  
                  //Переміщаємося на наступну функцію
                  if(++current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                  //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                  while (found_new_index == 0)//! BOOK4
                  {
                    check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                       /*add_filter,*/
                                                                       /*el_filter,*/
                                                                       1,
                                                                       TOTAL_GENERAL_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_DZO_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MTZ_STUB_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_ZDZ_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MCZO_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_MCZR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_APV_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_ACHR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UROV_SIGNAL_FOR_RANG_SMALL+1,
                                                                       TOTAL_DZR_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UMIN_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UMAX_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_UP_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_VMP_SIGNAL_FOR_RANG_SMALL,
                                                                       TOTAL_EL_SIGNAL_FOR_RANG_SMALL
                                                                      );
                    
                    //Перевіряємо режим рооботи функціональної кнопки (якщо іде редагування ФК)
                    if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                    {
                      uint32_t mode = (current_settings.buttons_mode >> (current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1)) & 0x1;
                      if (_CHECK_SET_BIT(buttons_mode[mode], current_ekran.index_position) == 0)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    
                    //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                    if(current_ekran.index_position >= max_row_ranguvannja)
                    {
                      found_new_index = 0;
                      current_ekran.index_position = 0;
                    }
                  }
                }
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                
                //Формуємо екран відображення зранжованих функцій
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
                  make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_BUTTON);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
                  make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_INPUT);//!  BOOK 3
              }
              else if(
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST        )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1   ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17             )) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR                                                                 ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR                                                                ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB                                                                             ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB                                                                              ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H                                                                           ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H                                                                            ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L                                                                           ) ||
                      ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L                                                                            ) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK           )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS)) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8         )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1       ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8          )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8         )) ||
                      ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1      ) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16        ))
                     )
              {
                int max_row_ranguvannja = 0;
                
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OUTPUT;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_LED;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ANALOG_REGISTRATOR;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DIGITAL_REGISTRATOR;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ON_CB;
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OFF_CB;
                else if ((current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H) || (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_ON_CB;
                else if ((current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H) || (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_OFF_CB;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DF;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_DT;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_AND;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_OR;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_XOR;
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  max_row_ranguvannja = MAX_ROW_RANGUVANNJA_D_NOT;
                else total_error_sw_fixed();

                if(current_ekran.edition == 0)
                {
                  unsigned int temp_state[N_BIG];
                  unsigned int not_null = false;
                  
                  if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_analog_registrator[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_digital_registrator[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on_cb[i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb_oh[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on__cb_oh[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_off_cb_rl[i];
                    }
                  }
                  else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_on__cb_rl[i];
                    }
                  }
                  
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                    unsigned int type_source = index_in_ekran_list % 3;
                    unsigned int index_of_df = index_in_ekran_list / 3;
    
                    if(type_source == 0)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else if(type_source == 1)
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                    else
                    {
                      for (unsigned int i = 0; i < N_BIG; i++)
                      {
                        temp_state[i] = current_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + i];
                        not_null |= (temp_state[i] != 0);
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  {
                    unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                    unsigned int type_source = index_in_ekran_list % 2;
                    unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                    unsigned int index_of_dt = index_in_ekran_list / 4;
    
                    if (type_of_action == INDEX_ML_SET_DT)
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                    }
                    else
                    {
                      if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                      else
                      {
                        for (unsigned int i = 0; i < N_BIG; i++)
                        {
                          temp_state[i] = current_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + i];
                          not_null |= (temp_state[i] != 0);
                        }
                      }
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }
                  else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  {
                    for (unsigned int i = 0; i < N_BIG; i++)
                    {
                      temp_state[i] = current_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + i];
                      not_null |= (temp_state[i] != 0);
                    }
                  }

                  if (not_null == false) current_ekran.index_position = 0;
                  else
                  {
                    if(++current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                    // (x>>5) аналогічне операції x / 32 - ціла частина від ділення на 32
                    // (x & 0x1f) аналогічне операції x % 32 - остача від ділення на 32
                    while ((temp_state[current_ekran.index_position >> 5] & (1<<(current_ekran.index_position  & 0x1f))) ==0)
                    {
                      current_ekran.index_position++;
                      if(current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                    }
                  }
                }
                else
                {
                  //Редагування
                  unsigned int found_new_index = 0;
//                  int add_filter[3 + 1] = 
//                  {
//                    RANG_PO_NZZ,
//                    RANG_NZZ,
//                    RANG_SECTOR_NZZ,
//                    -1 /*признак завершення масиву*/
//                  };
                  
                  //Переміщаємося на наступну функцію
                  if(++current_ekran.index_position >= max_row_ranguvannja) current_ekran.index_position = 0;
                  //Перевіряємо, чи даний індекс функції присутній у даній конфігурації 
                  while (found_new_index == 0)
                  {
                    check_current_index_is_presented_in_configuration_a01(&found_new_index,
                                                                       /*add_filter,*/
                                                                       /*el_filter,*/
                                                                       1,
                                                                       TOTAL_GENERAL_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_DZO_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MTZ_STUB_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_ZDZ_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MCZO_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_MCZR_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_APV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_ACHR_CHAPV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UROV_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_DZR_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UMIN_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UMAX_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_UP_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_VMP_SIGNAL_FOR_RNG_BIG,
                                                                       TOTAL_EL_SIGNAL_FOR_RNG_BIG
                                                                      );

                    //Перевіряємо, чи ми не  на індексі функцій із списку загальних, яку треба викинути для даного типу ранжування
                    if (
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR) ||
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB             ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB              ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H           ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H            ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L           ) || 
                        ( current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L            )  
                       
                       )   
                    {
                      unsigned int index_deleted_function = 0;
                      
                    if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                        index_deleted_function = RNG_BIG_WORK_A_REJESTRATOR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                        index_deleted_function = RNG_BIG_WORK_D_REJESTRATOR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                        index_deleted_function = RNG_BIG_WORK_BO_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                        index_deleted_function = RNG_BIG_WORK_BV_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                        index_deleted_function = RNG_BIG_WORK_BO_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                        index_deleted_function = RNG_BIG_WORK_BV_VVO;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                        index_deleted_function = RNG_BIG_WORK_BO_VVR;
                      else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                        index_deleted_function = RNG_BIG_WORK_BV_VVR;
                      else total_error_sw_fixed();
                    
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK))
                    {
                      unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                      unsigned int index_of_df = index_in_ekran_list / 3;

                      for (unsigned int i = 0; i < 2; i++)
                      {
                        unsigned int index_deleted_function;
                        //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу можна було переміститися на функцію, яку можна ранжувати
                        if (i == 0)
                        {
                          //!@if(index_of_df == 0)
                          //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_IN : RANG_DF1_OUT;
                          //!@else if(index_of_df == 1)
                          //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_IN : RANG_DF2_OUT;
                          //!@else if(index_of_df == 2)
                          //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_IN : RANG_DF3_OUT;
                          //!@else if(index_of_df == 3)
                          //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_IN : RANG_DF4_OUT;
                          //!@else if(index_of_df == 4)
                          //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_IN : RANG_DF5_OUT;
                          //!@else if(index_of_df == 5)
                          //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_IN : RANG_DF6_OUT;
                          //!@else if(index_of_df == 6)
                          //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_IN : RANG_DF7_OUT;
                          //!@else if(index_of_df == 7)
                          //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_IN : RANG_DF8_OUT;
                          //!@else if(index_of_df == 8)
                          //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_IN : RANG_DF9_OUT;
                          //!@else if(index_of_df == 9)
                          //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_IN : RANG_DF10_OUT;
                          //!@else if(index_of_df == 10)
                          //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_IN : RANG_DF11_OUT;
                          //!@else if(index_of_df == 11)
                          //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_IN : RANG_DF12_OUT;
                          //!@else if(index_of_df == 12)
                          //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_IN : RANG_DF13_OUT;
                          //!@else if(index_of_df == 13)
                          //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_IN : RANG_DF14_OUT;
                          //!@else if(index_of_df == 14)
                          //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_IN : RANG_DF15_OUT;
                          //!@else 
                          //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_IN : RANG_DF16_OUT;
                        if(index_of_df == 0)
                            index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_IN : RNG_BIG_DF1_OUT;
                          else if(index_of_df == 1)
                            index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_IN : RNG_BIG_DF2_OUT;
                          else if(index_of_df == 2)
                            index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_IN : RNG_BIG_DF3_OUT;
                          else if(index_of_df == 3)
                            index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_IN : RNG_BIG_DF4_OUT;
                          else if(index_of_df == 4)
                            index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_IN : RNG_BIG_DF5_OUT;
                          else if(index_of_df == 5)
                            index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_IN : RNG_BIG_DF6_OUT;
                          else if(index_of_df == 6)
                            index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_IN : RNG_BIG_DF7_OUT;
                          else if(index_of_df == 7)
                            index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_IN : RNG_BIG_DF8_OUT;
                          else if(index_of_df == 8)
                            index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_IN : RNG_BIG_DF9_OUT;
                          else if(index_of_df == 9)
                            index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_IN : RNG_BIG_DF10_OUT;
                          else if(index_of_df == 10)
                            index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_IN : RNG_BIG_DF11_OUT;
                          else if(index_of_df == 11)
                            index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_IN : RNG_BIG_DF12_OUT;
                          else if(index_of_df == 12)
                            index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_IN : RNG_BIG_DF13_OUT;
                          else if(index_of_df == 13)
                            index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_IN : RNG_BIG_DF14_OUT;
                          else if(index_of_df == 14)
                            index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_IN : RNG_BIG_DF15_OUT;
                          else 
                            index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_IN : RNG_BIG_DF16_OUT;
                        }
                        else
                        {
                          //!@if(index_of_df == 0)
                          //!@  index_deleted_function = (RANG_DF1_OUT > RANG_DF1_IN) ? RANG_DF1_OUT : RANG_DF1_IN;
                          //!@else if(index_of_df == 1)
                          //!@  index_deleted_function = (RANG_DF2_OUT > RANG_DF2_IN) ? RANG_DF2_OUT : RANG_DF2_IN;
                          //!@else if(index_of_df == 2)
                          //!@  index_deleted_function = (RANG_DF3_OUT > RANG_DF3_IN) ? RANG_DF3_OUT : RANG_DF3_IN;
                          //!@else if(index_of_df == 3)
                          //!@  index_deleted_function = (RANG_DF4_OUT > RANG_DF4_IN) ? RANG_DF4_OUT : RANG_DF4_IN;
                          //!@else if(index_of_df == 4)
                          //!@  index_deleted_function = (RANG_DF5_OUT > RANG_DF5_IN) ? RANG_DF5_OUT : RANG_DF5_IN;
                          //!@else if(index_of_df == 5)
                          //!@  index_deleted_function = (RANG_DF6_OUT > RANG_DF6_IN) ? RANG_DF6_OUT : RANG_DF6_IN;
                          //!@else if(index_of_df == 6)
                          //!@  index_deleted_function = (RANG_DF7_OUT > RANG_DF7_IN) ? RANG_DF7_OUT : RANG_DF7_IN;
                          //!@else if(index_of_df == 7)
                          //!@  index_deleted_function = (RANG_DF8_OUT > RANG_DF8_IN) ? RANG_DF8_OUT : RANG_DF8_IN;
                          //!@else if(index_of_df == 8)
                          //!@  index_deleted_function = (RANG_DF9_OUT > RANG_DF9_IN) ? RANG_DF9_OUT : RANG_DF9_IN;
                          //!@else if(index_of_df == 9)
                          //!@  index_deleted_function = (RANG_DF10_OUT > RANG_DF10_IN) ? RANG_DF10_OUT : RANG_DF10_IN;
                          //!@else if(index_of_df == 10)
                          //!@  index_deleted_function = (RANG_DF11_OUT > RANG_DF11_IN) ? RANG_DF11_OUT : RANG_DF11_IN;
                          //!@else if(index_of_df == 11)
                          //!@  index_deleted_function = (RANG_DF12_OUT > RANG_DF12_IN) ? RANG_DF12_OUT : RANG_DF12_IN;
                          //!@else if(index_of_df == 12)
                          //!@  index_deleted_function = (RANG_DF13_OUT > RANG_DF13_IN) ? RANG_DF13_OUT : RANG_DF13_IN;
                          //!@else if(index_of_df == 13)
                          //!@  index_deleted_function = (RANG_DF14_OUT > RANG_DF14_IN) ? RANG_DF14_OUT : RANG_DF14_IN;
                          //!@else if(index_of_df == 14)
                          //!@  index_deleted_function = (RANG_DF15_OUT > RANG_DF15_IN) ? RANG_DF15_OUT : RANG_DF15_IN;
                          //!@else
                          //!@  index_deleted_function = (RANG_DF16_OUT > RANG_DF16_IN) ? RANG_DF16_OUT : RANG_DF16_IN;
                        if(index_of_df == 0)
                            index_deleted_function = (RNG_BIG_DF1_OUT > RNG_BIG_DF1_IN) ? RNG_BIG_DF1_OUT : RNG_BIG_DF1_IN;
                          else if(index_of_df == 1)
                            index_deleted_function = (RNG_BIG_DF2_OUT > RNG_BIG_DF2_IN) ? RNG_BIG_DF2_OUT : RNG_BIG_DF2_IN;
                          else if(index_of_df == 2)
                            index_deleted_function = (RNG_BIG_DF3_OUT > RNG_BIG_DF3_IN) ? RNG_BIG_DF3_OUT : RNG_BIG_DF3_IN;
                          else if(index_of_df == 3)
                            index_deleted_function = (RNG_BIG_DF4_OUT > RNG_BIG_DF4_IN) ? RNG_BIG_DF4_OUT : RNG_BIG_DF4_IN;
                          else if(index_of_df == 4)
                            index_deleted_function = (RNG_BIG_DF5_OUT > RNG_BIG_DF5_IN) ? RNG_BIG_DF5_OUT : RNG_BIG_DF5_IN;
                          else if(index_of_df == 5)
                            index_deleted_function = (RNG_BIG_DF6_OUT > RNG_BIG_DF6_IN) ? RNG_BIG_DF6_OUT : RNG_BIG_DF6_IN;
                          else if(index_of_df == 6)
                            index_deleted_function = (RNG_BIG_DF7_OUT > RNG_BIG_DF7_IN) ? RNG_BIG_DF7_OUT : RNG_BIG_DF7_IN;
                          else if(index_of_df == 7)
                            index_deleted_function = (RNG_BIG_DF8_OUT > RNG_BIG_DF8_IN) ? RNG_BIG_DF8_OUT : RNG_BIG_DF8_IN;
                          else if(index_of_df == 8)
                            index_deleted_function = (RNG_BIG_DF9_OUT > RNG_BIG_DF9_IN) ? RNG_BIG_DF9_OUT : RNG_BIG_DF9_IN;
                          else if(index_of_df == 9)
                            index_deleted_function = (RNG_BIG_DF10_OUT > RNG_BIG_DF10_IN) ? RNG_BIG_DF10_OUT : RNG_BIG_DF10_IN;
                          else if(index_of_df == 10)
                            index_deleted_function = (RNG_BIG_DF11_OUT > RNG_BIG_DF11_IN) ? RNG_BIG_DF11_OUT : RNG_BIG_DF11_IN;
                          else if(index_of_df == 11)
                            index_deleted_function = (RNG_BIG_DF12_OUT > RNG_BIG_DF12_IN) ? RNG_BIG_DF12_OUT : RNG_BIG_DF12_IN;
                          else if(index_of_df == 12)
                            index_deleted_function = (RNG_BIG_DF13_OUT > RNG_BIG_DF13_IN) ? RNG_BIG_DF13_OUT : RNG_BIG_DF13_IN;
                          else if(index_of_df == 13)
                            index_deleted_function = (RNG_BIG_DF14_OUT > RNG_BIG_DF14_IN) ? RNG_BIG_DF14_OUT : RNG_BIG_DF14_IN;
                          else if(index_of_df == 14)
                            index_deleted_function = (RNG_BIG_DF15_OUT > RNG_BIG_DF15_IN) ? RNG_BIG_DF15_OUT : RNG_BIG_DF15_IN;
                          else
                            index_deleted_function = (RNG_BIG_DF16_OUT > RNG_BIG_DF16_IN) ? RNG_BIG_DF16_OUT : RNG_BIG_DF16_IN;
                        }
                    
                        if(index_deleted_function == current_ekran.index_position)
                        {
                          found_new_index = 0;
                          current_ekran.index_position++;
                        }
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                    {
                      unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                      unsigned int index_of_dt = index_in_ekran_list / 4;

                      for (unsigned int i = 0; i < 3; i++)
                      {
                        unsigned int index_deleted_function = 0;
                        //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                        if (i == 0)
                        {
                        if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_SET;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_SET;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_SET;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_SET;
                          else total_error_sw_fixed();
                        }
                        else if (i == 1)
                        {
                        if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_RESET;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_RESET;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_RESET;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_RESET;
                          else total_error_sw_fixed();
                        }
                        else
                        {
                        if(index_of_dt == 0)
                            index_deleted_function = RNG_BIG_DT1_OUT;
                          else if(index_of_dt == 1)
                            index_deleted_function = RNG_BIG_DT2_OUT;
                          else if(index_of_dt == 2)
                            index_deleted_function = RNG_BIG_DT3_OUT;
                          else if(index_of_dt == 3)
                            index_deleted_function = RNG_BIG_DT4_OUT;
                          else total_error_sw_fixed();
                        }
                    
                        if(index_deleted_function == current_ekran.index_position)
                        {
                          found_new_index = 0;
                          current_ekran.index_position++;
                        }
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                    {
                      unsigned int index_of_d_and = current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_AND1 + index_of_d_and;
                      unsigned int index_deleted_function = RNG_BIG_D_AND1 + index_of_d_and;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                    {
                      unsigned int index_of_d_or = current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_OR1 + index_of_d_or;
                      unsigned int index_deleted_function = RNG_BIG_D_OR1 + index_of_d_or;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                    {
                      unsigned int index_of_d_xor = current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_XOR1 + index_of_d_xor;
                      unsigned int index_deleted_function = RNG_BIG_D_XOR1 + index_of_d_xor;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }
                    else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                    {
                      unsigned int index_of_d_not = current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1;

                      //Першою перевіряємо функцію з меншим номером, щоб за одну операцію циклу  можна було переміститися на функцію, яку можна ранжувати
                      //!@unsigned int index_deleted_function = @RANG_D_NOT1 + index_of_d_not;
                      unsigned int index_deleted_function = RNG_BIG_D_NOT1 + index_of_d_not;
                    
                      if(index_deleted_function == current_ekran.index_position)
                      {
                        found_new_index = 0;
                        current_ekran.index_position++;
                      }
                    }

                    //Перевіряємо, чи ми не вийшли за допустиму кількість функцій
                    if(current_ekran.index_position >= max_row_ranguvannja)
                    {
                      found_new_index = 0;
                      current_ekran.index_position = 0;
                    }
                  }
                }
                position_in_current_level_menu[current_ekran.current_level] = current_ekran.index_position;
                
                //Формуємо екран відображення зранжованих функцій
                if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OUTPUT);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_LED);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_A_REG);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_REG);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_H);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_H);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_L);
                else if (current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_L);
                
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DF);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DT);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_AND);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_OR);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_XOR);
                else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
                  make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_NOT);
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else if ((new_state_keyboard == (1<<BIT_KEY_RIGHT)) || (new_state_keyboard == (1<<BIT_KEY_LEFT)))
            {
              //Натиснута кнопка RIGHT або LEFT
              //Міняємо на протилежний відповідний біт для вибраної функції
              if((current_ekran.current_level >= EKRAN_RANGUVANNJA_BUTTON_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_BUTTON_6))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_buttons[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_BUTTON_1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_BUTTON);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_INPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_INPUT_LAST))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_inputs[N_SMALL*(current_ekran.current_level - EKRAN_RANGUVANNJA_INPUT_1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_bi(current_ekran.current_level, INDEX_VIEWING_INPUT);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_OUTPUT_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_OUTPUT_LAST))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_outputs[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_OUTPUT_1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OUTPUT);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_LED_1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_LED_17))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_leds[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_LED_1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_LED);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ANALOG_REGISTRATOR)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_analog_registrator[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_A_REG);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_DIGITAL_REGISTRATOR)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_digital_registrator[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_REG);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_off_cb[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_on_cb[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_H)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_off_cb_oh[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_H);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_H)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_on__cb_oh[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_H);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_OFF_CB_L)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_off_cb_rl[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_OFF_CB_L);
              }
              else if(current_ekran.current_level == EKRAN_RANGUVANNJA_ON_CB_L)
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_on__cb_rl[offset] ^= (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_ON_CB_L);
              }
              
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_DF1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_DF16_BLK ))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_DF1_PLUS;
                unsigned int type_source = index_in_ekran_list % 3;
                unsigned int index_of_df = index_in_ekran_list / 3;
    
                if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DF)
                  edition_settings.ranguvannja_df_source_plus[N_BIG*index_of_df + offset] ^= (1 << shift);
                else if(type_source == INDEX_ML_LIST_TYPE_SOURCE_MINUS_DF)
                  edition_settings.ranguvannja_df_source_minus[N_BIG*index_of_df + offset] ^= (1 << shift);
                else
                  edition_settings.ranguvannja_df_source_blk[N_BIG*index_of_df + offset] ^= (1 << shift);
                
                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DF);
              }
              else if ((current_ekran.current_level >= EKRAN_RANGUVANNJA_SET_DT1_PLUS) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_RESET_DT4_MINUS))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                unsigned int index_in_ekran_list = current_ekran.current_level - EKRAN_RANGUVANNJA_SET_DT1_PLUS;
                unsigned int type_source = index_in_ekran_list % 2;
                unsigned int type_of_action = (index_in_ekran_list / 2) & 0x1;
                unsigned int index_of_dt = index_in_ekran_list / 4;
    
                if (type_of_action == INDEX_ML_SET_DT)
                {
                  if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    edition_settings.ranguvannja_set_dt_source_plus[N_BIG*index_of_dt + offset] ^= (1 << shift);
                  else
                    edition_settings.ranguvannja_set_dt_source_minus[N_BIG*index_of_dt + offset] ^= (1 << shift);
                }
                else
                {
                  if(type_source == INDEX_ML_LIST_TYPE_SOURCE_PLUS_DT)
                    edition_settings.ranguvannja_reset_dt_source_plus[N_BIG*index_of_dt + offset] ^= (1 << shift);
                  else
                    edition_settings.ranguvannja_reset_dt_source_minus[N_BIG*index_of_dt + offset] ^= (1 << shift);
                }
                
                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_DT);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_AND1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_AND8))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_d_and[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_AND1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_AND);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_OR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_OR8))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_d_or[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_OR1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_OR);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_XOR1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_XOR8))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_d_xor[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_XOR1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_XOR);
              }
              else if((current_ekran.current_level >= EKRAN_RANGUVANNJA_D_NOT1) && (current_ekran.current_level <= EKRAN_RANGUVANNJA_D_NOT16))
              {
                unsigned int offset, shift;
                offset =  current_ekran.index_position >> 5;        //Це є, фактично, ділення на 32
                shift  = (current_ekran.index_position & (32 - 1)); //Це є, фактично, визначення остачі від ділення на 32

                edition_settings.ranguvannja_d_not[N_BIG*(current_ekran.current_level - EKRAN_RANGUVANNJA_D_NOT1) + offset] ^=
                  (1 << shift);

                //Формуємо екран відображення зранжованих функцій
                make_ekran_set_function_in_output_led_df_dt_reg(current_ekran.current_level, INDEX_VIEWING_D_NOT);
              }

              //Очистити сигналізацію, що натиснута кнопка 
              if (new_state_keyboard == (1<<BIT_KEY_RIGHT)) new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
              else new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
/******************************************************************************************************************************************/ 

/************************************* BEGIN  EKRAN_VIDKLUCHENNJA *****************************************************************************************************/      
    case EKRAN_VIDKLUCHENNJA:
      {
        //Очищаємо всі біти краім упралінських
        new_state_keyboard &= (1<<BIT_KEY_ENTER)|(1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN)|(1<<BIT_REWRITE);
        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
        if (new_state_keyboard !=0)
        {
          //Пріоритет стоїть на обновлені екрану
          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
          {
            if(current_ekran.current_level == EKRAN_VIDKLUCHENNJA)
            {
              if(current_ekran.index_position >= ((int)MAX_ROW_FOR_VIDKLUCHENNJA)) current_ekran.index_position = 0;
              
              if (
                  (info_vidkluchennja_vymykacha[0] == 0) &&
                  (info_vidkluchennja_vymykacha[1] == 0)
                 )   
              {
                //Подаємо команду на вихід з віна повідомдень про відключення від захистів
                new_state_keyboard |= (1<<BIT_KEY_ENTER);
              }
              else
              {
                //Переходимо на наступну інформацію про спрацювання захистів
                current_ekran.index_position++;
              
                while (_CHECK_SET_BIT(info_vidkluchennja_vymykacha, current_ekran.index_position) == 0)
                {
                  current_ekran.index_position++;
                  if(current_ekran.index_position >= ((int)MAX_ROW_FOR_VIDKLUCHENNJA)) current_ekran.index_position = 0;
                }
              }
              position_in_current_level_menu[EKRAN_VIDKLUCHENNJA] = current_ekran.index_position;
              //Формуємо екран повідомдень про відключення від захистів
              make_ekran_vidkluchenja();
            }
            
            //Очищаємо біт обновлення екрану
            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
          }
          else
          {
            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
            {
              //Очищаємо інформацію про спрацювання захистів
              info_vidkluchennja_vymykacha[0] = 0;
              info_vidkluchennja_vymykacha[1] = 0;
              
              //Переходимо у попереднє меню
              current_ekran = current_ekran_reserv_off_on;

              //Відображаємо попередній екран (бо діалогові вікна не обновлюються при виконанні команди REWRITE)
              for (unsigned int i = 0; i < MAX_ROW_LCD; i++)
              {
                for (unsigned int j = 0; j < MAX_COL_LCD; j++) working_ekran[i][j] = working_ekran_reserv_off_on[i][j];
              }
              //Обновити повністю весь екран
              current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;
              time_rewrite = MAX_TIME_REWRITE_EKRAN;

//              //Виставляємо команду на обновлекння нового екрану
//              new_state_keyboard |= (1<<BIT_REWRITE);
              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_UP))
            {
              //Натиснута кнопка UP
              if(current_ekran.current_level == EKRAN_VIDKLUCHENNJA)
              {
                if (
                    (info_vidkluchennja_vymykacha[0] == 0) &&
                    (info_vidkluchennja_vymykacha[1] == 0)
                   )   
                {
                  //Подаємо команду на вихід з віна повідомдень про відключення від захистів
                  new_state_keyboard |= (1<<BIT_KEY_ENTER);
                }
                else
                {
                  if(--current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIDKLUCHENNJA - 1;
                  while (_CHECK_SET_BIT(info_vidkluchennja_vymykacha, current_ekran.index_position) == 0)
                  {
                    current_ekran.index_position--;
                    if(current_ekran.index_position < 0) current_ekran.index_position = MAX_ROW_FOR_VIDKLUCHENNJA - 1;
                  }
                }
                position_in_current_level_menu[EKRAN_VIDKLUCHENNJA] = current_ekran.index_position;
                //Формуємо екран повідомдень про відключення від захистів
                make_ekran_vidkluchenja();
                time_rewrite = 0;
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
            }
            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
            {
              //Натиснута кнопка DOWN
              if(current_ekran.current_level == EKRAN_VIDKLUCHENNJA)
              {
                if (
                    (info_vidkluchennja_vymykacha[0] == 0) &&
                    (info_vidkluchennja_vymykacha[1] == 0)
                   )   
                {
                  //Подаємо команду на вихід з віна повідомдень про відключення від захистів
                  new_state_keyboard |= (1<<BIT_KEY_ENTER);
                }
                else
                {
                  if(++current_ekran.index_position >= ((int)MAX_ROW_FOR_VIDKLUCHENNJA)) current_ekran.index_position = 0;
                  while (_CHECK_SET_BIT(info_vidkluchennja_vymykacha, current_ekran.index_position) == 0)
                  {
                    current_ekran.index_position++;
                    if(current_ekran.index_position >= ((int)MAX_ROW_FOR_VIDKLUCHENNJA)) current_ekran.index_position = 0;
                  }
                }
                position_in_current_level_menu[EKRAN_VIDKLUCHENNJA] = current_ekran.index_position;
                //Формуємо екран повідомдень про відключення від захистів
                make_ekran_vidkluchenja();
                time_rewrite = 0;
              }

              //Очистити сигналізацію, що натиснута кнопка 
              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
            }
            else
            {
              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
              unsigned int temp_data = new_state_keyboard;
              new_state_keyboard &= ~temp_data;
            }
          }
        }
        break;
      }
      
   

/************************************* BEGIN  EKRAN_LEVEL_ *****************************************************************************************************/      
//    case 0xff:
//      {
//        //Очищаємо всі біти краім упралінських
//        new_state_keyboard &= (1<<BIT_KEY_ENTER)|(1<<BIT_KEY_ESC)|(1<<BIT_KEY_UP)|(1<<BIT_KEY_DOWN)|(1<<BIT_REWRITE);
//        //Дальше виконуємо дії, якщо натиснута кнопка на яку треба реагівати, або стоїть команда обновити екран
//        if (new_state_keyboard !=0)
//        {
//          //Пріоритет стоїть на обновлені екрану
//          if((new_state_keyboard & (1<<BIT_REWRITE)) !=0)
//          {
//            //Очищаємо біт обновлення екрану
//            new_state_keyboard &= (unsigned int)(~(1<<BIT_REWRITE));
//          }
//          else
//          {
//            if (new_state_keyboard == (1<<BIT_KEY_ENTER))
//            {
//              //Натиснута кнопка ENTER
//
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ENTER));
//            }
//            else if (new_state_keyboard == (1<<BIT_KEY_ESC))
//            {
//              //Переходимо у попереднє меню
//              current_ekran.current_level = previous_level_in_current_level_menu[current_ekran.current_level];
//              current_ekran.index_position = position_in_current_level_menu[current_ekran.current_level];
//              current_ekran.edition = 0;
//
//              //Виставляємо команду на обновлекння нового екрану
//              new_state_keyboard |= (1<<BIT_REWRITE);
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_ESC));
//            }
//            else if (new_state_keyboard == (1<<BIT_KEY_UP))
//            {
//              //Натиснута кнопка UP
//
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_UP));
//            }
//            else if (new_state_keyboard == (1<<BIT_KEY_DOWN))
//            {
//              //Натиснута кнопка DOWN
//
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_DOWN));
//            }
//            else if (new_state_keyboard == (1<<BIT_KEY_RIGHT))
//            {
//              //Натиснута кнопка RIGHT
//
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_RIGHT));
//            }
//            else if (new_state_keyboard == (1<<BIT_KEY_LEFT))
//            {
//              //Натиснута кнопка LEFT
//
//              //Очистити сигналізацію, що натиснута кнопка 
//              new_state_keyboard &= (unsigned int)(~(1<<BIT_KEY_LEFT));
//            }
//            else
//            {
//              //Натиснуто зразу декілька кнопок - це є невизначена ситуація, тому скидаємо сигналізацію про натиснуті кнопки і чекаємо знову
//              unsigned int temp_data = new_state_keyboard;
//              new_state_keyboard &= ~temp_data;
//            }
//          }
//        }
//        break;
//      }
/************************************* END  EKRAN_LEVEL_ *****************************************************************************************************/ 
    default:  break;
    }
  }
}
/*****************************************************/


/*****************************************************/
//Збільшення або зменшення числа при натисканні кнопки
/*
  Вхідні параменти
  label_value - вказівник на змінюване  число
  inc_dec 
    0 - зменшити на одиницю
    1 - збільшити на одиницю
*/
/*****************************************************/
void inc_or_dec_value(unsigned int *label_value, unsigned int inc_dec)
{
  int temp_value = *label_value;
  
  if(inc_dec == 0) temp_value--;
  else if(inc_dec == 1) temp_value++;
  
  if(temp_value > 9) temp_value = 0;
  else if(temp_value < 0) temp_value = 9;
  
  *label_value = temp_value;
}
/*****************************************************/

/*****************************************************/
//Робимо повідомлення про те чи треба щоб зміни набули сили
/*****************************************************/
void make_ekran_ask_rewrite(void)
{
  static const unsigned char name_string[MAX_NAMBER_LANGUAGE][2][MAX_COL_LCD] = 
  {
    {
     "Ввести изменения",
     "Да-ENTER Нет-ESC"
    },
    {
     "  Ввести зміни  ",
     "Так-ENTER Ні-ESC"
    },
    {
     " Enter changes  ",
     "Yes-ENTER No-ESC"
    },
    {
     "Ввести изменения",
     "Да-ENTER Нет-ESC"
    }
  };

  int index_language;
  
  if (current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
    index_language = index_language_in_array(edition_settings.language);
  else
    index_language = index_language_in_array(current_settings.language);

  //Копіюємо  рядки у робочий екран
  for (unsigned int i=0; i< MAX_ROW_LCD; i++)
  {
    for (unsigned int j = 0; j<MAX_COL_LCD; j++) working_ekran[i][j] = (i < 2) ? name_string[index_language][i][j] : ' ';
  }
  
  //Обновити повністю весь екран
  current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;
}
/*****************************************************/

/*****************************************************/
//Робимо повідомлення підтвердження виконання команди
/*****************************************************/
void make_ekran_about_activation_command(unsigned int index, unsigned char information[][MAX_NAMBER_LANGUAGE][MAX_COL_LCD])
{
  static const unsigned char name_string[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
  {
    "Да-ENTER Нет-ESC",
    "Так-ENTER Ні-ESC",
    "Yes-ENTER No-ESC",
    "Да-ENTER Нет-ESC"
  };
  int index_language = index_language_in_array(current_settings.language);

  //Копіюємо  рядки у робочий екран
  for (unsigned int i=0; i< MAX_ROW_LCD; i++)
  {
    if (i == 0)
    {
      for (unsigned int j = 0; j<MAX_COL_LCD; j++) working_ekran[i][j] = information[index][index_language][j];
    }
    else
    {
      for (unsigned int j = 0; j<MAX_COL_LCD; j++) working_ekran[i][j] = (i == 1) ? name_string[index_language][j] : ' ';
    }
  }
  
  //Обновити повністю весь екран
  current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;
}
/*****************************************************/

/*****************************************************/
//Формування вікна про помилку
/*****************************************************/
void make_ekran_about_error(const unsigned char information[][MAX_COL_LCD])
{
  static const unsigned char name_string[MAX_NAMBER_LANGUAGE][MAX_COL_LCD] = 
  {
    " Выход Enter/Esc",
    " Вихід Enter/Esc",
    " Exit Enter/Esc ",
    " Выход Enter/Esc"
  };
  int index_language;

  if (current_ekran.current_level == EKRAN_VIEW_SETTING_LANGUAGE)
    index_language = index_language_in_array(edition_settings.language);
  else
    index_language = index_language_in_array(current_settings.language);
  
  //Копіюємо  рядки у робочий екран
  for (unsigned int i=0; i< MAX_ROW_LCD; i++)
  {
    if (i == 0)
    {
      for (unsigned int j = 0; j<MAX_COL_LCD; j++) working_ekran[i][j] = information[index_language][j];
    }
    else
    {
      for (unsigned int j = 0; j<MAX_COL_LCD; j++) working_ekran[i][j] = (i == 1) ? name_string[index_language][j] : ' ';
    }
  }
  
  //Обновити повністю весь екран
  current_ekran.current_action = ACTION_WITH_CARRENT_EKRANE_FULL_UPDATE;
}
/*****************************************************/

/*****************************************************/
//Редагування величин вводимих значень
/*****************************************************
Вхідні параметри
  0 - натснуто кнопку вниз
  1 - натиснуто кнопку вверх
Вхідні параметри
  Немає
*****************************************************/
unsigned int edit_setpoint(unsigned int action, unsigned int value, unsigned int floating_value, unsigned int comma, unsigned int end, unsigned int min_step)
{
  unsigned int rozrjad, vaga = min_step, temp_value, data_return;
  //Вираховуємо розряд числа на який зараз вказує курсор
  rozrjad = end - current_ekran.position_cursor_x;
  
  //У разі якщо редаговане число є числом з комою, то враховуємо позицію коми
  if (floating_value != 0)
    if (current_ekran.position_cursor_x < ((int)comma)) rozrjad--;
      
  for(unsigned int i=0; i < rozrjad; i++)  vaga *= 10;
  
  //Виділяємо число , яке трба змінити
  temp_value = (value / vaga) % 10;
  
  //У вхідному числі, який нас цікавить редагований розряд скидаємо в нуль відніманням
  data_return = value - temp_value*vaga;
  
  //Змінюємо виділений розняд
  inc_or_dec_value(&temp_value, action);
  
  //Вводимо зміненй розряд у кінцевий результат
  data_return += temp_value*vaga;
  
  
  return data_return;
}
/*****************************************************/

/*****************************************************/
//Перевіряємо достовірність даних
/*
Результат
  1 - дані достовірні
  0 - дані недостовірні
*/
/*****************************************************/
unsigned int check_data_setpoint(unsigned int current_value, unsigned int min_value, unsigned int max_value)
{
  if ((current_value < min_value) || (current_value > max_value)) return 0;

  //Вихід з повідомленням, що уставко в межах допуску
  return 1;
}
unsigned int check_data_setpoint_sign(int current_value, int min_value, int max_value)
{
  if ((current_value < min_value) || (current_value > max_value)) return 0;

  //Вихід з повідомленням, що уставко в межах допуску
  return 1;
}

unsigned int edit_setpoint_signed(unsigned int action, unsigned int lValue, unsigned int col_signed, unsigned int col_end)
{
  short flag=0;
   if(lValue&0x80000000)
   {
    lValue = ~lValue;
    lValue++;
    flag=1;
   }//if
   if(current_ekran.position_cursor_x!=col_signed) lValue = edit_setpoint(action, lValue, 0, 
                                                                   0, col_end, 1);
   if(flag)
   {
    lValue = ~lValue;
    lValue++;
   }//if
   if(current_ekran.position_cursor_x==col_signed)
   {
    lValue = ~lValue;
    lValue++;
   }//if
  return lValue;
}//


/*****************************************************/

/*****************************************************/
//
/*****************************************************/
/*****************************************************/
