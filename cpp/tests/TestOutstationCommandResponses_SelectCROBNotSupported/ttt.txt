TEST_CASE(SUITE("SelectCROBNotSupported"))
{
    OutstationConfig config;
    OutstationTestObject t(config);
    t.LowerLayerUp();

    t.cmdHandler->SetResponse(CommandStatus::NOT_SUPPORTED);

    // Select group 12 Var 1, count = 1, index = 3
    t.SendToOutstation("C0 03 0C 01 17 01 03 01 01 01 00 00 00 01 00 00 00 00");

    // conformance requires IIN 2.2 to be set whenever the command status is not supported
// ñîîòâåòñòâèå òğåáóåò óñòàíîâêè ÈÈÍ 2.2 âñÿêèé ğàç, êîãäà ñòàòóñ êîìàíäû íå ïîääåğæèâàåòñÿ
    REQUIRE(t.lower->PopWriteAsHex()
            == "C0 81 80 04 0C 01 17 01 03 01 01 01 00 00 00 01 00 00 00 04"); // 0x04 status ==
                                                                               // CommandStatus::NOT_SUPPORTED

    REQUIRE(t.cmdHandler->numStart == 1);
    REQUIRE(t.cmdHandler->numEnd == 1);
}
